import{c as jx,r as Hv,o as Cj,a as bj,b as uu,d as Sj,e as Rj}from"./app-Cpkp2jct.js";var zx={},th,Ux;function nn(){if(Ux)return th;Ux=1;var t=function(e){return e&&e.Math===Math&&e};return th=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof jx=="object"&&jx)||t(typeof th=="object"&&th)||function(){return this}()||Function("return this")(),th}var Dv={},Nv,Yx;function un(){return Yx||(Yx=1,Nv=function(t){try{return!!t()}catch{return!0}}),Nv}var kv,Gx;function dr(){if(Gx)return kv;Gx=1;var t=un();return kv=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),kv}var Lv,qx;function _w(){if(qx)return Lv;qx=1;var t=un();return Lv=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Lv}var Fv,Kx;function cn(){if(Kx)return Fv;Kx=1;var t=_w(),e=Function.prototype.call;return Fv=t?e.bind(e):function(){return e.apply(e,arguments)},Fv}var $v={},Xx;function _j(){if(Xx)return $v;Xx=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return $v.f=n?function(r){var s=e(this,r);return!!s&&s.enumerable}:t,$v}var Vv,Zx;function Ew(){return Zx||(Zx=1,Vv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),Vv}var Wv,Qx;function rn(){if(Qx)return Wv;Qx=1;var t=_w(),e=Function.prototype,n=e.call,i=t&&e.bind.bind(n,n);return Wv=t?i:function(r){return function(){return n.apply(r,arguments)}},Wv}var Bv,Jx;function Xl(){if(Jx)return Bv;Jx=1;var t=rn(),e=t({}.toString),n=t("".slice);return Bv=function(i){return n(e(i),8,-1)},Bv}var jv,eP;function Ej(){if(eP)return jv;eP=1;var t=rn(),e=un(),n=Xl(),i=Object,r=t("".split);return jv=e(function(){return!i("z").propertyIsEnumerable(0)})?function(s){return n(s)==="String"?r(s,""):i(s)}:i,jv}var zv,tP;function u_(){return tP||(tP=1,zv=function(t){return t==null}),zv}var Uv,nP;function Rf(){if(nP)return Uv;nP=1;var t=u_(),e=TypeError;return Uv=function(n){if(t(n))throw new e("Can't call method on "+n);return n},Uv}var Yv,iP;function _f(){if(iP)return Yv;iP=1;var t=Ej(),e=Rf();return Yv=function(n){return t(e(n))},Yv}var Gv,rP;function hn(){if(rP)return Gv;rP=1;var t=typeof document=="object"&&document.all;return Gv=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},Gv}var qv,sP;function fr(){if(sP)return qv;sP=1;var t=hn();return qv=function(e){return typeof e=="object"?e!==null:t(e)},qv}var Kv,oP;function Dc(){if(oP)return Kv;oP=1;var t=nn(),e=hn(),n=function(i){return e(i)?i:void 0};return Kv=function(i,r){return arguments.length<2?n(t[i]):t[i]&&t[i][r]},Kv}var Xv,aP;function Ef(){if(aP)return Xv;aP=1;var t=rn();return Xv=t({}.isPrototypeOf),Xv}var Zv,lP;function Tw(){if(lP)return Zv;lP=1;var t=nn(),e=t.navigator,n=e&&e.userAgent;return Zv=n?String(n):"",Zv}var Qv,uP;function Tj(){if(uP)return Qv;uP=1;var t=nn(),e=Tw(),n=t.process,i=t.Deno,r=n&&n.versions||i&&i.version,s=r&&r.v8,o,a;return s&&(o=s.split("."),a=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!a&&e&&(o=e.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=e.match(/Chrome\/(\d+)/),o&&(a=+o[1]))),Qv=a,Qv}var Jv,cP;function c_(){if(cP)return Jv;cP=1;var t=Tj(),e=un(),n=nn(),i=n.String;return Jv=!!Object.getOwnPropertySymbols&&!e(function(){var r=Symbol("symbol detection");return!i(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Jv}var ey,hP;function Gk(){if(hP)return ey;hP=1;var t=c_();return ey=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",ey}var ty,dP;function h_(){if(dP)return ty;dP=1;var t=Dc(),e=hn(),n=Ef(),i=Gk(),r=Object;return ty=i?function(s){return typeof s=="symbol"}:function(s){var o=t("Symbol");return e(o)&&n(o.prototype,r(s))},ty}var ny,fP;function Mw(){if(fP)return ny;fP=1;var t=String;return ny=function(e){try{return t(e)}catch{return"Object"}},ny}var iy,gP;function Ti(){if(gP)return iy;gP=1;var t=hn(),e=Mw(),n=TypeError;return iy=function(i){if(t(i))return i;throw new n(e(i)+" is not a function")},iy}var ry,mP;function Tf(){if(mP)return ry;mP=1;var t=Ti(),e=u_();return ry=function(n,i){var r=n[i];return e(r)?void 0:t(r)},ry}var sy,pP;function Mj(){if(pP)return sy;pP=1;var t=cn(),e=hn(),n=fr(),i=TypeError;return sy=function(r,s){var o,a;if(s==="string"&&e(o=r.toString)&&!n(a=t(o,r))||e(o=r.valueOf)&&!n(a=t(o,r))||s!=="string"&&e(o=r.toString)&&!n(a=t(o,r)))return a;throw new i("Can't convert object to primitive value")},sy}var oy={exports:{}},ay,wP;function xa(){return wP||(wP=1,ay=!1),ay}var ly,vP;function d_(){if(vP)return ly;vP=1;var t=nn(),e=Object.defineProperty;return ly=function(n,i){try{e(t,n,{value:i,configurable:!0,writable:!0})}catch{t[n]=i}return i},ly}var yP;function f_(){if(yP)return oy.exports;yP=1;var t=xa(),e=nn(),n=d_(),i="__core-js_shared__",r=oy.exports=e[i]||n(i,{});return(r.versions||(r.versions=[])).push({version:"3.44.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"}),oy.exports}var uy,CP;function qk(){if(CP)return uy;CP=1;var t=f_();return uy=function(e,n){return t[e]||(t[e]=n||{})},uy}var cy,bP;function Nc(){if(bP)return cy;bP=1;var t=Rf(),e=Object;return cy=function(n){return e(t(n))},cy}var hy,SP;function gr(){if(SP)return hy;SP=1;var t=rn(),e=Nc(),n=t({}.hasOwnProperty);return hy=Object.hasOwn||function(r,s){return n(e(r),s)},hy}var dy,RP;function Kk(){if(RP)return dy;RP=1;var t=rn(),e=0,n=Math.random(),i=t(1.1.toString);return dy=function(r){return"Symbol("+(r===void 0?"":r)+")_"+i(++e+n,36)},dy}var fy,_P;function Ur(){if(_P)return fy;_P=1;var t=nn(),e=qk(),n=gr(),i=Kk(),r=c_(),s=Gk(),o=t.Symbol,a=e("wks"),l=s?o.for||o:o&&o.withoutSetter||i;return fy=function(u){return n(a,u)||(a[u]=r&&n(o,u)?o[u]:l("Symbol."+u)),a[u]},fy}var gy,EP;function xj(){if(EP)return gy;EP=1;var t=cn(),e=fr(),n=h_(),i=Tf(),r=Mj(),s=Ur(),o=TypeError,a=s("toPrimitive");return gy=function(l,u){if(!e(l)||n(l))return l;var c=i(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new o("Can't convert object to primitive value")}return u===void 0&&(u="number"),r(l,u)},gy}var my,TP;function Xk(){if(TP)return my;TP=1;var t=xj(),e=h_();return my=function(n){var i=t(n,"string");return e(i)?i:i+""},my}var py,MP;function g_(){if(MP)return py;MP=1;var t=nn(),e=fr(),n=t.document,i=e(n)&&e(n.createElement);return py=function(r){return i?n.createElement(r):{}},py}var wy,xP;function Zk(){if(xP)return wy;xP=1;var t=dr(),e=un(),n=g_();return wy=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),wy}var PP;function Qk(){if(PP)return Dv;PP=1;var t=dr(),e=cn(),n=_j(),i=Ew(),r=_f(),s=Xk(),o=gr(),a=Zk(),l=Object.getOwnPropertyDescriptor;return Dv.f=t?l:function(c,h){if(c=r(c),h=s(h),a)try{return l(c,h)}catch{}if(o(c,h))return i(!e(n.f,c,h),c[h])},Dv}var vy={},yy,IP;function Jk(){if(IP)return yy;IP=1;var t=dr(),e=un();return yy=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),yy}var Cy,OP;function dn(){if(OP)return Cy;OP=1;var t=fr(),e=String,n=TypeError;return Cy=function(i){if(t(i))return i;throw new n(e(i)+" is not an object")},Cy}var AP;function Pa(){if(AP)return vy;AP=1;var t=dr(),e=Zk(),n=Jk(),i=dn(),r=Xk(),s=TypeError,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return vy.f=t?n?function(d,f,g){if(i(d),f=r(f),i(g),typeof d=="function"&&f==="prototype"&&"value"in g&&c in g&&!g[c]){var m=a(d,f);m&&m[c]&&(d[f]=g.value,g={configurable:u in g?g[u]:m[u],enumerable:l in g?g[l]:m[l],writable:!1})}return o(d,f,g)}:o:function(d,f,g){if(i(d),f=r(f),i(g),e)try{return o(d,f,g)}catch{}if("get"in g||"set"in g)throw new s("Accessors not supported");return"value"in g&&(d[f]=g.value),d},vy}var by,HP;function kc(){if(HP)return by;HP=1;var t=dr(),e=Pa(),n=Ew();return by=t?function(i,r,s){return e.f(i,r,n(1,s))}:function(i,r,s){return i[r]=s,i},by}var Sy={exports:{}},Ry,DP;function Pj(){if(DP)return Ry;DP=1;var t=dr(),e=gr(),n=Function.prototype,i=t&&Object.getOwnPropertyDescriptor,r=e(n,"name"),s=r&&(function(){}).name==="something",o=r&&(!t||t&&i(n,"name").configurable);return Ry={EXISTS:r,PROPER:s,CONFIGURABLE:o},Ry}var _y,NP;function Ij(){if(NP)return _y;NP=1;var t=rn(),e=hn(),n=f_(),i=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(r){return i(r)}),_y=n.inspectSource,_y}var Ey,kP;function Oj(){if(kP)return Ey;kP=1;var t=nn(),e=hn(),n=t.WeakMap;return Ey=e(n)&&/native code/.test(String(n)),Ey}var Ty,LP;function m_(){if(LP)return Ty;LP=1;var t=qk(),e=Kk(),n=t("keys");return Ty=function(i){return n[i]||(n[i]=e(i))},Ty}var My,FP;function p_(){return FP||(FP=1,My={}),My}var xy,$P;function eL(){if($P)return xy;$P=1;var t=Oj(),e=nn(),n=fr(),i=kc(),r=gr(),s=f_(),o=m_(),a=p_(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,g=function(y){return f(y)?d(y):h(y,{})},m=function(y){return function(M){var I;if(!n(M)||(I=d(M)).type!==y)throw new u("Incompatible receiver, "+y+" required");return I}};if(t||s.state){var v=s.state||(s.state=new c);v.get=v.get,v.has=v.has,v.set=v.set,h=function(y,M){if(v.has(y))throw new u(l);return M.facade=y,v.set(y,M),M},d=function(y){return v.get(y)||{}},f=function(y){return v.has(y)}}else{var S=o("state");a[S]=!0,h=function(y,M){if(r(y,S))throw new u(l);return M.facade=y,i(y,S,M),M},d=function(y){return r(y,S)?y[S]:{}},f=function(y){return r(y,S)}}return xy={set:h,get:d,has:f,enforce:g,getterFor:m},xy}var VP;function tL(){if(VP)return Sy.exports;VP=1;var t=rn(),e=un(),n=hn(),i=gr(),r=dr(),s=Pj().CONFIGURABLE,o=Ij(),a=eL(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),g=t([].join),m=r&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),v=String(String).split("String"),S=Sy.exports=function(y,M,I){d(c(M),0,7)==="Symbol("&&(M="["+f(c(M),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),I&&I.getter&&(M="get "+M),I&&I.setter&&(M="set "+M),(!i(y,"name")||s&&y.name!==M)&&(r?h(y,"name",{value:M,configurable:!0}):y.name=M),m&&I&&i(I,"arity")&&y.length!==I.arity&&h(y,"length",{value:I.arity});try{I&&i(I,"constructor")&&I.constructor?r&&h(y,"prototype",{writable:!1}):y.prototype&&(y.prototype=void 0)}catch{}var P=l(y);return i(P,"source")||(P.source=g(v,typeof M=="string"?M:"")),y};return Function.prototype.toString=S(function(){return n(this)&&u(this).source||o(this)},"toString"),Sy.exports}var Py,WP;function w_(){if(WP)return Py;WP=1;var t=hn(),e=Pa(),n=tL(),i=d_();return Py=function(r,s,o,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:s;if(t(o)&&n(o,u,a),a.global)l?r[s]=o:i(s,o);else{try{a.unsafe?r[s]&&(l=!0):delete r[s]}catch{}l?r[s]=o:e.f(r,s,{value:o,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return r},Py}var Iy={},Oy,BP;function Aj(){if(BP)return Oy;BP=1;var t=Math.ceil,e=Math.floor;return Oy=Math.trunc||function(i){var r=+i;return(r>0?e:t)(r)},Oy}var Ay,jP;function Mf(){if(jP)return Ay;jP=1;var t=Aj();return Ay=function(e){var n=+e;return n!==n||n===0?0:t(n)},Ay}var Hy,zP;function Hj(){if(zP)return Hy;zP=1;var t=Mf(),e=Math.max,n=Math.min;return Hy=function(i,r){var s=t(i);return s<0?e(s+r,0):n(s,r)},Hy}var Dy,UP;function Dj(){if(UP)return Dy;UP=1;var t=Mf(),e=Math.min;return Dy=function(n){var i=t(n);return i>0?e(i,9007199254740991):0},Dy}var Ny,YP;function Lc(){if(YP)return Ny;YP=1;var t=Dj();return Ny=function(e){return t(e.length)},Ny}var ky,GP;function Nj(){if(GP)return ky;GP=1;var t=_f(),e=Hj(),n=Lc(),i=function(r){return function(s,o,a){var l=t(s),u=n(l);if(u===0)return!r&&-1;var c=e(a,u),h;if(r&&o!==o){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((r||c in l)&&l[c]===o)return r||c||0;return!r&&-1}};return ky={includes:i(!0),indexOf:i(!1)},ky}var Ly,qP;function nL(){if(qP)return Ly;qP=1;var t=rn(),e=gr(),n=_f(),i=Nj().indexOf,r=p_(),s=t([].push);return Ly=function(o,a){var l=n(o),u=0,c=[],h;for(h in l)!e(r,h)&&e(l,h)&&s(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~i(c,h)||s(c,h));return c},Ly}var Fy,KP;function v_(){return KP||(KP=1,Fy=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),Fy}var XP;function kj(){if(XP)return Iy;XP=1;var t=nL(),e=v_(),n=e.concat("length","prototype");return Iy.f=Object.getOwnPropertyNames||function(r){return t(r,n)},Iy}var $y={},ZP;function Lj(){return ZP||(ZP=1,$y.f=Object.getOwnPropertySymbols),$y}var Vy,QP;function Fj(){if(QP)return Vy;QP=1;var t=Dc(),e=rn(),n=kj(),i=Lj(),r=dn(),s=e([].concat);return Vy=t("Reflect","ownKeys")||function(a){var l=n.f(r(a)),u=i.f;return u?s(l,u(a)):l},Vy}var Wy,JP;function iL(){if(JP)return Wy;JP=1;var t=gr(),e=Fj(),n=Qk(),i=Pa();return Wy=function(r,s,o){for(var a=e(s),l=i.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(r,h)&&!(o&&t(o,h))&&l(r,h,u(s,h))}},Wy}var By,eI;function $j(){if(eI)return By;eI=1;var t=un(),e=hn(),n=/#|\.prototype\./,i=function(l,u){var c=s[r(l)];return c===a?!0:c===o?!1:e(u)?t(u):!!u},r=i.normalize=function(l){return String(l).replace(n,".").toLowerCase()},s=i.data={},o=i.NATIVE="N",a=i.POLYFILL="P";return By=i,By}var jy,tI;function wt(){if(tI)return jy;tI=1;var t=nn(),e=Qk().f,n=kc(),i=w_(),r=d_(),s=iL(),o=$j();return jy=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,g,m,v,S;if(c?f=t:h?f=t[u]||r(u,{}):f=t[u]&&t[u].prototype,f)for(g in l){if(v=l[g],a.dontCallGetSet?(S=e(f,g),m=S&&S.value):m=f[g],d=o(c?g:u+(h?".":"#")+g,a.forced),!d&&m!==void 0){if(typeof v==typeof m)continue;s(v,m)}(a.sham||m&&m.sham)&&n(v,"sham",!0),i(f,g,v,a)}},jy}var zy,nI;function xf(){if(nI)return zy;nI=1;var t=_w(),e=Function.prototype,n=e.apply,i=e.call;return zy=typeof Reflect=="object"&&Reflect.apply||(t?i.bind(n):function(){return i.apply(n,arguments)}),zy}var Uy,iI;function rL(){if(iI)return Uy;iI=1;var t=rn(),e=Ti();return Uy=function(n,i,r){try{return t(e(Object.getOwnPropertyDescriptor(n,i)[r]))}catch{}},Uy}var Yy,rI;function Vj(){if(rI)return Yy;rI=1;var t=fr();return Yy=function(e){return t(e)||e===null},Yy}var Gy,sI;function Wj(){if(sI)return Gy;sI=1;var t=Vj(),e=String,n=TypeError;return Gy=function(i){if(t(i))return i;throw new n("Can't set "+e(i)+" as a prototype")},Gy}var qy,oI;function sL(){if(oI)return qy;oI=1;var t=rL(),e=fr(),n=Rf(),i=Wj();return qy=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,s={},o;try{o=t(Object.prototype,"__proto__","set"),o(s,[]),r=s instanceof Array}catch{}return function(l,u){return n(l),i(u),e(l)&&(r?o(l,u):l.__proto__=u),l}}():void 0),qy}var Ky,aI;function Bj(){if(aI)return Ky;aI=1;var t=Pa().f;return Ky=function(e,n,i){i in e||t(e,i,{configurable:!0,get:function(){return n[i]},set:function(r){n[i]=r}})},Ky}var Xy,lI;function jj(){if(lI)return Xy;lI=1;var t=hn(),e=fr(),n=sL();return Xy=function(i,r,s){var o,a;return n&&t(o=r.constructor)&&o!==s&&e(a=o.prototype)&&a!==s.prototype&&n(i,a),i},Xy}var Zy,uI;function zj(){if(uI)return Zy;uI=1;var t=Ur(),e=t("toStringTag"),n={};return n[e]="z",Zy=String(n)==="[object z]",Zy}var Qy,cI;function oL(){if(cI)return Qy;cI=1;var t=zj(),e=hn(),n=Xl(),i=Ur(),r=i("toStringTag"),s=Object,o=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return Qy=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=s(l),r))=="string"?c:o?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},Qy}var Jy,hI;function xw(){if(hI)return Jy;hI=1;var t=oL(),e=String;return Jy=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},Jy}var eC,dI;function Uj(){if(dI)return eC;dI=1;var t=xw();return eC=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},eC}var tC,fI;function Yj(){if(fI)return tC;fI=1;var t=fr(),e=kc();return tC=function(n,i){t(i)&&"cause"in i&&e(n,"cause",i.cause)},tC}var nC,gI;function Gj(){if(gI)return nC;gI=1;var t=rn(),e=Error,n=t("".replace),i=function(o){return String(new e(o).stack)}("zxcasd"),r=/\n\s*at [^:]*:[^\n]*/,s=r.test(i);return nC=function(o,a){if(s&&typeof o=="string"&&!e.prepareStackTrace)for(;a--;)o=n(o,r,"");return o},nC}var iC,mI;function qj(){if(mI)return iC;mI=1;var t=un(),e=Ew();return iC=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),iC}var rC,pI;function Kj(){if(pI)return rC;pI=1;var t=kc(),e=Gj(),n=qj(),i=Error.captureStackTrace;return rC=function(r,s,o,a){n&&(i?i(r,s):t(r,"stack",e(o,a)))},rC}var sC,wI;function Xj(){if(wI)return sC;wI=1;var t=Dc(),e=gr(),n=kc(),i=Ef(),r=sL(),s=iL(),o=Bj(),a=jj(),l=Uj(),u=Yj(),c=Kj(),h=dr(),d=xa();return sC=function(f,g,m,v){var S="stackTraceLimit",y=v?2:1,M=f.split("."),I=M[M.length-1],P=t.apply(null,M);if(P){var E=P.prototype;if(!d&&e(E,"cause")&&delete E.cause,!m)return P;var T=t("Error"),$=g(function(U,O){var G=l(v?O:U,void 0),q=v?new P(U):new P;return G!==void 0&&n(q,"message",G),c(q,$,q.stack,2),this&&i(E,this)&&a(q,this,$),arguments.length>y&&u(q,arguments[y]),q});if($.prototype=E,I!=="Error"?r?r($,T):s($,T,{name:!0}):h&&S in P&&(o($,P,S),o($,P,"prepareStackTrace")),s($,P),!d)try{E.name!==I&&n(E,"name",I),E.constructor=$}catch{}return $}},sC}var vI;function Zj(){if(vI)return zx;vI=1;var t=wt(),e=nn(),n=xf(),i=Xj(),r="WebAssembly",s=e[r],o=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=i(u,c,o),t({global:!0,constructor:!0,arity:1,forced:o},h)},l=function(u,c){if(s&&s[u]){var h={};h[u]=i(r+"."+u,c,o),t({target:r,stat:!0,constructor:!0,arity:1,forced:o},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),zx}Zj();var yI={},oC,CI;function aL(){if(CI)return oC;CI=1;var t=Xl();return oC=Array.isArray||function(n){return t(n)==="Array"},oC}var aC,bI;function lL(){if(bI)return aC;bI=1;var t=dr(),e=aL(),n=TypeError,i=Object.getOwnPropertyDescriptor,r=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}}();return aC=r?function(s,o){if(e(s)&&!i(s,"length").writable)throw new n("Cannot set read only .length");return s.length=o}:function(s,o){return s.length=o},aC}var lC,SI;function uL(){if(SI)return lC;SI=1;var t=TypeError,e=9007199254740991;return lC=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},lC}var RI;function Qj(){if(RI)return yI;RI=1;var t=wt(),e=Nc(),n=Lc(),i=lL(),r=uL(),s=un(),o=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;r(d+f);for(var g=0;g<f;g++)h[d]=arguments[g],d++;return i(h,d),d}}),yI}Qj();var _I={},uC,EI;function Jj(){if(EI)return uC;EI=1;var t=Xl(),e=rn();return uC=function(n){if(t(n)==="Function")return e(n)},uC}var cC,TI;function cL(){if(TI)return cC;TI=1;var t=Jj(),e=Ti(),n=_w(),i=t(t.bind);return cC=function(r,s){return e(r),s===void 0?r:n?i(r,s):function(){return r.apply(s,arguments)}},cC}var hC,MI;function hL(){return MI||(MI=1,hC={}),hC}var dC,xI;function ez(){if(xI)return dC;xI=1;var t=Ur(),e=hL(),n=t("iterator"),i=Array.prototype;return dC=function(r){return r!==void 0&&(e.Array===r||i[n]===r)},dC}var fC,PI;function y_(){if(PI)return fC;PI=1;var t=oL(),e=Tf(),n=u_(),i=hL(),r=Ur(),s=r("iterator");return fC=function(o){if(!n(o))return e(o,s)||e(o,"@@iterator")||i[t(o)]},fC}var gC,II;function tz(){if(II)return gC;II=1;var t=cn(),e=Ti(),n=dn(),i=Mw(),r=y_(),s=TypeError;return gC=function(o,a){var l=arguments.length<2?r(o):a;if(e(l))return n(t(l,o));throw new s(i(o)+" is not iterable")},gC}var mC,OI;function Mi(){if(OI)return mC;OI=1;var t=cn(),e=dn(),n=Tf();return mC=function(i,r,s){var o,a;e(i);try{if(o=n(i,"return"),!o){if(r==="throw")throw s;return s}o=t(o,i)}catch(l){a=!0,o=l}if(r==="throw")throw s;if(a)throw o;return e(o),s},mC}var pC,AI;function Fc(){if(AI)return pC;AI=1;var t=cL(),e=cn(),n=dn(),i=Mw(),r=ez(),s=Lc(),o=Ef(),a=tz(),l=y_(),u=Mi(),c=TypeError,h=function(f,g){this.stopped=f,this.result=g},d=h.prototype;return pC=function(f,g,m){var v=m&&m.that,S=!!(m&&m.AS_ENTRIES),y=!!(m&&m.IS_RECORD),M=!!(m&&m.IS_ITERATOR),I=!!(m&&m.INTERRUPTED),P=t(g,v),E,T,$,U,O,G,q,ne=function(te){return E&&u(E,"normal"),new h(!0,te)},Q=function(te){return S?(n(te),I?P(te[0],te[1],ne):P(te[0],te[1])):I?P(te,ne):P(te)};if(y)E=f.iterator;else if(M)E=f;else{if(T=l(f),!T)throw new c(i(f)+" is not iterable");if(r(T)){for($=0,U=s(f);U>$;$++)if(O=Q(f[$]),O&&o(d,O))return O;return new h(!1)}E=a(f,T)}for(G=y?f.next:E.next;!(q=e(G,E)).done;){try{O=Q(q.value)}catch(te){u(E,"throw",te)}if(typeof O=="object"&&O&&o(d,O))return O}return new h(!1)},pC}var wC,HI;function dL(){if(HI)return wC;HI=1;var t=dr(),e=Pa(),n=Ew();return wC=function(i,r,s){t?e.f(i,r,n(0,s)):i[r]=s},wC}var DI;function nz(){if(DI)return _I;DI=1;var t=wt(),e=Fc(),n=dL();return t({target:"Object",stat:!0},{fromEntries:function(r){var s={};return e(r,function(o,a){n(s,o,a)},{AS_ENTRIES:!0}),s}}),_I}nz();var NI={},vC,kI;function Is(){if(kI)return vC;kI=1;var t=rn(),e=Set.prototype;return vC={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},vC}var yC,LI;function Zl(){if(LI)return yC;LI=1;var t=Is().has;return yC=function(e){return t(e),e},yC}var CC,FI;function Ql(){if(FI)return CC;FI=1;var t=cn();return CC=function(e,n,i){for(var r=i?e:e.iterator,s=e.next,o,a;!(o=t(s,r)).done;)if(a=n(o.value),a!==void 0)return a},CC}var bC,$I;function Pf(){if($I)return bC;$I=1;var t=rn(),e=Ql(),n=Is(),i=n.Set,r=n.proto,s=t(r.forEach),o=t(r.keys),a=o(new i).next;return bC=function(l,u,c){return c?e({iterator:o(l),next:a},u):s(l,u)},bC}var SC,VI;function C_(){if(VI)return SC;VI=1;var t=Is(),e=Pf(),n=t.Set,i=t.add;return SC=function(r){var s=new n;return e(r,function(o){i(s,o)}),s},SC}var RC,WI;function If(){if(WI)return RC;WI=1;var t=rL(),e=Is();return RC=t(e.proto,"size","get")||function(n){return n.size},RC}var _C,BI;function Os(){return BI||(BI=1,_C=function(t){return{iterator:t,next:t.next,done:!1}}),_C}var EC,jI;function Jl(){if(jI)return EC;jI=1;var t=Ti(),e=dn(),n=cn(),i=Mf(),r=Os(),s="Invalid size",o=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return r(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},EC=function(c){e(c);var h=+c.size;if(h!==h)throw new a(s);var d=i(h);if(d<0)throw new o(s);return new u(c,d)},EC}var TC,zI;function iz(){if(zI)return TC;zI=1;var t=Zl(),e=Is(),n=C_(),i=If(),r=Jl(),s=Pf(),o=Ql(),a=e.has,l=e.remove;return TC=function(c){var h=t(this),d=r(c),f=n(h);return i(h)<=d.size?s(h,function(g){d.includes(g)&&l(f,g)}):o(d.getIterator(),function(g){a(f,g)&&l(f,g)}),f},TC}var MC,UI;function eu(){if(UI)return MC;UI=1;var t=Dc(),e=function(i){return{size:i,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(i){return{size:i,has:function(){return!0},keys:function(){throw new Error("e")}}};return MC=function(i,r){var s=t("Set");try{new s()[i](e(0));try{return new s()[i](e(-1)),!1}catch{if(!r)return!0;try{return new s()[i](n(-1/0)),!1}catch{var o=new s;return o.add(1),o.add(2),r(o[i](n(1/0)))}}}catch{return!1}},MC}var YI;function rz(){if(YI)return NI;YI=1;var t=wt(),e=iz(),n=un(),i=eu(),r=!i("difference",function(o){return o.size===0}),s=r||n(function(){var o={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(o).size!==3});return t({target:"Set",proto:!0,real:!0,forced:s},{difference:e}),NI}rz();var GI={},xC,qI;function sz(){if(qI)return xC;qI=1;var t=Zl(),e=Is(),n=If(),i=Jl(),r=Pf(),s=Ql(),o=e.Set,a=e.add,l=e.has;return xC=function(c){var h=t(this),d=i(c),f=new o;return n(h)>d.size?s(d.getIterator(),function(g){l(h,g)&&a(f,g)}):r(h,function(g){d.includes(g)&&a(f,g)}),f},xC}var KI;function oz(){if(KI)return GI;KI=1;var t=wt(),e=un(),n=sz(),i=eu(),r=!i("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:r},{intersection:n}),GI}oz();var XI={},PC,ZI;function az(){if(ZI)return PC;ZI=1;var t=Zl(),e=Is().has,n=If(),i=Jl(),r=Pf(),s=Ql(),o=Mi();return PC=function(l){var u=t(this),c=i(l);if(n(u)<=c.size)return r(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return s(h,function(d){if(e(u,d))return o(h,"normal",!1)})!==!1},PC}var QI;function lz(){if(QI)return XI;QI=1;var t=wt(),e=az(),n=eu(),i=!n("isDisjointFrom",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isDisjointFrom:e}),XI}lz();var JI={},IC,eO;function uz(){if(eO)return IC;eO=1;var t=Zl(),e=If(),n=Pf(),i=Jl();return IC=function(s){var o=t(this),a=i(s);return e(o)>a.size?!1:n(o,function(l){if(!a.includes(l))return!1},!0)!==!1},IC}var tO;function cz(){if(tO)return JI;tO=1;var t=wt(),e=uz(),n=eu(),i=!n("isSubsetOf",function(r){return r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSubsetOf:e}),JI}cz();var nO={},OC,iO;function hz(){if(iO)return OC;iO=1;var t=Zl(),e=Is().has,n=If(),i=Jl(),r=Ql(),s=Mi();return OC=function(a){var l=t(this),u=i(a);if(n(l)<u.size)return!1;var c=u.getIterator();return r(c,function(h){if(!e(l,h))return s(c,"normal",!1)})!==!1},OC}var rO;function dz(){if(rO)return nO;rO=1;var t=wt(),e=hz(),n=eu(),i=!n("isSupersetOf",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSupersetOf:e}),nO}dz();var sO={},AC,oO;function fz(){if(oO)return AC;oO=1;var t=Zl(),e=Is(),n=C_(),i=Jl(),r=Ql(),s=e.add,o=e.has,a=e.remove;return AC=function(u){var c=t(this),h=i(u).getIterator(),d=n(c);return r(h,function(f){o(c,f)?a(d,f):s(d,f)}),d},AC}var HC,aO;function fL(){return aO||(aO=1,HC=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},i=e[t](n);return i.size===1&&i.values().next().value===4}catch{return!1}}),HC}var lO;function gz(){if(lO)return sO;lO=1;var t=wt(),e=fz(),n=fL(),i=eu(),r=!i("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:r},{symmetricDifference:e}),sO}gz();var uO={},DC,cO;function mz(){if(cO)return DC;cO=1;var t=Zl(),e=Is().add,n=C_(),i=Jl(),r=Ql();return DC=function(o){var a=t(this),l=i(o).getIterator(),u=n(a);return r(l,function(c){e(u,c)}),u},DC}var hO;function pz(){if(hO)return uO;hO=1;var t=wt(),e=mz(),n=fL(),i=eu(),r=!i("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:r},{union:e}),uO}pz();var dO={},fO={},NC,gO;function wz(){if(gO)return NC;gO=1;var t=Ef(),e=TypeError;return NC=function(n,i){if(t(i,n))return n;throw new e("Incorrect invocation")},NC}var kC,mO;function vz(){if(mO)return kC;mO=1;var t=un();return kC=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),kC}var LC,pO;function gL(){if(pO)return LC;pO=1;var t=gr(),e=hn(),n=Nc(),i=m_(),r=vz(),s=i("IE_PROTO"),o=Object,a=o.prototype;return LC=r?o.getPrototypeOf:function(l){var u=n(l);if(t(u,s))return u[s];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof o?a:null},LC}var FC,wO;function yz(){if(wO)return FC;wO=1;var t=tL(),e=Pa();return FC=function(n,i,r){return r.get&&t(r.get,i,{getter:!0}),r.set&&t(r.set,i,{setter:!0}),e.f(n,i,r)},FC}var $C={},VC,vO;function Cz(){if(vO)return VC;vO=1;var t=nL(),e=v_();return VC=Object.keys||function(i){return t(i,e)},VC}var yO;function bz(){if(yO)return $C;yO=1;var t=dr(),e=Jk(),n=Pa(),i=dn(),r=_f(),s=Cz();return $C.f=t&&!e?Object.defineProperties:function(a,l){i(a);for(var u=r(l),c=s(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},$C}var WC,CO;function mL(){if(CO)return WC;CO=1;var t=Dc();return WC=t("document","documentElement"),WC}var BC,bO;function b_(){if(bO)return BC;bO=1;var t=dn(),e=bz(),n=v_(),i=p_(),r=mL(),s=g_(),o=m_(),a=">",l="<",u="prototype",c="script",h=o("IE_PROTO"),d=function(){},f=function(y){return l+c+a+y+l+"/"+c+a},g=function(y){y.write(f("")),y.close();var M=y.parentWindow.Object;return y=null,M},m=function(){var y=s("iframe"),M="java"+c+":",I;return y.style.display="none",r.appendChild(y),y.src=String(M),I=y.contentWindow.document,I.open(),I.write(f("document.F=Object")),I.close(),I.F},v,S=function(){try{v=new ActiveXObject("htmlfile")}catch{}S=typeof document<"u"?document.domain&&v?g(v):m():g(v);for(var y=n.length;y--;)delete S[u][n[y]];return S()};return i[h]=!0,BC=Object.create||function(M,I){var P;return M!==null?(d[u]=t(M),P=new d,d[u]=null,P[h]=M):P=S(),I===void 0?P:e.f(P,I)},BC}var jC,SO;function pL(){if(SO)return jC;SO=1;var t=un(),e=hn(),n=fr(),i=b_(),r=gL(),s=w_(),o=Ur(),a=xa(),l=o("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=r(r(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var g={};return c[l].call(g)!==g});return f?c={}:a&&(c=i(c)),e(c[l])||s(c,l,function(){return this}),jC={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},jC}var RO;function Sz(){if(RO)return fO;RO=1;var t=wt(),e=nn(),n=wz(),i=dn(),r=hn(),s=gL(),o=yz(),a=dL(),l=un(),u=gr(),c=Ur(),h=pL().IteratorPrototype,d=dr(),f=xa(),g="constructor",m="Iterator",v=c("toStringTag"),S=TypeError,y=e[m],M=f||!r(y)||y.prototype!==h||!l(function(){y({})}),I=function(){if(n(this,h),s(this)===h)throw new S("Abstract class Iterator not directly constructable")},P=function(E,T){d?o(h,E,{configurable:!0,get:function(){return T},set:function($){if(i(this),this===h)throw new S("You can't redefine this property");u(this,E)?this[E]=$:a(this,E,$)}}):h[E]=T};return u(h,v)||P(v,m),(M||!u(h,g)||h[g]===Object)&&P(g,I),I.prototype=h,t({global:!0,constructor:!0,forced:M},{Iterator:I}),fO}var _O;function Rz(){return _O||(_O=1,Sz()),dO}Rz();var EO={},TO={},zC,MO;function _z(){if(MO)return zC;MO=1;var t=w_();return zC=function(e,n,i){for(var r in n)t(e,r,n[r],i);return e},zC}var UC,xO;function Ez(){return xO||(xO=1,UC=function(t,e){return{value:t,done:e}}),UC}var YC,PO;function Tz(){if(PO)return YC;PO=1;var t=Mi();return YC=function(e,n,i){for(var r=e.length-1;r>=0;r--)if(e[r]!==void 0)try{i=t(e[r].iterator,n,i)}catch(s){n="throw",i=s}if(n==="throw")throw i;return i},YC}var GC,IO;function S_(){if(IO)return GC;IO=1;var t=cn(),e=b_(),n=kc(),i=_z(),r=Ur(),s=eL(),o=Tf(),a=pL().IteratorPrototype,l=Ez(),u=Mi(),c=Tz(),h=r("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",g="normal",m="throw",v=s.set,S=function(I){var P=s.getterFor(I?f:d);return i(e(a),{next:function(){var T=P(this);if(I)return T.nextHandler();if(T.done)return l(void 0,!0);try{var $=T.nextHandler();return T.returnHandlerResult?$:l($,T.done)}catch(U){throw T.done=!0,U}},return:function(){var E=P(this),T=E.iterator;if(E.done=!0,I){var $=o(T,"return");return $?t($,T):l(void 0,!0)}if(E.inner)try{u(E.inner.iterator,g)}catch(U){return u(T,m,U)}if(E.openIters)try{c(E.openIters,g)}catch(U){return u(T,m,U)}return T&&u(T,g),l(void 0,!0)}})},y=S(!0),M=S(!1);return n(M,h,"Iterator Helper"),GC=function(I,P,E){var T=function(U,O){O?(O.iterator=U.iterator,O.next=U.next):O=U,O.type=P?f:d,O.returnHandlerResult=!!E,O.nextHandler=I,O.counter=0,O.done=!1,v(this,O)};return T.prototype=P?y:M,T},GC}var qC,OO;function wL(){if(OO)return qC;OO=1;var t=dn(),e=Mi();return qC=function(n,i,r,s){try{return s?i(t(r)[0],r[1]):i(r)}catch(o){e(n,"throw",o)}},qC}var KC,AO;function R_(){return AO||(AO=1,KC=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),KC}var XC,HO;function Ia(){if(HO)return XC;HO=1;var t=nn();return XC=function(e,n){var i=t.Iterator,r=i&&i.prototype,s=r&&r[e],o=!1;if(s)try{s.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(a){a instanceof n||(o=!1)}if(!o)return s},XC}var DO;function Mz(){if(DO)return TO;DO=1;var t=wt(),e=cn(),n=Ti(),i=dn(),r=Os(),s=S_(),o=wL(),a=xa(),l=Mi(),u=R_(),c=Ia(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),f=a||h||d,g=s(function(){for(var m=this.iterator,v=this.predicate,S=this.next,y,M,I;;){if(y=i(e(S,m)),M=this.done=!!y.done,M)return;if(I=y.value,o(m,v,[I,this.counter++],!0))return I}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(v){i(this);try{n(v)}catch(S){l(this,"throw",S)}return d?e(d,this,v):new g(r(this),{predicate:v})}}),TO}var NO;function xz(){return NO||(NO=1,Mz()),EO}xz();var kO={},LO={},FO;function Pz(){if(FO)return LO;FO=1;var t=wt(),e=cn(),n=Fc(),i=Ti(),r=dn(),s=Os(),o=Mi(),a=Ia(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){r(this);try{i(c)}catch(f){o(this,"throw",f)}if(l)return e(l,this,c);var h=s(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),LO}var $O;function Iz(){return $O||($O=1,Pz()),kO}Iz();var VO={},WO={},BO;function Oz(){if(BO)return WO;BO=1;var t=wt(),e=cn(),n=Ti(),i=dn(),r=Os(),s=S_(),o=wL(),a=Mi(),l=R_(),u=Ia(),c=xa(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),f=c||h||d,g=s(function(){var m=this.iterator,v=i(e(this.next,m)),S=this.done=!!v.done;if(!S)return o(m,this.mapper,[v.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(v){i(this);try{n(v)}catch(S){a(this,"throw",S)}return d?e(d,this,v):new g(r(this),{mapper:v})}}),WO}var jO;function Az(){return jO||(jO=1,Oz()),VO}Az();var zO={},UO={},ZC,YO;function __(){if(YO)return ZC;YO=1;var t=rn();return ZC=t([].slice),ZC}var QC,GO;function vL(){if(GO)return QC;GO=1;var t=TypeError;return QC=function(e,n){if(e<n)throw new t("Not enough arguments");return e},QC}var JC,qO;function Hz(){if(qO)return JC;qO=1;var t=Tw();return JC=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),JC}var eb,KO;function yL(){if(KO)return eb;KO=1;var t=nn(),e=Tw(),n=Xl(),i=function(r){return e.slice(0,r.length)===r};return eb=function(){return i("Bun/")?"BUN":i("Cloudflare-Workers")?"CLOUDFLARE":i("Deno/")?"DENO":i("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),eb}var tb,XO;function Dz(){if(XO)return tb;XO=1;var t=yL();return tb=t==="NODE",tb}var nb,ZO;function CL(){if(ZO)return nb;ZO=1;var t=nn(),e=xf(),n=cL(),i=hn(),r=gr(),s=un(),o=mL(),a=__(),l=g_(),u=vL(),c=Hz(),h=Dz(),d=t.setImmediate,f=t.clearImmediate,g=t.process,m=t.Dispatch,v=t.Function,S=t.MessageChannel,y=t.String,M=0,I={},P="onreadystatechange",E,T,$,U;s(function(){E=t.location});var O=function(Q){if(r(I,Q)){var te=I[Q];delete I[Q],te()}},G=function(Q){return function(){O(Q)}},q=function(Q){O(Q.data)},ne=function(Q){t.postMessage(y(Q),E.protocol+"//"+E.host)};return(!d||!f)&&(d=function(te){u(arguments.length,1);var Me=i(te)?te:v(te),Ce=a(arguments,1);return I[++M]=function(){e(Me,void 0,Ce)},T(M),M},f=function(te){delete I[te]},h?T=function(Q){g.nextTick(G(Q))}:m&&m.now?T=function(Q){m.now(G(Q))}:S&&!c?($=new S,U=$.port2,$.port1.onmessage=q,T=n(U.postMessage,U)):t.addEventListener&&i(t.postMessage)&&!t.importScripts&&E&&E.protocol!=="file:"&&!s(ne)?(T=ne,t.addEventListener("message",q,!1)):P in l("script")?T=function(Q){o.appendChild(l("script"))[P]=function(){o.removeChild(this),O(Q)}}:T=function(Q){setTimeout(G(Q),0)}),nb={set:d,clear:f},nb}var QO;function Nz(){if(QO)return UO;QO=1;var t=wt(),e=nn(),n=CL().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),UO}var JO={},ib,e1;function kz(){if(e1)return ib;e1=1;var t=nn(),e=xf(),n=hn(),i=yL(),r=Tw(),s=__(),o=vL(),a=t.Function,l=/MSIE .\./.test(r)||i==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return ib=function(u,c){var h=c?2:1;return l?function(d,f){var g=o(arguments.length,1)>h,m=n(d)?d:a(d),v=g?s(arguments,h):[],S=g?function(){e(m,this,v)}:m;return c?u(S,f):u(S)}:u},ib}var t1;function Lz(){if(t1)return JO;t1=1;var t=wt(),e=nn(),n=CL().set,i=kz(),r=e.setImmediate?i(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==r},{setImmediate:r}),JO}var n1;function Fz(){return n1||(n1=1,Nz(),Lz()),zO}Fz();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:bL,setPrototypeOf:i1,isFrozen:$z,getPrototypeOf:Vz,getOwnPropertyDescriptor:Wz}=Object;let{freeze:ii,seal:ur,create:SL}=Object,{apply:XR,construct:ZR}=typeof Reflect<"u"&&Reflect;ii||(ii=function(e){return e});ur||(ur=function(e){return e});XR||(XR=function(e,n,i){return e.apply(n,i)});ZR||(ZR=function(e,n){return new e(...n)});const ng=ri(Array.prototype.forEach),Bz=ri(Array.prototype.lastIndexOf),r1=ri(Array.prototype.pop),nh=ri(Array.prototype.push),jz=ri(Array.prototype.splice),Zm=ri(String.prototype.toLowerCase),rb=ri(String.prototype.toString),s1=ri(String.prototype.match),ih=ri(String.prototype.replace),zz=ri(String.prototype.indexOf),Uz=ri(String.prototype.trim),Ir=ri(Object.prototype.hasOwnProperty),qn=ri(RegExp.prototype.test),rh=Yz(TypeError);function ri(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return XR(t,e,i)}}function Yz(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return ZR(t,n)}}function Fe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zm;i1&&i1(t,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){const s=n(r);s!==r&&($z(e)||(e[i]=s),r=s)}t[r]=!0}return t}function Gz(t){for(let e=0;e<t.length;e++)Ir(t,e)||(t[e]=null);return t}function Qs(t){const e=SL(null);for(const[n,i]of bL(t))Ir(t,n)&&(Array.isArray(i)?e[n]=Gz(i):i&&typeof i=="object"&&i.constructor===Object?e[n]=Qs(i):e[n]=i);return e}function sh(t,e){for(;t!==null;){const i=Wz(t,e);if(i){if(i.get)return ri(i.get);if(typeof i.value=="function")return ri(i.value)}t=Vz(t)}function n(){return null}return n}const o1=ii(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sb=ii(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ob=ii(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),qz=ii(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ab=ii(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Kz=ii(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),a1=ii(["#text"]),l1=ii(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),lb=ii(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),u1=ii(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ig=ii(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Xz=ur(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Zz=ur(/<%[\w\W]*|[\w\W]*%>/gm),Qz=ur(/\$\{[\w\W]*/gm),Jz=ur(/^data-[\-\w.\u00B7-\uFFFF]+$/),eU=ur(/^aria-[\-\w]+$/),RL=ur(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),tU=ur(/^(?:\w+script|data):/i),nU=ur(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),_L=ur(/^html$/i),iU=ur(/^[a-z][.\w]*(-[.\w]+)+$/i);var c1=Object.freeze({__proto__:null,ARIA_ATTR:eU,ATTR_WHITESPACE:nU,CUSTOM_ELEMENT:iU,DATA_ATTR:Jz,DOCTYPE_NAME:_L,ERB_EXPR:Zz,IS_ALLOWED_URI:RL,IS_SCRIPT_OR_DATA:tU,MUSTACHE_EXPR:Xz,TMPLIT_EXPR:Qz});const oh={element:1,text:3,progressingInstruction:7,comment:8,document:9},rU=function(){return typeof window>"u"?null:window},sU=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const r="data-tt-policy-suffix";n&&n.hasAttribute(r)&&(i=n.getAttribute(r));const s="dompurify"+(i?"#"+i:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},h1=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function EL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rU();const e=pe=>EL(pe);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==oh.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const i=n,r=i.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,m=sh(g,"cloneNode"),v=sh(g,"remove"),S=sh(g,"nextSibling"),y=sh(g,"childNodes"),M=sh(g,"parentNode");if(typeof o=="function"){const pe=n.createElement("template");pe.content&&pe.content.ownerDocument&&(n=pe.content.ownerDocument)}let I,P="";const{implementation:E,createNodeIterator:T,createDocumentFragment:$,getElementsByTagName:U}=n,{importNode:O}=i;let G=h1();e.isSupported=typeof bL=="function"&&typeof M=="function"&&E&&E.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:q,ERB_EXPR:ne,TMPLIT_EXPR:Q,DATA_ATTR:te,ARIA_ATTR:Me,IS_SCRIPT_OR_DATA:Ce,ATTR_WHITESPACE:Ie,CUSTOM_ELEMENT:at}=c1;let{IS_ALLOWED_URI:Le}=c1,Ge=null;const St=Fe({},[...o1,...sb,...ob,...ab,...a1]);let p=null;const w=Fe({},[...l1,...lb,...u1,...ig]);let b=Object.seal(SL(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),N=null,V=null,j=!0,X=!0,C=!1,R=!0,_=!1,x=!0,H=!1,L=!1,B=!1,D=!1,F=!1,W=!1,z=!0,Y=!1;const oe="user-content-";let ae=!0,Re=!1,We={},Be=null;const _e=Fe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let be=null;const it=Fe({},["audio","video","img","source","image","track"]);let oi=null;const ks=Fe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Cr="http://www.w3.org/1998/Math/MathML",gn="http://www.w3.org/2000/svg",Rt="http://www.w3.org/1999/xhtml";let Ot=Rt,vt=!1,et=null;const Bi=Fe({},[Cr,gn,Rt],rb);let Gn=Fe({},["mi","mo","mn","ms","mtext"]),Da=Fe({},["annotation-xml"]);const tg=Fe({},["title","style","font","a","script"]);let Jc=null;const mj=["application/xhtml+xml","text/html"],pj="text/html";let bn=null,au=null;const wj=n.createElement("form"),Ox=function(k){return k instanceof RegExp||k instanceof Function},Iv=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(au&&au===k)){if((!k||typeof k!="object")&&(k={}),k=Qs(k),Jc=mj.indexOf(k.PARSER_MEDIA_TYPE)===-1?pj:k.PARSER_MEDIA_TYPE,bn=Jc==="application/xhtml+xml"?rb:Zm,Ge=Ir(k,"ALLOWED_TAGS")?Fe({},k.ALLOWED_TAGS,bn):St,p=Ir(k,"ALLOWED_ATTR")?Fe({},k.ALLOWED_ATTR,bn):w,et=Ir(k,"ALLOWED_NAMESPACES")?Fe({},k.ALLOWED_NAMESPACES,rb):Bi,oi=Ir(k,"ADD_URI_SAFE_ATTR")?Fe(Qs(ks),k.ADD_URI_SAFE_ATTR,bn):ks,be=Ir(k,"ADD_DATA_URI_TAGS")?Fe(Qs(it),k.ADD_DATA_URI_TAGS,bn):it,Be=Ir(k,"FORBID_CONTENTS")?Fe({},k.FORBID_CONTENTS,bn):_e,N=Ir(k,"FORBID_TAGS")?Fe({},k.FORBID_TAGS,bn):Qs({}),V=Ir(k,"FORBID_ATTR")?Fe({},k.FORBID_ATTR,bn):Qs({}),We=Ir(k,"USE_PROFILES")?k.USE_PROFILES:!1,j=k.ALLOW_ARIA_ATTR!==!1,X=k.ALLOW_DATA_ATTR!==!1,C=k.ALLOW_UNKNOWN_PROTOCOLS||!1,R=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,_=k.SAFE_FOR_TEMPLATES||!1,x=k.SAFE_FOR_XML!==!1,H=k.WHOLE_DOCUMENT||!1,D=k.RETURN_DOM||!1,F=k.RETURN_DOM_FRAGMENT||!1,W=k.RETURN_TRUSTED_TYPE||!1,B=k.FORCE_BODY||!1,z=k.SANITIZE_DOM!==!1,Y=k.SANITIZE_NAMED_PROPS||!1,ae=k.KEEP_CONTENT!==!1,Re=k.IN_PLACE||!1,Le=k.ALLOWED_URI_REGEXP||RL,Ot=k.NAMESPACE||Rt,Gn=k.MATHML_TEXT_INTEGRATION_POINTS||Gn,Da=k.HTML_INTEGRATION_POINTS||Da,b=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&Ox(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(b.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&Ox(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(b.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(b.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),_&&(X=!1),F&&(D=!0),We&&(Ge=Fe({},a1),p=[],We.html===!0&&(Fe(Ge,o1),Fe(p,l1)),We.svg===!0&&(Fe(Ge,sb),Fe(p,lb),Fe(p,ig)),We.svgFilters===!0&&(Fe(Ge,ob),Fe(p,lb),Fe(p,ig)),We.mathMl===!0&&(Fe(Ge,ab),Fe(p,u1),Fe(p,ig))),k.ADD_TAGS&&(Ge===St&&(Ge=Qs(Ge)),Fe(Ge,k.ADD_TAGS,bn)),k.ADD_ATTR&&(p===w&&(p=Qs(p)),Fe(p,k.ADD_ATTR,bn)),k.ADD_URI_SAFE_ATTR&&Fe(oi,k.ADD_URI_SAFE_ATTR,bn),k.FORBID_CONTENTS&&(Be===_e&&(Be=Qs(Be)),Fe(Be,k.FORBID_CONTENTS,bn)),ae&&(Ge["#text"]=!0),H&&Fe(Ge,["html","head","body"]),Ge.table&&(Fe(Ge,["tbody"]),delete N.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw rh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw rh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');I=k.TRUSTED_TYPES_POLICY,P=I.createHTML("")}else I===void 0&&(I=sU(f,r)),I!==null&&typeof P=="string"&&(P=I.createHTML(""));ii&&ii(k),au=k}},Ax=Fe({},[...sb,...ob,...qz]),Hx=Fe({},[...ab,...Kz]),vj=function(k){let ee=M(k);(!ee||!ee.tagName)&&(ee={namespaceURI:Ot,tagName:"template"});const ge=Zm(k.tagName),At=Zm(ee.tagName);return et[k.namespaceURI]?k.namespaceURI===gn?ee.namespaceURI===Rt?ge==="svg":ee.namespaceURI===Cr?ge==="svg"&&(At==="annotation-xml"||Gn[At]):!!Ax[ge]:k.namespaceURI===Cr?ee.namespaceURI===Rt?ge==="math":ee.namespaceURI===gn?ge==="math"&&Da[At]:!!Hx[ge]:k.namespaceURI===Rt?ee.namespaceURI===gn&&!Da[At]||ee.namespaceURI===Cr&&!Gn[At]?!1:!Hx[ge]&&(tg[ge]||!Ax[ge]):!!(Jc==="application/xhtml+xml"&&et[k.namespaceURI]):!1},Gr=function(k){nh(e.removed,{element:k});try{M(k).removeChild(k)}catch{v(k)}},lu=function(k,ee){try{nh(e.removed,{attribute:ee.getAttributeNode(k),from:ee})}catch{nh(e.removed,{attribute:null,from:ee})}if(ee.removeAttribute(k),k==="is")if(D||F)try{Gr(ee)}catch{}else try{ee.setAttribute(k,"")}catch{}},Dx=function(k){let ee=null,ge=null;if(B)k="<remove></remove>"+k;else{const mn=s1(k,/^[\r\n\t ]+/);ge=mn&&mn[0]}Jc==="application/xhtml+xml"&&Ot===Rt&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const At=I?I.createHTML(k):k;if(Ot===Rt)try{ee=new d().parseFromString(At,Jc)}catch{}if(!ee||!ee.documentElement){ee=E.createDocument(Ot,"template",null);try{ee.documentElement.innerHTML=vt?P:At}catch{}}const On=ee.body||ee.documentElement;return k&&ge&&On.insertBefore(n.createTextNode(ge),On.childNodes[0]||null),Ot===Rt?U.call(ee,H?"html":"body")[0]:H?ee.documentElement:On},Nx=function(k){return T.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Ov=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},kx=function(k){return typeof a=="function"&&k instanceof a};function Ls(pe,k,ee){ng(pe,ge=>{ge.call(e,k,ee,au)})}const Lx=function(k){let ee=null;if(Ls(G.beforeSanitizeElements,k,null),Ov(k))return Gr(k),!0;const ge=bn(k.nodeName);if(Ls(G.uponSanitizeElement,k,{tagName:ge,allowedTags:Ge}),x&&k.hasChildNodes()&&!kx(k.firstElementChild)&&qn(/<[/\w!]/g,k.innerHTML)&&qn(/<[/\w!]/g,k.textContent)||k.nodeType===oh.progressingInstruction||x&&k.nodeType===oh.comment&&qn(/<[/\w]/g,k.data))return Gr(k),!0;if(!Ge[ge]||N[ge]){if(!N[ge]&&$x(ge)&&(b.tagNameCheck instanceof RegExp&&qn(b.tagNameCheck,ge)||b.tagNameCheck instanceof Function&&b.tagNameCheck(ge)))return!1;if(ae&&!Be[ge]){const At=M(k)||k.parentNode,On=y(k)||k.childNodes;if(On&&At){const mn=On.length;for(let ai=mn-1;ai>=0;--ai){const Fs=m(On[ai],!0);Fs.__removalCount=(k.__removalCount||0)+1,At.insertBefore(Fs,S(k))}}}return Gr(k),!0}return k instanceof l&&!vj(k)||(ge==="noscript"||ge==="noembed"||ge==="noframes")&&qn(/<\/no(script|embed|frames)/i,k.innerHTML)?(Gr(k),!0):(_&&k.nodeType===oh.text&&(ee=k.textContent,ng([q,ne,Q],At=>{ee=ih(ee,At," ")}),k.textContent!==ee&&(nh(e.removed,{element:k.cloneNode()}),k.textContent=ee)),Ls(G.afterSanitizeElements,k,null),!1)},Fx=function(k,ee,ge){if(z&&(ee==="id"||ee==="name")&&(ge in n||ge in wj))return!1;if(!(X&&!V[ee]&&qn(te,ee))){if(!(j&&qn(Me,ee))){if(!p[ee]||V[ee]){if(!($x(k)&&(b.tagNameCheck instanceof RegExp&&qn(b.tagNameCheck,k)||b.tagNameCheck instanceof Function&&b.tagNameCheck(k))&&(b.attributeNameCheck instanceof RegExp&&qn(b.attributeNameCheck,ee)||b.attributeNameCheck instanceof Function&&b.attributeNameCheck(ee))||ee==="is"&&b.allowCustomizedBuiltInElements&&(b.tagNameCheck instanceof RegExp&&qn(b.tagNameCheck,ge)||b.tagNameCheck instanceof Function&&b.tagNameCheck(ge))))return!1}else if(!oi[ee]){if(!qn(Le,ih(ge,Ie,""))){if(!((ee==="src"||ee==="xlink:href"||ee==="href")&&k!=="script"&&zz(ge,"data:")===0&&be[k])){if(!(C&&!qn(Ce,ih(ge,Ie,"")))){if(ge)return!1}}}}}}return!0},$x=function(k){return k!=="annotation-xml"&&s1(k,at)},Vx=function(k){Ls(G.beforeSanitizeAttributes,k,null);const{attributes:ee}=k;if(!ee||Ov(k))return;const ge={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:p,forceKeepAttr:void 0};let At=ee.length;for(;At--;){const On=ee[At],{name:mn,namespaceURI:ai,value:Fs}=On,eh=bn(mn),Av=Fs;let An=mn==="value"?Av:Uz(Av);if(ge.attrName=eh,ge.attrValue=An,ge.keepAttr=!0,ge.forceKeepAttr=void 0,Ls(G.uponSanitizeAttribute,k,ge),An=ge.attrValue,Y&&(eh==="id"||eh==="name")&&(lu(mn,k),An=oe+An),x&&qn(/((--!?|])>)|<\/(style|title)/i,An)){lu(mn,k);continue}if(ge.forceKeepAttr)continue;if(!ge.keepAttr){lu(mn,k);continue}if(!R&&qn(/\/>/i,An)){lu(mn,k);continue}_&&ng([q,ne,Q],Bx=>{An=ih(An,Bx," ")});const Wx=bn(k.nodeName);if(!Fx(Wx,eh,An)){lu(mn,k);continue}if(I&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!ai)switch(f.getAttributeType(Wx,eh)){case"TrustedHTML":{An=I.createHTML(An);break}case"TrustedScriptURL":{An=I.createScriptURL(An);break}}if(An!==Av)try{ai?k.setAttributeNS(ai,mn,An):k.setAttribute(mn,An),Ov(k)?Gr(k):r1(e.removed)}catch{lu(mn,k)}}Ls(G.afterSanitizeAttributes,k,null)},yj=function pe(k){let ee=null;const ge=Nx(k);for(Ls(G.beforeSanitizeShadowDOM,k,null);ee=ge.nextNode();)Ls(G.uponSanitizeShadowNode,ee,null),Lx(ee),Vx(ee),ee.content instanceof s&&pe(ee.content);Ls(G.afterSanitizeShadowDOM,k,null)};return e.sanitize=function(pe){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ee=null,ge=null,At=null,On=null;if(vt=!pe,vt&&(pe="<!-->"),typeof pe!="string"&&!kx(pe))if(typeof pe.toString=="function"){if(pe=pe.toString(),typeof pe!="string")throw rh("dirty is not a string, aborting")}else throw rh("toString is not a function");if(!e.isSupported)return pe;if(L||Iv(k),e.removed=[],typeof pe=="string"&&(Re=!1),Re){if(pe.nodeName){const Fs=bn(pe.nodeName);if(!Ge[Fs]||N[Fs])throw rh("root node is forbidden and cannot be sanitized in-place")}}else if(pe instanceof a)ee=Dx("<!---->"),ge=ee.ownerDocument.importNode(pe,!0),ge.nodeType===oh.element&&ge.nodeName==="BODY"||ge.nodeName==="HTML"?ee=ge:ee.appendChild(ge);else{if(!D&&!_&&!H&&pe.indexOf("<")===-1)return I&&W?I.createHTML(pe):pe;if(ee=Dx(pe),!ee)return D?null:W?P:""}ee&&B&&Gr(ee.firstChild);const mn=Nx(Re?pe:ee);for(;At=mn.nextNode();)Lx(At),Vx(At),At.content instanceof s&&yj(At.content);if(Re)return pe;if(D){if(F)for(On=$.call(ee.ownerDocument);ee.firstChild;)On.appendChild(ee.firstChild);else On=ee;return(p.shadowroot||p.shadowrootmode)&&(On=O.call(i,On,!0)),On}let ai=H?ee.outerHTML:ee.innerHTML;return H&&Ge["!doctype"]&&ee.ownerDocument&&ee.ownerDocument.doctype&&ee.ownerDocument.doctype.name&&qn(_L,ee.ownerDocument.doctype.name)&&(ai="<!DOCTYPE "+ee.ownerDocument.doctype.name+`>
`+ai),_&&ng([q,ne,Q],Fs=>{ai=ih(ai,Fs," ")}),I&&W?I.createHTML(ai):ai},e.setConfig=function(){let pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Iv(pe),L=!0},e.clearConfig=function(){au=null,L=!1},e.isValidAttribute=function(pe,k,ee){au||Iv({});const ge=bn(pe),At=bn(k);return Fx(ge,At,ee)},e.addHook=function(pe,k){typeof k=="function"&&nh(G[pe],k)},e.removeHook=function(pe,k){if(k!==void 0){const ee=Bz(G[pe],k);return ee===-1?void 0:jz(G[pe],ee,1)[0]}return r1(G[pe])},e.removeHooks=function(pe){G[pe]=[]},e.removeAllHooks=function(){G=h1()},e}var oU=EL();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var TL;function Z(){return TL.apply(null,arguments)}function aU(t){TL=t}function Br(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Fl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function tt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function E_(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(tt(t,e))return!1;return!0}function pi(t){return t===void 0}function bo(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Of(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function ML(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function aa(t,e){for(var n in e)tt(e,n)&&(t[n]=e[n]);return tt(e,"toString")&&(t.toString=e.toString),tt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function As(t,e,n,i){return XL(t,e,n,i,!0).utc()}function lU(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Oe(t){return t._pf==null&&(t._pf=lU()),t._pf}var QR;Array.prototype.some?QR=Array.prototype.some:QR=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function T_(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=Oe(t),n=QR.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function Pw(t){var e=As(NaN);return t!=null?aa(Oe(e),t):Oe(e).userInvalidated=!0,e}var d1=Z.momentProperties=[],ub=!1;function M_(t,e){var n,i,r,s=d1.length;if(pi(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),pi(e._i)||(t._i=e._i),pi(e._f)||(t._f=e._f),pi(e._l)||(t._l=e._l),pi(e._strict)||(t._strict=e._strict),pi(e._tzm)||(t._tzm=e._tzm),pi(e._isUTC)||(t._isUTC=e._isUTC),pi(e._offset)||(t._offset=e._offset),pi(e._pf)||(t._pf=Oe(e)),pi(e._locale)||(t._locale=e._locale),s>0)for(n=0;n<s;n++)i=d1[n],r=e[i],pi(r)||(t[i]=r);return t}function Af(t){M_(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ub===!1&&(ub=!0,Z.updateOffset(this),ub=!1)}function jr(t){return t instanceof Af||t!=null&&t._isAMomentObject!=null}function xL(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function mr(t,e){var n=!0;return aa(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var i=[],r,s,o,a=arguments.length;for(s=0;s<a;s++){if(r="",typeof arguments[s]=="object"){r+=`
[`+s+"] ";for(o in arguments[0])tt(arguments[0],o)&&(r+=o+": "+arguments[0][o]+", ");r=r.slice(0,-2)}else r=arguments[s];i.push(r)}xL(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var f1={};function PL(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),f1[t]||(xL(e),f1[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function Hs(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function uU(t){var e,n;for(n in t)tt(t,n)&&(e=t[n],Hs(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function JR(t,e){var n=aa({},t),i;for(i in e)tt(e,i)&&(Fl(t[i])&&Fl(e[i])?(n[i]={},aa(n[i],t[i]),aa(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)tt(t,i)&&!tt(e,i)&&Fl(t[i])&&(n[i]=aa({},n[i]));return n}function x_(t){t!=null&&this.set(t)}var e0;Object.keys?e0=Object.keys:e0=function(t){var e,n=[];for(e in t)tt(t,e)&&n.push(e);return n};var cU={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function hU(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return Hs(i)?i.call(e,n):i}function xs(t,e,n){var i=""+Math.abs(t),r=e-i.length,s=t>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var P_=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,rg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,cb={},dc={};function we(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(dc[t]=r),e&&(dc[e[0]]=function(){return xs(r.apply(this,arguments),e[1],e[2])}),n&&(dc[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function dU(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function fU(t){var e=t.match(P_),n,i;for(n=0,i=e.length;n<i;n++)dc[e[n]]?e[n]=dc[e[n]]:e[n]=dU(e[n]);return function(r){var s="",o;for(o=0;o<i;o++)s+=Hs(e[o])?e[o].call(r,t):e[o];return s}}function Qm(t,e){return t.isValid()?(e=IL(e,t.localeData()),cb[e]=cb[e]||fU(e),cb[e](t)):t.localeData().invalidDate()}function IL(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(rg.lastIndex=0;n>=0&&rg.test(t);)t=t.replace(rg,i),rg.lastIndex=0,n-=1;return t}var gU={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function mU(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(P_).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var pU="Invalid date";function wU(){return this._invalidDate}var vU="%d",yU=/\d{1,2}/;function CU(t){return this._ordinal.replace("%d",t)}var bU={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function SU(t,e,n,i){var r=this._relativeTime[n];return Hs(r)?r(t,e,n,i):r.replace(/%d/i,t)}function RU(t,e){var n=this._relativeTime[t>0?"future":"past"];return Hs(n)?n(e):n.replace(/%s/i,e)}var g1={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function pr(t){return typeof t=="string"?g1[t]||g1[t.toLowerCase()]:void 0}function I_(t){var e={},n,i;for(i in t)tt(t,i)&&(n=pr(i),n&&(e[n]=t[i]));return e}var _U={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function EU(t){var e=[],n;for(n in t)tt(t,n)&&e.push({unit:n,priority:_U[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var OL=/\d/,Wi=/\d\d/,AL=/\d{3}/,O_=/\d{4}/,Iw=/[+-]?\d{6}/,It=/\d\d?/,HL=/\d\d\d\d?/,DL=/\d\d\d\d\d\d?/,Ow=/\d{1,3}/,A_=/\d{1,4}/,Aw=/[+-]?\d{1,6}/,$c=/\d+/,Hw=/[+-]?\d+/,TU=/Z|[+-]\d\d:?\d\d/gi,Dw=/Z|[+-]\d\d(?::?\d\d)?/gi,MU=/[+-]?\d+(\.\d{1,3})?/,Hf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Vc=/^[1-9]\d?/,H_=/^([1-9]\d|\d)/,bp;bp={};function ue(t,e,n){bp[t]=Hs(e)?e:function(i,r){return i&&n?n:e}}function xU(t,e){return tt(bp,t)?bp[t](e._strict,e._locale):new RegExp(PU(t))}function PU(t){return yo(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,s){return n||i||r||s}))}function yo(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function rr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ze(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=rr(e)),n}var t0={};function mt(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),bo(e)&&(i=function(s,o){o[e]=ze(s)}),r=t.length,n=0;n<r;n++)t0[t[n]]=i}function Df(t,e){mt(t,function(n,i,r,s){r._w=r._w||{},e(n,r._w,r,s)})}function IU(t,e,n){e!=null&&tt(t0,t)&&t0[t](e,n._a,n,t)}function Nw(t){return t%4===0&&t%100!==0||t%400===0}var zn=0,co=1,Cs=2,yn=3,Lr=4,ho=5,Pl=6,OU=7,AU=8;we("Y",0,0,function(){var t=this.year();return t<=9999?xs(t,4):"+"+t});we(0,["YY",2],0,function(){return this.year()%100});we(0,["YYYY",4],0,"year");we(0,["YYYYY",5],0,"year");we(0,["YYYYYY",6,!0],0,"year");ue("Y",Hw);ue("YY",It,Wi);ue("YYYY",A_,O_);ue("YYYYY",Aw,Iw);ue("YYYYYY",Aw,Iw);mt(["YYYYY","YYYYYY"],zn);mt("YYYY",function(t,e){e[zn]=t.length===2?Z.parseTwoDigitYear(t):ze(t)});mt("YY",function(t,e){e[zn]=Z.parseTwoDigitYear(t)});mt("Y",function(t,e){e[zn]=parseInt(t,10)});function Cd(t){return Nw(t)?366:365}Z.parseTwoDigitYear=function(t){return ze(t)+(ze(t)>68?1900:2e3)};var NL=Wc("FullYear",!0);function HU(){return Nw(this.year())}function Wc(t,e){return function(n){return n!=null?(kL(this,t,n),Z.updateOffset(this,e),this):Kd(this,t)}}function Kd(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function kL(t,e,n){var i,r,s,o,a;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}s=n,o=t.month(),a=t.date(),a=a===29&&o===1&&!Nw(s)?28:a,r?i.setUTCFullYear(s,o,a):i.setFullYear(s,o,a)}}function DU(t){return t=pr(t),Hs(this[t])?this[t]():this}function NU(t,e){if(typeof t=="object"){t=I_(t);var n=EU(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=pr(t),Hs(this[t]))return this[t](e);return this}function kU(t,e){return(t%e+e)%e}var Zt;Array.prototype.indexOf?Zt=Array.prototype.indexOf:Zt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function D_(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=kU(e,12);return t+=(e-n)/12,n===1?Nw(t)?29:28:31-n%7%2}we("M",["MM",2],"Mo",function(){return this.month()+1});we("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});we("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",It,Vc);ue("MM",It,Wi);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});mt(["M","MM"],function(t,e){e[co]=ze(t)-1});mt(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[co]=r:Oe(n).invalidMonth=t});var LU="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),LL="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),FL=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,FU=Hf,$U=Hf;function VU(t,e){return t?Br(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||FL).test(e)?"format":"standalone"][t.month()]:Br(this._months)?this._months:this._months.standalone}function WU(t,e){return t?Br(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[FL.test(e)?"format":"standalone"][t.month()]:Br(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function BU(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)s=As([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(s,"").toLocaleLowerCase();return n?e==="MMM"?(r=Zt.call(this._shortMonthsParse,o),r!==-1?r:null):(r=Zt.call(this._longMonthsParse,o),r!==-1?r:null):e==="MMM"?(r=Zt.call(this._shortMonthsParse,o),r!==-1?r:(r=Zt.call(this._longMonthsParse,o),r!==-1?r:null)):(r=Zt.call(this._longMonthsParse,o),r!==-1?r:(r=Zt.call(this._shortMonthsParse,o),r!==-1?r:null))}function jU(t,e,n){var i,r,s;if(this._monthsParseExact)return BU.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=As([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function $L(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ze(e);else if(e=t.localeData().monthsParse(e),!bo(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,D_(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function VL(t){return t!=null?($L(this,t),Z.updateOffset(this,!0),this):Kd(this,"Month")}function zU(){return D_(this.year(),this.month())}function UU(t){return this._monthsParseExact?(tt(this,"_monthsRegex")||WL.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(tt(this,"_monthsShortRegex")||(this._monthsShortRegex=FU),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function YU(t){return this._monthsParseExact?(tt(this,"_monthsRegex")||WL.call(this),t?this._monthsStrictRegex:this._monthsRegex):(tt(this,"_monthsRegex")||(this._monthsRegex=$U),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function WL(){function t(l,u){return u.length-l.length}var e=[],n=[],i=[],r,s,o,a;for(r=0;r<12;r++)s=As([2e3,r]),o=yo(this.monthsShort(s,"")),a=yo(this.months(s,"")),e.push(o),n.push(a),i.push(a),i.push(o);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function GU(t,e,n,i,r,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,i,r,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,i,r,s,o),a}function Xd(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Sp(t,e,n){var i=7+e-n,r=(7+Xd(t,0,i).getUTCDay()-e)%7;return-r+i-1}function BL(t,e,n,i,r){var s=(7+n-i)%7,o=Sp(t,i,r),a=1+7*(e-1)+s+o,l,u;return a<=0?(l=t-1,u=Cd(l)+a):a>Cd(t)?(l=t+1,u=a-Cd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Zd(t,e,n){var i=Sp(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,s,o;return r<1?(o=t.year()-1,s=r+Co(o,e,n)):r>Co(t.year(),e,n)?(s=r-Co(t.year(),e,n),o=t.year()+1):(o=t.year(),s=r),{week:s,year:o}}function Co(t,e,n){var i=Sp(t,e,n),r=Sp(t+1,e,n);return(Cd(t)-i+r)/7}we("w",["ww",2],"wo","week");we("W",["WW",2],"Wo","isoWeek");ue("w",It,Vc);ue("ww",It,Wi);ue("W",It,Vc);ue("WW",It,Wi);Df(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=ze(t)});function qU(t){return Zd(t,this._week.dow,this._week.doy).week}var KU={dow:0,doy:6};function XU(){return this._week.dow}function ZU(){return this._week.doy}function QU(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function JU(t){var e=Zd(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}we("d",0,"do","day");we("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});we("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});we("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});we("e",0,0,"weekday");we("E",0,0,"isoWeekday");ue("d",It);ue("e",It);ue("E",It);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});Df(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:Oe(n).invalidWeekday=t});Df(["d","e","E"],function(t,e,n,i){e[i]=ze(t)});function e2(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function t2(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function N_(t,e){return t.slice(e,7).concat(t.slice(0,e))}var n2="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),jL="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),i2="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),r2=Hf,s2=Hf,o2=Hf;function a2(t,e){var n=Br(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?N_(n,this._week.dow):t?n[t.day()]:n}function l2(t){return t===!0?N_(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function u2(t){return t===!0?N_(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function c2(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)s=As([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(s,"").toLocaleLowerCase();return n?e==="dddd"?(r=Zt.call(this._weekdaysParse,o),r!==-1?r:null):e==="ddd"?(r=Zt.call(this._shortWeekdaysParse,o),r!==-1?r:null):(r=Zt.call(this._minWeekdaysParse,o),r!==-1?r:null):e==="dddd"?(r=Zt.call(this._weekdaysParse,o),r!==-1||(r=Zt.call(this._shortWeekdaysParse,o),r!==-1)?r:(r=Zt.call(this._minWeekdaysParse,o),r!==-1?r:null)):e==="ddd"?(r=Zt.call(this._shortWeekdaysParse,o),r!==-1||(r=Zt.call(this._weekdaysParse,o),r!==-1)?r:(r=Zt.call(this._minWeekdaysParse,o),r!==-1?r:null)):(r=Zt.call(this._minWeekdaysParse,o),r!==-1||(r=Zt.call(this._weekdaysParse,o),r!==-1)?r:(r=Zt.call(this._shortWeekdaysParse,o),r!==-1?r:null))}function h2(t,e,n){var i,r,s;if(this._weekdaysParseExact)return c2.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=As([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(s="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function d2(t){if(!this.isValid())return t!=null?this:NaN;var e=Kd(this,"Day");return t!=null?(t=e2(t,this.localeData()),this.add(t-e,"d")):e}function f2(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function g2(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=t2(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function m2(t){return this._weekdaysParseExact?(tt(this,"_weekdaysRegex")||k_.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(tt(this,"_weekdaysRegex")||(this._weekdaysRegex=r2),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function p2(t){return this._weekdaysParseExact?(tt(this,"_weekdaysRegex")||k_.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(tt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=s2),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function w2(t){return this._weekdaysParseExact?(tt(this,"_weekdaysRegex")||k_.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(tt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=o2),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function k_(){function t(c,h){return h.length-c.length}var e=[],n=[],i=[],r=[],s,o,a,l,u;for(s=0;s<7;s++)o=As([2e3,1]).day(s),a=yo(this.weekdaysMin(o,"")),l=yo(this.weekdaysShort(o,"")),u=yo(this.weekdays(o,"")),e.push(a),n.push(l),i.push(u),r.push(a),r.push(l),r.push(u);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function L_(){return this.hours()%12||12}function v2(){return this.hours()||24}we("H",["HH",2],0,"hour");we("h",["hh",2],0,L_);we("k",["kk",2],0,v2);we("hmm",0,0,function(){return""+L_.apply(this)+xs(this.minutes(),2)});we("hmmss",0,0,function(){return""+L_.apply(this)+xs(this.minutes(),2)+xs(this.seconds(),2)});we("Hmm",0,0,function(){return""+this.hours()+xs(this.minutes(),2)});we("Hmmss",0,0,function(){return""+this.hours()+xs(this.minutes(),2)+xs(this.seconds(),2)});function zL(t,e){we(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}zL("a",!0);zL("A",!1);function UL(t,e){return e._meridiemParse}ue("a",UL);ue("A",UL);ue("H",It,H_);ue("h",It,Vc);ue("k",It,Vc);ue("HH",It,Wi);ue("hh",It,Wi);ue("kk",It,Wi);ue("hmm",HL);ue("hmmss",DL);ue("Hmm",HL);ue("Hmmss",DL);mt(["H","HH"],yn);mt(["k","kk"],function(t,e,n){var i=ze(t);e[yn]=i===24?0:i});mt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});mt(["h","hh"],function(t,e,n){e[yn]=ze(t),Oe(n).bigHour=!0});mt("hmm",function(t,e,n){var i=t.length-2;e[yn]=ze(t.substr(0,i)),e[Lr]=ze(t.substr(i)),Oe(n).bigHour=!0});mt("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[yn]=ze(t.substr(0,i)),e[Lr]=ze(t.substr(i,2)),e[ho]=ze(t.substr(r)),Oe(n).bigHour=!0});mt("Hmm",function(t,e,n){var i=t.length-2;e[yn]=ze(t.substr(0,i)),e[Lr]=ze(t.substr(i))});mt("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[yn]=ze(t.substr(0,i)),e[Lr]=ze(t.substr(i,2)),e[ho]=ze(t.substr(r))});function y2(t){return(t+"").toLowerCase().charAt(0)==="p"}var C2=/[ap]\.?m?\.?/i,b2=Wc("Hours",!0);function S2(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var YL={calendar:cU,longDateFormat:gU,invalidDate:pU,ordinal:vU,dayOfMonthOrdinalParse:yU,relativeTime:bU,months:LU,monthsShort:LL,week:KU,weekdays:n2,weekdaysMin:i2,weekdaysShort:jL,meridiemParse:C2},Ht={},ah={},Qd;function R2(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function m1(t){return t&&t.toLowerCase().replace("_","-")}function _2(t){for(var e=0,n,i,r,s;e<t.length;){for(s=m1(t[e]).split("-"),n=s.length,i=m1(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=kw(s.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&R2(s,i)>=n-1)break;n--}e++}return Qd}function E2(t){return!!(t&&t.match("^[^/\\\\]*$"))}function kw(t){var e=null,n;if(Ht[t]===void 0&&typeof module<"u"&&module&&module.exports&&E2(t))try{e=Qd._abbr,n=require,n("./locale/"+t),ma(e)}catch{Ht[t]=null}return Ht[t]}function ma(t,e){var n;return t&&(pi(e)?n=To(t):n=F_(t,e),n?Qd=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Qd._abbr}function F_(t,e){if(e!==null){var n,i=YL;if(e.abbr=t,Ht[t]!=null)PL("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Ht[t]._config;else if(e.parentLocale!=null)if(Ht[e.parentLocale]!=null)i=Ht[e.parentLocale]._config;else if(n=kw(e.parentLocale),n!=null)i=n._config;else return ah[e.parentLocale]||(ah[e.parentLocale]=[]),ah[e.parentLocale].push({name:t,config:e}),null;return Ht[t]=new x_(JR(i,e)),ah[t]&&ah[t].forEach(function(r){F_(r.name,r.config)}),ma(t),Ht[t]}else return delete Ht[t],null}function T2(t,e){if(e!=null){var n,i,r=YL;Ht[t]!=null&&Ht[t].parentLocale!=null?Ht[t].set(JR(Ht[t]._config,e)):(i=kw(t),i!=null&&(r=i._config),e=JR(r,e),i==null&&(e.abbr=t),n=new x_(e),n.parentLocale=Ht[t],Ht[t]=n),ma(t)}else Ht[t]!=null&&(Ht[t].parentLocale!=null?(Ht[t]=Ht[t].parentLocale,t===ma()&&ma(t)):Ht[t]!=null&&delete Ht[t]);return Ht[t]}function To(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Qd;if(!Br(t)){if(e=kw(t),e)return e;t=[t]}return _2(t)}function M2(){return e0(Ht)}function $_(t){var e,n=t._a;return n&&Oe(t).overflow===-2&&(e=n[co]<0||n[co]>11?co:n[Cs]<1||n[Cs]>D_(n[zn],n[co])?Cs:n[yn]<0||n[yn]>24||n[yn]===24&&(n[Lr]!==0||n[ho]!==0||n[Pl]!==0)?yn:n[Lr]<0||n[Lr]>59?Lr:n[ho]<0||n[ho]>59?ho:n[Pl]<0||n[Pl]>999?Pl:-1,Oe(t)._overflowDayOfYear&&(e<zn||e>Cs)&&(e=Cs),Oe(t)._overflowWeeks&&e===-1&&(e=OU),Oe(t)._overflowWeekday&&e===-1&&(e=AU),Oe(t).overflow=e),t}var x2=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,P2=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,I2=/Z|[+-]\d\d(?::?\d\d)?/,sg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],hb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],O2=/^\/?Date\((-?\d+)/i,A2=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,H2={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function GL(t){var e,n,i=t._i,r=x2.exec(i)||P2.exec(i),s,o,a,l,u=sg.length,c=hb.length;if(r){for(Oe(t).iso=!0,e=0,n=u;e<n;e++)if(sg[e][1].exec(r[1])){o=sg[e][0],s=sg[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(r[3]){for(e=0,n=c;e<n;e++)if(hb[e][1].exec(r[3])){a=(r[2]||" ")+hb[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(r[4])if(I2.exec(r[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),W_(t)}else t._isValid=!1}function D2(t,e,n,i,r,s){var o=[N2(t),LL.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return s&&o.push(parseInt(s,10)),o}function N2(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function k2(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function L2(t,e,n){if(t){var i=jL.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return Oe(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function F2(t,e,n){if(t)return H2[t];if(e)return 0;var i=parseInt(n,10),r=i%100,s=(i-r)/100;return s*60+r}function qL(t){var e=A2.exec(k2(t._i)),n;if(e){if(n=D2(e[4],e[3],e[2],e[5],e[6],e[7]),!L2(e[1],n,t))return;t._a=n,t._tzm=F2(e[8],e[9],e[10]),t._d=Xd.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Oe(t).rfc2822=!0}else t._isValid=!1}function $2(t){var e=O2.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(GL(t),t._isValid===!1)delete t._isValid;else return;if(qL(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=mr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Zu(t,e,n){return t??e??n}function V2(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function V_(t){var e,n,i=[],r,s,o;if(!t._d){for(r=V2(t),t._w&&t._a[Cs]==null&&t._a[co]==null&&W2(t),t._dayOfYear!=null&&(o=Zu(t._a[zn],r[zn]),(t._dayOfYear>Cd(o)||t._dayOfYear===0)&&(Oe(t)._overflowDayOfYear=!0),n=Xd(o,0,t._dayOfYear),t._a[co]=n.getUTCMonth(),t._a[Cs]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[yn]===24&&t._a[Lr]===0&&t._a[ho]===0&&t._a[Pl]===0&&(t._nextDay=!0,t._a[yn]=0),t._d=(t._useUTC?Xd:GU).apply(null,i),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[yn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(Oe(t).weekdayMismatch=!0)}}function W2(t){var e,n,i,r,s,o,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,n=Zu(e.GG,t._a[zn],Zd(Pt(),1,4).year),i=Zu(e.W,1),r=Zu(e.E,1),(r<1||r>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,u=Zd(Pt(),s,o),n=Zu(e.gg,t._a[zn],u.year),i=Zu(e.w,u.week),e.d!=null?(r=e.d,(r<0||r>6)&&(l=!0)):e.e!=null?(r=e.e+s,(e.e<0||e.e>6)&&(l=!0)):r=s),i<1||i>Co(n,s,o)?Oe(t)._overflowWeeks=!0:l!=null?Oe(t)._overflowWeekday=!0:(a=BL(n,i,r,s,o),t._a[zn]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function W_(t){if(t._f===Z.ISO_8601){GL(t);return}if(t._f===Z.RFC_2822){qL(t);return}t._a=[],Oe(t).empty=!0;var e=""+t._i,n,i,r,s,o,a=e.length,l=0,u,c;for(r=IL(t._f,t._locale).match(P_)||[],c=r.length,n=0;n<c;n++)s=r[n],i=(e.match(xU(s,t))||[])[0],i&&(o=e.substr(0,e.indexOf(i)),o.length>0&&Oe(t).unusedInput.push(o),e=e.slice(e.indexOf(i)+i.length),l+=i.length),dc[s]?(i?Oe(t).empty=!1:Oe(t).unusedTokens.push(s),IU(s,i,t)):t._strict&&!i&&Oe(t).unusedTokens.push(s);Oe(t).charsLeftOver=a-l,e.length>0&&Oe(t).unusedInput.push(e),t._a[yn]<=12&&Oe(t).bigHour===!0&&t._a[yn]>0&&(Oe(t).bigHour=void 0),Oe(t).parsedDateParts=t._a.slice(0),Oe(t).meridiem=t._meridiem,t._a[yn]=B2(t._locale,t._a[yn],t._meridiem),u=Oe(t).era,u!==null&&(t._a[zn]=t._locale.erasConvertYear(u,t._a[zn])),V_(t),$_(t)}function B2(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function j2(t){var e,n,i,r,s,o,a=!1,l=t._f.length;if(l===0){Oe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<l;r++)s=0,o=!1,e=M_({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],W_(e),T_(e)&&(o=!0),s+=Oe(e).charsLeftOver,s+=Oe(e).unusedTokens.length*10,Oe(e).score=s,a?s<i&&(i=s,n=e):(i==null||s<i||o)&&(i=s,n=e,o&&(a=!0));aa(t,n||e)}function z2(t){if(!t._d){var e=I_(t._i),n=e.day===void 0?e.date:e.day;t._a=ML([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),V_(t)}}function U2(t){var e=new Af($_(KL(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function KL(t){var e=t._i,n=t._f;return t._locale=t._locale||To(t._l),e===null||n===void 0&&e===""?Pw({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),jr(e)?new Af($_(e)):(Of(e)?t._d=e:Br(n)?j2(t):n?W_(t):Y2(t),T_(t)||(t._d=null),t))}function Y2(t){var e=t._i;pi(e)?t._d=new Date(Z.now()):Of(e)?t._d=new Date(e.valueOf()):typeof e=="string"?$2(t):Br(e)?(t._a=ML(e.slice(0),function(n){return parseInt(n,10)}),V_(t)):Fl(e)?z2(t):bo(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function XL(t,e,n,i,r){var s={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(Fl(t)&&E_(t)||Br(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=r,s._l=n,s._i=t,s._f=e,s._strict=i,U2(s)}function Pt(t,e,n,i){return XL(t,e,n,i,!1)}var G2=mr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Pt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Pw()}),q2=mr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Pt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Pw()});function ZL(t,e){var n,i;if(e.length===1&&Br(e[0])&&(e=e[0]),!e.length)return Pt();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function K2(){var t=[].slice.call(arguments,0);return ZL("isBefore",t)}function X2(){var t=[].slice.call(arguments,0);return ZL("isAfter",t)}var Z2=function(){return Date.now?Date.now():+new Date},lh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Q2(t){var e,n=!1,i,r=lh.length;for(e in t)if(tt(t,e)&&!(Zt.call(lh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[lh[i]]){if(n)return!1;parseFloat(t[lh[i]])!==ze(t[lh[i]])&&(n=!0)}return!0}function J2(){return this._isValid}function eY(){return Yr(NaN)}function Lw(t){var e=I_(t),n=e.year||0,i=e.quarter||0,r=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=Q2(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+r+i*3+n*12,this._data={},this._locale=To(),this._bubble()}function Jm(t){return t instanceof Lw}function n0(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function tY(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0,o;for(o=0;o<i;o++)ze(t[o])!==ze(e[o])&&s++;return s+r}function QL(t,e){we(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+xs(~~(n/60),2)+e+xs(~~n%60,2)})}QL("Z",":");QL("ZZ","");ue("Z",Dw);ue("ZZ",Dw);mt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=B_(Dw,t)});var nY=/([\+\-]|\d\d)/gi;function B_(t,e){var n=(e||"").match(t),i,r,s;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(nY)||["-",0,0],s=+(r[1]*60)+ze(r[2]),s===0?0:r[0]==="+"?s:-s)}function j_(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(jr(t)||Of(t)?t.valueOf():Pt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),Z.updateOffset(n,!1),n):Pt(t).local()}function i0(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function iY(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=B_(Dw,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=i0(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?tF(this,Yr(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:i0(this)}function rY(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function sY(t){return this.utcOffset(0,t)}function oY(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(i0(this),"m")),this}function aY(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=B_(TU,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function lY(t){return this.isValid()?(t=t?Pt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function uY(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function cY(){if(!pi(this._isDSTShifted))return this._isDSTShifted;var t={},e;return M_(t,this),t=KL(t),t._a?(e=t._isUTC?As(t._a):Pt(t._a),this._isDSTShifted=this.isValid()&&tY(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function hY(){return this.isValid()?!this._isUTC:!1}function dY(){return this.isValid()?this._isUTC:!1}function JL(){return this.isValid()?this._isUTC&&this._offset===0:!1}var fY=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,gY=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Yr(t,e){var n=t,i=null,r,s,o;return Jm(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:bo(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=fY.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:ze(i[Cs])*r,h:ze(i[yn])*r,m:ze(i[Lr])*r,s:ze(i[ho])*r,ms:ze(n0(i[Pl]*1e3))*r}):(i=gY.exec(t))?(r=i[1]==="-"?-1:1,n={y:Na(i[2],r),M:Na(i[3],r),w:Na(i[4],r),d:Na(i[5],r),h:Na(i[6],r),m:Na(i[7],r),s:Na(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(o=mY(Pt(n.from),Pt(n.to)),n={},n.ms=o.milliseconds,n.M=o.months),s=new Lw(n),Jm(t)&&tt(t,"_locale")&&(s._locale=t._locale),Jm(t)&&tt(t,"_isValid")&&(s._isValid=t._isValid),s}Yr.fn=Lw.prototype;Yr.invalid=eY;function Na(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function p1(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function mY(t,e){var n;return t.isValid()&&e.isValid()?(e=j_(e,t),t.isBefore(e)?n=p1(t,e):(n=p1(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function eF(t,e){return function(n,i){var r,s;return i!==null&&!isNaN(+i)&&(PL(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=n,n=i,i=s),r=Yr(n,i),tF(this,r,t),this}}function tF(t,e,n,i){var r=e._milliseconds,s=n0(e._days),o=n0(e._months);t.isValid()&&(i=i??!0,o&&$L(t,Kd(t,"Month")+o*n),s&&kL(t,"Date",Kd(t,"Date")+s*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&Z.updateOffset(t,s||o))}var pY=eF(1,"add"),wY=eF(-1,"subtract");function nF(t){return typeof t=="string"||t instanceof String}function vY(t){return jr(t)||Of(t)||nF(t)||bo(t)||CY(t)||yY(t)||t===null||t===void 0}function yY(t){var e=Fl(t)&&!E_(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,s,o=i.length;for(r=0;r<o;r+=1)s=i[r],n=n||tt(t,s);return e&&n}function CY(t){var e=Br(t),n=!1;return e&&(n=t.filter(function(i){return!bo(i)&&nF(t)}).length===0),e&&n}function bY(t){var e=Fl(t)&&!E_(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,s;for(r=0;r<i.length;r+=1)s=i[r],n=n||tt(t,s);return e&&n}function SY(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function RY(t,e){arguments.length===1&&(arguments[0]?vY(arguments[0])?(t=arguments[0],e=void 0):bY(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Pt(),i=j_(n,this).startOf("day"),r=Z.calendarFormat(this,i)||"sameElse",s=e&&(Hs(e[r])?e[r].call(this,n):e[r]);return this.format(s||this.localeData().calendar(r,this,Pt(n)))}function _Y(){return new Af(this)}function EY(t,e){var n=jr(t)?t:Pt(t);return this.isValid()&&n.isValid()?(e=pr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function TY(t,e){var n=jr(t)?t:Pt(t);return this.isValid()&&n.isValid()?(e=pr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function MY(t,e,n,i){var r=jr(t)?t:Pt(t),s=jr(e)?e:Pt(e);return this.isValid()&&r.isValid()&&s.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(s,n):!this.isAfter(s,n))):!1}function xY(t,e){var n=jr(t)?t:Pt(t),i;return this.isValid()&&n.isValid()?(e=pr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function PY(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function IY(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function OY(t,e,n){var i,r,s;if(!this.isValid())return NaN;if(i=j_(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=pr(e),e){case"year":s=ep(this,i)/12;break;case"month":s=ep(this,i);break;case"quarter":s=ep(this,i)/3;break;case"second":s=(this-i)/1e3;break;case"minute":s=(this-i)/6e4;break;case"hour":s=(this-i)/36e5;break;case"day":s=(this-i-r)/864e5;break;case"week":s=(this-i-r)/6048e5;break;default:s=this-i}return n?s:rr(s)}function ep(t,e){if(t.date()<e.date())return-ep(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,s;return e-i<0?(r=t.clone().add(n-1,"months"),s=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),s=(e-i)/(r-i)),-(n+s)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function AY(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function HY(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Qm(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Hs(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Qm(n,"Z")):Qm(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function DY(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(n+i+r+s)}function NY(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=Qm(this,t);return this.localeData().postformat(e)}function kY(t,e){return this.isValid()&&(jr(t)&&t.isValid()||Pt(t).isValid())?Yr({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function LY(t){return this.from(Pt(),t)}function FY(t,e){return this.isValid()&&(jr(t)&&t.isValid()||Pt(t).isValid())?Yr({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function $Y(t){return this.to(Pt(),t)}function iF(t){var e;return t===void 0?this._locale._abbr:(e=To(t),e!=null&&(this._locale=e),this)}var rF=mr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function sF(){return this._locale}var Rp=1e3,fc=60*Rp,_p=60*fc,oF=(365*400+97)*24*_p;function gc(t,e){return(t%e+e)%e}function aF(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-oF:new Date(t,e,n).valueOf()}function lF(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-oF:Date.UTC(t,e,n)}function VY(t){var e,n;if(t=pr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?lF:aF,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=gc(e+(this._isUTC?0:this.utcOffset()*fc),_p);break;case"minute":e=this._d.valueOf(),e-=gc(e,fc);break;case"second":e=this._d.valueOf(),e-=gc(e,Rp);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function WY(t){var e,n;if(t=pr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?lF:aF,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=_p-gc(e+(this._isUTC?0:this.utcOffset()*fc),_p)-1;break;case"minute":e=this._d.valueOf(),e+=fc-gc(e,fc)-1;break;case"second":e=this._d.valueOf(),e+=Rp-gc(e,Rp)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function BY(){return this._d.valueOf()-(this._offset||0)*6e4}function jY(){return Math.floor(this.valueOf()/1e3)}function zY(){return new Date(this.valueOf())}function UY(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function YY(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function GY(){return this.isValid()?this.toISOString():null}function qY(){return T_(this)}function KY(){return aa({},Oe(this))}function XY(){return Oe(this).overflow}function ZY(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}we("N",0,0,"eraAbbr");we("NN",0,0,"eraAbbr");we("NNN",0,0,"eraAbbr");we("NNNN",0,0,"eraName");we("NNNNN",0,0,"eraNarrow");we("y",["y",1],"yo","eraYear");we("y",["yy",2],0,"eraYear");we("y",["yyy",3],0,"eraYear");we("y",["yyyy",4],0,"eraYear");ue("N",z_);ue("NN",z_);ue("NNN",z_);ue("NNNN",lG);ue("NNNNN",uG);mt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?Oe(n).era=r:Oe(n).invalidEra=t});ue("y",$c);ue("yy",$c);ue("yyy",$c);ue("yyyy",$c);ue("yo",cG);mt(["y","yy","yyy","yyyy"],zn);mt(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[zn]=n._locale.eraYearOrdinalParse(t,r):e[zn]=parseInt(t,10)});function QY(t,e){var n,i,r,s=this._eras||To("en")._eras;for(n=0,i=s.length;n<i;++n){switch(typeof s[n].since){case"string":r=Z(s[n].since).startOf("day"),s[n].since=r.valueOf();break}switch(typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":r=Z(s[n].until).startOf("day").valueOf(),s[n].until=r.valueOf();break}}return s}function JY(t,e,n){var i,r,s=this.eras(),o,a,l;for(t=t.toUpperCase(),i=0,r=s.length;i<r;++i)if(o=s[i].name.toUpperCase(),a=s[i].abbr.toUpperCase(),l=s[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[i];break;case"NNNN":if(o===t)return s[i];break;case"NNNNN":if(l===t)return s[i];break}else if([o,a,l].indexOf(t)>=0)return s[i]}function eG(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function tG(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function nG(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function iG(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function rG(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-Z(r[t].since).year())*n+r[t].offset;return this.year()}function sG(t){return tt(this,"_erasNameRegex")||U_.call(this),t?this._erasNameRegex:this._erasRegex}function oG(t){return tt(this,"_erasAbbrRegex")||U_.call(this),t?this._erasAbbrRegex:this._erasRegex}function aG(t){return tt(this,"_erasNarrowRegex")||U_.call(this),t?this._erasNarrowRegex:this._erasRegex}function z_(t,e){return e.erasAbbrRegex(t)}function lG(t,e){return e.erasNameRegex(t)}function uG(t,e){return e.erasNarrowRegex(t)}function cG(t,e){return e._eraYearOrdinalRegex||$c}function U_(){var t=[],e=[],n=[],i=[],r,s,o,a,l,u=this.eras();for(r=0,s=u.length;r<s;++r)o=yo(u[r].name),a=yo(u[r].abbr),l=yo(u[r].narrow),e.push(o),t.push(a),n.push(l),i.push(o),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}we(0,["gg",2],0,function(){return this.weekYear()%100});we(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Fw(t,e){we(0,[t,t.length],0,e)}Fw("gggg","weekYear");Fw("ggggg","weekYear");Fw("GGGG","isoWeekYear");Fw("GGGGG","isoWeekYear");ue("G",Hw);ue("g",Hw);ue("GG",It,Wi);ue("gg",It,Wi);ue("GGGG",A_,O_);ue("gggg",A_,O_);ue("GGGGG",Aw,Iw);ue("ggggg",Aw,Iw);Df(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=ze(t)});Df(["gg","GG"],function(t,e,n,i){e[i]=Z.parseTwoDigitYear(t)});function hG(t){return uF.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function dG(t){return uF.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function fG(){return Co(this.year(),1,4)}function gG(){return Co(this.isoWeekYear(),1,4)}function mG(){var t=this.localeData()._week;return Co(this.year(),t.dow,t.doy)}function pG(){var t=this.localeData()._week;return Co(this.weekYear(),t.dow,t.doy)}function uF(t,e,n,i,r){var s;return t==null?Zd(this,i,r).year:(s=Co(t,i,r),e>s&&(e=s),wG.call(this,t,e,n,i,r))}function wG(t,e,n,i,r){var s=BL(t,e,n,i,r),o=Xd(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}we("Q",0,"Qo","quarter");ue("Q",OL);mt("Q",function(t,e){e[co]=(ze(t)-1)*3});function vG(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}we("D",["DD",2],"Do","date");ue("D",It,Vc);ue("DD",It,Wi);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});mt(["D","DD"],Cs);mt("Do",function(t,e){e[Cs]=ze(t.match(It)[0])});var cF=Wc("Date",!0);we("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Ow);ue("DDDD",AL);mt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=ze(t)});function yG(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}we("m",["mm",2],0,"minute");ue("m",It,H_);ue("mm",It,Wi);mt(["m","mm"],Lr);var CG=Wc("Minutes",!1);we("s",["ss",2],0,"second");ue("s",It,H_);ue("ss",It,Wi);mt(["s","ss"],ho);var bG=Wc("Seconds",!1);we("S",0,0,function(){return~~(this.millisecond()/100)});we(0,["SS",2],0,function(){return~~(this.millisecond()/10)});we(0,["SSS",3],0,"millisecond");we(0,["SSSS",4],0,function(){return this.millisecond()*10});we(0,["SSSSS",5],0,function(){return this.millisecond()*100});we(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});we(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});we(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});we(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Ow,OL);ue("SS",Ow,Wi);ue("SSS",Ow,AL);var la,hF;for(la="SSSS";la.length<=9;la+="S")ue(la,$c);function SG(t,e){e[Pl]=ze(("0."+t)*1e3)}for(la="S";la.length<=9;la+="S")mt(la,SG);hF=Wc("Milliseconds",!1);we("z",0,0,"zoneAbbr");we("zz",0,0,"zoneName");function RG(){return this._isUTC?"UTC":""}function _G(){return this._isUTC?"Coordinated Universal Time":""}var J=Af.prototype;J.add=pY;J.calendar=RY;J.clone=_Y;J.diff=OY;J.endOf=WY;J.format=NY;J.from=kY;J.fromNow=LY;J.to=FY;J.toNow=$Y;J.get=DU;J.invalidAt=XY;J.isAfter=EY;J.isBefore=TY;J.isBetween=MY;J.isSame=xY;J.isSameOrAfter=PY;J.isSameOrBefore=IY;J.isValid=qY;J.lang=rF;J.locale=iF;J.localeData=sF;J.max=q2;J.min=G2;J.parsingFlags=KY;J.set=NU;J.startOf=VY;J.subtract=wY;J.toArray=UY;J.toObject=YY;J.toDate=zY;J.toISOString=HY;J.inspect=DY;typeof Symbol<"u"&&Symbol.for!=null&&(J[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});J.toJSON=GY;J.toString=AY;J.unix=jY;J.valueOf=BY;J.creationData=ZY;J.eraName=tG;J.eraNarrow=nG;J.eraAbbr=iG;J.eraYear=rG;J.year=NL;J.isLeapYear=HU;J.weekYear=hG;J.isoWeekYear=dG;J.quarter=J.quarters=vG;J.month=VL;J.daysInMonth=zU;J.week=J.weeks=QU;J.isoWeek=J.isoWeeks=JU;J.weeksInYear=mG;J.weeksInWeekYear=pG;J.isoWeeksInYear=fG;J.isoWeeksInISOWeekYear=gG;J.date=cF;J.day=J.days=d2;J.weekday=f2;J.isoWeekday=g2;J.dayOfYear=yG;J.hour=J.hours=b2;J.minute=J.minutes=CG;J.second=J.seconds=bG;J.millisecond=J.milliseconds=hF;J.utcOffset=iY;J.utc=sY;J.local=oY;J.parseZone=aY;J.hasAlignedHourOffset=lY;J.isDST=uY;J.isLocal=hY;J.isUtcOffset=dY;J.isUtc=JL;J.isUTC=JL;J.zoneAbbr=RG;J.zoneName=_G;J.dates=mr("dates accessor is deprecated. Use date instead.",cF);J.months=mr("months accessor is deprecated. Use month instead",VL);J.years=mr("years accessor is deprecated. Use year instead",NL);J.zone=mr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",rY);J.isDSTShifted=mr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",cY);function EG(t){return Pt(t*1e3)}function TG(){return Pt.apply(null,arguments).parseZone()}function dF(t){return t}var nt=x_.prototype;nt.calendar=hU;nt.longDateFormat=mU;nt.invalidDate=wU;nt.ordinal=CU;nt.preparse=dF;nt.postformat=dF;nt.relativeTime=SU;nt.pastFuture=RU;nt.set=uU;nt.eras=QY;nt.erasParse=JY;nt.erasConvertYear=eG;nt.erasAbbrRegex=oG;nt.erasNameRegex=sG;nt.erasNarrowRegex=aG;nt.months=VU;nt.monthsShort=WU;nt.monthsParse=jU;nt.monthsRegex=YU;nt.monthsShortRegex=UU;nt.week=qU;nt.firstDayOfYear=ZU;nt.firstDayOfWeek=XU;nt.weekdays=a2;nt.weekdaysMin=u2;nt.weekdaysShort=l2;nt.weekdaysParse=h2;nt.weekdaysRegex=m2;nt.weekdaysShortRegex=p2;nt.weekdaysMinRegex=w2;nt.isPM=y2;nt.meridiem=S2;function Ep(t,e,n,i){var r=To(),s=As().set(i,e);return r[n](s,t)}function fF(t,e,n){if(bo(t)&&(e=t,t=void 0),t=t||"",e!=null)return Ep(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=Ep(t,i,n,"month");return r}function Y_(t,e,n,i){typeof t=="boolean"?(bo(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,bo(e)&&(n=e,e=void 0),e=e||"");var r=To(),s=t?r._week.dow:0,o,a=[];if(n!=null)return Ep(e,(n+s)%7,i,"day");for(o=0;o<7;o++)a[o]=Ep(e,(o+s)%7,i,"day");return a}function MG(t,e){return fF(t,e,"months")}function xG(t,e){return fF(t,e,"monthsShort")}function PG(t,e,n){return Y_(t,e,n,"weekdays")}function IG(t,e,n){return Y_(t,e,n,"weekdaysShort")}function OG(t,e,n){return Y_(t,e,n,"weekdaysMin")}ma("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=ze(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=mr("moment.lang is deprecated. Use moment.locale instead.",ma);Z.langData=mr("moment.langData is deprecated. Use moment.localeData instead.",To);var $s=Math.abs;function AG(){var t=this._data;return this._milliseconds=$s(this._milliseconds),this._days=$s(this._days),this._months=$s(this._months),t.milliseconds=$s(t.milliseconds),t.seconds=$s(t.seconds),t.minutes=$s(t.minutes),t.hours=$s(t.hours),t.months=$s(t.months),t.years=$s(t.years),this}function gF(t,e,n,i){var r=Yr(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function HG(t,e){return gF(this,t,e,1)}function DG(t,e){return gF(this,t,e,-1)}function w1(t){return t<0?Math.floor(t):Math.ceil(t)}function NG(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,s,o,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=w1(r0(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=rr(t/1e3),i.seconds=r%60,s=rr(r/60),i.minutes=s%60,o=rr(s/60),i.hours=o%24,e+=rr(o/24),l=rr(mF(e)),n+=l,e-=w1(r0(l)),a=rr(n/12),n%=12,i.days=e,i.months=n,i.years=a,this}function mF(t){return t*4800/146097}function r0(t){return t*146097/4800}function kG(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=pr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+mF(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(r0(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function Mo(t){return function(){return this.as(t)}}var pF=Mo("ms"),LG=Mo("s"),FG=Mo("m"),$G=Mo("h"),VG=Mo("d"),WG=Mo("w"),BG=Mo("M"),jG=Mo("Q"),zG=Mo("y"),UG=pF;function YG(){return Yr(this)}function GG(t){return t=pr(t),this.isValid()?this[t+"s"]():NaN}function tu(t){return function(){return this.isValid()?this._data[t]:NaN}}var qG=tu("milliseconds"),KG=tu("seconds"),XG=tu("minutes"),ZG=tu("hours"),QG=tu("days"),JG=tu("months"),eq=tu("years");function tq(){return rr(this.days()/7)}var ro=Math.round,oc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function nq(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function iq(t,e,n,i){var r=Yr(t).abs(),s=ro(r.as("s")),o=ro(r.as("m")),a=ro(r.as("h")),l=ro(r.as("d")),u=ro(r.as("M")),c=ro(r.as("w")),h=ro(r.as("y")),d=s<=n.ss&&["s",s]||s<n.s&&["ss",s]||o<=1&&["m"]||o<n.m&&["mm",o]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=i,nq.apply(null,d)}function rq(t){return t===void 0?ro:typeof t=="function"?(ro=t,!0):!1}function sq(t,e){return oc[t]===void 0?!1:e===void 0?oc[t]:(oc[t]=e,t==="s"&&(oc.ss=e-1),!0)}function oq(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=oc,r,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},oc,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),s=iq(this,!n,i,r),n&&(s=r.pastFuture(+this,s)),r.postformat(s)}var db=Math.abs;function cu(t){return(t>0)-(t<0)||+t}function $w(){if(!this.isValid())return this.localeData().invalidDate();var t=db(this._milliseconds)/1e3,e=db(this._days),n=db(this._months),i,r,s,o,a=this.asSeconds(),l,u,c,h;return a?(i=rr(t/60),r=rr(i/60),t%=60,i%=60,s=rr(n/12),n%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=cu(this._months)!==cu(a)?"-":"",c=cu(this._days)!==cu(a)?"-":"",h=cu(this._milliseconds)!==cu(a)?"-":"",l+"P"+(s?u+s+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(r||i||t?"T":"")+(r?h+r+"H":"")+(i?h+i+"M":"")+(t?h+o+"S":"")):"P0D"}var Ze=Lw.prototype;Ze.isValid=J2;Ze.abs=AG;Ze.add=HG;Ze.subtract=DG;Ze.as=kG;Ze.asMilliseconds=pF;Ze.asSeconds=LG;Ze.asMinutes=FG;Ze.asHours=$G;Ze.asDays=VG;Ze.asWeeks=WG;Ze.asMonths=BG;Ze.asQuarters=jG;Ze.asYears=zG;Ze.valueOf=UG;Ze._bubble=NG;Ze.clone=YG;Ze.get=GG;Ze.milliseconds=qG;Ze.seconds=KG;Ze.minutes=XG;Ze.hours=ZG;Ze.days=QG;Ze.weeks=tq;Ze.months=JG;Ze.years=eq;Ze.humanize=oq;Ze.toISOString=$w;Ze.toString=$w;Ze.toJSON=$w;Ze.locale=iF;Ze.localeData=sF;Ze.toIsoString=mr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",$w);Ze.lang=rF;we("X",0,0,"unix");we("x",0,0,"valueOf");ue("x",Hw);ue("X",MU);mt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});mt("x",function(t,e,n){n._d=new Date(ze(t))});//! moment.js
Z.version="2.30.1";aU(Pt);Z.fn=J;Z.min=K2;Z.max=X2;Z.now=Z2;Z.utc=As;Z.unix=EG;Z.months=MG;Z.isDate=Of;Z.locale=ma;Z.invalid=Pw;Z.duration=Yr;Z.isMoment=jr;Z.weekdays=PG;Z.parseZone=TG;Z.localeData=To;Z.isDuration=Jm;Z.monthsShort=xG;Z.weekdaysMin=OG;Z.defineLocale=F_;Z.updateLocale=T2;Z.locales=M2;Z.weekdaysShort=IG;Z.normalizeUnits=pr;Z.relativeTimeRounding=rq;Z.relativeTimeThreshold=sq;Z.calendarFormat=SY;Z.prototype=J;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function wF(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function s0(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function bd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,i=t[0].length;for(let r=0;r<n;r++)for(let s=0;s<i;s++)e[s]||(e[s]=[]),e[s][r]=t[r][s];return e}function fn(t,e,n,i){let r=-1,s=t,o=n;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(i&&a&&(r+=1,o=s[r]),r+=1;r<a;)o=e(o,s[r],r,s),r+=1;return o}function ba(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,s=[];let o=-1;for(;n<r;){const a=i[n];e(a,n,i)&&(o+=1,s[o]=a),n+=1}return s}function Ve(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,s=[];let o=-1;for(;n<r;){const a=i[n];o+=1,s[o]=e(a,n,i),n+=1}return s}function A(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length;for(;n<r&&e(i[n],n,i)!==!1;)n+=1;return t}function vF(t){return fn(t,(e,n)=>e+n,0)}function aq(t){return fn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function lq(t){return fn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function uq(t){return t.length?vF(t)/t.length:0}function yF(t){return fn(t,(e,n)=>e.concat(Array.isArray(n)?yF(n):n),[])}function CF(t){const e=[];return A(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function o0(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let s=i;return A(r,o=>{s=s.filter(a=>!o.includes(a))}),s}function cq(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let s=i;return A(r,o=>{s=s.filter(a=>o.includes(a))}),s}function hq(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e],s=new Set(i);return A(r,o=>{A(o,a=>{s.has(a)||s.add(a)})}),Array.from(s)}function a0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const dq=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:uq,arrayEach:A,arrayFilter:ba,arrayFlatten:yF,arrayMap:Ve,arrayMax:aq,arrayMin:lq,arrayReduce:fn,arraySum:vF,arrayUnique:CF,extendArray:s0,getDifferenceOfArrays:o0,getIntersectionOfArrays:cq,getUnionOfArrays:hq,pivot:bd,stringToArray:a0,to2dArray:wF},Symbol.toStringTag,{value:"Module"}));function ot(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return fn(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return s+l+u},"").trim()}function bt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function Mt(t){return typeof t>"u"}function Wt(t){return t===null||t===""||Mt(t)}function bF(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const ud="length",Sd=t=>parseInt(t,16),v1=t=>parseInt(t,10),Tp=(t,e,n)=>t.substr(e,n),Rd=t=>t.codePointAt(0)-65,l0=t=>`${t}`.replace(/\-/g,""),fq=t=>Sd(Tp(l0(t),Sd("12"),Rd("F")))/(Sd(Tp(l0(t),Rd("B"),~~![][ud]))||9),gq=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let y1=!1;const C1={invalid:()=>ot`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ot`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ot`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},b1={invalid:()=>ot`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ot`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ot`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function SF(t,e){const n=!Wt(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",r="16.0.0";let s,o="invalid",a="invalid";t=l0(t||"");const l=mq(t);if(n||i||l)if(l){const u=Z("09/07/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=fq(t);s=Z((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(o="expired",a="expired"):(o="valid",a="valid")}else i?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(gq()&&(o="valid",a="valid"),!y1&&o!=="valid"&&(C1[o]({keyValidityDate:s,hotVersion:r})&&console[o==="non_commercial"?"info":"warn"](C1[o]({keyValidityDate:s,hotVersion:r})),y1=!0),a!=="valid"&&e&&b1[a]({keyValidityDate:s,hotVersion:r})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=b1[a]({keyValidityDate:s,hotVersion:r}),e.appendChild(c)}}function mq(t){let e=[][ud],n=e;if(t[ud]!==Rd("Z"))return!1;for(let i="",r="B<H4P+".split(""),s=Rd(r.shift());s;s=Rd(r.shift()||"A"))--s<""[ud]?n=n|(v1(`${v1(Sd(i)+(Sd(Tp(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=Tp(t,s,s?r[ud]===1?9:8:6);return n===e}const pq=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:SF,isDefined:le,isEmpty:Wt,isRegExp:bF,isUndefined:Mt,stringify:bt},Symbol.toStringTag,{value:"Module"}));function Un(t){return t[0].toUpperCase()+t.substr(1)}function wq(){const t=[];for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];let r=n.length;for(;r;){r-=1;const s=bt(n[r]).toLowerCase();t.indexOf(s)===-1&&t.push(s)}return t.length===1}function G_(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function q_(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function K_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,i)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[i]===void 0?"":e[i])}function u0(t){return Vw(`${t}`,{ALLOWED_TAGS:[]})}function Vw(t,e){return oU.sanitize(t,e)}const vq=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:wq,isPercentValue:q_,randomString:G_,sanitize:Vw,stripTags:u0,substitute:K_,toUpperCaseFirst:Un},Symbol.toStringTag,{value:"Module"})),Oa=t=>["tabindex",t],yq=()=>["role","treegrid"],fo=()=>["role","presentation"],Cq=()=>["role","gridcell"],bq=()=>["role","gridcell button"],Sq=()=>["role","rowheader"],RF=()=>["role","rowgroup"],Rq=()=>["role","columnheader"],_F=()=>["role","row"],_q=()=>["role","menu"],Eq=()=>["role","menuitem"],Tq=()=>["role","menuitemcheckbox"],Mq=()=>["role","combobox"],EF=()=>["role","listbox"],xq=()=>["role","option"],Pq=()=>["role","checkbox"],Iq=()=>["scope","col"],Oq=()=>["scope","row"],Aq=()=>["type","text"],bc=t=>["aria-label",t],nu=()=>["aria-hidden","true"],Hq=()=>["aria-disabled","true"],Dq=()=>["aria-multiselectable","true"],TF=t=>["aria-haspopup",t],MF=t=>["aria-rowcount",t],Ww=t=>["aria-colcount",t],xF=t=>["aria-rowindex",t],X_=t=>["aria-colindex",t],lr=t=>["aria-expanded",t],Nq=t=>["aria-sort",t],S1=()=>["aria-readonly","true"],R1=()=>["aria-invalid","true"],PF=t=>["aria-checked",t],Z_=()=>["aria-selected","true"],kq=()=>["aria-autocomplete","list"],Lq=t=>["aria-controls",t],Fq=t=>["aria-activedescendant",t],$q=t=>["aria-live",t],Vq=t=>["aria-relevant",t],Wq=t=>["aria-setsize",t],Bq=t=>["aria-posinset",t];var _1={},fb,E1;function jq(){if(E1)return fb;E1=1;var t=rn(),e=aL(),n=hn(),i=Xl(),r=xw(),s=t([].push);return fb=function(o){if(n(o))return o;if(e(o)){for(var a=o.length,l=[],u=0;u<a;u++){var c=o[u];typeof c=="string"?s(l,c):(typeof c=="number"||i(c)==="Number"||i(c)==="String")&&s(l,r(c))}var h=l.length,d=!0;return function(f,g){if(d)return d=!1,g;if(e(this))return g;for(var m=0;m<h;m++)if(l[m]===f)return g}}},fb}var T1;function zq(){if(T1)return _1;T1=1;var t=wt(),e=Dc(),n=xf(),i=cn(),r=rn(),s=un(),o=hn(),a=h_(),l=__(),u=jq(),c=c_(),h=String,d=e("JSON","stringify"),f=r(/./.exec),g=r("".charAt),m=r("".charCodeAt),v=r("".replace),S=r(1.1.toString),y=/[\uD800-\uDFFF]/g,M=/^[\uD800-\uDBFF]$/,I=/^[\uDC00-\uDFFF]$/,P=!c||s(function(){var U=e("Symbol")("stringify detection");return d([U])!=="[null]"||d({a:U})!=="{}"||d(Object(U))!=="{}"}),E=s(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),T=function(U,O){var G=l(arguments),q=u(O);if(!(!o(q)&&(U===void 0||a(U))))return G[1]=function(ne,Q){if(o(q)&&(Q=i(q,this,h(ne),Q)),!a(Q))return Q},n(d,null,G)},$=function(U,O,G){var q=g(G,O-1),ne=g(G,O+1);return f(M,U)&&!f(I,ne)||f(I,U)&&!f(M,q)?"\\u"+S(m(U,0),16):U};return d&&t({target:"JSON",stat:!0,arity:3,forced:P||E},{stringify:function(O,G,q){var ne=l(arguments),Q=n(P?T:d,null,ne);return E&&typeof Q=="string"?v(Q,y,$):Q}}),_1}zq();function Sc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},He(t,(n,i)=>{i!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[i]=Sc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[i]=[Sc(n[0])]:e[i]=[]:e[i]=null)})),e}function IF(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function tn(t,e,n){const i=Array.isArray(n);return He(e,(r,s)=>{(i===!1||n.includes(s))&&(t[s]=r)}),t}function Nf(t,e){He(e,(n,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),Nf(t[i],e[i])):t[i]=e[i]})}function Yn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function zr(t){const e={};return He(t,(n,i)=>{e[i]=n}),e}function ht(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return A(n,r=>{t.MIXINS.push(r.MIXIN_NAME),He(r,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(c,h){const d=`_${c}`,f=g=>{let m=g;return(Array.isArray(m)||Ae(m))&&(m=Yn(m)),m};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function Bw(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ae(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ds(t,e,n,i){i.value=n,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function He(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function OF(t,e){const n=e.split(".");let i=t;return He(n,r=>{if(i=i[r],i===void 0)return i=void 0,!1}),i}function tp(t,e,n){if(typeof e!="string")return;const i=e.split(".");let r=t;i.forEach((s,o)=>{s==="__proto__"||s==="constructor"||s==="prototype"||(o!==i.length-1?(Qt(r,s)||(r[s]={}),r=r[s]):r[s]=n)})}function jw(t){if(!Ae(t))return 0;const e=function(n){let i=0;return Ae(n)?He(n,(r,s)=>{s!=="__children"&&(i+=e(r))}):i+=1,i};return e(t)}function Ei(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(r){this._touched=!0,this[n]=r},enumerable:!0,configurable:!0}),i}function Qt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Uq=Object.freeze(Object.defineProperty({__proto__:null,clone:zr,createObjectPropListener:Ei,deepClone:Yn,deepExtend:Nf,deepObjectSize:jw,defineGetter:Ds,duckSchema:Sc,extend:tn,getProperty:OF,hasOwnProperty:Qt,inherit:IF,isObject:Ae,isObjectEqual:Bw,mixin:ht,objectEach:He,setProperty:tp},Symbol.toStringTag,{value:"Module"}));function Jd(t){return window.requestAnimationFrame(t)}function ef(t){window.cancelAnimationFrame(t)}function Q_(){return"ontouchstart"in window}function AF(){return typeof window<"u"}let hu;function HF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return hu||(typeof Intl=="object"?hu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?hu=(n,i)=>`${n}`.localeCompare(i):hu=(n,i)=>n===i?0:n>i?-1:1,hu)}const Yq=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:ef,getComparisonFunction:HF,isCSR:AF,isTouchSupported:Q_,requestAnimationFrame:Jd},Symbol.toStringTag,{value:"Module"})),Qi=t=>{const e={value:!1};return e.test=(n,i)=>{e.value=t(n,i)},e},xo={chrome:Qi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Qi(t=>/CriOS/.test(t)),edge:Qi(t=>/Edge/.test(t)),edgeWebKit:Qi(t=>/EdgiOS/.test(t)),firefox:Qi(t=>/Firefox/.test(t)),firefoxWebKit:Qi(t=>/FxiOS/.test(t)),mobile:Qi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Qi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Bc={mac:Qi(t=>/^Mac/.test(t)),win:Qi(t=>/^Win/.test(t)),linux:Qi(t=>/^Linux/.test(t)),ios:Qi(t=>/iPhone|iPad|iPod/i.test(t))};function DF(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};He(xo,n=>{let{test:i}=n;return void i(t,e)})}function NF(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};He(Bc,e=>{let{test:n}=e;return void n(t)})}AF()&&(DF(),NF());function J_(){return xo.chrome.value}function kF(){return xo.chromeWebKit.value}function np(){return xo.firefox.value}function LF(){return xo.firefoxWebKit.value}function Rc(){return xo.safari.value}function FF(){return xo.edge.value}function Gq(){return xo.edgeWebKit.value}function Fr(){return xo.mobile.value}function eE(){return Bc.ios.value}function tE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Bc.mac.value}function Mp(){return Bc.win.value}function xp(){return Bc.mac.value}function qq(){return Bc.linux.value}const Kq=Object.freeze(Object.defineProperty({__proto__:null,isChrome:J_,isChromeWebKit:kF,isEdge:FF,isEdgeWebKit:Gq,isFirefox:np,isFirefoxWebKit:LF,isIOS:eE,isIpadOS:tE,isLinuxOS:qq,isMacOS:xp,isMobileBrowser:Fr,isSafari:Rc,isWindowsOS:Mp,setBrowserMeta:DF,setPlatformMeta:NF},Symbol.toStringTag,{value:"Module"}));function $F(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=null,r=t;for(;r!==null;){if(n===e){i=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(n+=1,r=r.parentNode)}return i}function _d(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function VF(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Wl(t){return VF(t)&&t.parent}function Xq(t){return!!Object.getPrototypeOf(t.parent)}function Sa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:r}=Node;let s=t;for(;s!=null&&s!==n;){const{nodeType:o,nodeName:a}=s;if(o===i&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===r?s=l:s=s.parentNode}return null}function cd(t,e,n){const i=[];let r=t;for(;r&&(r=Sa(r,e,n),!(!r||n&&!n.contains(r)));)i.push(r),r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:r=r.parentNode;const s=i.length;return s?i[s-1]:null}function WF(t,e){const n={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&i.classList.contains(e))n.element=i,n.classNames.push(e);else if(e instanceof RegExp){const r=Array.from(i.classList).filter(s=>e.test(s));r.length&&(n.element=i,n.classNames.push(...r))}i=i.parentElement}return n}function pa(t,e){let n=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);n!==null;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function BF(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function qo(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function jF(t){return!t||!t.length?[]:t.filter(e=>!!e)}function zF(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],i=[];return i.push(...t.filter(r=>{const s=r instanceof RegExp;return s&&e&&n.push(r),!s})),{regexFree:i,regexes:n}}function ye(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function K(t,e){typeof e=="string"&&(e=e.split(" ")),e=jF(e),e.length>0&&t.classList.add(...e)}function me(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=zF(e,!0);n=jF(n),n.length>0&&t.classList.remove(...n),i.forEach(r=>{t.classList.forEach(s=>{r.test(s)&&t.classList.remove(s)})})}function ve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function iu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=zF(e,!0);n.forEach(r=>{r!==""&&t.removeAttribute(r)}),i.forEach(r=>{t.getAttributeNames().forEach(s=>{r.test(s)&&t.removeAttribute(s)})})}function nE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)nE(e[n])}}function Ps(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const UF=/(<(.*)>|&(.*);)/;function ru(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;UF.test(e)?t.innerHTML=n?Vw(e):e:Ra(t,e)}function Ra(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Ps(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Bl(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return Bl(i.host.impl);if(i.host)return Bl(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function YF(t){const n=t.ownerDocument.defaultView;let i=t;for(;i.parentNode;){if(i.style.height==="0px"||i.style.height==="0")return n.getComputedStyle(i).overflow==="hidden";i=i.parentNode}return!1}function xn(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let r=t,s,o,a;for(s=r.offsetLeft,o=r.offsetTop,a=r;(r=r.offsetParent)&&!(r===e.body||!("offsetLeft"in r));)s+=r.offsetLeft,o+=r.offsetTop,a=r;return a&&a.style.position==="fixed"&&(s+=n.pageXOffset||i.scrollLeft,o+=n.pageYOffset||i.scrollTop),{left:s,top:o}}function iE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function zw(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Uw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?iE(e):t.scrollTop}function rE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?zw(e):t.scrollLeft}function tf(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let r=t.parentNode;for(;r&&r.style&&e.body!==r;){let{overflow:s,overflowX:o,overflowY:a}=r.style;if([s,o,a].includes("scroll"))return r;if({overflow:s,overflowX:o,overflowY:a}=n.getComputedStyle(r),i.includes(s)||i.includes(o)||i.includes(a)||r.clientHeight<=r.scrollHeight+1&&(i.includes(a)||i.includes(s))||r.clientWidth<=r.scrollWidth+1&&(i.includes(o)||i.includes(s)))return r;r=r.parentNode}return n}function GF(t){return t.scrollHeight-t.clientHeight}function qF(t){return t.scrollWidth-t.clientWidth}function _c(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const r=n.getComputedStyle(i),s=["scroll","hidden","auto"],o=r.getPropertyValue("overflow"),a=r.getPropertyValue("overflow-y"),l=r.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return i;i=i.parentNode}return n}function nf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const r=n.getComputedStyle(t);if(r[e]!==""&&r[e]!==void 0)return r[e]}function Zq(t,e){const{selectorText:n}=e;let i=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?i=t.msMatchesSelector(n):t.matches&&(i=t.matches(n))),i}function Gt(t){return t.offsetWidth}function en(t){return t.offsetHeight}function mc(t){return t.clientHeight||t.innerHeight}function sE(t){return t.clientWidth||t.innerWidth}function Qq(t,e,n){t.addEventListener(e,n,!1)}function Jq(t,e,n){t.removeEventListener(e,n,!1)}function oE(t){return t.selectionStart?t.selectionStart:0}function KF(t){return t.selectionEnd?t.selectionEnd:0}function eK(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function c0(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function kf(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const r=t.parentNode,s=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=s}}}let gb;function aE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Mp()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function tK(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");Rc()&&!Fr()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.offsetWidth;n.style.overflow="scroll";let r=e.offsetWidth;return i===r&&(r=n.clientWidth),(t.body||t.documentElement).removeChild(n),i-r+aE(t)}function Cn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return gb===void 0&&(gb=tK(t)),gb}function lE(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function uE(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Yw(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function nK(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Lf(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Ed(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Gw(t){return Ed(t)&&t.hasAttribute("data-hot-input")===!1}function iK(t){const e=t.ownerDocument.activeElement;Gw(e)||t.select()}function cE(t){return!t.parentNode}function XF(t,e){new IntersectionObserver((i,r)=>{i.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function hE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,r=i.createRange(),s=i.defaultView.getSelection();ve(t,"contenteditable",!0),n&&ve(t,...nu()),e&&K(t,"invisibleSelection"),r.selectNodeContents(t),s.removeAllRanges(),s.addRange(r)}function dE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&me(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function ZF(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;hE(t,n),e(),dE(t,n)}function Es(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const rK=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:UF,addClass:K,addEvent:Qq,clearTextSelection:c0,closest:Sa,closestDown:cd,empty:Ps,fastInnerHTML:ru,fastInnerText:Ra,findFirstParentWithClass:WF,getCaretPosition:oE,getCssTransform:nK,getFractionalScalingCompensation:aE,getFrameElement:VF,getMaximumScrollLeft:qF,getMaximumScrollTop:GF,getParent:$F,getParentWindow:Wl,getScrollLeft:rE,getScrollTop:Uw,getScrollableElement:tf,getScrollbarWidth:Cn,getSelectionEndPosition:KF,getSelectionText:eK,getStyle:nf,getTrimmingContainer:_c,getWindowScrollLeft:zw,getWindowScrollTop:iE,hasAccessToParentWindow:Xq,hasClass:ye,hasHorizontalScrollbar:uE,hasVerticalScrollbar:lE,hasZeroHeight:YF,index:BF,innerHeight:mc,innerWidth:sE,isChildOf:pa,isDetached:cE,isHTMLElement:Es,isInput:Ed,isInternalElement:_d,isOutsideInput:Gw,isVisible:Bl,makeElementContentEditableAndSelectItsContent:hE,matchesCSSRules:Zq,observeVisibilityChangeOnce:XF,offset:xn,outerHeight:en,outerWidth:Gt,overlayContainsElement:qo,removeAttribute:iu,removeClass:me,removeContentEditableFromElementAndDeselect:dE,removeEvent:Jq,removeTextNodes:nE,resetCssTransform:Lf,runWithSelectedContendEditableElement:ZF,selectElementIfAllowed:iK,setAttribute:ve,setCaretPosition:kf,setOverlayPosition:Yw},Symbol.toStringTag,{value:"Module"}));function st(t){return typeof t=="function"}function QF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const i={lastCallThrottled:!0};let r=null;function s(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];const u=Date.now();let c=!1;i.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(i.lastCallThrottled=!1,t.apply(this,a)):(r&&clearTimeout(r),r=setTimeout(()=>{i.lastCallThrottled=!1,t.apply(this,a),n=0,r=void 0},h)),i}return s}function sK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const i=QF(t,e);let r=n;function s(){r=n}function o(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return r?(r-=1,t.apply(this,l)):i.apply(this,l)}return o.clearHits=s,o}function Ff(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,i;function r(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{i=t.apply(this,o)},e),i}return r}function oK(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=e;return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return fn(r,(u,c)=>c(u),i.apply(this,a))}}function fE(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,n.concat(o))}}function JF(t){const e=t.length;function n(i){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=i.concat(o);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function aK(t){const e=t.length;function n(i){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=i.concat(o.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Pp(t,e,n,i,r,s,o,a){return le(a)?t.call(e,n,i,r,s,o,a):le(o)?t.call(e,n,i,r,s,o):le(s)?t.call(e,n,i,r,s):le(r)?t.call(e,n,i,r):le(i)?t.call(e,n,i):le(n)?t.call(e,n):t.call(e)}const lK=Object.freeze(Object.defineProperty({__proto__:null,curry:JF,curryRight:aK,debounce:Ff,fastCall:Pp,isFunction:st,partial:fE,pipe:oK,throttle:QF,throttleAfterHits:sK},Symbol.toStringTag,{value:"Module"})),he={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:np()?182:174,AUDIO_MUTE:np()?181:173,AUDIO_UP:np()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},uK=[he.ALT,he.ARROW_DOWN,he.ARROW_LEFT,he.ARROW_RIGHT,he.ARROW_UP,he.AUDIO_DOWN,he.AUDIO_MUTE,he.AUDIO_UP,he.BACKSPACE,he.CAPS_LOCK,he.DELETE,he.END,he.ENTER,he.ESCAPE,he.F1,he.F2,he.F3,he.F4,he.F5,he.F6,he.F7,he.F8,he.F9,he.F10,he.F11,he.F12,he.F13,he.F14,he.F15,he.F16,he.F17,he.F18,he.F19,he.HOME,he.INSERT,he.MEDIA_NEXT,he.MEDIA_PLAY_PAUSE,he.MEDIA_PREV,he.MEDIA_STOP,he.NULL,he.NUM_LOCK,he.PAGE_DOWN,he.PAGE_UP,he.PAUSE,he.SCROLL_LOCK,he.SHIFT,he.TAB];function e$(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function gE(t){return uK.includes(t)}function cK(t){const e=[];return xp()?e.push(he.COMMAND_LEFT,he.COMMAND_RIGHT,he.COMMAND_FIREFOX):e.push(he.CONTROL),e.includes(t)}function t$(t){return[he.CONTROL,he.COMMAND_LEFT,he.COMMAND_RIGHT,he.COMMAND_FIREFOX].includes(t)}function jc(t,e){const n=e.split("|");let i=!1;return A(n,r=>{if(t===he[r])return i=!0,!1}),i}const hK=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:he,isCtrlKey:cK,isCtrlMetaKey:t$,isFunctionKey:gE,isKey:jc,isPrintableChar:e$},Symbol.toStringTag,{value:"Module"}));function wr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ia(t){return t.isImmediatePropagationEnabled===!1}function _a(t){return t.button===2}function qw(t){return t.button===0}function n$(t){return t instanceof TouchEvent}function i$(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!Es(e)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}const dK=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ia,isLeftClick:qw,isRightClick:_a,isTouchEvent:n$,offsetRelativeTo:i$,stopImmediatePropagation:wr},Symbol.toStringTag,{value:"Module"}));function Je(){le(console)&&console.warn(...arguments)}function mE(){le(console)&&console.error(...arguments)}const Tl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],mb=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),pb=new Map([[]]);var M1={},wb,x1;function fK(){if(x1)return wb;x1=1;var t=Lc();return wb=function(e,n,i){for(var r=0,s=arguments.length>2?i:t(n),o=new e(s);s>r;)o[r]=n[r++];return o},wb}var vb,P1;function gK(){if(P1)return vb;P1=1;var t=nn();return vb=function(e,n){var i=t[e],r=i&&i.prototype;return r&&r[n]},vb}var yb,I1;function Kw(){if(I1)return yb;I1=1;var t=Ur(),e=b_(),n=Pa().f,i=t("unscopables"),r=Array.prototype;return r[i]===void 0&&n(r,i,{configurable:!0,value:e(null)}),yb=function(s){r[i][s]=!0},yb}var O1;function mK(){if(O1)return M1;O1=1;var t=wt(),e=rn(),n=Ti(),i=_f(),r=fK(),s=gK(),o=Kw(),a=Array,l=e(s("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=i(this),d=r(a,h);return l(d,c)}}),o("toSorted"),M1}mK();var A1={},H1={},D1;function pK(){if(D1)return H1;D1=1;var t=wt(),e=cn(),n=Fc(),i=Ti(),r=dn(),s=Os(),o=Mi(),a=Ia(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){r(this);try{i(c)}catch(f){o(this,"throw",f)}if(l)return e(l,this,c);var h=s(this),d=0;return n(h,function(f,g){if(c(f,d++))return g(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),H1}var N1;function wK(){return N1||(N1=1,pK()),A1}wK();function vK(t,e){r$(t,e),e.add(t)}function Cb(t,e,n){r$(t,e),e.set(t,n)}function r$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function k1(t,e,n){return t.set(Ip(t,e),n),n}function Mn(t,e){return t.get(Ip(t,e))}function Ip(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yK=100;var Oi=new WeakMap,Qu=new WeakMap,bb=new WeakMap,Sb=new WeakSet;class L1{constructor(){vK(this,Sb),Cb(this,Oi,new Map),Cb(this,Qu,new Map),Cb(this,bb,new Set),Tl.forEach(e=>Ip(Sb,this,F1).call(this,e))}getHooks(e){var n;return(n=Mn(Oi,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Mn(Oi,this).has(e)||(Ip(Sb,this,F1).call(this,e),Tl.push(e));const r=Mn(Oi,this).get(e);if(r.find(u=>u.callback===n))return;const s=Number.isInteger(i.orderIndex)?i.orderIndex:0,o=!!i.runOnce,a=!!i.initialHook;let l=!1;if(a){const u=r.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){r.push({callback:n,orderIndex:s,runOnce:o,initialHook:a,skip:!1});let u=Mn(bb,this).has(e);!u&&s!==0&&(u=!0,Mn(bb,this).add(e)),u&&r.length>1&&Mn(Oi,this).set(e,r.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Mn(Oi,this).has(e)&&Mn(Oi,this).get(e).length>0}remove(e,n){if(!Mn(Oi,this).has(e))return!1;const i=Mn(Oi,this).get(e),r=i.find(s=>s.callback===n);if(r){let s=Mn(Qu,this).get(e);return r.skip=!0,s+=1,s>yK&&(Mn(Oi,this).set(e,i.filter(o=>!o.skip)),s=0),Mn(Qu,this).set(e,s),!0}return!1}destroy(){Mn(Oi,this).clear(),Mn(Qu,this).clear(),k1(Oi,this,null),k1(Qu,this,null)}}function F1(t){Mn(Oi,this).set(t,[]),Mn(Qu,this).set(t,0)}function CK(t,e,n){return(e=bK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bK(t){var e=SK(t,"string");return typeof e=="symbol"?e:e+""}function SK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const RK=ot`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class re{constructor(){CK(this,"globalBucket",new L1)}static getSingleton(){return EK()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new L1),e.pluginHookBucket):this.globalBucket}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?A(n,s=>this.add(e,s,i)):(mb.has(e)&&Je(K_(RK,{hookName:e,removedInVersion:mb.get(e)})),pb.has(e)&&Je(pb.get(e)),this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!1})),this}once(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?A(n,s=>this.once(e,s,i)):this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?A(n,r=>this.addAsFixed(e,r,i)):this.getBucket(i).add(e,n,{initialHook:!0}),this}remove(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,i,r,s,o,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Pp(u[h].callback,e,i,r,s,o,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Pp(u[h].callback,e,i,r,s,o,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Tl.push(e)}deregister(e){this.isRegistered(e)&&Tl.splice(Tl.indexOf(e),1)}isDeprecated(e){return pb.has(e)||mb.has(e)}isRegistered(e){return Tl.indexOf(e)>=0}getRegistered(){return Tl}}const _K=new re;function EK(){return _K}const Il=new Map;function vr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Il.has(t)||Il.set(t,new Map);const e=Il.get(t);function n(l,u){e.set(l,u)}function i(l){return e.get(l)}function r(l){return e.has(l)}function s(){return[...e.keys()]}function o(){return[...e.values()]}function a(){Il.delete(t),e.clear()}return{register:n,getItem:i,hasItem:r,getNames:s,getValues:o,clear:a}}function TK(t,e){var n;return Il==null||(n=Il.get(t.guid))===null||n===void 0?void 0:n.get(e)}const h0=new WeakMap,{register:MK,getItem:s$,hasItem:o$,getNames:xK,getValues:Jpe}=vr("editors");function PK(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new n(i)),e[i.guid]},re.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function a$(t,e){let n;if(typeof t=="function")h0.get(t)||wi(null,t),n=h0.get(t);else if(typeof t=="string")n=s$(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Op(t){if(typeof t=="function")return t;if(!o$(t))throw Error(`No registered editor found under "${t}" name`);return s$(t).getConstructor()}function wi(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new PK(e);typeof t=="string"&&MK(t,n),h0.set(e,n)}function IK(t,e,n){return(e=OK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OK(t){var e=AK(t,"string");return typeof e=="symbol"?e:e+""}function AK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let ip=0;class cr{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;IK(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){i.call(this,HK(o))}return this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:s,options:r,eventManager:this}),e.addEventListener(n,s,r),ip+=1,()=>{this.removeEventListener(e,n,i)}}removeEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===n&&o.element===e){if(i&&i!==o.callback||r&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),ip-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const i=this.context.eventListeners[n];e&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),ip-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const s={bubbles:!0,cancelable:n!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;i.createEvent?(o=i.createEvent("MouseEvents"),o.initMouseEvent(n,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,i.body.parentNode)):o=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${n}`,o)}}function HK(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),wr(this)},t}function DK(){return ip}function NK(t,e){kK(t,e),e.add(t)}function kK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ka(t,e,n){return(e=LK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LK(t){var e=FK(t,"string");return typeof e=="symbol"?e:e+""}function FK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var og=new WeakSet;class d0{constructor(e,n,i){NK(this,og),ka(this,"hot",void 0),ka(this,"tableMeta",void 0),ka(this,"selection",void 0),ka(this,"eventManager",void 0),ka(this,"destroyed",!1),ka(this,"activeEditor",void 0),ka(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=i,this.eventManager=new cr(e),this.hot.addHook("afterDocumentKeyDown",r=>Rb(og,this,$1).call(this,r)),this.hot.addHook("beforeCompositionStart",r=>Rb(og,this,$1).call(this,r)),this.hot.view._wt.update("onCellDblClick",(r,s,o)=>Rb(og,this,$K).call(this,r,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:i,col:r}=n,s=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");let o=i,a=r;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(i,r,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=a$(u,this.hot),this.activeEditor.prepare(i,r,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,n,i);if(n instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&r.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(i))||o.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function $1(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ia(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!gE(n)&&!t$(n)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function $K(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const V1=new WeakMap;d0.getInstance=function(t,e,n){let i=V1.get(t);return i||(i=new d0(t,e,n),V1.set(t,i)),i};function VK(t,e){l$(t,e),e.add(t)}function uh(t,e,n){l$(t,e),e.set(t,n)}function l$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yt(t,e){return t.get(uo(t,e))}function ch(t,e,n){return t.set(uo(t,e),n),n}function uo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pc=Object.freeze({CELL:"cell",MIXED:"mixed"});var ln=new WeakMap,ag=new WeakMap,lg=new WeakMap,ug=new WeakMap,cg=new WeakMap,Qo=new WeakSet;class WK{constructor(e){var n=this;VK(this,Qo),uh(this,ln,void 0),uh(this,ag,void 0),uh(this,lg,1),uh(this,ug,null),uh(this,cg,new Map);const i=e.getSettings();ch(ln,this,e),ch(ag,this,i.imeFastEdit?pc.MIXED:pc.CELL),yt(ln,this).addHook("afterUpdateSettings",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return uo(Qo,n,jK).call(n,...s)}),yt(ln,this).addHook("afterSelection",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return uo(Qo,n,W1).call(n,...s)}),yt(ln,this).addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return uo(Qo,n,W1).call(n,...s)}),yt(ln,this).addHook("afterSelectionEnd",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return uo(Qo,n,BK).call(n,...s)})}getFocusMode(){return yt(ag,this)}setFocusMode(e){Object.values(pc).includes(e)?ch(ag,this,e):Je(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return yt(lg,this)}setRefocusDelay(e){ch(lg,this,e)}setRefocusElementGetter(e){ch(ug,this,e)}getRefocusElement(){var e;return typeof yt(ug,this)=="function"?yt(ug,this).call(this):(e=yt(ln,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=i=>{var r,s;const o=(r=yt(ln,this).getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;if(!o)return;let a=yt(ln,this).runHooks("modifyFocusedElement",o.row,o.col,i);Es(a)||(a=i),a&&!((s=yt(ln,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?n(e):uo(Qo,this,pE).call(this,i=>n(i))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yt(lg,this);if(yt(ln,this).getSettings().imeFastEdit&&!((e=yt(ln,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var i,r;(i=yt(ln,this).getActiveEditor())===null||i===void 0||(r=i.refreshValue)===null||r===void 0||r.call(i),yt(cg,this).has(n)||yt(cg,this).set(n,Ff(()=>{if(!yt(ln,this).isDestroyed){var s;(s=this.getRefocusElement())===null||s===void 0||s.select()}},n)),yt(cg,this).get(n)()}}}function pE(t){var e;const n=(e=yt(ln,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!yt(ln,this).selection.isCellVisible(n)){t(null);return}const i=yt(ln,this).getCell(n.row,n.col,!0);i===null?yt(ln,this).addHookOnce("afterScroll",()=>{t(yt(ln,this).getCell(n.row,n.col,!0))}):t(i)}function W1(){uo(Qo,this,pE).call(this,t=>{const{activeElement:e}=yt(ln,this).rootDocument;e&&Gw(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function BK(){uo(Qo,this,pE).call(this,t=>{this.getFocusMode()===pc.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function jK(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?pc.MIXED:pc.CELL)}var B1={},_b,j1;function zK(){if(j1)return _b;j1=1;var t=fr(),e=Xl(),n=Ur(),i=n("match");return _b=function(r){var s;return t(r)&&((s=r[i])!==void 0?!!s:e(r)==="RegExp")},_b}var Eb,z1;function UK(){if(z1)return Eb;z1=1;var t=nn(),e=un(),n=t.RegExp,i=!e(function(){var r=!0;try{n(".","d")}catch{r=!1}var s={},o="",a=r?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(s,d,{get:function(){return o+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};r&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(s);return h!==a||o!==a});return Eb={correct:i},Eb}var Tb,U1;function YK(){if(U1)return Tb;U1=1;var t=dn();return Tb=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},Tb}var Mb,Y1;function GK(){if(Y1)return Mb;Y1=1;var t=cn(),e=gr(),n=Ef(),i=UK(),r=YK(),s=RegExp.prototype;return Mb=i.correct?function(o){return o.flags}:function(o){return!i.correct&&n(s,o)&&!e(o,"flags")?t(r,o):o.flags},Mb}var xb,G1;function qK(){if(G1)return xb;G1=1;var t=rn(),e=Nc(),n=Math.floor,i=t("".charAt),r=t("".replace),s=t("".slice),o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return xb=function(l,u,c,h,d,f){var g=c+l.length,m=h.length,v=a;return d!==void 0&&(d=e(d),v=o),r(f,v,function(S,y){var M;switch(i(y,0)){case"$":return"$";case"&":return l;case"`":return s(u,0,c);case"'":return s(u,g);case"<":M=d[s(y,1,-1)];break;default:var I=+y;if(I===0)return S;if(I>m){var P=n(I/10);return P===0?S:P<=m?h[P-1]===void 0?i(y,1):h[P-1]+i(y,1):S}M=h[I-1]}return M===void 0?"":M})},xb}var q1;function KK(){if(q1)return B1;q1=1;var t=wt(),e=cn(),n=rn(),i=Rf(),r=hn(),s=fr(),o=zK(),a=xw(),l=Tf(),u=GK(),c=qK(),h=Ur(),d=xa(),f=h("replace"),g=TypeError,m=n("".indexOf),v=n("".replace),S=n("".slice),y=Math.max;return t({target:"String",proto:!0},{replaceAll:function(I,P){var E=i(this),T,$,U,O,G,q,ne,Q,te,Me,Ce=0,Ie="";if(s(I)){if(T=o(I),T&&($=a(i(u(I))),!~m($,"g")))throw new g("`.replaceAll` does not allow non-global regexes");if(U=l(I,f),U)return e(U,I,E,P);if(d&&T)return v(a(E),I,P)}for(O=a(E),G=a(I),q=r(P),q||(P=a(P)),ne=G.length,Q=y(1,ne),te=m(O,G);te!==-1;)Me=q?a(P(G,te,O)):c(G,O,te,[],void 0,P),Ie+=S(O,Ce,te)+Me,Ce=te+ne,te=te+Q>O.length?-1:m(O,G,te+Q);return Ce<O.length&&(Ie+=S(O,Ce)),Ie}}),B1}KK();var K1={},X1={},Z1;function XK(){if(Z1)return X1;Z1=1;var t=wt(),e=Fc(),n=Ti(),i=dn(),r=Os(),s=Mi(),o=Ia(),a=xf(),l=un(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&o("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){i(this);try{n(f)}catch(y){s(this,"throw",y)}var g=arguments.length<2,m=g?void 0:arguments[1];if(h)return a(h,this,g?[f]:[f,m]);var v=r(this),S=0;if(e(v,function(y){g?(g=!1,m=y):m=f(m,y,S),S++},{IS_RECORD:!0}),g)throw new u("Reduce of empty iterator with no initial value");return m}}),X1}var Q1;function ZK(){return Q1||(Q1=1,XK()),K1}ZK();const u$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},QK=new RegExp(Object.keys(u$).map(t=>`(${t})`).join("|"),"gi");function JK(t){return(t&&t.nodeName||"")==="TABLE"}function f0(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),s=r.length,o=s>0?r[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,g=[];for(let v=0;v<o;v+=1){const S=!f&&n&&v===0;let y="";if(f)y=`<th>${t.getColHeader(v-c)}</th>`;else if(S)y=`<th>${t.getRowHeader(d-h)}</th>`;else{const M=r[d][v],{hidden:I,rowspan:P,colspan:E}=t.getCellMeta(d-h,v-c);if(!I){const T=[];if(P&&T.push(`rowspan="${P}"`),E&&T.push(`colspan="${E}"`),Wt(M))y=`<td ${T.join(" ")}></td>`;else{const $=M.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");y=`<td ${T.join(" ")}>${$}</td>`}}}g.push(y)}const m=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,m):u.splice(-1,0,m)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function g0(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],s=r.length,o=[];i===0&&n.push("<tbody>");for(let a=0;a<s;a+=1){const l=r[a],u=Wt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}n.push("<tr>",...o,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function c$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},i=e.createDocumentFragment(),r=e.createElement("div");i.appendChild(r);let s=t;if(typeof s=="string"){const M=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,I=>{const P=I.match(/<td\b[^>]*?>/g)[0],E=/<p.*?>/g,T=I.substring(P.length,I.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(E,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${P}${T}</td>`});r.insertAdjacentHTML("afterbegin",`${M}`),s=r.querySelector("table")}if(!s||!JK(s))return;const o=r.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),u=l?Array.from(l.cells).reduce((M,I)=>M+I.colSpan,0)-(a?1:0):0,c=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(s.tHead){const M=Array.from(s.tHead.rows).filter(I=>{const P=I.querySelector("td")!==null;return P&&h.push(I),!P});f=M.length,d=f>0,f>1?n.nestedHeaders=Array.from(M).reduce((I,P)=>{const E=Array.from(P.cells).reduce((T,$,U)=>{if(a&&U===0)return T;const{colSpan:O,innerHTML:G}=$,q=O>1?{label:G,colspan:O}:G;return T.push(q),T},[]);return I.push(E),I},[]):d&&(n.colHeaders=Array.from(M[0].children).reduce((I,P,E)=>(a&&E===0||I.push(P.innerHTML),I),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const m=[...h,...Array.from(s.tBodies).reduce((M,I)=>(M.push(...Array.from(I.rows)),M),[]),...c];g=m.length;const v=new Array(g);for(let M=0;M<g;M++)v[M]=new Array(u);const S=[],y=[];for(let M=0;M<g;M++){const I=m[M],P=Array.from(I.cells),E=P.length;for(let T=0;T<E;T++){const $=P[T],{nodeName:U,innerHTML:O,rowSpan:G,colSpan:q}=$,ne=v[M].findIndex(Q=>Q===void 0);if(U==="TD"){if(G>1||q>1){for(let Ce=M;Ce<M+G;Ce++)if(Ce<g)for(let Ie=ne;Ie<ne+q;Ie++)v[Ce][Ie]=null;const te=$.getAttribute("style");te&&te.includes("mso-ignore:colspan")||S.push({col:ne,row:M,rowspan:G,colspan:q})}let Q="";o&&/excel/gi.test(o.content)?Q=O.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):Q=O.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),v[M][ne]=Q.replace(QK,te=>u$[te])}else y.push(O)}}return S.length&&(n.mergeCells=S),y.length&&(n.rowHeaders=y),v.length&&(n.data=v),n}const e3=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:g0,htmlToGridSettings:c$,instanceToHTML:f0},Symbol.toStringTag,{value:"Module"}));function Bn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(r=>`\\${r}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function h$(t){return Bn(t,[","])}function de(t,e,n){let i=-1;for(typeof e=="function"?(n=e,e=t):i=t-1;++i<=e&&n(i)!==!1;);}function m0(t,e,n){let i=t+1;for(typeof e=="function"&&(n=e,e=0);--i>=e&&n(i)!==!1;);}function wE(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function je(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const t3=Object.freeze(Object.defineProperty({__proto__:null,clamp:je,isNumeric:Bn,isNumericLike:h$,rangeEach:de,rangeEachReverse:m0,valueAccordingPercent:wE},Symbol.toStringTag,{value:"Module"})),p0="asc",n3="desc",J1=new Map([[p0,[-1,1]],[n3,[1,-1]]]),i3=t=>`The priority '${t}' is already declared in a map.`,r3=t=>`The priority '${t}' is not a number.`;function s3(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=st(t)?t:i3,e=st(e)?e:r3;function i(s,o){if(!Bn(s))throw new Error(e(s));if(n.has(s))throw new Error(t(s));n.set(s,o)}function r(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p0;const[o,a]=J1.get(s)||J1.get(p0);return[...n].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:i,getItems:r}}const o3=t=>`The id '${t}' is already declared in a map.`;function Xw(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=st(t)?t:o3;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function i(u){return e.delete(u)}function r(){e.clear()}function s(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:r,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:i}}const a3=t=>`'${t}' value is already declared in a unique set.`;function l3(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=st(t)?t:a3;function n(s){if(e.has(s))throw new Error(t(s));e.add(s)}function i(){return[...e]}function r(){e.clear()}return{addItem:n,clear:r,getItems:i}}const vE=t=>`There is already registered "${t}" plugin.`,u3=t=>`There is already registered plugin on priority "${t}".`,c3=t=>`The priority "${t}" is not a number.`,d$=s3({errorPriorityExists:u3,errorPriorityNaN:c3}),f$=l3({errorItemExists:vE}),w0=Xw({errorIdExists:vE});function yE(){return[...d$.getItems(),...f$.getItems()]}function $f(t){const e=Un(t);return w0.getItem(e)}function h3(t){return!!$f(t)}function Ue(t,e,n){[t,e,n]=f3(t,e,n),$f(t)===void 0&&d3(t,e,n)}function d3(t,e,n){const i=Un(t);if(w0.hasItem(i))throw new Error(vE(i));n===void 0?f$.addItem(i):d$.addItem(n,i),w0.addItem(i,e)}function f3(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:g3,getItem:m3,hasItem:g$,getNames:p3,getValues:ewe}=vr("renderers");function Ap(t){if(typeof t=="function")return t;if(!g$(t))throw Error(`No registered renderer found under "${t}" name`);return m3(t)}function Hi(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),g3(t,e)}const{register:w3,getItem:v3,hasItem:m$,getNames:y3,getValues:twe}=vr("validators");function CE(t){if(typeof t=="function")return t;if(!m$(t))throw Error(`No registered validator found under "${t}" name`);return v3(t)}function Ml(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),w3(t,e)}var eA={},tA;function C3(){if(tA)return eA;tA=1;var t=wt(),e=Nc(),n=Lc(),i=Mf(),r=Kw();return t({target:"Array",proto:!0},{at:function(o){var a=e(this),l=n(a),u=i(o),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),r("at"),eA}C3();var nA={},iA;function b3(){if(iA)return nA;iA=1;var t=wt(),e=rn(),n=Rf(),i=Mf(),r=xw(),s=un(),o=e("".charAt),a=s(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=r(n(this)),h=c.length,d=i(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:o(c,f)}}),nA}b3();function hh(t,e,n){return(e=S3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S3(t){var e=R3(t,"string");return typeof e=="symbol"?e:e+""}function R3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _3{constructor(){hh(this,"count",0),hh(this,"startColumn",null),hh(this,"endColumn",null),hh(this,"startPosition",null),hh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:s,columnWidth:o}=n,a=r>0?s+1:s;i>=r&&i+o<=r+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=r&&(this.startColumn-=1),g>=r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=o>0?r+1:r,d=i+r-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*s||i>u.at(-1)||-1*i-r>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function dh(t,e,n){return(e=E3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E3(t){var e=T3(t,"string");return typeof e=="symbol"?e:e+""}function T3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M3{constructor(){dh(this,"count",0),dh(this,"startRow",null),dh(this,"endRow",null),dh(this,"startPosition",null),dh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:s,rowHeight:o}=n;i>=r&&i+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=r-s&&(this.startRow-=1),d>=r-s)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=i+r-s,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function fh(t,e,n){return(e=x3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x3(t){var e=P3(t,"string");return typeof e=="symbol"?e:e+""}function P3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p${constructor(){fh(this,"count",0),fh(this,"startColumn",null),fh(this,"endColumn",null),fh(this,"startPosition",null),fh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:s}=n;i<=r&&(this.startColumn=e);const o=r>0?s+1:s;i>=r&&i<=r+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=o>0?r+1:r;i+r-h<-1*s||i>u.at(-1)+c||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function gh(t,e,n){return(e=I3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I3(t){var e=O3(t,"string");return typeof e=="symbol"?e:e+""}function O3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w${constructor(){gh(this,"count",0),gh(this,"startRow",null),gh(this,"endRow",null),gh(this,"startPosition",null),gh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:s}=n;i<=r&&(this.startRow=e),i>=r&&i<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=r-s)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,i+r-s<0||i>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function mh(t,e,n){return(e=A3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A3(t){var e=H3(t,"string");return typeof e=="symbol"?e:e+""}function H3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D3{constructor(){mh(this,"count",0),mh(this,"startColumn",0),mh(this,"endColumn",0),mh(this,"startPosition",0),mh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function ph(t,e,n){return(e=N3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N3(t){var e=k3(t,"string");return typeof e=="symbol"?e:e+""}function k3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L3{constructor(){ph(this,"count",0),ph(this,"startRow",0),ph(this,"endRow",0),ph(this,"startPosition",0),ph(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function rA(t,e,n){return(e=F3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F3(t){var e=$3(t,"string");return typeof e=="symbol"?e:e+""}function $3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V3 extends p${constructor(){super(...arguments),rA(this,"columnStartOffset",0),rA(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:s}=e;if(this.startColumn!==null&&typeof i=="function"){const o=this.startColumn,a=this.endColumn;i(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=s[this.startColumn])!==null&&n!==void 0?n:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function sA(t,e,n){return(e=W3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W3(t){var e=B3(t,"string");return typeof e=="symbol"?e:e+""}function B3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j3 extends w${constructor(){super(...arguments),sA(this,"rowStartOffset",0),sA(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:s}=e;if(this.startRow!==null&&typeof i=="function"){const o=this.startRow,a=this.endRow;i(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=s[this.startRow])!==null&&n!==void 0?n:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function oA(t,e,n){return(e=z3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z3(t){var e=U3(t,"string");return typeof e=="symbol"?e:e+""}function U3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v${constructor(e){oA(this,"calculationTypes",[]),oA(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[i,r]=n;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,n){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,i]=n;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function br(t,e,n){return(e=Y3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y3(t){var e=G3(t,"string");return typeof e=="symbol"?e:e+""}function G3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ec=50;class q3 extends v${constructor(e){let{calculationTypes:n,viewportWidth:i,scrollOffset:r,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(n),br(this,"viewportWidth",0),br(this,"scrollOffset",0),br(this,"zeroBasedScrollOffset",0),br(this,"totalColumns",0),br(this,"columnWidthFn",null),br(this,"columnWidth",0),br(this,"overrideFn",null),br(this,"inlineStartOffset",0),br(this,"totalCalculatedWidth",0),br(this,"startPositions",[]),br(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Ec:n}}function ji(t,e,n){return(e=K3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K3(t){var e=X3(t,"string");return typeof e=="symbol"?e:e+""}function X3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z3 extends v${constructor(e){let{calculationTypes:n,viewportHeight:i,scrollOffset:r,totalRows:s,defaultRowHeight:o,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),ji(this,"viewportHeight",0),ji(this,"scrollOffset",0),ji(this,"zeroBasedScrollOffset",0),ji(this,"totalRows",0),ji(this,"rowHeightFn",null),ji(this,"rowHeight",0),ji(this,"overrideFn",null),ji(this,"horizontalScrollbarHeight",0),ji(this,"innerViewportHeight",0),ji(this,"totalCalculatedHeight",0),ji(this,"startPositions",[]),ji(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=s,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function Q3(t,e,n){J3(t,e),e.set(t,n)}function J3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aA(t,e,n){return(e=e5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e5(t){var e=t5(t,"string");return typeof e=="symbol"?e:e+""}function t5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function du(t,e){return t.get(y$(t,e))}function lA(t,e,n){return t.set(y$(t,e),n),n}function y$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vs=new WeakMap;class jl{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;aA(this,"row",null),aA(this,"col",null),Q3(this,Vs,!1),lA(Vs,this,i),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:i,countRowHeaders:r,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-r||this.row>=n||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return du(Vs,this)}isSouthEastOf(e){return this.row>=e.row&&(du(Vs,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(du(Vs,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(du(Vs,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(du(Vs,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof jl&&lA(Vs,this,e.isRtl()),this}clone(){return new jl(this.row,this.col,du(Vs,this))}toObject(){return{row:this.row,col:this.col}}}function n5(t,e,n){i5(t,e),e.set(t,n)}function i5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pb(t,e,n){return(e=r5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r5(t){var e=s5(t,"string");return typeof e=="symbol"?e:e+""}function s5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zi(t,e){return t.get(C$(t,e))}function o5(t,e,n){return t.set(C$(t,e),n),n}function C$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var li=new WeakMap;class Vf{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Pb(this,"highlight",null),Pb(this,"from",null),Pb(this,"to",null),n5(this,li,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=i.clone(),o5(li,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:i}=e,r=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return r.row<=n&&s.row>=n&&r.col<=i&&s.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(i.row,o.row),u=Math.min(i.col,o.col),c=Math.max(r.row,a.row),h=Math.max(r.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(s),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return zi(li,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return zi(li,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return zi(li,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return zi(li,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return zi(li,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return zi(li,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return zi(li,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return zi(li,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof jl))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return n.top===i.top&&r.push("top"),n.right===i.right&&r.push(zi(li,this)?"left":"right"),n.bottom===i.bottom&&r.push("bottom"),n.left===i.left&&r.push(zi(li,this)?"right":"left"),r}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let s=e.col;s<=n.col;s++)!(this.from.row===r&&this.from.col===s)&&!(this.to.row===r&&this.to.col===s)&&i.push(this._createCellCoords(r,s));return i}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let s=e.col;s<=n.col;s++)e.row===r&&e.col===s?i.push(e):n.row===r&&n.col===s?i.push(n):i.push(this._createCellCoords(r,s));return i}forAll(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=n.row;r<=i.row;r++)for(let s=n.col;s<=i.col;s++)if(e(r,s)===!1)return}clone(){return new Vf(this.highlight,this.from,this.to,zi(li,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new jl(e,n,zi(li,this))}}function qr(t,e,n){a5(t,e),e.set(t,n)}function a5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fe(t,e){return t.get(b$(t,e))}function Oo(t,e,n){return t.set(b$(t,e),n),n}function b$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ui=new WeakMap,Ib=new WeakMap,Sn=new WeakMap,fu=new WeakMap,hg=new WeakMap,Sr=new WeakMap,Ob=new WeakMap,wh=new WeakMap,La=new WeakMap,Kr=new WeakMap;let S$=class{constructor(e,n,i,r,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;qr(this,Ui,void 0),qr(this,Ib,void 0),qr(this,Sn,void 0),qr(this,fu,void 0),qr(this,hg,void 0),qr(this,Sr,void 0),qr(this,Ob,void 0),qr(this,wh,void 0),qr(this,La,[null,null]),qr(this,Kr,[null,null]),Oo(Ui,this,i),Oo(Ib,this,n),Oo(Sn,this,s),Oo(fu,this,o),Oo(hg,this,a),Oo(Sr,this,r),Oo(Ob,this,e),this.registerEvents()}registerEvents(){fe(Sr,this).addEventListener(fe(Sn,this).holder,"contextmenu",i=>this.onContextMenu(i)),fe(Sr,this).addEventListener(fe(Sn,this).TABLE,"mouseover",i=>this.onMouseOver(i)),fe(Sr,this).addEventListener(fe(Sn,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{fe(Sr,this).addEventListener(fe(Sn,this).holder,"touchstart",i=>this.onTouchStart(i)),fe(Sr,this).addEventListener(fe(Sn,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),fe(Sr,this).addEventListener(fe(Sn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||fe(Ui,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,fe(Ui,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{fe(Sr,this).addEventListener(fe(Sn,this).holder,"mouseup",i=>this.onMouseUp(i)),fe(Sr,this).addEventListener(fe(Sn,this).holder,"mousedown",i=>this.onMouseDown(i))};Fr()?e():(Q_()&&e(),n())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(fe(wh,this)&&i){const[r,s]=[i.row,fe(wh,this).from.row],[o,a]=[i.col,fe(wh,this).from.col];return r===s&&o===a}return!1}parentCell(e){const n={},i=fe(Sn,this).TABLE,r=cd(e,["TD","TH"],i);return r?(n.coords=fe(Sn,this).getCoords(r),n.TD=r):ye(e,"wtBorder")&&ye(e,"current")?(n.coords=fe(fu,this).getFocusSelection().cellRange.highlight,n.TD=fe(Sn,this).getCell(n.coords)):ye(e,"wtBorder")&&ye(e,"area")&&fe(fu,this).getAreaSelection().cellRange&&(n.coords=fe(fu,this).getAreaSelection().cellRange.to,n.TD=fe(Sn,this).getCell(n.coords)),n}onMouseDown(e){const n=fe(Ib,this).rootDocument.activeElement,i=fE($F,e.target),r=e.target;if(!["TD","TH"].includes(n.nodeName)&&(r===n||i(0)===n||i(1)===n))return;const s=this.parentCell(r);ye(r,"corner")?fe(Ui,this).getSetting("onCellCornerMouseDown",e,r):s.TD&&fe(Ui,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(fe(Kr,this)[0]=s.TD,clearTimeout(fe(La,this)[0]),fe(La,this)[0]=setTimeout(()=>{fe(Kr,this)[0]=null},1e3))}onContextMenu(e){if(fe(Ui,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!fe(Ui,this).has("onCellMouseOver"))return;const n=fe(Sn,this).TABLE,i=cd(e.target,["TD","TH"],n),r=fe(hg,this)||this;i&&i!==r.lastMouseOver&&pa(i,n)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,fe(Sn,this).getCoords(i),i))}onMouseOut(e){if(!fe(Ui,this).has("onCellMouseOut"))return;const n=fe(Sn,this).TABLE,i=cd(e.target,["TD","TH"],n),r=cd(e.relatedTarget,["TD","TH"],n),s=fe(hg,this)||this;i&&i!==r&&pa(i,n)&&(this.callListener("onCellMouseOut",e,fe(Sn,this).getCoords(i),i),r===null&&(s.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&fe(Ui,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===fe(Kr,this)[0]&&n.TD===fe(Kr,this)[1]?(ye(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),fe(Kr,this)[0]=null,fe(Kr,this)[1]=null):n.TD===fe(Kr,this)[0]&&(fe(Kr,this)[1]=n.TD,clearTimeout(fe(La,this)[1]),fe(La,this)[1]=setTimeout(()=>{fe(Kr,this)[1]=null},500)))}onTouchStart(e){Oo(wh,this,fe(fu,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const i=e.target,r=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,s=le(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&s&&fe(Ui,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];eE()&&(kF()||LF())&&this.selectedCellWasTouched(i)&&!a.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,i,r){const s=fe(Ui,this).getSettingPure(e);s&&s(n,i,r,fe(Ob,this).call(this))}destroy(){clearTimeout(fe(La,this)[0]),clearTimeout(fe(La,this)[1]),fe(Sr,this).destroy()}};function Ab(t,e,n){return(e=l5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l5(t){var e=u5(t,"string");return typeof e=="symbol"?e:e+""}function u5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c5{constructor(e,n,i){Ab(this,"offset",void 0),Ab(this,"total",void 0),Ab(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Hb(t,e,n){return(e=h5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h5(t){var e=d5(t,"string");return typeof e=="symbol"?e:e+""}function d5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f5{constructor(e,n,i){Hb(this,"offset",void 0),Hb(this,"total",void 0),Hb(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function dg(t,e,n){return(e=g5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g5(t){var e=m5(t,"string");return typeof e=="symbol"?e:e+""}function m5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p5{constructor(){dg(this,"currentSize",0),dg(this,"nextSize",0),dg(this,"currentOffset",0),dg(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const w5=0,uA=1,v0=2;function Db(t,e,n){return(e=v5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v5(t){var e=y5(t,"string");return typeof e=="symbol"?e:e+""}function y5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C5{constructor(){Db(this,"size",new p5),Db(this,"workingSpace",w5),Db(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=uA,e.workingSpace=v0,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=v0,e.workingSpace=uA,this.sharedSize=e.getViewSize()}}var cA={},Nb,hA;function b5(){if(hA)return Nb;hA=1;var t=Mw(),e=TypeError;return Nb=function(n,i){if(!delete n[i])throw new e("Cannot delete property "+t(i)+" of "+t(n))},Nb}var dA;function S5(){if(dA)return cA;dA=1;var t=wt(),e=Nc(),n=Lc(),i=lL(),r=b5(),s=uL(),o=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){s(d+f);for(var g=d;g--;){var m=g+f;g in h?h[m]=h[g]:r(h,m)}for(var v=0;v<f;v++)h[v]=arguments[v]}return i(h,d+f)}}),cA}S5();function R5(t,e,n){return(e=_5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _5(t){var e=E5(t,"string");return typeof e=="symbol"?e:e+""}function E5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fA{constructor(e,n){R5(this,"order",[]),this.order=[...Array(n).keys()].map(i=>e+i)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function T5(t,e,n){return(e=M5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M5(t){var e=x5(t,"string");return typeof e=="symbol"?e:e+""}function x5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P5{constructor(e){T5(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:i}=e.getViewSize();let r=Math.max(i,n);if(r===0)return[];const{currentOffset:s,nextOffset:o}=e.getViewSize(),a=new fA(s,n),l=new fA(o,i),u=[];for(let c=0;c<r;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(v0)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),i<=a.length&&(r-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function gu(t,e,n){return(e=I5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I5(t){var e=O5(t,"string");return typeof e=="symbol"?e:e+""}function O5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R${constructor(e,n){gu(this,"rootNode",void 0),gu(this,"nodesPool",void 0),gu(this,"sizeSet",new C5),gu(this,"collectedNodes",[]),gu(this,"viewDiffer",new P5(this.sizeSet)),gu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[i,r,s,o]=e,a=this.nodesPool(r);switch(this.collectedNodes.push(a),i){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(s)),n.removeChild(this.nodesPool(o));break;case"replace":n.replaceChild(a,this.nodesPool(s));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class _$ extends R${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function gA(t,e,n){return(e=A5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A5(t){var e=H5(t,"string");return typeof e=="symbol"?e:e+""}function H5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D5{constructor(e){gA(this,"nodeType",void 0),gA(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const r=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(r))return this.pool.get(r);const s=this.rootDocument.createElement(this.nodeType);return this.pool.set(r,s),s}}function vh(t,e,n){return(e=N5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N5(t){var e=k5(t,"string");return typeof e=="symbol"?e:e+""}function k5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wf{constructor(e,n){vh(this,"nodesPool",null),vh(this,"nodeType",void 0),vh(this,"rootNode",void 0),vh(this,"table",null),vh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new D5(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function mA(t,e,n){return(e=L5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L5(t){var e=F5(t,"string");return typeof e=="symbol"?e:e+""}function F5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $5 extends Wf{constructor(){super("TH"),mA(this,"orderViews",new WeakMap),mA(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new _$(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:i,rows:r,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=r.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=s.obtainOrderView(l);u.appendView(c).setSize(i).setOffset(0).start();for(let h=i-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),iu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(d,[Sq(),Oq(),X_(h+1),Oa(-1)]),n[h](a,d,h)}u.end()}}}class V5 extends Wf{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,s=r+n;for(let a=0,l=e;a<l;a++){for(i=this.rootNode.childNodes[a],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<s;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)i.removeChild(i.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&Ps(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&ve(this.rootNode,[RF()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&ve(o,[_F(),xF(n+1)]);for(let a=-1*s;a<r;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),iu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(u,[X_(a+1+this.table.rowHeadersCount),Oa(-1),Rq(),...a>=0?[Iq()]:[bq(),bc("Select whole grid")]]),i[n](l,u,n)}}}}let pA=!1;class W5 extends Wf{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,i=e+n;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!pA&&e>1e3&&(pA=!0,Je(ot`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){const s=this.table.renderedColumnToSource(r),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[r].style.width=`${o}px`}for(let r=0;r<e;r++){const s=this.table.renderedColumnToSource(r),o=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[r+n].style.width=`${o}px`}const i=this.rootNode.firstChild;i&&K(i,"rowHeader")}}function B5(t,e,n){return(e=j5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j5(t){var e=z5(t,"string");return typeof e=="symbol"?e:e+""}function z5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let wA=!1;class U5 extends Wf{constructor(e){super("TR",e),B5(this,"orderView",void 0),this.orderView=new R$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!wA&&e>1e3&&(wA=!0,Je(ot`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ve(this.rootNode,[RF()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var n,i;ve(s,[_F(),xF(o+((n=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(o+1)%2===0?ye(s,mu.rowEven)||(me(s,mu.rowOdd),K(s,mu.rowEven)):ye(s,mu.rowOdd)||(me(s,mu.rowEven),K(s,mu.rowOdd))}this.orderView.end()}}function vA(t,e,n){return(e=Y5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y5(t){var e=G5(t,"string");return typeof e=="symbol"?e:e+""}function G5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q5 extends Wf{constructor(){super("TD"),vA(this,"orderViews",new WeakMap),vA(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new _$(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:i,rowHeaders:r}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=i.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=r.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(ye(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),iu(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var s,o;ve(g,[...g.hasAttribute("role")?[]:[Cq()],Oa(-1),X_(f+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}c.end()}}}function on(t,e,n){return(e=K5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K5(t){var e=X5(t,"string");return typeof e=="symbol"?e:e+""}function X5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z5{constructor(e){let{cellRenderer:n,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};on(this,"rootNode",void 0),on(this,"rootDocument",void 0),on(this,"rowHeaders",null),on(this,"columnHeaders",null),on(this,"colGroup",null),on(this,"rows",null),on(this,"cells",null),on(this,"rowFilter",null),on(this,"columnFilter",null),on(this,"rowUtils",null),on(this,"columnUtils",null),on(this,"rowsToRender",0),on(this,"columnsToRender",0),on(this,"rowHeaderFunctions",[]),on(this,"rowHeadersCount",0),on(this,"columnHeaderFunctions",[]),on(this,"columnHeadersCount",0),on(this,"cellRenderer",void 0),on(this,"activeOverlayName",void 0),on(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:i,rows:r,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),i.setTable(this),r.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=i,this.rows=r,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let i=0;i<e;i++){const r=n.getRenderedNode(i),s=this.rowUtils;if(r.firstChild){const o=this.renderedRowToSource(i),a=s.getHeightByOverlayName(o,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?r.firstChild.style.height=`${a-u}px`:r.firstChild.style.height=""}}}}class Q5{constructor(){let{TABLE:e,THEAD:n,COLGROUP:i,TBODY:r,rowUtils:s,columnUtils:o,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Z5(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new $5,columnHeaders:new V5(n),colGroup:new W5(i),rows:new U5(r),cells:new q5}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function kb(t,e,n){return(e=J5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J5(t){var e=eX(t,"string");return typeof e=="symbol"?e:e+""}function eX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tX{constructor(e,n){kb(this,"dataAccessObject",void 0),kb(this,"wtSettings",void 0),kb(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let s=0;s<i;s++){let o=Array.isArray(n)?n[s]:n;o=o??r,this.headerWidths.set(s,o)}}}}function yA(t,e,n){return(e=nX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nX(t){var e=iX(t,"string");return typeof e=="symbol"?e:e+""}function iX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rX{constructor(e,n){yA(this,"dataAccessObject",void 0),yA(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}getHeightByOverlayName(e,n){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}}function Xr(t,e,n){return(e=sX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sX(t){var e=oX(t,"string");return typeof e=="symbol"?e:e+""}function oX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zc{constructor(e,n,i,r,s){Xr(this,"wtSettings",null),Xr(this,"domBindings",void 0),Xr(this,"TBODY",null),Xr(this,"THEAD",null),Xr(this,"COLGROUP",null),Xr(this,"hasTableHeight",!0),Xr(this,"hasTableWidth",!0),Xr(this,"isTableVisible",!1),Xr(this,"tableOffset",0),Xr(this,"holderOffset",0),this.domBindings=i,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,nE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new rX(this.dataAccessObject,this.wtSettings),this.columnUtils=new tX(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Q5({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ve(i,[fo()]),i}createHider(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(i,[fo()]),i}createHolder(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",this.isMaster&&ve(i,[Oa(-1)]),n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ve(i.parentNode,[fo()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(i,[fo()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,s=n.getSetting("totalRows"),o=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=xn(this.holder),h=r.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=i.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=xn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new f5(f,s,c),this.columnFilter=new c5(g,o,l);let m=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const v={};this.wtSettings.getSetting("beforeDraw",!0,v),m=v.skipRender!==!0}m&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(bs)||this.is(wa))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(bs))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(bs)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,s=this.getColumnHeaderHeight(i),o=this.getColumnHeader(n,i),o&&(a=mc(o),(!s&&r<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),Array.isArray(l)?l[i]!==null&&l[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let s=0,o=r.length;s<o;s++)if(i[s]){if(!n[s]||n[s].childNodes.length===0)return;n[s].childNodes[0].style.height=`${i[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(bs))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const s=this.rowFilter.renderedToSource(r);n.oversizedRows&&n.oversizedRows[s]&&(n.oversizedRows[s]=void 0)}}}getCell(e){let n=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",n,i,!this.isMaster,"render");if(r&&Array.isArray(r)&&([n,i]=r),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!o&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let n=null,i=null;if(e<0){var r;n=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var s;n=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[n];return i?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const s=r.childNodes[i];s&&n.push(s)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(n>=i)return;const r=this.rowFilter.sourceToRendered(e),s=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,a=(r<0?this.THEAD:this.TBODY).childNodes[s];return a?.childNodes[n]}getRowHeaders(e){const n=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s?.childNodes[r];o&&n.push(o)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Sa(n,["TD","TH"])),n===null)return null;const i=n.parentNode;if(!i)return null;const r=i.parentNode;let s=BF(i),o=n.cellIndex;qo(Yl,n,this.wtRootElement)||qo(zl,n,this.wtRootElement)?r.nodeName==="THEAD"&&(s-=r.childNodes.length):qo(wa,n,this.wtRootElement)||qo(bs,n,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-r.childNodes.length+s:r===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):this.rowFilter&&(s=this.rowFilter.renderedToSource(s)),qo(Yl,n,this.wtRootElement)||qo(Ul,n,this.wtRootElement)||qo(wa,n,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",s,o);return a&&Array.isArray(a)&&([s,o]=a),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),i=e*n.getDefaultRowHeight(),r=mc(this.TBODY)-1,s=n.areCellsBorderBox(),o=s?en:mc,a=s?0:1,l=s?1:0;let u,c,h,d,f;if(!(i===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const g=h===0?l:0;f?c=o(f):c=o(d)-a,(!u&&n.getDefaultRowHeight()<c-g||u<c)&&(s||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Gt(this.TABLE)}getHeight(){return en(this.TABLE)}getTotalWidth(){const e=Gt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=en(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Bl(this.TABLE)}_modifyRowHeaderWidth(e){let n=st(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const aX="stickyRowsBottom",bE={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Ds(bE,"MIXIN_NAME",aX,{writable:!1,enumerable:!1});const lX="stickyColumnsStart",Zw={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ds(Zw,"MIXIN_NAME",lX,{writable:!1,enumerable:!1});class SE extends zc{constructor(e,n,i,r){super(e,n,i,r,wa)}}ht(SE,bE);ht(SE,Zw);const zl="top",bs="bottom",Ul="inline_start",Yl="top_inline_start_corner",wa="bottom_inline_start_corner",E$=[zl,bs,Ul,Yl,wa],uX=new Map([[zl,`ht_clone_${zl}`],[bs,`ht_clone_${bs}`],[Ul,`ht_clone_${Ul} ht_clone_left`],[Yl,`ht_clone_${Yl} ht_clone_top_left_corner`],[wa,`ht_clone_${wa} ht_clone_bottom_left_corner`]]);function cX(t,e){hX(t,e),e.add(t)}function hX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dX(t,e,n){return(e=fX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fX(t){var e=gX(t,"string");return typeof e=="symbol"?e:e+""}function gX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yh=new WeakSet;class mX{constructor(e){cX(this,yh),dX(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,i){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,n),s=this.scrollViewportVertically(e.row,i);return r||s}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i)return!1;const s=Ei(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>r)return!1;n=s.value;const{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<o)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:r}=this.dataAccessObject;if(!i)return!1;const s=Ei(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>r)return!1;n=s.value;const{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>r-o-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return fg(yh,this,bA).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return fg(yh,this,bA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return fg(yh,this,CA).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return fg(yh,this,CA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function CA(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(n.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const c=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=xn(i.wtRootElement).left;const u=Math.abs(rE(o,o));if(l>u){const c=sE(o);let h=r.getRowHeaderWidth();for(let d=1;d<=s;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function bA(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=xn(n.wtRootElement),a=Uw(s,s);if(o.top>a){const l=mc(s);let u=i.getColumnHeaderHeight();for(let c=1;c<=r;c++)if(u+=e.sumCellSizes(c-1,c),o.top+u-a>=l){t=c-2;break}}}return t}function Yi(t,e,n){return(e=pX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pX(t){var e=wX(t,"string");return typeof e=="symbol"?e:e+""}function wX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RE{get eventManager(){return new cr(this)}constructor(e,n){Yi(this,"wtTable",void 0),Yi(this,"wtScroll",void 0),Yi(this,"wtViewport",void 0),Yi(this,"wtOverlays",void 0),Yi(this,"selectionManager",void 0),Yi(this,"wtEvent",void 0),Yi(this,"guid",`wt_${G_()}`),Yi(this,"drawInterrupted",!1),Yi(this,"drawn",!1),Yi(this,"activeOverlayName","master"),Yi(this,"domBindings",void 0),Yi(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new mX(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,i){Ra(i,e[n])}])}}createCellCoords(e,n){return new jl(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,i){return new Vf(e,n,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||YF(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=i-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,i){return this.wtScroll.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function SA(t,e,n){return(e=vX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vX(t){var e=yX(t,"string");return typeof e=="symbol"?e:e+""}function yX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CX extends RE{constructor(e,n,i){super(e,n),SA(this,"cloneSource",void 0),SA(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new S$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function bX(t,e,n){return(e=SX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SX(t){var e=RX(t,"string");return typeof e=="symbol"?e:e+""}function RX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bf{constructor(e,n,i,r,s){bX(this,"wtSettings",null),Ds(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=n,this.wtSettings=r;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=_c(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=_c(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=tf(e.TABLE)}getRelativeCellPosition(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){Je(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,s=i<this.wtSettings.getSetting("fixedColumnsStart"),o=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return r?h=this.getRelativeCellPositionWithinWindow(o,s,c,u):h=this.getRelativeCellPositionWithinHolder(o,a,s,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,i,r){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!n)o=r.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+Cn())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=r.top,{start:i.start+o,top:i.top+a}}getRelativeCellPositionWithinHolder(e,n,i,r,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(i||(a=o.horizontal-s.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:r.start-a,top:r.top-l}}makeClone(){if(E$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=i.createElement("div"),o=i.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${uX.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,n.getSetting("ariaTags")&&ve(s,[fo()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===zl||u==="vertical"&&this.type===Ul?this.mainTableScrollableElement=r:r.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=tf(e.TABLE),new CX(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,r=n.style,s=e.parentNode.style;[i,r,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class _X extends Bf{constructor(e,n,i,r,s,o){super(e,n,wa,i,r),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new SE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${s}px`,n.style.bottom=`${o}px`}else Lf(n),this.repositionOverlay();let i=en(this.clone.wtTable.TABLE);const r=Gt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),n.style.height=`${i}px`,n.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=Cn(i)),r.style.bottom=`${s}px`}}const EX="calculatedColumns",Qw={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ds(Qw,"MIXIN_NAME",EX,{writable:!1,enumerable:!1});class _E extends zc{constructor(e,n,i,r){super(e,n,i,r,bs)}}ht(_E,bE);ht(_E,Qw);function TX(t,e,n){return(e=MX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MX(t){var e=xX(t,"string");return typeof e=="symbol"?e:e+""}function xX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PX extends Bf{constructor(e,n,i,r){super(e,n,bs,i,r),TX(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new _E(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),n.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=Cn(i)),r.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const s=n.scrollY;n.scrollTo(zw(n),top),r=s!==n.scrollY}else if(e!==i.scrollTop){const s=i.scrollTop;i.scrollTop=e,r=s!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:i,wtSettings:r}=this.wot,s=r.getSetting("stylesHandler").getDefaultRowHeight();let o=e,a=0;for(;o<n;){const l=i.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Cn(i)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=en(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let i=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;n&&s.offsetHeight!==s.clientHeight&&(o=Cn(this.domBindings.rootDocument)),n?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=o,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Uw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=r-s,a=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==n,r=this.wtSettings.getSetting("columnHeaders");let s=!1;if((i||n===0)&&r.length>0){const o=this.wot.wtTable.holder.parentNode,a=ye(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(K(o,"innerBorderBottom"),s=!a):(me(o,"innerBorderBottom"),s=a)}return s}}const IX="calculatedRows",EE={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ds(EE,"MIXIN_NAME",IX,{writable:!1,enumerable:!1});class TE extends zc{constructor(e,n,i,r){super(e,n,i,r,Ul)}}ht(TE,EE);ht(TE,Zw);const OX="localHooks",In={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,i,r,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Pp(this._localHooks[t][l],this,e,n,i,r,s,o)}},clearLocalHooks(){return this._localHooks={},this}};Ds(In,"MIXIN_NAME",OX,{writable:!1,enumerable:!1});let T$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};ht(T$,In);const M$="active-header",ME="header",xE="area",Hp="focus",AX="fill",HX="row",DX="column",NX="custom-selection",PE=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),r=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:i,borderStyle:"solid",borderColor:r})};var RA={},_A;function kX(){if(_A)return RA;_A=1;var t=Kw();return t("flat"),RA}kX();function LX(t,e){x$(t,e),e.add(t)}function EA(t,e,n){x$(t,e),e.set(t,n)}function x$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lt(t,e){return t.get(Td(t,e))}function TA(t,e,n){return t.set(Td(t,e),n),n}function Td(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xr=new WeakMap,kn=new WeakMap,gg=new WeakSet;class FX{constructor(){LX(this,gg),EA(this,xr,void 0),EA(this,kn,void 0)}setActiveOverlay(e){return TA(kn,this,e),this}setActiveSelection(e){return TA(xr,this,e),this}scan(){const e=Lt(xr,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="area"?this.scanCellsRange(i=>n.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i)),this.scanCellsRange(i=>n.add(i))):e==="fill"?this.scanCellsRange(i=>n.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>n.add(i)),this.scanRowsInCellsRange(i=>n.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanColumnsInCellsRange(i=>n.add(i))),n}scanColumnsInHeadersRange(e){const[n,i,r,s]=Lt(xr,this).getCorners(),{wtTable:o}=Lt(kn,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let c=-o.getRowHeadersCount();c<a;c++){const h=o.columnFilter.renderedToSource(c);if(!(h<i||h>s)){for(let d=-l;d<0;d++){if(d<n||d>r)continue;const f=d+l;let g=o.getColumnHeader(h,f);const m=Lt(kn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Lt(xr,this).settings.selectionType,columnCursor:u,selectionWidth:s-i+1});m!==null&&(m!==h&&(g=o.getColumnHeader(m,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,i,r,s]=Lt(xr,this).getCorners(),{wtTable:o}=Lt(kn,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let c=-o.getColumnHeadersCount();c<a;c++){const h=o.rowFilter.renderedToSource(c);if(!(h<n||h>r)){for(let d=-l;d<0;d++){if(d<i||d>s)continue;const f=d+l;let g=o.getRowHeader(h,f);const m=Lt(kn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Lt(xr,this).settings.selectionType,rowCursor:u,selectionHeight:r-n+1});m!==null&&(m!==h&&(g=o.getRowHeader(m,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Lt(kn,this);Td(gg,this,$X).call(this,(i,r)=>{const s=n.getCell(Lt(kn,this).createCellCoords(i,r)),o=Lt(kn,this).getSetting("onAfterDrawSelection",i,r,Lt(xr,this).settings.layerLevel);typeof o=="string"&&K(s,o),e(s)})}scanRowsInCellsRange(e){const[n,,i]=Lt(xr,this).getCorners(),{wtTable:r}=Lt(kn,this);Td(gg,this,MA).call(this,(s,o)=>{if(s>=n&&s<=i){const a=r.getCell(Lt(kn,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,n,,i]=Lt(xr,this).getCorners(),{wtTable:r}=Lt(kn,this);Td(gg,this,MA).call(this,(s,o)=>{if(o>=n&&o<=i){const a=r.getCell(Lt(kn,this).createCellCoords(s,o));e(a)}})}}function $X(t){let[e,n,i,r]=Lt(xr,this).getCorners();if(e<0&&i<0||n<0&&r<0)return;const{wtTable:s}=Lt(kn,this),o=e!==i||n!==r;if(n=Math.max(n,0),r=Math.max(r,0),e=Math.max(e,0),i=Math.max(i,0),o){if(n=Math.max(n,s.getFirstRenderedColumn()),r=Math.min(r,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),i=Math.min(i,s.getLastRenderedRow()),r<n||i<e)return}else{const a=s.getCell(Lt(kn,this).createCellCoords(e,n));if(!Es(a))return}for(let a=e;a<=i;a+=1)for(let l=n;l<=r;l+=1)t(a,l)}function MA(t){const{wtTable:e}=Lt(kn,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let r=0;r<n;r+=1){const s=e.rowFilter.renderedToSource(r);for(let o=0;o<i;o+=1)t(s,e.columnFilter.renderedToSource(o))}}class xA{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=PE(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,i=this.main.childNodes.length;n<i;n++){const r=this.main.childNodes[n];this.eventManager.addEventListener(r,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),wr(e);const i=this,r=this.wot.rootDocument.body,s=n.getBoundingClientRect();n.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(i.eventManager.removeEventListener(r,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(r,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let a=0;a<5;a++){const l=i[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),r=u.style,r.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,r.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,r.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Fr()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=n.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,i=n.getSetting("stylesHandler"),r=i.getCSSVariableValue("cell-mobile-handle-size"),s=i.getCSSVariableValue("cell-mobile-handle-border-radius"),o=i.getCSSVariableValue("cell-mobile-handle-background-color"),a=i.getCSSVariableValue("cell-mobile-handle-border-width"),l=i.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};He(h,(f,g)=>{this.selectionHandles.styles.bottomHitArea[g]=f,this.selectionHandles.styles.topHitArea[g]=f});const d=i.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${s}px`,background:`${o}`,border:`${a}px solid ${l}`};He(d,(f,g)=>{this.selectionHandles.styles.bottom[g]=f,this.selectionHandles.styles.top[g]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,i,r,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),m=parseInt(c.width,10),v=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();u.top=`${parseInt(i-g-1,10)}px`,u[l]=`${parseInt(r-g-1,10)}px`,c.top=`${parseInt(i-m/4*3,10)}px`,c[l]=`${parseInt(r-m/4*3,10)}px`;const y=Math.min(parseInt(r+s,10),v-g-f*2),M=Math.min(parseInt(r+s-m/4,10),v-m-f*2);h[l]=`${y}px`,d[l]=`${M}px`;const I=Math.min(parseInt(i+o,10),S-g-f*2),P=Math.min(parseInt(i+o-m/4,10),S-m-f*2);h.top=`${I}px`,d.top=`${P}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,i,r,s]=e;if(n<0&&r<0||i<0&&s<0){this.disappear();return}const{wtTable:o,rootDocument:a,rootWindow:l}=this.wot,u=n!==r||i!==s,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=o.getFirstRenderedRow(),d=o.getLastRenderedRow(),f=o.getFirstRenderedColumn(),g=o.getLastRenderedColumn();if(f<0&&g<0||h<0&&d<0){this.disappear();return}let m;if(u){if(i=Math.max(i,f),s=Math.min(s,g),n=Math.max(n,h),r=Math.min(r,d),s<i||r<n){this.disappear();return}m=o.getCell(this.wot.createCellCoords(n,i))}else if(m=o.getCell(this.wot.createCellCoords(n,i)),!Es(m)){this.disappear();return}const v=u?o.getCell(this.wot.createCellCoords(r,s)):m,S=xn(m),y=u?xn(v):S,M=xn(o.TABLE),I=S.top,P=S.left,E=this.wot.wtSettings.getSetting("rtlMode");let T=0,$=0;if(E){const Ie=Gt(o.TABLE),at=Gt(m),Le=l.innerWidth-M.left-Ie;$=P+at-y.left,T=l.innerWidth-P-at-Le-1}else $=y.left+Gt(v)-P,T=P-M.left-1;if(this.isEntireColumnSelected(n,r)){const Ie=n,at=this.getDimensionsFromHeader("columns",i,s,Ie,M);let Le=null;at&&([Le,T,$]=at),Le&&(m=Le)}let U=I-M.top-1,O=y.top+en(v)-I;if(this.isEntireRowSelected(i,s)){const Ie=i,at=this.getDimensionsFromHeader("rows",n,r,Ie,M);let Le=null;at&&([Le,U,O]=at),Le&&(m=Le)}const G=l.getComputedStyle(m);parseInt(G.borderTopWidth,10)>0&&(U+=1,O=O>0?O-1:0),parseInt(G[E?"borderRightWidth":"borderLeftWidth"],10)>0&&(T+=1,$=$>0?$-1:0);const q=E?"right":"left",ne=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${U}px`,this.topStyle[q]=`${T}px`,this.topStyle.width=`${$+ne}px`,this.topStyle.display="block",this.startStyle.top=`${U}px`,this.startStyle[q]=`${T}px`,this.startStyle.height=`${O+ne}px`,this.startStyle.display="block",this.bottomStyle.top=`${U+O-parseInt(this.bottomStyle.height,10)+ne}px`,this.bottomStyle[q]=`${T}px`,this.bottomStyle.width=`${$+ne}px`,this.bottomStyle.display="block",this.endStyle.top=`${U}px`,this.endStyle[q]=`${T+$-parseInt(this.endStyle.width,10)+ne}px`,this.endStyle.height=`${O+ne}px`,this.endStyle.display="block";let Q=this.settings.border.cornerVisible;Q=typeof Q=="function"?Q(this.settings.layerLevel):Q;const te=this.wot.getSetting("onModifyGetCellCoords",r,s,!1,"render");let[Me,Ce]=[r,s];if(te&&Array.isArray(te)&&([,,Me,Ce]=te),Fr()||!Q||this.isPartRange(Me,Ce))this.cornerStyle.display="none";else{this.cornerStyle.top=`${U+O+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[q]=`${T+$+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ie=_c(o.TABLE);const at=Ie===l;at&&(Ie=a.documentElement);const Le=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Ge=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),St=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const p=at?v.getBoundingClientRect().left:v.offsetLeft;let w=!1,b=0;if(E?(b=p-parseInt(this.cornerDefaultStyle.width,10)/2,w=b<0):(b=p+Gt(v)+parseInt(this.cornerDefaultStyle.width,10)/2,w=b>=sE(Ie)),w){const N=Math.floor(T+$+this.cornerCenterPointOffset-Ge-Le);c?(this.cornerStyle[q]=`${N}px`,this.cornerStyle[E?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[q]=`${N-1}px`}}if(r===this.wot.getSetting("totalRows")-1&&(at?v.getBoundingClientRect().top:v.offsetTop)+en(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=mc(Ie)){const N=Math.floor(U+O+this.cornerCenterPointOffset-St-Le);c?(this.cornerStyle.top=`${N}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${N-1}px`}this.cornerStyle.display="block"}Fr()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,s,U,T,$,O)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,i,r,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,m=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return en(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return Gt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const v=this.wot.getSetting("columnHeaders").length;if(g=l(n,v-r),m=l(i,v-r),!g||!m)return!1;const S=xn(g),y=xn(m);return g&&m&&(h=S[f]-s[f]-1,d=y[f]+u(m)-S[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const i=this[e].style,r=n[e];!r||r.hide?K(this[e],"hidden"):(ye(this[e],"hidden")&&me(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width=`${n.width}px`,i.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?K(this[e],"hidden"):me(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Fr()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function VX(t,e){P$(t,e),e.add(t)}function pu(t,e,n){P$(t,e),e.set(t,n)}function P$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function De(t,e){return t.get(IE(t,e))}function PA(t,e,n){return t.set(IE(t,e),n),n}function IE(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ln=new WeakMap,vi=new WeakMap,Lb=new WeakMap,hd=new WeakMap,Fb=new WeakMap,Fa=new WeakMap,IA=new WeakSet;class WX{constructor(e){VX(this,IA),pu(this,Ln,void 0),pu(this,vi,void 0),pu(this,Lb,new FX),pu(this,hd,new WeakMap),pu(this,Fb,new WeakSet),pu(this,Fa,new Map),PA(vi,this,e)}setActiveOverlay(e){return PA(Ln,this,e),De(Lb,this).setActiveOverlay(De(Ln,this)),De(hd,this).has(De(Ln,this))||De(hd,this).set(De(Ln,this),new Set),this}getFocusSelection(){return De(vi,this)!==null?De(vi,this).getFocus():null}getAreaSelection(){return De(vi,this)!==null?De(vi,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(De(Fa,this).has(e)){const i=De(Fa,this).get(e);if(i.has(De(Ln,this)))return i.get(De(Ln,this));const r=new xA(De(Ln,this),e.settings);return i.set(De(Ln,this),r),r}const n=new xA(De(Ln,this),e.settings);return De(Fa,this).set(e,new Map([[De(Ln,this),n]])),n}getBorderInstances(e){var n,i;return Array.from((n=(i=De(Fa,this).get(e))===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[])}destroyBorders(e){De(Fa,this).get(e).forEach(n=>n.destroy()),De(Fa,this).delete(e)}render(e){if(De(vi,this)===null)return;e&&IE(IA,this,BX).call(this);const n=Array.from(De(vi,this)),i=new Map,r=new Map;for(let s=0;s<n.length;s++){const o=n[s],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=o.settings;De(Fb,this).has(o)||(De(Fb,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const h=this.getBorderInstance(o);if(o.isEmpty()){h?.disappear();continue}a&&De(Lb,this).setActiveSelection(o).scan().forEach(g=>{if(i.has(g)){const m=i.get(g);m.has(a)&&u===!0?m.set(a,m.get(a)+1):m.set(a,1)}else i.set(g,new Map([[a,1]]));l&&(r.has(g)||r.set(g,[]),g.nodeName==="TH"&&r.get(g).push(...l))});const d=o.getCorners();De(Ln,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}i.forEach((s,o)=>{var a;const l=Array.from(s).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>De(hd,this).get(De(Ln,this)).add(u)),K(o,l),o.nodeName==="TD"&&Array.isArray((a=De(vi,this).options)===null||a===void 0?void 0:a.cellAttributes)&&ve(o,De(vi,this).options.cellAttributes)}),Array.from(r.keys()).forEach(s=>{ve(s,[...r.get(s)])})}}function BX(){const t=De(hd,this).get(De(Ln,this)),e=De(Ln,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var i,r;const s=De(Ln,this).wtTable.TABLE.querySelectorAll(`.${n}`);let o=[];Array.isArray((i=De(vi,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(o=De(vi,this).options.cellAttributes.map(a=>a[0])),Array.isArray((r=De(vi,this).options)===null||r===void 0?void 0:r.headerAttributes)&&(o=[...o,...De(vi,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)me(s[a],n),iu(s[a],o)}),t.clear()}class jX extends Bf{constructor(e,n,i,r){super(e,n,Ul,i,r)}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new TE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===n&&(!r||r!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),Yw(i,`${s}px`,"0px")):(s=this.getScrollPosition(),Lf(i));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;this.isRtl()&&(e=-e);const r=this.mainTableScrollableElement;if(r===n&&e!==n.scrollX){const s=n.scrollX;n.scrollTo(e,iE(n)),i=s!==n.scrollX}else if(e!==r.scrollLeft){const s=r.scrollLeft;r.scrollLeft=e,i=s!==r.scrollLeft}return i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,s=0;for(;r<n;)s+=this.wot.wtTable.getColumnWidth(r)||i,r+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=Cn(i)),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=Gt(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=PE(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),s=i.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&r.length>0&&!ye(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=Cn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,qF(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(rE(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=r-s;i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),o=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";o?me(i,"emptyRows"):K(i,"emptyRows");let l=!1;if(!a){if(s&&!r.length)K(i,"innerBorderLeft innerBorderInlineStart");else if(!s&&r.length){const u=ye(i,"innerBorderInlineStart");e?(K(i,"innerBorderLeft innerBorderInlineStart"),l=!u):(me(i,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const zX="stickyRowsTop",OE={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ds(OE,"MIXIN_NAME",zX,{writable:!1,enumerable:!1});class AE extends zc{constructor(e,n,i,r){super(e,n,i,r,Yl)}}ht(AE,OE);ht(AE,Zw);function OA(t,e,n){return(e=UX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UX(t){var e=YX(t,"string");return typeof e=="symbol"?e:e+""}function YX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GX extends Bf{constructor(e,n,i,r,s,o){super(e,n,Yl,i,r),OA(this,"topOverlay",void 0),OA(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new AE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();Yw(e,`${r}px`,`${s}px`)}else Lf(e);let n=en(this.clone.wtTable.TABLE);const i=Gt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}}class HE extends zc{constructor(e,n,i,r){super(e,n,i,r,zl)}}ht(HE,OE);ht(HE,Qw);function qX(t,e,n){return(e=KX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KX(t){var e=XX(t,"string");return typeof e=="symbol"?e:e+""}function XX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZX extends Bf{constructor(e,n,i,r){super(e,n,zl,i,r),qX(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new HE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,s=!1;if(this.trimmingContainer===n&&(!i||i!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;s=u===c,r=this.getOverlayOffset(),Yw(e,"0px",`${r}px`)}else r=this.getScrollPosition(),Lf(e);const o=this.adjustHeaderBordersPosition(r,s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const s=n.scrollY;n.scrollTo(zw(n),e),r=s!==n.scrollY}else if(e!==i.scrollTop){const s=i.scrollTop;i.scrollTop=e,r=s!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let r=e,s=0;for(;r<n;){const o=this.wot.wtTable.getRowHeight(r);s+=o===void 0?i:o,r+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Cn(i)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=en(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=PE(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:i,wtSettings:r}=this,o=(i.cloneSource?i.cloneSource:i).wtTable.holder,a=r.getSetting("columnHeaders"),u=r.getSetting("fixedRowsTop")===0&&a.length>0&&!ye(o.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&o.offsetHeight!==o.clientHeight&&(h=Cn(this.domBindings.rootDocument)),n){const d=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=i.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return c+=h,GF(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Uw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=r-s;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,s=i.getSetting("totalColumns"),o=i.getSetting("preventOverflow")==="horizontal";s?me(r,"emptyColumns"):K(r,"emptyColumns");let a=!1;if(!n&&!o){const l=i.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=i.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ye(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(K(r,"innerBorderTop"),a=!h):(me(r,"innerBorderTop"),a=h)}}return a}}function mg(t,e,n){QX(t,e),e.set(t,n)}function QX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ws(t,e,n){return(e=JX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JX(t){var e=e4(t,"string");return typeof e=="symbol"?e:e+""}function e4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $a(t,e,n){return t.set(I$(t,e),n),n}function Bs(t,e){return t.get(I$(t,e))}function I$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wu=new WeakMap,pg=new WeakMap,vu=new WeakMap,wg=new WeakMap;class t4{constructor(e,n,i,r,s,o){Ws(this,"wot",null),mg(this,wu,[]),Ws(this,"topOverlay",null),Ws(this,"bottomOverlay",null),Ws(this,"inlineStartOverlay",null),Ws(this,"topInlineStartCornerOverlay",null),Ws(this,"bottomInlineStartCornerOverlay",null),Ws(this,"browserLineHeight",void 0),Ws(this,"wtSettings",null),mg(this,pg,!1),mg(this,vu,0),mg(this,wg,null),Ws(this,"resizeObserver",new ResizeObserver(c=>{Jd(()=>{!Array.isArray(c)||!c.length||($a(vu,this,Bs(vu,this)+1),Bs(vu,this)===100&&(Je("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Bs(wg,this)!==null&&clearTimeout(Bs(wg,this)),$a(wg,this,setTimeout(()=>{$a(vu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=n,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=Cn(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:tf(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Bs(wu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,i=e.getComputedStyle(n.body),r=parseInt(i.lineHeight,10),s=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new ZX(...e),this.bottomOverlay=new PX(...e),this.inlineStartOverlay=new jX(...e),this.topInlineStartCornerOverlay=new GX(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new _X(...e,this.bottomOverlay,this.inlineStartOverlay),$a(wu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){$a(pg,this,Bs(wu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Bs(wu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Bs(wu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=n.devicePixelRatio&&n.devicePixelRatio>1,o=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!J_())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Jd(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{$a(vu,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(r!==n&&s!==n&&!e.target.contains(r)||i!==n&&s!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==i&&o!==i&&!o.contains(s),l=r!==i&&o!==i&&!o.contains(r);if(this.keyPressed&&(a||l)||this.scrollableElement===i)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=jc(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);const r=this.scrollVertically(n),s=this.scrollHorizontally(i);return r||s}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let i=this.scrollableElement.scrollLeft,r=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(i=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(r=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==i,this.verticalScrolling=this.lastScrollY!==r,this.lastScrollX=i,this.lastScrollY=r,this.horizontalScrolling){e.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!Bs(pg,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),$a(pg,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=tf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,i=e.clientHeight,r=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,s),d=n.hider.style,f=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),m=f()?1:0,v=g()?1:0;d.width=`${c+v}px`,d.height=`${u+m}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return A(n,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];A(n,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function AA(t,e,n){return(e=n4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n4(t){var e=i4(t,"string");return typeof e=="symbol"?e:e+""}function i4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class r4{constructor(e){AA(this,"settings",{}),AA(this,"defaults",Object.freeze(this.getDefaults())),He(this.defaults,(n,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(n===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,i)=>{const r=this.getSetting("data",e,n);Ra(i,r??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?He(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=n,this}getSetting(e,n,i,r,s){return typeof this.settings[e]=="function"?this.settings[e](n,i,r,s):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class DE extends zc{constructor(e,n,i,r){super(e,n,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=_c(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=nf(e,"height",n),s=nf(e,"overflow",n),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?i.insertBefore(d,e.nextElementSibling):i.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);i.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),o.height=r==="auto"?"auto":`${c}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Bl(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,i="master",s=e.getSetting("columnHeaders").length;if(s&&!n.hasOversizedColumnHeadersMarked[i]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[i]=!0}}}ht(DE,EE);ht(DE,Qw);class s4{constructor(e,n,i,r,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=i,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new L3:new j3],["fullyVisible",()=>new M3],["partiallyVisible",()=>new w$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new D3:new V3],["fullyVisible",()=>new _3],["partiallyVisible",()=>new p$]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return n===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=en(n)>0&&n.clientHeight>0?n.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(i===n){const s=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>r&&(r=e.documentElement.clientWidth)}else r=i.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollHeight>s.clientHeight}const{holder:e,hider:n}=this.wtTable,i=e.clientHeight,r=n.offsetHeight;return i<r?!0:r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollWidth>s.clientWidth}const{holder:e,hider:n}=this.wtTable,i=e.clientWidth,r=n.offsetWidth;return i<r?!0:r>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let i=0,r=e;for(;r<n;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getWorkspaceOffset(){return xn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=en(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=n.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,s=n.length;r<s;r++)i?(this.rowHeaderWidth+=Gt(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,r-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),r-=o),i.holder.clientHeight===i.holder.offsetHeight?s=0:s=Cn(this.domBindings.rootDocument),new Z3({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:r,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>i.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=n.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,r-=a}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=Cn(this.domBindings.rootDocument)),new q3({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:r,scrollOffset:s,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>i.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!n.getSetting("renderAllColumns")){const s=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:r,endRow:s,rowStartOffset:o,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(o,u)),i=Math.min(l,i+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(o/2)),i=Math.min(l,i+Math.ceil(a/2))),n<r||n===r&&n>0?!1:!(i>s||i===s&&i<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:r,endColumn:s,columnStartOffset:o,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(o,u)),i=Math.min(l,i+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(o/2)),i=Math.min(l,i+Math.ceil(a/2))),n<r||n===r&&n>0?!1:!(i>s||i===s&&i<l)}resetHasOversizedColumnHeadersMarked(){He(this.hasOversizedColumnHeadersMarked,(e,n,i)=>{i[n]=void 0})}}class o4 extends RE{constructor(e,n){super(e,new r4(n));const i=this.wtSettings.getSetting("facade",this);this.wtTable=new DE(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new s4(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new WX(this.wtSettings.getSetting("selections")),this.wtEvent=new S$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new t4(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],i=[];He(e,(r,s)=>{this.wtSettings.getSetting(s).length&&i.push(r),n.push(r)}),me(this.wtTable.wtRootElement.parentNode,n),K(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var n;if(!E$.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(n=this.wtOverlays[`${i}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class NE{constructor(e){e instanceof RE?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const i=new NE(n);return()=>i},this._wot=new o4(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,i){return this._wot.createCellRange(e,n,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,i){return this._wot.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,i,r,s){return this._wot.wtSettings.getSetting(e,n,i,r,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function HA(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:r,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),c=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)r.row>=0&&r.col>=0&&!o.cell?s.setRangeEnd(r):(u||c)&&r.row>=0&&r.col>=0&&!o.cell?s.setRangeEnd(a(r.row,r.col)):u&&r.row<0&&!o.column?s.setRangeEnd(a(l.to.row,r.col)):c&&r.col<0&&!o.row?s.setRangeEnd(a(r.row,l.to.col)):(!u&&!c&&r.col<0||u&&r.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),r.row,r.col):(!u&&!c&&r.row<0||c&&r.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),r.col,r.row);else{const h=!s.inInSelection(r),d=n||i&&h;r.row<0&&r.col>=0&&!o.column?d&&s.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!o.row?d&&s.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!o.cell?d&&s.setRangeStart(r):r.col<0&&r.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function a4(t){let{isLeftClick:e,coords:n,selection:i,controller:r,cellCoordsFactory:s}=t;if(!e)return;const o=i.isSelectedByRowHeader(),a=i.isSelectedByColumnHeader(),l=i.tableProps.countCols(),u=i.tableProps.countRows();i.markSource("mouse"),a&&!r.column?i.setRangeEnd(s(u-1,n.col)):o&&!r.row?i.setRangeEnd(s(n.row,l-1)):r.cell||i.setRangeEnd(n),i.markEndSource()}function l4(t){let{isLeftClick:e,selection:n,cellRangeMapper:i}=t;if(!e||n.settings.selectionMode!=="multiple")return;const r=n.getSelectedRange(),s=r.clone().map(a=>i.toRenderable(a)),o=s.current();if(s.size()>1&&!o.isHeader()&&!n.isMultiple(o)){const a=s.findAll(o);a.length===s.size()?(r.pop(),n.refresh()):a.length>1&&(r.removeLayers(a.map(l=>{let{layer:u}=l;return u})),n.refresh())}}const u4=new Map([["touchstart",HA],["mousedown",HA],["mouseover",a4],["mouseup",l4]]);function $b(t,e){u4.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:qw(t)||t.type==="touchstart",isRightClick:_a(t),...e})}const O$=new WeakMap,kE=Symbol("rootInstance");function c4(t){O$.set(t,!0)}function h4(t){return t===kE}function Ju(t){return O$.has(t)}function d4(t,e){A$(t,e),e.add(t)}function Ao(t,e,n){A$(t,e),e.set(t,n)}function A$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ho(t,e,n){return(e=f4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f4(t){var e=g4(t,"string");return typeof e=="symbol"?e:e+""}function g4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kt(t,e){return t.get(wc(t,e))}function ui(t,e,n){return t.set(wc(t,e),n),n}function wc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vb=new WeakMap,vg=new WeakMap,yg=new WeakMap,js=new WeakMap,Rr=new WeakMap,Wb=new WeakMap,Bb=new WeakMap,yu=new WeakMap,dd=new WeakSet;class m4{constructor(e){d4(this,dd),Ho(this,"hot",void 0),Ho(this,"eventManager",void 0),Ho(this,"settings",void 0),Ho(this,"THEAD",void 0),Ho(this,"TBODY",void 0),Ho(this,"_wt",void 0),Ho(this,"activeWt",void 0),Ao(this,Vb,0),Ao(this,vg,0),Ho(this,"postponedAdjustElementsSize",!1),Ao(this,yg,!1),Ao(this,js,void 0),Ao(this,Rr,void 0),Ao(this,Wb,0),Ao(this,Bb,0),Ao(this,yu,null),this.hot=e,this.eventManager=new cr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),wc(dd,this,w4).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const i=this._wt.getCell(e,n);return i<0?null:i}scrollViewport(e,n,i){return this._wt.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),K(e,"handsontable"),ui(Rr,this,n.createElement("TABLE")),K(Kt(Rr,this),"htCore"),this.hot.getSettings().tableClassName&&K(Kt(Rr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(ve(Kt(Rr,this),[fo()]),ve(e,[yq(),MF(-1),Ww(this.hot.countCols()),Dq()])),this.THEAD=n.createElement("THEAD"),Kt(Rr,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Kt(Rr,this).appendChild(this.TBODY),this.hot.table=Kt(Rr,this),this.hot.container.insertBefore(Kt(Rr,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:i,rootWindow:r}=this.hot,s=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{ui(yg,this,!0),this.isTextSelectionAllowed(a.target)||(c0(r),a.preventDefault(),r.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{ui(yg,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Kt(yg,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&c0(r),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{i.isInProgress()&&!a.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{i.isInProgress()&&qw(a)&&i.finish(),ui(js,this,!1);const l=Gw(n.activeElement);Ed(n.activeElement)&&!l||(l||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(a.target)&&!_a(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{i.isInProgress()&&_a(a)&&(i.finish(),ui(js,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),ui(js,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Kt(js,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=Cn(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==s;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=Wl(r);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=Wl(o);this.eventManager.addEventListener(Kt(Rr,this),"selectstart",a=>{this.settings.fragmentSelection||Ed(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,i))}translateFromRenderableToVisualIndex(e,n){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),r===null&&(r=n),[i,r]}countRenderableIndexes(e,n){const i=Math.min(e.getNotTrimmedIndexesLength(),n),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,i,r){if(isNaN(e)||e<0)return 0;const s=i.getNearestNotHiddenIndex(e,n),o=i.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return n<0?a=o+1:n>0&&(a=r-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}addClassNameToLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&K(i,e)}removeClassNameFromLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&me(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Kt(Rr,this),isDataViewInstance:()=>Ju(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),ui(vg,this,s.length),this.hot.getSettings().ariaTags&&wc(dd,this,H$).call(this)===this.hot.countCols()&&wc(dd,this,p4).call(this,Kt(vg,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),ui(Vb,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(s,o),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let m=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(m=this.hot.runHooks("beforeValueRender",m,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,m,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,m,f),this.hot.runHooks("afterRenderer",a,l,u,g,m,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Bl(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,ui(js,this,!0),ui(yu,this,{x:s.clientX,y:s.clientY}),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,c),!ia(s)&&($b(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,ui(js,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!ia(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!ia(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,c),!ia(s)&&(Kt(js,this)&&(!Kt(yu,this)||Kt(yu,this).x!==s.clientX||Kt(yu,this).y!==s.clientY)&&$b(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt,ui(yu,this,null))},onCellMouseUp:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(ia(s)||this.hot.isDestroyed)&&($b(s,{coords:u,selection:this.hot.selection,cellRangeMapper:TK(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,o)=>{const a=this.hot.rowIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollVertically",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(s,o)=>{const a=this.hot.columnIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,u,c]=s,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=o>=0?c.getVisualFromRenderableIndex(o):o,d=s>=0?u.getVisualFromRenderableIndex(s):s,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,m,v,S]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,m>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(m,1)):m,v>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(v,-1)):v,S>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(S,-1)):S]}},onModifyGetCoordsElement:(s,o)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=o>=0?l.getVisualFromRenderableIndex(o):o,c=s>=0?a.getVisualFromRenderableIndex(s):s,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const c=Math.max(1,Math.ceil(u/a*12));s.startRow=Math.max(l-c,0),s.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const c=Math.max(1,Math.ceil(u/a*6));s.startColumn=Math.max(l-c,0),s.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new NE(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(n,"mousedown",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Ed(e))return!0;const n=pa(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Kt(js,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const i=n.firstChild;if(!ye(i,"relative")){Ps(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,s=i.createElement("div"),o=i.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,r),s.appendChild(o),n.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(n.firstChild){const o=n.firstChild;ye(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,i,r),o.className="",K(o,["relative",...s()])):(Ps(n),this.appendColHeader(e,n,i,r))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(ve(a,...fo()),ve(l,...fo())),this.updateCellHeader(l,e,i,r),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,r)}updateCellHeader(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=n;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ye(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(n):ye(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(n))),s>-1?ru(e,i(n,r)):(Ra(e,"Â "),K(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,n){ui(Wb,this,e),ui(Bb,this,n)}getLastSize(){return{width:Kt(Wb,this),height:Kt(Bb,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Kt(Vb,this)}getRowHeadersCount(){return Kt(vg,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function H$(){return parseInt(this.hot.rootElement.getAttribute(Ww()[0]),10)}function p4(t){const e=wc(dd,this,H$).call(this)+t;ve(this.hot.rootElement,...Ww(e))}function w4(){const t=this.hot.rootElement;this.hasVerticalScroll()?K(t,"htHasScrollY"):me(t,"htHasScrollY"),this.hasHorizontalScroll()?K(t,"htHasScrollX"):me(t,"htHasScrollX")}var DA={},NA={},kA;function v4(){if(kA)return NA;kA=1;var t=wt(),e=cn(),n=Fc(),i=Ti(),r=dn(),s=Os(),o=Mi(),a=Ia(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){r(this);try{i(c)}catch(f){o(this,"throw",f)}if(l)return e(l,this,c);var h=s(this),d=0;return!n(h,function(f,g){if(!c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),NA}var LA;function y4(){return LA||(LA=1,v4()),DA}y4();const D$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",y0=D$.length;function Jw(t){let e=t+1,n="",i;for(;e>0;)i=(e-1)%y0,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/y0,10);return n}function C4(t){let e=0;if(t)for(let n=0,i=t.length-1;n<t.length;n+=1,i-=1)e+=y0**i*(D$.indexOf(t[n])+1);return e-=1,e}function b4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let i,r;for(i=0;i<t;i++){const s=[];for(r=0;r<e;r++)s.push(Jw(r)+(i+1));n.push(s)}return n}function S4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let i,r;for(i=0;i<t;i++){const s={};for(r=0;r<e;r++)s[`prop${r}`]=Jw(r)+(i+1);n.push(s)}return n}function R4(t,e){const n=[];let i;for(let r=0;r<t;r++){i=[];for(let s=0;s<e;s++)i.push("");n.push(i)}return n}function LE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((r,s)=>{Array.isArray(r)?r.forEach((o,a)=>{i.push([s+e,a,o])}):Object.keys(r).forEach(o=>{i.push([s+e,o,r[o]])})}),i}function FE(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ae(t[0])&&(e=jw(t[0]))),e}function N$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function k$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const _4=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:FE,createEmptySpreadsheetData:R4,createSpreadsheetData:b4,createSpreadsheetObjectData:S4,dataRowToChangesArray:LE,isArrayOfArrays:N$,isArrayOfObjects:k$,spreadsheetColumnIndex:C4,spreadsheetColumnLabel:Jw},Symbol.toStringTag,{value:"Module"}));function Ch(t,e,n){return(e=E4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E4(t){var e=T4(t,"string");return typeof e=="symbol"?e:e+""}function T4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Ch(this,"hot",void 0),Ch(this,"data",void 0),Ch(this,"dataType","array"),Ch(this,"colToProp",()=>{}),Ch(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return A(this.data,(i,r)=>{const s=this.getAtCell(r,e);n.push(s)}),n}getAtRow(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=n===void 0&&i===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):de(n,i,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(Ae(a)||st(a))if(r?l=[]:l={},!s||r){const c=this.countFirstRowKeys()-1;de(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(i||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);r?l.push(f):o?tp(l,d,f):l[d]=f}})}else He(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);o?tp(l,c,h):l[c]=h});return l}setAtCell(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=Ei(i);this.hot.runHooks("modifySourceData",e,n,r,"set"),r.isTouched()&&(i=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=i:tp(this.data[e],n,i))}}getAtPhysicalCell(e,n,i){let r=null;if(i)if(typeof n=="string"){const{dataDotNotation:s}=this.hot.getSettings();r=s?OF(i,n):i[n]}else typeof n=="function"?r=n(i):r=i[n];if(this.hot.hasHook("modifySourceData")){const s=Ei(r);this.hot.runHooks("modifySourceData",e,n,s,"get"),s.isTouched()&&(r=s.value)}return r}getAtCell(e,n){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,s=null,o=null,a=null,l=null;e===null||n===null?(r=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,n.row),o=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return de(s,a,c=>{u.push(r?this.getAtRow(c,void 0,void 0,i):this.getAtRow(c,o,l,i))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return FE(this.data)}destroy(){this.data=null,this.hot=null}}var FA={},$A={},VA;function x4(){if(VA)return $A;VA=1;var t=wt(),e=cn(),n=Fc(),i=Ti(),r=dn(),s=Os(),o=Mi(),a=Ia(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){r(this);try{i(c)}catch(f){o(this,"throw",f)}if(l)return e(l,this,c);var h=s(this),d=0;return n(h,function(f,g){if(c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),$A}var WA;function P4(){return WA||(WA=1,x4()),FA}P4();function BA(t,e,n){return(e=I4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I4(t){var e=O4(t,"string");return typeof e=="symbol"?e:e+""}function O4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class su{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;BA(this,"indexedValues",[]),BA(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,st(this.initValueOrFn)?de(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):de(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ht(su,In);function $E(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((s,o)=>st(i)?i(s,o):i),...r===void 0?[]:t.slice(r)]}function VE(t,e){return ba(t,(n,i)=>e.includes(i)===!1)}class Aa extends su{insert(e,n){this.indexedValues=$E(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=VE(this.indexedValues,e),super.remove(e)}}class ev extends Aa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return fn(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}function WE(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function rf(t,e){return ba(t,n=>e.includes(n)===!1)}function BE(t,e){return Ve(t,n=>n-e.filter(i=>i<n).length)}function jE(t,e){const n=e[0],i=e.length;return Ve(t,r=>r>=n?r+i:r)}function A4(t,e,n){return(e=H4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H4(t){var e=D4(t,"string");return typeof e=="symbol"?e:e+""}function D4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tv extends su{constructor(){super(...arguments),A4(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=rf(this.orderOfIndexes,[e]),st(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=$E(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=jE(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=VE(this.indexedValues,e),this.orderOfIndexes=rf(this.orderOfIndexes,e),this.orderOfIndexes=BE(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class jf extends Aa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return fn(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}const jA=new Map([["indexesSequence",{getListWithInsertedItems:WE,getListWithRemovedItems:rf}],["physicallyIndexed",{getListWithInsertedItems:$E,getListWithRemovedItems:VE}]]),L$=t=>{if(jA.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return jA.get(t)};class F$ extends su{constructor(){super(e=>e)}insert(e,n){const i=jE(this.indexedValues,n);this.indexedValues=WE(i,e,n),super.insert(e,n)}remove(e){const n=rf(this.indexedValues,e);this.indexedValues=BE(n,e),super.remove(e)}}const zA=new Map([["hiding",ev],["index",su],["linkedPhysicalIndexToValue",tv],["physicalIndexToValue",Aa],["trimming",jf]]);function N4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!zA.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(zA.get(t))(e)}function k4(t,e,n){return(e=L4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L4(t){var e=F4(t,"string");return typeof e=="symbol"?e:e+""}function F4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let C0=0;class zE{constructor(){k4(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),C0+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),C0-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Mt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(i=>{i.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}ht(zE,In);function $4(){return C0}function jb(t,e,n){return(e=V4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V4(t){var e=W4(t,"string");return typeof e=="symbol"?e:e+""}function W4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UA extends zE{constructor(e,n){super(),jb(this,"mergedValuesCache",[]),jb(this,"aggregationFunction",void 0),jb(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ve(this.get(),s=>s.getValues()),i=[],r=le(n[0])&&n[0].length||0;for(let s=0;s<r;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(n[a][s]);i.push(o)}return Ve(i,this.aggregationFunction)}getMergedValueAtIndex(e,n){const i=this.getMergedValues(n)[e];return le(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function B4(t,e,n){j4(t,e),e.set(t,n)}function j4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z4(t,e,n){return t.set($$(t,e),n),n}function U4(t,e){return t.get($$(t,e))}function $$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zb=new WeakMap;class V${constructor(){B4(this,zb,[])}subscribe(e){return this.addLocalHook("change",e),this._write(U4(zb,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){z4(zb,this,e)}}ht(V$,In);function YA(t,e){const n=[];let i=0,r=0;for(;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function bh(t,e,n){Y4(t,e),e.set(t,n)}function Y4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gi(t,e){return t.get(W$(t,e))}function Cg(t,e,n){return t.set(W$(t,e),n),n}function W$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bg=new WeakMap,Sh=new WeakMap,Sg=new WeakMap,Rg=new WeakMap,_g=new WeakMap;class G4{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bh(this,bg,new Set),bh(this,Sh,[]),bh(this,Sg,[]),bh(this,Rg,!1),bh(this,_g,!1),Cg(_g,this,e??!1)}createObserver(){const e=new V$;return Gi(bg,this).add(e),e.addLocalHook("unsubscribe",()=>{Gi(bg,this).delete(e)}),e._writeInitialChanges(YA(Gi(Sh,this),Gi(Sg,this))),e}emit(e){let n=Gi(Sg,this);(!Gi(Rg,this)||Gi(Sh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Gi(_g,this)):Cg(Sh,this,new Array(e.length).fill(Gi(_g,this))),Gi(Rg,this)||(Cg(Rg,this,!0),n=Gi(Sh,this)));const i=YA(n,e);Gi(bg,this).forEach(r=>r._write(i)),Cg(Sg,this,e)}}function Kn(t,e,n){return(e=q4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q4(t){var e=K4(t,"string");return typeof e=="symbol"?e:e+""}function K4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b0{constructor(){Kn(this,"indexesSequence",new F$),Kn(this,"trimmingMapsCollection",new UA(e=>e.some(n=>n===!0),!1)),Kn(this,"hidingMapsCollection",new UA(e=>e.some(n=>n===!0),!1)),Kn(this,"variousMapsCollection",new zE),Kn(this,"hidingChangesObservable",new G4({initialIndexValue:!1})),Kn(this,"notTrimmedIndexesCache",[]),Kn(this,"notHiddenIndexesCache",[]),Kn(this,"isBatched",!1),Kn(this,"indexesSequenceChanged",!1),Kn(this,"indexesChangeSource",void 0),Kn(this,"trimmedIndexesChanged",!1),Kn(this,"hiddenIndexesChanged",!1),Kn(this,"renderablePhysicalIndexesCache",[]),Kn(this,"fromPhysicalToVisualIndexesCache",new Map),Kn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,i){return this.registerMap(e,N4(n,i))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof jf?this.trimmingMapsCollection.register(e,n):n instanceof ev?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const i=this.getNumberOfIndexes();return i>0&&n.init(i),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return n>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?i?this.getNearestNotHiddenIndex(e,-n,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const i=Ve(e,u=>this.getPhysicalFromVisualIndex(u)),r=this.getNotTrimmedIndexesLength(),s=e.length,o=rf(this.getIndexesSequence(),i),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(n+s<r){const u=a[n];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(WE(o,l,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const r=this.getNotTrimmedIndexes()[e],s=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),a=Ve(new Array(n).fill(s),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0;const l=i==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(o,l),this.hidingMapsCollection.insertToEvery(o,l),this.variousMapsCollection.insertToEvery(o,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromRenderableIndex(n),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,n)}}}ht(b0,In);function X4(t,e){return He(e,(n,i)=>{Mt(t[i])&&(t[i]=n)}),t}function B$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function j$(t){le(t)&&mE(ot`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Z4(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:Q4,getValues:J4}=vr("phraseFormatters");function e6(t,e){Q4(t,e)}function t6(){return J4()}e6("pluralize",Z4);const z$="ContextMenu:items",Te=z$,UE=`${Te}.noItems`,YE=`${Te}.insertRowAbove`,GE=`${Te}.insertRowBelow`,qE=`${Te}.insertColumnOnTheLeft`,KE=`${Te}.insertColumnOnTheRight`,XE=`${Te}.removeRow`,ZE=`${Te}.removeColumn`,QE=`${Te}.undo`,JE=`${Te}.redo`,Dp=`${Te}.readOnly`,eT=`${Te}.clearColumn`,tT=`${Te}.copy`,nT=`${Te}.copyWithHeaders`,iT=`${Te}.copyWithGroupHeaders`,rT=`${Te}.copyHeadersOnly`,sT=`${Te}.cut`,oT=`${Te}.freezeColumn`,aT=`${Te}.unfreezeColumn`,lT=`${Te}.mergeCells`,uT=`${Te}.unmergeCells`,cT=`${Te}.addComment`,hT=`${Te}.editComment`,dT=`${Te}.removeComment`,fT=`${Te}.readOnlyComment`,gT=`${Te}.align`,mT=`${Te}.align.left`,pT=`${Te}.align.center`,wT=`${Te}.align.right`,vT=`${Te}.align.justify`,yT=`${Te}.align.top`,CT=`${Te}.align.middle`,bT=`${Te}.align.bottom`,ST=`${Te}.borders`,RT=`${Te}.borders.top`,_T=`${Te}.borders.right`,ET=`${Te}.borders.bottom`,TT=`${Te}.borders.left`,MT=`${Te}.borders.remove`,xT=`${Te}.nestedHeaders.insertChildRow`,PT=`${Te}.nestedHeaders.detachFromParent`,IT=`${Te}.hideColumn`,OT=`${Te}.showColumn`,AT=`${Te}.hideRow`,HT=`${Te}.showRow`,si="Filters:",Bt=`${si}conditions`,nv=`${Bt}.none`,DT=`${Bt}.isEmpty`,NT=`${Bt}.isNotEmpty`,kT=`${Bt}.isEqualTo`,LT=`${Bt}.isNotEqualTo`,FT=`${Bt}.beginsWith`,$T=`${Bt}.endsWith`,VT=`${Bt}.contains`,WT=`${Bt}.doesNotContain`,n6=`${Bt}.byValue`,BT=`${Bt}.greaterThan`,jT=`${Bt}.greaterThanOrEqualTo`,zT=`${Bt}.lessThan`,UT=`${Bt}.lessThanOrEqualTo`,YT=`${Bt}.isBetween`,GT=`${Bt}.isNotBetween`,qT=`${Bt}.after`,KT=`${Bt}.before`,XT=`${Bt}.today`,ZT=`${Bt}.tomorrow`,QT=`${Bt}.yesterday`,JT=`${si}labels.filterByCondition`,eM=`${si}labels.filterByValue`,tM=`${si}labels.conjunction`,iv=`${si}labels.disjunction`,Np=`${si}values.blankCells`,nM=`${si}buttons.selectAll`,iM=`${si}buttons.clear`,rM=`${si}buttons.ok`,sM=`${si}buttons.cancel`,oM=`${si}buttons.placeholder.search`,aM=`${si}buttons.placeholder.value`,lM=`${si}buttons.placeholder.secondValue`,uM="CheckboxRenderer:",cM=`${uM}checked`,hM=`${uM}unchecked`,i6=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:cM,CHECKBOX_RENDERER_NAMESPACE:uM,CHECKBOX_UNCHECKED:hM,CONTEXTMENU_ITEMS_ADD_COMMENT:cT,CONTEXTMENU_ITEMS_ALIGNMENT:gT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:bT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:pT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:vT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:mT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:CT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:wT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:yT,CONTEXTMENU_ITEMS_BORDERS:ST,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:ET,CONTEXTMENU_ITEMS_BORDERS_LEFT:TT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:_T,CONTEXTMENU_ITEMS_BORDERS_TOP:RT,CONTEXTMENU_ITEMS_CLEAR_COLUMN:eT,CONTEXTMENU_ITEMS_COPY:tT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:rT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:iT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:nT,CONTEXTMENU_ITEMS_CUT:sT,CONTEXTMENU_ITEMS_EDIT_COMMENT:hT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:oT,CONTEXTMENU_ITEMS_HIDE_COLUMN:IT,CONTEXTMENU_ITEMS_HIDE_ROW:AT,CONTEXTMENU_ITEMS_INSERT_LEFT:qE,CONTEXTMENU_ITEMS_INSERT_RIGHT:KE,CONTEXTMENU_ITEMS_MERGE_CELLS:lT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:PT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:xT,CONTEXTMENU_ITEMS_NO_ITEMS:UE,CONTEXTMENU_ITEMS_READ_ONLY:Dp,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:fT,CONTEXTMENU_ITEMS_REDO:JE,CONTEXTMENU_ITEMS_REMOVE_BORDERS:MT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:ZE,CONTEXTMENU_ITEMS_REMOVE_COMMENT:dT,CONTEXTMENU_ITEMS_REMOVE_ROW:XE,CONTEXTMENU_ITEMS_ROW_ABOVE:YE,CONTEXTMENU_ITEMS_ROW_BELOW:GE,CONTEXTMENU_ITEMS_SHOW_COLUMN:OT,CONTEXTMENU_ITEMS_SHOW_ROW:HT,CONTEXTMENU_ITEMS_UNDO:QE,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:aT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:uT,CONTEXT_MENU_ITEMS_NAMESPACE:z$,FILTERS_BUTTONS_CANCEL:sM,FILTERS_BUTTONS_CLEAR:iM,FILTERS_BUTTONS_OK:rM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:oM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:lM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:aM,FILTERS_BUTTONS_SELECT_ALL:nM,FILTERS_CONDITIONS_AFTER:qT,FILTERS_CONDITIONS_BEFORE:KT,FILTERS_CONDITIONS_BEGINS_WITH:FT,FILTERS_CONDITIONS_BETWEEN:YT,FILTERS_CONDITIONS_BY_VALUE:n6,FILTERS_CONDITIONS_CONTAINS:VT,FILTERS_CONDITIONS_EMPTY:DT,FILTERS_CONDITIONS_ENDS_WITH:$T,FILTERS_CONDITIONS_EQUAL:kT,FILTERS_CONDITIONS_GREATER_THAN:BT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:jT,FILTERS_CONDITIONS_LESS_THAN:zT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:UT,FILTERS_CONDITIONS_NAMESPACE:Bt,FILTERS_CONDITIONS_NONE:nv,FILTERS_CONDITIONS_NOT_BETWEEN:GT,FILTERS_CONDITIONS_NOT_CONTAIN:WT,FILTERS_CONDITIONS_NOT_EMPTY:NT,FILTERS_CONDITIONS_NOT_EQUAL:LT,FILTERS_CONDITIONS_TODAY:XT,FILTERS_CONDITIONS_TOMORROW:ZT,FILTERS_CONDITIONS_YESTERDAY:QT,FILTERS_DIVS_FILTER_BY_CONDITION:JT,FILTERS_DIVS_FILTER_BY_VALUE:eM,FILTERS_LABELS_CONJUNCTION:tM,FILTERS_LABELS_DISJUNCTION:iv,FILTERS_NAMESPACE:si,FILTERS_VALUES_BLANK_CELLS:Np},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const U$={languageCode:"en-US",[UE]:"No available options",[YE]:"Insert row above",[GE]:"Insert row below",[qE]:"Insert column left",[KE]:"Insert column right",[XE]:["Remove row","Remove rows"],[ZE]:["Remove column","Remove columns"],[QE]:"Undo",[JE]:"Redo",[Dp]:"Read only",[eT]:"Clear column",[gT]:"Alignment",[mT]:"Left",[pT]:"Center",[wT]:"Right",[vT]:"Justify",[yT]:"Top",[CT]:"Middle",[bT]:"Bottom",[oT]:"Freeze column",[aT]:"Unfreeze column",[ST]:"Borders",[RT]:"Top",[_T]:"Right",[ET]:"Bottom",[TT]:"Left",[MT]:"Remove border(s)",[cT]:"Add comment",[hT]:"Edit comment",[dT]:"Delete comment",[fT]:"Read-only comment",[lT]:"Merge cells",[uT]:"Unmerge cells",[tT]:"Copy",[nT]:["Copy with header","Copy with headers"],[iT]:["Copy with group header","Copy with group headers"],[rT]:["Copy header only","Copy headers only"],[sT]:"Cut",[xT]:"Insert child row",[PT]:"Detach from parent",[IT]:["Hide column","Hide columns"],[OT]:["Show column","Show columns"],[AT]:["Hide row","Hide rows"],[HT]:["Show row","Show rows"],[nv]:"None",[DT]:"Is empty",[NT]:"Is not empty",[kT]:"Is equal to",[LT]:"Is not equal to",[FT]:"Begins with",[$T]:"Ends with",[VT]:"Contains",[WT]:"Does not contain",[BT]:"Greater than",[jT]:"Greater than or equal to",[zT]:"Less than",[UT]:"Less than or equal to",[YT]:"Is between",[GT]:"Is not between",[qT]:"After",[KT]:"Before",[XT]:"Today",[ZT]:"Tomorrow",[QT]:"Yesterday",[Np]:"Blank cells",[JT]:"Filter by condition",[eM]:"Filter by value",[tM]:"And",[iv]:"Or",[nM]:"Select all",[iM]:"Clear",[rM]:"OK",[sM]:"Cancel",[oM]:"Search",[aM]:"Value",[lM]:"Second value",[cM]:"Checked",[hM]:"Unchecked"},r6=i6,S0=U$.languageCode,{register:s6,getItem:Y$,hasItem:o6,getValues:a6}=vr("languagesDictionaries");G$(U$);function G$(t,e){let n=t,i=e;return Ae(t)&&(i=t,n=i.languageCode),l6(n,i),s6(n,Yn(i)),Yn(i)}function l6(t,e){t!==S0&&X4(e,Y$(S0))}function q$(t){return dM(t)?Yn(Y$(t)):null}function dM(t){return o6(t)}function u6(){return a6()}function K$(t,e,n){const i=q$(t);if(i===null)return null;const r=i[e];if(Mt(r))return null;const s=c6(r,n);return Array.isArray(s)?s[0]:s}function c6(t,e){let n=t;return A(t6(),i=>{n=i(t,e)}),n}function h6(t){let e=B$(t);return dM(e)||(e=S0,j$(t)),e}function d6(t,e,n){return(e=f6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f6(t){var e=g6(t,"string");return typeof e=="symbol"?e:e+""}function g6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Po extends T${constructor(e,n){super(e,null),d6(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:i}=e,r=this.getNearestNotHiddenCoords(n,1),s=this.getNearestNotHiddenCoords(i,-1);return r===null||s===null?null:((r.row>s.row||r.col>s.col)&&(r=n,s=i),this.settings.createCellRange(r,r,s))}getNearestNotHiddenCoords(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(r===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return s===null?null:this.settings.createCellCoords(r,s)}getNearestNotHiddenIndex(e,n,i){return n<0?n:e.getNearestNotHiddenIndex(n,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(n,i,r)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(n);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}}function Ub(t){let{activeHeaderClassName:e,...n}=t;return new Po({className:e,...n,selectionType:M$})}function m6(t){let{areaCornerVisible:e,...n}=t;return new Po({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:xE})}function p6(t){let{...e}=t;return new Po({className:"highlight",...e,selectionType:xE})}function w6(t){let{columnClassName:e,...n}=t;return new Po({className:e,...n,selectionType:DX})}function v6(t){let{cellCornerVisible:e,...n}=t;return new Po({className:"current",headerAttributes:[Z_()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Hp})}function y6(t){let{border:e,visualCellRange:n,...i}=t;return new Po({...e,...i,selectionType:NX},n)}function C6(t){let{...e}=t;return new Po({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:AX})}function GA(t){let{headerClassName:e,...n}=t;return new Po({className:e,...n,selectionType:ME})}function b6(t){let{rowClassName:e,...n}=t;return new Po({className:e,...n,selectionType:HX})}function S6(t,e){R6(t,e),e.add(t)}function R6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ci(t,e,n){return(e=_6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _6(t){var e=E6(t,"string");return typeof e=="symbol"?e:e+""}function E6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zr=new WeakSet;class T6{constructor(e){S6(this,Zr),ci(this,"options",void 0),ci(this,"layerLevel",0),ci(this,"focus",void 0),ci(this,"fill",void 0),ci(this,"layeredAreas",new Map),ci(this,"areas",new Map),ci(this,"rowHeaders",new Map),ci(this,"columnHeaders",new Map),ci(this,"activeRowHeaders",new Map),ci(this,"activeColumnHeaders",new Map),ci(this,"activeCornerHeaders",new Map),ci(this,"rowHighlights",new Map),ci(this,"columnHighlights",new Map),ci(this,"customSelections",[]),this.options=e,this.focus=v6(e),this.fill=C6(e)}isEnabledFor(e,n){let i=e;e===Hp&&(i="current");let r=this.options.disabledCellSelection(n.row,n.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return zs(Zr,this,Us).call(this,this.layeredAreas,m6)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return zs(Zr,this,Us).call(this,this.areas,p6)}getAreas(){return[...this.areas.values()]}createRowHeader(){return zs(Zr,this,Us).call(this,this.rowHeaders,GA)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return zs(Zr,this,Us).call(this,this.columnHeaders,GA)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return zs(Zr,this,Us).call(this,this.activeRowHeaders,Ub)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return zs(Zr,this,Us).call(this,this.activeColumnHeaders,Ub)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return zs(Zr,this,Us).call(this,this.activeCornerHeaders,Ub)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return zs(Zr,this,Us).call(this,this.rowHighlights,b6)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return zs(Zr,this,Us).call(this,this.columnHighlights,w6)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(y6({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),A(this.areas.values(),e=>void e.clear()),A(this.layeredAreas.values(),e=>void e.clear()),A(this.rowHeaders.values(),e=>void e.clear()),A(this.columnHeaders.values(),e=>void e.clear()),A(this.activeRowHeaders.values(),e=>void e.clear()),A(this.activeColumnHeaders.values(),e=>void e.clear()),A(this.activeCornerHeaders.values(),e=>void e.clear()),A(this.rowHighlights.values(),e=>void e.clear()),A(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Us(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e({layerLevel:n,...this.options});return t.set(n,i),i}function qA(t,e,n){return(e=M6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M6(t){var e=x6(t,"string");return typeof e=="symbol"?e:e+""}function x6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fM{constructor(e){qA(this,"ranges",[]),qA(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((i,r)=>i.includes(e)&&n(i,r))}findAll(e){const n=[];return this.ranges.forEach((i,r)=>{i.isEqual(e)&&n.push({range:i,layer:r})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(i=>i.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,i)=>!e.includes(i)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new fM(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,i)=>e(n,i)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function P6(t,e){X$(t,e),e.add(t)}function Yb(t,e,n){X$(t,e),e.set(t,n)}function X$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,e){return t.get(an(t,e))}function Eg(t,e,n){return t.set(an(t,e),n),n}function an(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tg=new WeakMap,Ct=new WeakMap,Vr=new WeakMap,wn=new WeakSet;class R0{constructor(e,n){P6(this,wn),Yb(this,Tg,void 0),Yb(this,Ct,void 0),Yb(this,Vr,{x:0,y:0}),Eg(Tg,this,e),Eg(Ct,this,n)}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=Ke(Ct,this).createCellCoords(e,n);let s=Ke(Tg,this).current().highlight;const o=Ke(Ct,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",r),o.row!==null&&o.col!==null){const{width:u,height:c}=an(wn,this,Z$).call(this),{row:h,col:d}=an(wn,this,XA).call(this,s),f=Ke(Ct,this).fixedRowsBottom(),g=Ke(Ct,this).minSpareRows(),m=Ke(Ct,this).minSpareCols(),v=Ke(Ct,this).autoWrapRow(),S=Ke(Ct,this).autoWrapCol(),y=Ke(Ct,this).createCellCoords(h+r.row,d+r.col);if(y.row>=c){const P=Ei(i&&g>0&&f===0),E=y.col+1,T=Ke(Ct,this).createCellCoords(y.row-c,E>=u?E-u:E);this.runLocalHooks("beforeColumnWrap",P,an(wn,this,Cu).call(this,T),E>=u),P.value?this.runLocalHooks("insertRowRequire",Ke(Ct,this).countRenderableRows()):S&&y.assign(T)}else if(y.row<0){const P=Ei(S),E=y.col-1,T=Ke(Ct,this).createCellCoords(c+y.row,E<0?u+E:E);this.runLocalHooks("beforeColumnWrap",P,an(wn,this,Cu).call(this,T),E<0),S&&y.assign(T)}if(y.col>=u){const P=Ei(i&&m>0),E=y.row+1,T=Ke(Ct,this).createCellCoords(E>=c?E-c:E,y.col-u);this.runLocalHooks("beforeRowWrap",P,an(wn,this,Cu).call(this,T),E>=c),P.value?this.runLocalHooks("insertColRequire",Ke(Ct,this).countRenderableColumns()):v&&y.assign(T)}else if(y.col<0){const P=Ei(v),E=y.row-1,T=Ke(Ct,this).createCellCoords(E<0?c+E:E,u+y.col);this.runLocalHooks("beforeRowWrap",P,an(wn,this,Cu).call(this,T),E<0),v&&y.assign(T)}const{rowDir:M,colDir:I}=an(wn,this,KA).call(this,y);a=M,l=I,s=an(wn,this,Cu).call(this,y)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,n){const i=Ke(Ct,this).createCellCoords(e,n),r=Ke(Tg,this).current(),s=Ke(Ct,this).visualToRenderableCoords(r.highlight),o=an(wn,this,Gb).call(this,r.to.row,r.from.row),a=an(wn,this,qb).call(this,r.to.col,r.from.col),l=r.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",i),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:h,col:d}=an(wn,this,XA).call(this,r.highlight),f=Ke(Ct,this).createCellCoords(o+i.row,a+i.col),g=r.getTopStartCorner(),m=r.getTopEndCorner(),v=r.getBottomEndCorner();if(i.col<0&&a>=d&&f.col<d){const I=f.col-d;f.col=an(wn,this,qb).call(this,g.col,m.col)+I}else if(i.col>0&&a<=d&&f.col>d){const I=an(wn,this,qb).call(this,m.col,g.col),P=Math.max(f.col-I,1);f.col=I+P}if(i.row<0&&o>=h&&f.row<h){const I=f.row-h;f.row=an(wn,this,Gb).call(this,g.row,v.row)+I}else if(i.row>0&&o<=h&&f.row>h){const I=an(wn,this,Gb).call(this,v.row,g.row),P=Math.max(f.row-I,1);f.row=I+P}const{rowDir:S,colDir:y}=an(wn,this,KA).call(this,f);u=S,c=y;const M=an(wn,this,Cu).call(this,f);i.row===0&&i.col!==0?l.col=M.col:i.row!==0&&i.col===0?l.row=M.row:(l.row=M.row,l.col=M.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:i}=e;Eg(Vr,this,{x:n,y:i})}resetOffsetSize(){Eg(Vr,this,{x:0,y:0})}}function KA(t){const{width:e,height:n}=an(wn,this,Z$).call(this);let i=0,r=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(r=-1,t.col=0):t.col>0&&t.col>=e&&(r=1,t.col=e-1),{rowDir:i,colDir:r}}function Z$(){return{width:Ke(Vr,this).x+Ke(Ct,this).countRenderableColumns(),height:Ke(Vr,this).y+Ke(Ct,this).countRenderableRows()}}function Gb(t,e){const n=Ke(Ct,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Ke(Vr,this).y+n}function qb(t,e){const n=Ke(Ct,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Ke(Vr,this).x+n}function XA(t){const{row:e,col:n}=Ke(Ct,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Ke(Ct,this).createCellCoords(Ke(Vr,this).y+e,Ke(Vr,this).x+n)}function Cu(t){const e=t.clone();return e.col=t.col-Ke(Vr,this).x,e.row=t.row-Ke(Vr,this).y,Ke(Ct,this).renderableToVisualCoords(e)}ht(R0,In);const rv=0,sv=1,Q$=2,gM=3,I6=[gM,Q$],O6=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Kb=Symbol("root"),ZA=Symbol("child");function Tc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kb;if(e!==Kb&&e!==ZA)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===Kb;let r=rv;if(n){const s=t[0];t.length===0?r=sv:i&&s instanceof Vf?r=gM:i&&Array.isArray(s)?r=Tc(s,ZA):t.length>=2&&t.length<=4&&!t.some((a,l)=>!O6[l].includes(typeof a))&&(r=Q$)}return r}function sf(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!I6.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===gM;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],c=o?s.to.col:s[3];if(typeof r=="function"&&(typeof l=="string"&&(l=r(l)),typeof c=="string"&&(c=r(c))),Mt(u)&&(u=a),Mt(c)&&(c=l),!i){const f=a,g=l,m=u,v=c;a=Math.min(f,m),l=Math.min(g,v),u=Math.max(f,m),c=Math.max(g,v)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function A6(t){const e=Tc(t.getSelected());if(e===rv||e===sv)return[];const n=sf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;A(t.getSelected(),o=>{const{from:a,to:l}=n(o),u=Math.max(a.col,0),c=l.col-u+1;A(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((o,a)=>o-a);return fn(r,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function H6(t){const e=Tc(t.getSelected());if(e===rv||e===sv)return[];const n=sf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;A(t.getSelected(),o=>{const{from:a,to:l}=n(o),u=Math.max(a.row,0),c=l.row-u+1;A(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((o,a)=>o-a);return fn(r,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function bu(t,e,n){D6(t,e),e.set(t,n)}function D6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Va(t,e,n){return(e=N6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N6(t){var e=k6(t,"string");return typeof e=="symbol"?e:e+""}function k6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _t(t,e){return t.get(J$(t,e))}function Qr(t,e,n){return t.set(J$(t,e),n),n}function J$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hn=new WeakMap,Wa=new WeakMap,Mg=new WeakMap,Rh=new WeakMap,xg=new WeakMap,_h=new WeakMap;class eV{constructor(e,n){var i=this;Va(this,"settings",void 0),Va(this,"tableProps",void 0),Va(this,"inProgress",!1),Va(this,"selectedRange",new fM((r,s,o)=>this.tableProps.createCellRange(r,s,o))),Va(this,"highlight",void 0),bu(this,Hn,void 0),bu(this,Wa,void 0),Va(this,"selectedByRowHeader",new Set),Va(this,"selectedByColumnHeader",new Set),bu(this,Mg,!1),bu(this,Rh,!1),bu(this,xg,"unknown"),bu(this,_h,-1),this.settings=e,this.tableProps=n,this.highlight=new T6({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Z_()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,s)=>this.tableProps.isDisabledCellSelection(r,s),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,s)=>this.tableProps.createCellCoords(r,s),createCellRange:(r,s,o)=>this.tableProps.createCellRange(r,s,o)}),Qr(Hn,this,new R0(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,s)=>this.tableProps.createCellCoords(r,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Qr(Wa,this,new R0(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,r.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,r.getOuterBottomEndCorner().col)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,s)=>this.tableProps.createCellCoords(r,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),_t(Hn,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformStart",...s)}),_t(Hn,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformStart",...s)}),_t(Hn,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformEnd",...s)}),_t(Hn,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformEnd",...s)}),_t(Hn,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("insertRowRequire",...s)}),_t(Hn,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("insertColRequire",...s)}),_t(Hn,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeRowWrap",...s)}),_t(Hn,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeColumnWrap",...s)}),_t(Wa,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformFocus",...s)}),_t(Wa,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){Qr(xg,this,e)}markEndSource(){Qr(xg,this,"unknown")}getSelectionSource(){return _t(xg,this)}setExpectedLayers(e){Qr(_h,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Qr(_h,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=Mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Qr(Mg,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,a),(!s||s&&!o&&Mt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||r>0)&&(i===0&&n.col<0&&!s||r===0&&n.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),u=o.getVerticalDirection(),c=this.isMultiple();o.setTo(n),c&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),c&&(u!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=_t(_h,this)===-1||this.selectedRange.size()===_t(_h,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();n<this.highlight.layerLevel&&(A(this.highlight.getAreas(),g=>void g.clear()),A(this.highlight.getLayeredAreas(),g=>void g.clear()),A(this.highlight.getRowHeaders(),g=>void g.clear()),A(this.highlight.getColumnHeaders(),g=>void g.clear()),A(this.highlight.getActiveRowHeaders(),g=>void g.clear()),A(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),A(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),A(this.highlight.getRowHighlights(),g=>void g.clear()),A(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(xE,e.highlight)&&(this.isMultiple()||n>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(ME,e.highlight)){if(!e.isSingleHeader()){const v=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),S=this.tableProps.createCellCoords(e.to.row,-1),y=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),M=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(v).commit(),l.add(y).commit(),d.add(v).commit(),f.add(y).commit()):(a.add(v).add(S).commit(),l.add(y).add(M).commit(),d.add(v).add(S).commit(),f.add(y).add(M).commit())}const g=!_t(Rh,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),m=!_t(Rh,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),m&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&m&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Hp,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(Qr(Mg,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?_t(Hn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_t(Hn,this).resetOffsetSize(),this.setRangeStart(_t(Hn,this).transformStart(e,n,i))}transformEnd(e,n){this.settings.navigableHeaders?_t(Hn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_t(Hn,this).resetOffsetSize(),this.setRangeEnd(_t(Hn,this).transformEnd(e,n))}transformFocus(e,n){const i=this.selectedRange.current(),{row:r,col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,r-1);i.highlight.isHeader()?_t(Wa,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:r<0?Math.abs(r):-a}):_t(Wa,this).setOffsetSize({x:s<0?0:-o,y:r<0?0:-a});const l=_t(Wa,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:s,highlight:o}=i,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(je(r.row+h,c,a-1),r.col),f=this.tableProps.createCellCoords(je(s.row+n,c,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(je(o.row+n,0,a-1),o.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:s,highlight:o}=i,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(r.row,je(r.col+h,c,a-1)),f=this.tableProps.createCellCoords(s.row,je(s.col+n,c,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,je(o.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const n=Ei(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&_t(Mg,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{col:s}=r.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&r.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{row:s}=r.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&r.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=i?-l:0,c=n?-a:0;if(u===0&&c===0&&(s===0||o===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=r;Qr(Rh,this,f),d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(je(d.row,u,s-1),je(d.col,c,o-1)));const g=this.tableProps.createCellCoords(u,c),m=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.finish(),Qr(Rh,this,!1)}selectCells(e){var n=this;const i=Tc(e);if(i===sv)return!1;if(i===rv)throw new Error(ot`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=sf(i,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=r(l),c=u.isValid(o);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),A(e,l=>{const{from:u,to:c}=r(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof n=="string"?this.tableProps.propToCol(n):n,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,r),h=this.tableProps.createCellCoords(o-1,s),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(i?.row)&&Number.isInteger(i?.col)?(f=je(i.row,u,o-1),g=je(i.col,Math.min(r,s),Math.max(r,s))):(f=je(i,u,o-1),g=r);const m=this.tableProps.createCellCoords(f,g),v=l===0?0:je(m.row,u,-1),S=o-1,y=this.tableProps.createCellCoords(v,r),M=this.tableProps.createCellCoords(S,s);this.runLocalHooks("beforeSelectColumns",y,M,m),y.row=v,M.row=S,this.setRangeStartOnly(y,void 0,m),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(M),this.runLocalHooks("afterSelectColumns",y,M,m),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,s-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:r,countCols:s,countRowHeaders:o,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(i?.row)&&Number.isInteger(i?.col)?(h=je(i.row,Math.min(e,n),Math.max(e,n)),d=je(i.col,a,s-1)):(h=e,d=je(i,a,s-1));const f=this.tableProps.createCellCoords(h,d),g=o===0?0:je(f.col,a,-1),m=s-1,v=this.tableProps.createCellCoords(e,g),S=this.tableProps.createCellCoords(n,m);this.runLocalHooks("beforeSelectRows",v,S,f),v.col=g,S.col=m,this.setRangeStartOnly(v,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectRows",v,S,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const i=this.selectedRange.ranges.map(o=>o.clone());this.markSource("refresh");const r=new Set(this.selectedByRowHeader),s=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(i.length),i.forEach(o=>{const{from:a,to:l,highlight:u}=o,c=e-1,h=n-1;u.assign({row:je(u.row,this.settings.navigableHeaders?-1/0:0,c),col:je(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:je(a.row,-1/0,c),col:je(a.col,-1/0,h)}),l.assign({row:je(l.row,-1/0,c),col:je(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=r,this.selectedByColumnHeader=s,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),i=this.selectedRange.current();this.highlight.isEnabledFor(Hp,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}ht(eV,In);const QA=/^(\r\n|\n\r|\r|\n)/,L6=/^[^\t\r\n]+/,JA=/^\t/;function F6(t){const e=[[""]];if(t.length===0)return e;let n=0,i=0,r;for(;t.length>0&&r!==t.length;)if(r=t.length,t.match(JA))t=t.replace(JA,""),n+=1,e[i][n]="";else if(t.match(QA))t=t.replace(QA,""),n=0,i+=1,e[i]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(o+=1),s+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=t.match(L6);s=o?o[0]:"",t=t.slice(s.length)}e[i][n]=s}return e}function Md(t){let e,n,i,r,s="",o;for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,i=0;i<r;i+=1)i>0&&(s+="	"),o=t[e][i],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==n-1&&(s+=`
`)}return s}function Ba(t,e,n){return(e=$6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $6(t){var e=V6(t,"string");return typeof e=="symbol"?e:e+""}function V6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ac{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,i){Ba(this,"hot",void 0),Ba(this,"metaManager",void 0),Ba(this,"tableMeta",void 0),Ba(this,"dataSource",void 0),Ba(this,"duckSchema",void 0),Ba(this,"colToPropCache",void 0),Ba(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,n){let r=0,s=0,o=!1;if(typeof n=="function"){const a=jw(e);r=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;r=Math.min(a,n.length)}for(i=0;i<r;i++){const a=o?n(i):n[i];if(Ae(a)){if(typeof a.data<"u"){const l=o?s:i;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return FE(this.dataSource)}recursiveDuckColumns(e,n,i){let r=n,s=i,o;return typeof r>"u"&&(r=0,s=""),typeof e=="object"&&!Array.isArray(e)&&He(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,r),r+=1):r=this.recursiveDuckColumns(a,r,`${l}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Sc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,i)===!1||o===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&s+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Yn(this.getSchema()):(g=[],de(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},Nf(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),r==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):i!=="auto"&&this.metaManager.createRow(o,n)),this.hot.runHooks("afterCreateRow",f,a,i),{delta:a,startPhysicalIndex:o}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,n,i)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=r==="end"?Math.min(h+1,a):h;let f=0;for(let g=d;f<n&&l+f<o;g++){if(typeof c!="number"||c>=l+f)if(u>0)for(let m=0;m<u;m+=1)typeof s[m]>"u"&&(s[m]=[]),s[m].push(null);else s.push([null]);else for(let m=0;m<u;m++)s[m].splice(g,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):i!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(c,f,r),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,i),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-n;const s=this.visualRowsToPhysical(r,n),o=this.hot.countSourceRows();if(r=(o+r)%o,this.hot.runHooks("beforeRemoveRow",r,s.length,s,i)===!1)return!1;const l=s.length;if(this.filterData(r,l,s),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",r,l,s,i),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-n:e;r=(this.hot.countCols()+r)%this.hot.countCols();const s=this.visualColumnsToPhysical(r,n),o=s.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",r,n,s,i)===!1)return!1;let l=!0;const u=o.length,c=this.dataSource;for(let h=0;h<u;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(s[0],n),h===0&&this.metaManager.removeColumn(s[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(o[f],1),h===0&&this.metaManager.removeColumn(o[f],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,n,s,i),this.refreshDuckSchema(),!0}spliceCol(e,n,i){const r=this.hot.getDataAtCol(e),s=r.slice(n,n+i),o=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];s0(l,o);let c=0;for(;c<i;)l.push(null),c+=1;return wF(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),s}spliceRow(e,n,i){const r=this.hot.getSourceDataAtRow(e),s=r.slice(n,n+i),o=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];s0(l,o);let c=0;for(;c<i;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),s}spliceData(e,n,i){if(this.hot.runHooks("beforeDataSplice",e,n,i)!==!1){const s=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,n,i){let r=this.hot.runHooks("filterData",e,n,i);Array.isArray(r)===!1&&(r=this.dataSource.filter((s,o)=>i.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,n){const i=this.hot.toPhysicalRow(e);let r=this.dataSource[i];const s=this.hot.runHooks("modifyRowData",i);r=isNaN(s)?s:r;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(r&&r.hasOwnProperty&&Qt(r,n))a=r[n];else if(o&&typeof n=="string"&&n.indexOf(".")>-1){let l=r;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const l=Ei(a);this.hot.runHooks("modifyData",e,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,i){const r=this.hot.toPhysicalRow(e);let s=i,o=this.dataSource[r];const a=this.hot.runHooks("modifyRowData",r);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=Ei(s);this.hot.runHooks("modifyData",e,this.propToCol(n),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&Qt(o,n))o[n]=s;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=o,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=s}else if(typeof n=="function")n(this.dataSource.slice(r,r+1)[0],s);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;o[n]=s}}visualRowsToPhysical(e,n){const i=this.hot.countSourceRows(),r=[];let s=(i+e)%i,o=n,a;for(;s<i&&o;)a=this.hot.toPhysicalRow(s),r.push(a),o-=1,s+=1;return r}visualColumnsToPhysical(e,n){const i=this.hot.countCols(),r=[];let s=(i+e)%i,o=n;for(;s<i&&o;){const a=this.hot.toPhysicalColumn(s);r.push(a),o-=1,s+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,ac.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,i){const r=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=i===ac.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(s=Math.min(e.row,n.row);s<=h;s++){a=[];const f=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,n.col);o<=d&&f!==null;o++)a.push(c.call(this,s,this.colToProp(o)));f!==null&&r.push(a)}return r}getText(e,n){return Md(this.getRange(e,n,ac.DESTINATION_RENDERER))}getCopyableText(e,n){return Md(this.getRange(e,n,ac.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:W6,getItem:B6,hasItem:tV,getNames:j6,getValues:rwe}=vr("cellTypes");function mM(t){if(!tV(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return B6(t)}function Xi(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:i,validator:r}=e;n&&wi(t,n),i&&Hi(t,i),r&&Ml(t,r),W6(t,e)}function z6(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Qt(e,t)}function ov(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?mM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&He(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!Ae(i))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const r={};He(i,(s,o)=>{if(z6(o,n)){var a;r[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),tn(t,r)}function U6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}IF(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}function rp(t){return Number.isInteger(t)&&t>=0}function sp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Pg(t){return t==null}const nV=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),Wt(i)===!1)return!1;return!0},isEmptyRow(t){let e,n,i,r;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),Wt(i)===!1)return typeof i=="object"?(r=this.getCellMeta(t,e),Bw(this.getSchema()[r.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function eH(t,e,n){return(e=Y6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y6(t){var e=G6(t,"string");return typeof e=="symbol"?e:e+""}function G6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q6(){return class{}}class K6{constructor(e){eH(this,"metaCtor",q6()),eH(this,"meta",void 0),this.meta=this.metaCtor.prototype,tn(this.meta,nV()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;tn(this.meta,e),ov(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function X6(t,e,n){return(e=Z6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z6(t){var e=Q6(t,"string");return typeof e=="symbol"?e:e+""}function Q6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J6{constructor(e){X6(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){tn(this.meta,e),ov(this.meta,e,e)}}function Ig(t,e,n){return(e=e8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e8(t){var e=t8(t,"string");return typeof e=="symbol"?e:e+""}function t8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kp{constructor(e){Ig(this,"valueFactory",void 0),Ig(this,"data",[]),Ig(this,"index",[]),Ig(this,"holes",new Set),this.valueFactory=e}obtain(e){sp(()=>rp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let i;if(n>=0)i=this.data[n],i===void 0&&(i=this.valueFactory(e),this.data[n]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;sp(()=>rp(e)||Pg(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let o=0;o<n;o++)i.push(r+o),this.data.push(void 0);const s=Pg(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...i,...this.index.slice(s)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;sp(()=>rp(e)||Pg(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(Pg(e)?this.index.length-n:e,n);for(let r=0;r<i.length;r++){const s=i[r];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&this.data[i]!==void 0&&e.push([r,this.data[i]])}let n=0;return{next:()=>{if(n<e.length){const i=e[n];return n+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function tH(t,e,n){return(e=n8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n8(t){var e=i8(t,"string");return typeof e=="symbol"?e:e+""}function i8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const r8=["data","width"];class s8{constructor(e){tH(this,"globalMeta",void 0),tH(this,"metas",new kp(()=>this._createMeta())),this.globalMeta=e,this.metas=new kp(()=>this._createMeta())}updateMeta(e,n){const i=this.getMeta(e);tn(i,n),ov(i,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return U6(this.globalMeta.getMetaConstructor(),r8).prototype}}function nH(t,e,n){return(e=o8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o8(t){var e=a8(t,"string");return typeof e=="symbol"?e:e+""}function a8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l8{constructor(e){nH(this,"columnMeta",void 0),nH(this,"metas",new kp(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,i){const r=this.getMeta(e,n);tn(r,i),ov(r,i)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}getMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);return i===void 0?r:r[i]}setMeta(e,n,i,r){var s;const o=this.metas.obtain(e).obtain(n);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(i),o[i]=r}removeMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);delete r[i]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let i=0;i<n.length;i++)le(n[i])&&e.push(...n[i].values());return e}getMetasAtRow(e){sp(()=>rp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new kp(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class iV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new K6(e),this.tableMeta=new J6(this.globalMeta),this.columnMeta=new s8(this.globalMeta),this.cellMeta=new l8(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,i){const r=this.cellMeta.getMeta(e,n);return r.visualRow=i.visualRow,r.visualCol=i.visualColumn,r.row=e,r.col=n,i.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}setCellMeta(e,n,i,r){this.cellMeta.setMeta(e,n,i,r)}updateCellMeta(e,n,i){this.cellMeta.updateMeta(e,n,i)}removeCellMeta(e,n,i){this.cellMeta.removeMeta(e,n,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ht(iV,In);function iH(t,e,n,i){const{hotInstance:r,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:c}=i,h=Un(a),d=r.getSettings();Array.isArray(d.dataSchema)?r.dataType="array":st(d.dataSchema)?r.dataType="function":r.dataType="object",s&&s.destroy(),t=r.runHooks(`before${h}`,t,c,l);const f=new ac(r,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let m,v=0,S=0;for(v=0,S=d.startRows;v<S;v++)if((r.dataType==="object"||r.dataType==="function")&&d.dataSchema)m=Yn(g),t.push(m);else if(r.dataType==="array")m=Yn(g[0]),t.push(m);else{m=[];for(let y=0,M=d.startCols;y<M;y++)m.push(null);t.push(m)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(r.dataType="array"),d.data=t,f.dataSource=t,o.data=t,o.dataType=r.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),n(f),r.runHooks(`after${h}`,t,c,l),c||(r.runHooks("afterChange",null,a),r.render()),r.getSettings().ariaTags&&ve(r.rootElement,[MF(-1),Ww(r.countCols()+(r.view?r.countRowHeaders():0))])}function rH(t,e,n){return(e=u8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u8(t){var e=c8(t,"string");return typeof e=="symbol"?e:e+""}function c8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h8{constructor(e){var n=this;rH(this,"metaManager",void 0),rH(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),re.getSingleton().add("beforeRender",i=>{i&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:i,col:r}=e;if((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(r))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=Qt(e,"type")?e.type:null;let c=st(e.cells)?e.cells(i,r,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(i,r,c),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}}function d8(t,e,n){f8(t,e),e.set(t,n)}function f8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xb(t,e,n){return(e=g8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g8(t){var e=m8(t,"string");return typeof e=="symbol"?e:e+""}function m8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function p8(t,e){return t.get(w8(t,e))}function w8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sH=new WeakMap;class v8{constructor(e){Xb(this,"metaManager",void 0),Xb(this,"usageTracker",new Set),Xb(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),d8(this,sH,(n,i,r)=>{if(!r)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:i,target:r,onChange:s}=e,o=typeof r=="string",a=o?r:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(n,l,s),o&&this.installPropWatcher(r,l,s)):i&&(this.installPropWatcher(n,l,p8(sH,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(s){const o=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,s,o),this[n]=s},enumerable:!0,configurable:!0})}}const rV="gridDefault",Ha="editorManager.handlingEditor",y8={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},C8="hooksRefRegisterer",sV={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){A(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){He(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Ds(sV,"MIXIN_NAME",C8,{writable:!1,enumerable:!1});function _r(t,e,n){return(e=b8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b8(t){var e=S8(t,"string");return typeof e=="symbol"?e:e+""}function S8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const R8="base",Ut=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Uc{static get EDITOR_TYPE(){return R8}constructor(e){_r(this,"hot",void 0),_r(this,"state",Ut.VIRGIN),_r(this,"_opened",!1),_r(this,"_fullEditMode",!1),_r(this,"_closeCallback",null),_r(this,"TD",null),_r(this,"row",null),_r(this,"col",null),_r(this,"prop",null),_r(this,"originalValue",null),_r(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,i,r,s,o){this.TD=r,this.row=e,this.col=n,this.prop=i,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:Ut.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let i,r,s,o;if(n){const l=this.hot.getSelectedLast();i=Math.max(Math.min(l[0],l[2]),0),r=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[i,r,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");Array.isArray(a)&&([i,r]=a),this.hot.populateFromArray(i,r,e,s,o,"edit")}beginEditing(e,n){if(this.state!==Ut.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=Ut.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:bt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),i.view.scrollViewport(i._createCellCoords(r,s))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,n,i){let r;if(i){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),i(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Ut.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Ut.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:r=[[s]],this.state=Ut.WAITING,this.saveValue(r,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=Ut.FINISHED,this.discardEditor(o)}):(this.state=Ut.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Ut.FINISHED,this.discardEditor()}discardEditor(e){this.state===Ut.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Ut.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Ut.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Ut.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,s=this.hot.rootWindow,o=xn(n),a=Gt(n),l=xn(this.hot.rootElement),u=Gt(this.hot.rootElement),c=i.topOverlay.holder,h=i.inlineStartOverlay.holder,d=c!==s?c.scrollTop:0,f=h!==s?h.scrollLeft:0,g=s.innerWidth-l.left-u,{wtTable:m}=(e=i.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,v=m.name,S=["master","inline_start"].includes(v)?d:0,y=["master","top","bottom"].includes(v)?f:0,M=o.top===l.top?0:1;let I=o.top-l.top-M-S,P=0;this.hot.isRtl()?P=s.innerWidth-o.left-a-g-1+y:P=o.left-l.left-1-y,["top","top_inline_start_corner"].includes(v)&&(I+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(v)&&(P+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const E=this.hot.hasColHeaders(),T=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),$=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),O=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(E&&T<=0||T===O)&&(I+=1),$<=0&&(P+=1);const G=r.rowsRenderCalculator.startPosition,q=r.columnsRenderCalculator.startPosition,ne=Math.abs(i.inlineStartOverlay.getScrollPosition()),Q=i.topOverlay.getScrollPosition(),te=Cn(this.hot.rootDocument);let Me=n.offsetTop;if(["inline_start","master"].includes(v)&&(Me+=G-Q),["bottom","bottom_inline_start_corner"].includes(v)){const{wtViewport:j,wtTable:X}=i.bottomOverlay.clone;Me+=j.getWorkspaceHeight()-X.getHeight()-te}let Ce=n.offsetLeft;this.hot.isRtl()?(Ce>=0?Ce=m.getWidth()-n.offsetLeft:Ce=Math.abs(Ce),Ce+=q-ne-a):["top","master","bottom"].includes(v)&&(Ce+=q-ne);const Ie=s.getComputedStyle(this.TD),at=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Le=parseInt(Ie[at],10)>0?0:1,Ge=parseInt(Ie.borderTopWidth,10)>0?0:1,St=Gt(n)+Le,p=en(n)+Ge,w=lE(c)?te:0,b=uE(h)?te:0,N=this.hot.view.maximumVisibleElementWidth(Ce)-w+Le,V=Math.max(this.hot.view.maximumVisibleElementHeight(Me)-b+Ge,this.hot.stylesHandler.getDefaultRowHeight());return{top:I,start:P,height:p,maxHeight:V,width:St,maxWidth:N}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}ht(Uc,sV);const _8={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),r=i.getActiveEditor();r.isInFullEditMode()&&r.state===Ut.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},E8={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},T8={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},M8={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},x8={name:"editorOpen",callback(t,e,n){const i=t._getEditorManager(),r=t.getSelectedRangeLast(),{highlight:s}=r;if(t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),wr(e))}};function P8(){return[y8,_8,E8,T8,M8,x8]}const I8={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},O8={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeLast(),r=Math.min(i.row+t.countVisibleRows(),t.countRows()-1),s=n.getNearestNotHiddenIndex(r,-1);if(s!==null){const o=t._createCellCoords(s,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.min(o.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(o),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},A8={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},H8={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},D8={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(i.col,r.col,n),e.markEndSource()}},N8={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=r.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},k8={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const o=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=r.clone();a.col=i.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(s.row,o)),e.markEndSource()}}},L8={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(o,1),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},F8={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},$8={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},V8={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(0,1),l=r.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},W8={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(i.row,r.row,n),e.markEndSource()}},B8={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},j8={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeLast(),r=Math.max(i.row-t.countVisibleRows(),0),s=n.getNearestNotHiddenIndex(r,1);if(s!==null){const o=t._createCellCoords(s,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.max(o.row-a,0);e.markSource("keyboard"),e.setRangeEnd(o),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function z8(){return[I8,O8,A8,H8,D8,N8,k8,L8,F8,$8,V8,W8,B8,j8]}const U8={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},Y8={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+i;s=s===0?1:s,r===t.countRows()-1?s=1:r+s>t.countRows()&&(s=t.countRows()-r-1),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},G8={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRangeLast(),s=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-s.row,-s.col):n.transformStart(-s.row,-s.col),n.markEndSource()}},q8={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRangeLast(),s=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(s.row,s.col):n.transformStart(s.row,s.col),n.markEndSource()}},K8={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},X8={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},Z8={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);i===null&&(i=-1),e.setRangeStart(t._createCellCoords(i,n))}},Q8={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsBottom,10),s=n.getNearestNotHiddenIndex(t.countRows()-r-1,-1),o=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,o)),e.markEndSource()}},J8={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},e9={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),r=t.getSelectedRangeLast().highlight.row,s=n.getNearestNotHiddenIndex(i,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,s)),e.markEndSource()}},t9={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeLast().highlight.row;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);r===null&&(r=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},n9={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeLast().highlight;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);r===null&&(r=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},i9={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);i===null&&(i=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,n)),e.markEndSource()}},r9={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=n.getNearestNotHiddenIndex(r,1),a=i.getNearestNotHiddenIndex(s,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,a)),e.markEndSource()}},s9={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},o9={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+i;s=s===0?-1:-s,r===-i?s=-1:r+s<i&&(s=-(r+i)),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function a9(){return[U8,Y8,G8,q8,K8,X8,Z8,Q8,J8,e9,t9,n9,i9,r9,s9,o9]}const l9={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},u9={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,r=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(n,i),a=t._createCellCoords(r,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},c9={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},h9={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},d9={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),r=t.getDataAtCell(n,i),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==i)){const{readOnly:u}=t.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,r])}});t.setDataAtCell(Array.from(s.values()))}},f9=[...P8(),...z8(),...a9(),l9,u9,c9,h9,d9];function oV(t){const e={};return f9.forEach(n=>{let{name:i,callback:r}=n;e[i]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r(t,...o)}}),e}function g9(t){const e=t.getShortcutManager().addContext("editor"),n=oV(t),i={group:Ha};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,s)=>n.editorCloseAndSaveByEnter(r,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,s)=>n.editorCloseAndSaveByEnter(r,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(r,s)=>n.editorCloseAndSave(r,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,s)=>n.editorCloseAndSaveByArrowKeys(r,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function m9(t){const e=t.getShortcutManager().addContext("grid"),n=oV(t),i={runOnlyIf:()=>{const{navigableHeaders:r}=t.getSettings();return le(t.getSelected())&&(r||!r&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:rV};e.addShortcuts([{keys:[["F2"]],callback:r=>n.editorFastOpen(r)},{keys:[["Enter"],["Enter","Shift"]],callback:(r,s)=>n.editorOpen(r,s)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Ha,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var r;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var r;return(r=t.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var r,s;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineStart(r)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineEnd(r)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i)}function p9(t){[m9,g9].forEach(e=>e(t))}function w9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,i=oH(t),r=oH(t);return i.addEventListener("focus",()=>e?.onFocusFromTop()),r.addEventListener("focus",()=>e?.onFocusFromBottom()),n.before(i),n.after(r),{activate(){t._registerTimeout(()=>{i.tabIndex=0,r.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,r.tabIndex=-1},10)}}}function oH(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&ve(n,[bc("Focus catcher")]),n}function v9(t){const e=y9(t);let n;const{activate:i,deactivate:r}=w9(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:_0(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:E0(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>i()),t.addHook("afterSelection",(h,d,f,g,m)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,m.value=!0),o){var v;n=(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{s.wrapped=!0,s.flipped=f});function u(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:rV,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(o=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,o=!0,!d||!t.selection.isSelected()||f&&s.wrapped&&s.flipped||!f&&s.wrapped)return f&&s.wrapped&&s.flipped&&(n=h.shiftKey?_0(t):E0(t)),u(),!1;h.preventDefault()},position:"after"}])}function _0(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let r=i&&t.countColHeaders()>0?-t.countColHeaders():0,s=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),s===0&&(s=n.getVisualFromRenderableIndex(s)),r===null||s===null?null:t._createCellCoords(r,s)}function E0(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:r}=t,{navigableHeaders:s}=t.getSettings();let o=i.getRenderableIndexesLength()-1,a=r.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(n=r.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function y9(t){return e=>{if(!e)return null;const n=_0(t),i=E0(t);return e.col<n.col&&(e.col=n.col),e.col>i.col&&(e.col=i.col),e.row<n.row&&(e.row=n.row),e.row>i.row&&(e.row=i.row),e}}function Yc(t){Es(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function av(t){const{selection:e,view:n}=t,i=t.getSelectedRangeLast(),r=e.getSelectionSource(),s=n.getFirstFullyVisibleColumn(),o=n.getLastFullyVisibleColumn(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,u=a<=s,c=l>=o,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=i.getTopStartCorner().row,g=i.getBottomEndCorner().row,m=f<=h,v=g>=d;return{getComputedColumnTarget(S){return r==="mouse"||r==="keyboard"?S.col:u&&c?i.highlight.col:u?a:c?l:S.col},getComputedRowTarget(S){return r==="mouse"||r==="keyboard"?S.row:m&&v?i.highlight.row:m?f:v?g:S.row}}}function C9(t){return e=>{const n=av(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const i=!!t.getSettings().colHeaders;Yc(t.getCell(i?-1:0,n,!0))})}}function b9(){return()=>{}}function S9(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:i}=t.getSelectedRangeLast().highlight;Yc(t.getCell(n,i,!0))})}}function R9(t){return e=>{const n=av(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:s}=i;Yc(t.getCell(r,s,!0))})}}function _9(t){return e=>{const n=av(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:s}=i;Yc(t.getCell(r,s,!0))})}}function E9(t){return e=>{const n=av(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const i=!!t.getSettings().rowHeaders;Yc(t.getCell(n,i?-1:0,!0))})}}function T9(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:r}=e,s=()=>{Yc(t.getCell(i,r,!0))};if(i<0&&r>=0)t.scrollViewportTo({col:r},s);else if(r<0&&i>=0)t.scrollViewportTo({row:i},s);else{if(n==="mouse"&&(r===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:r},s)}}}function M9(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(r){var s;if(n||i){n=!1;return}let o;e.isFocusSelectionChanged()?o=S9(t):e.isSelectedByCorner()?o=b9():e.isSelectedByRowHeader()?o=E9(t):e.isSelectedByColumnHeader()?o=C9(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=R9(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=T9(t):e.getSelectedRange().size()>1&&(o=_9(t)),(s=o)===null||s===void 0||s(r)}}}const aH=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Og=t=>t.map(e=>{const n=e.toLowerCase();return aH.has(n)?aH.get(n):n}).sort().join("+"),x9=t=>t.split("+"),lH=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Zb=t=>{let{which:e,key:n}=t;if(lH.has(e))return lH.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},aV=Symbol("shortcut-context");function lV(t){return Ae(t)&&t.__kindOf===aV}const P9=t=>{const e=Xw({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:m,position:v,forwardToContext:S}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Mt(c))throw new Error("You need to define the shortcut's group.");if(st(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ot`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const y={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};le(m)&&(y.relativeToGroup=m,y.position=v),lV(S)&&(y.forwardToContext=S),l.forEach(M=>{const I=Og(M);if(e.hasItem(I)){const E=e.getItem(I);let T=E.findIndex($=>$.group===m);T!==-1?v==="before"?T-=1:T+=1:T=E.length,E.splice(T,0,y)}else e.addItem(I,[y])})},i=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{He(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},r=l=>{const u=Og(l);e.removeItem(u)};return{__kindOf:aV,addShortcut:n,addShortcuts:i,getShortcuts:l=>{const u=Og(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=Og(l);return e.hasItem(u)},removeShortcutsByKeys:r,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?r(x9(h)):(d.length=0,d.push(...f))})}}};function I9(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const O9=["meta","alt","shift","control"],Eh=I9(),Th=[];let Ag=0;function A9(t,e,n,i,r){const s=f=>O9.includes(f),o=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=[];return f.altKey&&m.push("alt"),g&&(f.ctrlKey||f.metaKey)?m.push("control/meta"):(f.ctrlKey&&m.push("control"),f.metaKey&&m.push("meta")),f.shiftKey&&m.push("shift"),m},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||ia(f))return;const m=Zb(f);let v=[];s(m)||(v=o(f));const S=[m].concat(v);!r(f,S)&&(xp()&&v.includes("meta")||!xp()&&v.includes("control"))&&r(f,[m].concat(o(f,!0))),i(f)},l=f=>{if(typeof f.key=="string"){const g=Zb(f);s(g)&&Eh.press(g)}},u=f=>{if(typeof f.key=="string"){const g=Zb(f);s(g)&&Eh.release(g)}},c=()=>{Eh.releaseAll()};return{mount:()=>{let f=t;for(Ag+=1;f;)Ag===1&&(f.document.documentElement.addEventListener("keydown",l),Th.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Th.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=Wl(f)},unmount:()=>{let f=t;for(Ag-=1;f;){if(Ag===0){for(let g=0;g<Th.length;g++){const{event:m,listener:v}=Th[g];f.document.documentElement.removeEventListener(m,v)}Th.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=Wl(f)}},isPressed:f=>Eh.isPressed(f),releasePressedKeys:()=>Eh.releaseAll()}}const H9=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:r}=t;const s=Xw({errorIdExists:g=>`The "${g}" context name is already registered.`});let o="grid";const a=g=>{const m=P9(g);return s.addItem(g,m),m},l=()=>o,u=g=>s.getItem(g),c=g=>{if(!s.hasItem(g))throw new Error(ot`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=g};let h=!1;const d=function(g,m){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const S=lV(v)?v:u(v);let y=!1;if(!S.hasShortcut(m))return y;const M=S.getShortcuts(m);for(let I=0;I<M.length;I++){const{callback:P,runOnlyIf:E,preventDefault:T,stopPropagation:$,captureCtrl:U,forwardToContext:O}=M[I];if(E(g)===!0){if(h=U,y=P(g,m)===!1,h=!1,T&&g.preventDefault(),$&&(wr(g),g.stopPropagation()),y)break;O&&d(g,m,O)}}return y},f=A9(e,n,i,r,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function uH(t){const{classNames:e}=WF(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function D9(t,e){uV(t,e),e.add(t)}function ja(t,e,n){uV(t,e),e.set(t,n)}function uV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wn(t,e){return t.get(Nr(t,e))}function Ji(t,e,n){return t.set(Nr(t,e),n),n}function Nr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cH=23;var za=new WeakMap,Lp=new WeakMap,pM=new WeakMap,T0=new WeakMap,Ko=new WeakMap,fd=new WeakMap,of=new WeakMap,fs=new WeakSet;class N9{constructor(e,n){D9(this,fs),ja(this,za,void 0),ja(this,Lp,void 0),ja(this,pM,void 0),ja(this,T0,void 0),ja(this,Ko,!0),ja(this,fd,{}),ja(this,of,{}),Ji(Lp,this,e),Ji(T0,this,n)}isClassicTheme(){return Wn(Ko,this)}getCSSVariableValue(e){var n;if(Wn(Ko,this))return null;if(Wn(fd,this)[`--ht-${e}`])return Wn(fd,this)[`--ht-${e}`];const i=(n=Nr(fs,this,F9).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Nr(fs,this,cV).call(this,`--ht-${e}`);if(i!==null)return Wn(fd,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var n;return(n=Wn(of,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Wn(Ko,this))return cH;const e=Nr(fs,this,k9).call(this);return e||cH}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Ji(za,this,void 0),Ji(Ko,this,!0),Nr(fs,this,Qb).call(this);return}if(e&&e!==Wn(za,this)){if(!/ht-theme-.*/.test(e)){Je(`Invalid theme name: ${e}. Please provide a valid theme name.`),Ji(za,this,void 0),Ji(Ko,this,!1),Nr(fs,this,Qb).call(this);return}Wn(za,this)&&Nr(fs,this,$9).call(this),Ji(za,this,e),Ji(Ko,this,!1),Nr(fs,this,Qb).call(this)}}getThemeName(){return Wn(za,this)}}function k9(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Qb(){this.isClassicTheme()||Ji(pM,this,getComputedStyle(Wn(Lp,this)));const t=Nr(fs,this,L9).call(this,["box-sizing","border-bottom-width"]);Wn(of,this).td={...Wn(of,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function L9(t){const e=Wn(T0,this),n=Wn(Lp,this),i=e.createElement("table"),r=e.createElement("tbody"),s=e.createElement("tr"),o=e.createElement("tr"),a=e.createElement("td");o.appendChild(a),r.appendChild(s),r.appendChild(o),i.appendChild(r),n.appendChild(i);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(i),u}function F9(t){const e=Math.ceil(parseFloat(Nr(fs,this,cV).call(this,t)));return Number.isNaN(e)?null:e}function cV(t){const e=Wn(pM,this).getPropertyValue(t);return e===""?null:e}function $9(){Ji(of,this,{}),Ji(fd,this,{}),Ji(Ko,this,!0)}function V9(t,e){hV(t,e),e.add(t)}function hH(t,e,n){hV(t,e),e.set(t,n)}function hV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dH(t,e){return t.get(Mc(t,e))}function fH(t,e,n){return t.set(Mc(t,e),n),n}function Mc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var M0=new WeakMap,x0=new WeakMap,xd=new WeakSet;class W9{constructor(e){let{rowIndexMapper:n,columnIndexMapper:i}=e;V9(this,xd),hH(this,M0,void 0),hH(this,x0,void 0),fH(M0,this,n),fH(x0,this,i)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,r=Mc(xd,this,gH).call(this,e.from,n,i);if(r===null)return null;const s=Mc(xd,this,gH).call(this,e.to,-n,-i);if(s===null)return null;const o=e.clone();return o.from=r,o.to=s,o.includes(e.highlight)||(o.highlight=r),o}}function gH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const i=Mc(xd,this,mH).call(this,dH(M0,this),t.row,e);if(i===null)return null;const r=Mc(xd,this,mH).call(this,dH(x0,this),t.col,n);return r===null?null:t.clone().assign({row:i,col:r})}function mH(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}let Jb=null;const eS=new Map;function dV(t,e){var n,i=this;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new cr(s);let a,l,u,c,h,d,f=!0;h4(r)&&c4(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=Ju(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Ju(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),K(this.rootElement,"ht-wrapper"),K(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),K(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e?.layoutDirection)!==null&&n!==void 0?n:"inherit",m=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return m==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new N9(s.rootElement,s.rootDocument),e.language=h6(e.language);const v=Object.fromEntries(Object.entries(e).filter(p=>{let[w]=p;return!(re.getSingleton().isRegistered(w)||re.getSingleton().isDeprecated(w))})),S=new iV(s,v,[h8,v8]),y=S.getTableMeta(),M=S.getGlobalMeta(),I=Xw();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),Ju(this)&&SF(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${G_()}`,eS.set(this.guid,this),this.columnIndexMapper=new b0,this.rowIndexMapper=new b0,this.columnIndexMapper.addLocalHook("indexesSequenceChange",p=>{s.runHooks("afterColumnSequenceChange",p)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",p=>{s.runHooks("afterRowSequenceChange",p)}),o.addEventListener(this.rootDocument.documentElement,"compositionstart",p=>{s.runHooks("beforeCompositionStart",p)}),l=new M4(s);const P=vr(this.guid);P.register("cellRangeMapper",new W9({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const E=p=>{const{row:w,col:b}=p;return s._createCellCoords(w>=0?s.rowIndexMapper.getRenderableFromVisualIndex(w):w,b>=0?s.columnIndexMapper.getRenderableFromVisualIndex(b):b)},T=p=>{const{row:w,col:b}=p;return s._createCellCoords(w>=0?s.rowIndexMapper.getVisualFromRenderableIndex(w):w,b>=0?s.columnIndexMapper.getVisualFromRenderableIndex(b):b)},$=(p,w)=>{const b=w>p?1:-1,N=Math.min(p,w),V=Math.max(p,w),j=s.rowIndexMapper.getNearestNotHiddenIndex(p,b);return j===null||b===1&&j>V||b===-1&&j<N?null:j>=0?s.rowIndexMapper.getRenderableFromVisualIndex(j):j},U=(p,w)=>{const b=w>p?1:-1,N=Math.min(p,w),V=Math.max(p,w),j=s.columnIndexMapper.getNearestNotHiddenIndex(p,b);return j===null||b===1&&j>V||b===-1&&j<N?null:j>=0?s.columnIndexMapper.getRenderableFromVisualIndex(j):j};let O=new eV(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:p=>a.propToCol(p),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(p,w)=>s._createCellCoords(p,w),createCellRange:(p,w,b)=>s._createCellRange(p,w,b),visualToRenderableCoords:E,renderableToVisualCoords:T,findFirstNonHiddenRenderableRow:$,findFirstNonHiddenRenderableColumn:U,isDisabledCellSelection:(p,w)=>p<0||w<0?s.getSettings().disableVisualSelection:s.getCellMeta(p,w).disableVisualSelection});this.selection=O;const G=p=>{let{hiddenIndexesChanged:w}=p;this.forceFullRender=!0,w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",G),this.rowIndexMapper.addLocalHook("cacheUpdated",G),this.selection.addLocalHook("afterSetRangeEnd",(p,w)=>{const b=Ei(!1),N=this.selection.getSelectedRange(),{from:V,to:j}=N.current(),X=N.size()-1;this.runHooks("afterSelection",V.row,V.col,j.row,j.col,b,X),this.runHooks("afterSelectionByProp",V.row,s.colToProp(V.col),j.row,s.colToProp(j.col),b,X),w&&(!b.isTouched()||b.isTouched()&&!b.value)&&d.scrollTo(p);const C=O.isSelectedByRowHeader(),R=O.isSelectedByColumnHeader();C&&R?K(this.rootElement,["ht__selection--rows","ht__selection--columns"]):C?(me(this.rootElement,"ht__selection--columns"),K(this.rootElement,"ht__selection--rows")):R?(me(this.rootElement,"ht__selection--rows"),K(this.rootElement,"ht__selection--columns")):me(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(O.getSelectionSource())||c.closeEditor(null),O.getSelectionSource()!=="refresh"&&(s.view.render(),c.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",p=>{this.runHooks("beforeSelectionFocusSet",p.row,p.col)}),this.selection.addLocalHook("afterSetFocus",p=>{const w=Ei(!1);this.runHooks("afterSelectionFocusSet",p.row,p.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(p),c.closeEditor(),s.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",p=>{const w=p.length-1,{from:b,to:N}=p[w];this.runHooks("afterSelectionEnd",b.row,b.col,N.row,N.col,w),this.runHooks("afterSelectionEndByProp",b.row,s.colToProp(b.col),N.row,s.colToProp(N.col),w),O.getSelectionSource()==="refresh"&&(s.view.render(),c.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",p=>{const w=this.runHooks("afterIsMultipleSelection",p.value);p.value&&(p.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),s.view.render(),me(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("afterSelectRows",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var p=arguments.length,w=new Array(p),b=0;b<p;b++)w[b]=arguments[b];return i.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",p=>this.alter("insert_row_above",p,1,"auto")).addLocalHook("insertColRequire",p=>this.alter("insert_col_start",p,1,"auto")),u={alter(p,w){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,N=arguments.length>3?arguments[3]:void 0,V=arguments.length>4?arguments[4]:void 0;const j=X=>{if(X.length===0)return[];const C=[...X];return C.sort((_,x)=>{let[H]=_,[L]=x;return H===L?0:H>L?1:-1}),fn(C,(_,x)=>{let[H,L]=x;const B=_[_.length-1],[D,F]=B,W=D+F;if(H<=W){const z=Math.max(L-(W-H),0);B[1]+=z}else _.push([H,L]);return _},[C[0]])};switch(p){case"insert_row_below":case"insert_row_above":const X=s.countSourceRows();if(y.maxRows===X)return;const C=p==="insert_row_below"?"below":"above";w=w??(C==="below"?X:0);const{delta:R,startPhysicalIndex:_}=a.createRow(w,b,{source:N,mode:C});O.shiftRows(s.toVisualRow(_),R);break;case"insert_col_start":case"insert_col_end":const x=p==="insert_col_end"?"end":"start";w=w??(x==="end"?s.countSourceCols():0);const{delta:H,startPhysicalIndex:L}=a.createCol(w,b,{source:N,mode:x});if(H){if(Array.isArray(y.colHeaders)){const F=[s.toVisualColumn(L),0];F.length+=H,Array.prototype.splice.apply(y.colHeaders,F)}O.shiftColumns(s.toVisualColumn(L),H)}break;case"remove_row":const B=F=>{let W=0;A(F,z=>{let[Y,oe]=z;const ae=Wt(Y)?s.countRows()-1:Math.max(Y-W,0);if(Number.isInteger(Y)&&(Y=Math.max(Y-W,0)),!a.removeRow(Y,oe,N))return;if(O.isSelected()){const{row:be}=s.getSelectedRangeLast().highlight;be>=Y&&be<=Y+oe-1&&c.closeEditor(!0)}const We=s.countRows(),Be=y.fixedRowsTop;Be>=ae+1&&(y.fixedRowsTop-=Math.min(oe,Be-ae));const _e=y.fixedRowsBottom;if(_e&&ae>=We-_e&&(y.fixedRowsBottom-=Math.min(oe,_e)),We===0)O.deselect();else if(N==="ContextMenu.removeRow"){const be=O.getSelectedRange(),it=be.pop();be.clear().set(it.from).current().setTo(it.to),O.refresh()}else O.shiftRows(Y,-oe);W+=oe})};Array.isArray(w)?B(j(w)):B([[w,b]]);break;case"remove_col":const D=F=>{let W=0;A(F,z=>{let[Y,oe]=z;const ae=Wt(Y)?s.countCols()-1:Math.max(Y-W,0);let Re=s.toPhysicalColumn(ae);if(Number.isInteger(Y)&&(Y=Math.max(Y-W,0)),!a.removeCol(Y,oe,N))return;if(O.isSelected()){const{col:be}=s.getSelectedRangeLast().highlight;be>=Y&&be<=Y+oe-1&&c.closeEditor(!0)}if(s.countCols()===0)O.deselect();else if(N==="ContextMenu.removeColumn"){const be=O.getSelectedRange(),it=be.pop();be.clear().set(it.from).current().setTo(it.to),O.refresh()}else O.shiftColumns(Y,-oe);const _e=y.fixedColumnsStart;_e>=ae+1&&(y.fixedColumnsStart-=Math.min(oe,_e-ae)),Array.isArray(y.colHeaders)&&(typeof Re>"u"&&(Re=-1),y.colHeaders.splice(Re,oe)),W+=oe})};Array.isArray(w)?D(j(w)):D([[w,b]]);break;default:throw new Error(`There is no such action "${p}"`)}V||u.adjustRowsAndCols(),s.view.render(),s.view.adjustElementsSize()},adjustRowsAndCols(){const p=y.minRows,w=y.minSpareRows,b=y.minCols,N=y.minSpareCols;if(p){const V=s.countRows();V<p&&a.createRow(V,p-V,{source:"auto"})}if(w){const V=s.countEmptyRows(!0);if(V<w){const j=w-V,X=Math.min(j,y.maxRows-s.countSourceRows());a.createRow(s.countRows(),X,{source:"auto"})}}{let V;(b||N)&&(V=s.countEmptyCols(!0));let j=s.countCols();if(b&&!y.columns&&j<b){const X=b-j;V+=X,a.createCol(j,X,{source:"auto"})}if(N&&!y.columns&&s.dataType==="array"&&V<N){j=s.countCols();const X=N-V,C=Math.min(X,y.maxCols-j);a.createCol(j,C,{source:"auto"})}}},populateFromArray(p,w,b,N,V){let j,X,C,R;const _=[],x={},H=[],L=p.row,B=p.col;if(X=w.length,X===0)return!1;let D=0,F=0;switch(Ae(b)&&(D=b.col-B+1,F=b.row-L+1),V){case"shift_down":const W=bd(w),z=W.length,Y=Math.max(z,D),oe=s.getData().slice(L),ae=bd(oe).slice(B,B+Y);for(C=0;C<Y;C+=1)if(C<z){for(j=0,X=W[C].length;j<F-X;j+=1)W[C].push(W[C][j%X]);C<ae.length?H.push(W[C].concat(ae[C])):H.push(W[C].concat(new Array(oe.length).fill(null)))}else H.push(W[C%z].concat(ae[C]));s.populateFromArray(L,B,bd(H));break;case"shift_right":const Re=w.length,We=Math.max(Re,F),Be=s.getData().slice(L).map(Rt=>Rt.slice(B));for(j=0;j<We;j+=1)if(j<Re){for(C=0,R=w[j].length;C<D-R;C+=1)w[j].push(w[j][C%R]);if(j<Be.length)for(let Rt=0;Rt<Be[j].length;Rt+=1)w[j].push(Be[j][Rt]);else w[j].push(...new Array(Be[0].length).fill(null))}else w.push(w[j%X].slice(0,We).concat(Be[j]));s.populateFromArray(L,B,w);break;case"overwrite":default:x.row=p.row,x.col=p.col;let _e=0,be=0,it=!0,oi;const ks=function(Ot){let vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const et=w[Ot%w.length];return vt!==null?et[vt%et.length]:et},Cr=w.length,gn=b?b.row-p.row+1:0;for(b?X=gn:X=Math.max(Cr,gn),j=0;j<X&&!(b&&x.row>b.row&&gn>Cr||!y.allowInsertRow&&x.row>s.countRows()-1||x.row>=y.maxRows);j++){const Rt=j-_e,Ot=ks(Rt).length,vt=b?b.col-p.col+1:0;if(b?R=vt:R=Math.max(Ot,vt),x.col=p.col,oi=s.getCellMeta(x.row,x.col),(N==="CopyPaste.paste"||N==="Autofill.fill")&&oi.skipRowOnPaste){_e+=1,x.row+=1,X+=1;continue}for(be=0,C=0;C<R&&!(b&&x.col>b.col&&vt>Ot||!y.allowInsertColumn&&x.col>s.countCols()-1||x.col>=y.maxCols);C++){if(oi=s.getCellMeta(x.row,x.col),(N==="CopyPaste.paste"||N==="Autofill.fill")&&oi.skipColumnOnPaste){be+=1,x.col+=1,R+=1;continue}if(oi.readOnly&&N!=="UndoRedo.undo"){x.col+=1;continue}const et=C-be;let Bi=ks(Rt,et),Gn=s.getDataAtCell(x.row,x.col);if(Bi!==null&&typeof Bi=="object")if(Array.isArray(Bi)&&Gn===null&&(Gn=[]),Gn===null||typeof Gn!="object")it=!1;else{const Da=Sc(Array.isArray(Gn)?Gn:Gn[0]||Gn),tg=Sc(Array.isArray(Bi)?Bi:Bi[0]||Bi);Bw(Da,tg)||Array.isArray(Da)&&Array.isArray(tg)?Bi=Yn(Bi):it=!1}else Gn!==null&&typeof Gn=="object"&&(it=!1);it&&_.push([x.row,x.col,Bi]),it=!0,x.col+=1}x.row+=1}s.setDataAtCell(_,null,null,N||"populateFromArray");break}}};function q(p){const w=B$(p);dM(w)?(s.runHooks("beforeLanguageChange",w),M.language=w,s.runHooks("afterLanguageChange",w)):j$(p)}function ne(p,w){const b=p==="className"?s.rootElement:s.table;if(f)K(b,w);else{let N=[],V=[];M[p]&&(N=Array.isArray(M[p])?M[p]:a0(M[p])),w&&(V=Array.isArray(w)?w:a0(w));const j=o0(N,V),X=o0(V,N);j.length&&me(b,j),X.length&&K(b,X)}M[p]=w}this.init=function(){l.setData(y.data),s.runHooks("beforeInit"),(Fr()||tE())&&K(s.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new m4(this);const p=y.themeName||uH(s.rootContainer);s.useTheme(p),c=d0.getInstance(s,y,O),d=M9(s),h=new WK(s),Ju(this)&&v9(s),s.runHooks("init"),this.render(),f&&s.rootElement.offsetParent===null&&XF(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function Q(){let p=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,p=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&p===!1&&(p=!0,this.onQueueEmpty(this.valid))}}}function te(p){const w=p.replace(",",".");return isNaN(parseFloat(w))===!1?parseFloat(w):p}function Me(p,w,b){if(!p.length){b();return}const N=s.getActiveEditor(),V=new Q;let j=!0;V.onQueueEmpty=()=>{N&&j&&N.cancelChanges(),b()};for(let X=p.length-1;X>=0;X--){const[C,R]=p[X],_=a.propToCol(R);let x;Number.isInteger(_)?x=s.getCellMeta(C,_):x={...Object.getPrototypeOf(y),...y},s.getCellValidator(x)&&(V.addValidatorToQueue(),s.validateCell(p[X][3],x,function(H,L){return function(B){if(typeof B!="boolean")throw new Error("Validation error: result is not boolean");B===!1&&L.allowInvalid===!1&&(j=!1,p.splice(H,1),L.valid=!0),V.removeValidatorFormQueue()}}(X,x),w))}V.checkIfQueueIsEmpty()}function Ce(p,w){for(let N=p.length-1;N>=0;N--){let V=!1;if(p[N]===null){p.splice(N,1);continue}if(!((p[N][2]===null||p[N][2]===void 0)&&(p[N][3]===null||p[N][3]===void 0))){if(y.allowInsertRow)for(;p[N][0]>s.countRows()-1;){const{delta:j}=a.createRow(void 0,void 0,{source:"auto"});if(j===0){V=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;a.propToCol(p[N][1])>s.countCols()-1;){const{delta:j}=a.createCol(void 0,void 0,{source:"auto"});if(j===0){V=!0;break}}V||a.set(p[N][0],p[N][1],p[N][3])}}if(p.length>0){u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",p,w),c.closeEditor(),s.render(),c.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",p,w||"edit");const N=s.getActiveEditor();N&&le(N.refreshValue)&&N.refreshValue()}else s.render()}this._createCellCoords=function(p,w){return s.view._wt.createCellCoords(p,w)},this._createCellRange=function(p,w,b){return s.view._wt.createCellRange(p,w,b)},this.validateCell=function(p,w,b,N){let V=s.getCellValidator(w);function j(X){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){b(X);return}const R=w.visualCol,_=w.visualRow,x=s.getCell(_,R,!0);if(x&&x.nodeName!=="TH"){const H=s.rowIndexMapper.getRenderableFromVisualIndex(_),L=s.columnIndexMapper.getRenderableFromVisualIndex(R);s.view._wt.getSetting("cellRenderer",H,L,x)}b(X)}bF(V)&&(V=function(X){return function(C,R){R(X.test(C))}}(V)),st(V)?(p=s.runHooks("beforeValidate",p,w.visualRow,w.prop,N),s._registerImmediate(()=>{V.call(w,p,X=>{s&&(X=s.runHooks("afterValidate",X,p,w.visualRow,w.prop,N),w.valid=X,j(X),s.runHooks("postAfterValidate",X,p,w.visualRow,w.prop,N))})})):s._registerImmediate(()=>{w.valid=!0,j(w.valid,!1)})};function Ie(p,w,b){return Array.isArray(p)?p:[[p,w,b]]}function at(p,w){const b=s.runHooks("beforeChange",p,w||"edit"),N=p.filter(j=>j!==null);if(b===!1||N.length===0){var V;return(V=s.getActiveEditor())===null||V===void 0||V.cancelChanges(),[]}for(let j=N.length-1;j>=0;j--){const[X,C,,R]=N[j],_=a.propToCol(C);let x;Number.isInteger(_)?x=s.getCellMeta(X,_):x={...Object.getPrototypeOf(y),...y};const{type:H,checkedTemplate:L,uncheckedTemplate:B}=x;if(H==="numeric"&&typeof R=="string"&&h$(R)&&(N[j][3]=te(R)),H==="checkbox"){const D=bt(R),F=D===bt(L),W=D===bt(B);(F||W)&&(N[j][3]=F?L:B)}}return N}this.setDataAtCell=function(p,w,b,N){const V=Ie(p,w,b),j=[];let X=N,C,R,_;for(C=0,R=V.length;C<R;C++){if(typeof V[C]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof V[C][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");V[C][1]>=this.countCols()?_=V[C][1]:_=a.colToProp(V[C][1]),j.push([V[C][0],_,l.getAtCell(this.toPhysicalRow(V[C][0]),V[C][1]),V[C][2]])}!X&&typeof p=="object"&&(X=w);const x=at(j,X);s.runHooks("afterSetDataAtCell",x,X),Me(x,X,()=>{Ce(x,X)})},this.setDataAtRowProp=function(p,w,b,N){const V=Ie(p,w,b),j=[];let X=N,C,R;for(C=0,R=V.length;C<R;C++)j.push([V[C][0],V[C][1],l.getAtCell(this.toPhysicalRow(V[C][0]),V[C][1]),V[C][2]]);!X&&typeof p=="object"&&(X=w);const _=at(j,N);s.runHooks("afterSetDataAtRowProp",_,X),Me(_,X,()=>{Ce(_,X)})},this.listen=function(){s&&!s.isListening()&&(eS.forEach(p=>{s!==p&&p.unlisten()}),Jb=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Jb=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Jb===s.guid},this.destroyEditor=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(p),s.view.render(),w&&O.isSelected()&&c.prepareEditor()},this.populateFromArray=function(p,w,b,N,V,j,X){if(!(typeof b=="object"&&typeof b[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const C=typeof N=="number"?s._createCellCoords(N,V):null;return u.populateFromArray(s._createCellCoords(p,w),b,C,j,X)},this.spliceCol=function(p,w,b){for(var N=arguments.length,V=new Array(N>3?N-3:0),j=3;j<N;j++)V[j-3]=arguments[j];return a.spliceCol(p,w,b,...V)},this.spliceRow=function(p,w,b){for(var N=arguments.length,V=new Array(N>3?N-3:0),j=3;j<N;j++)V[j-3]=arguments[j];return a.spliceRow(p,w,b,...V)},this.getSelected=function(){if(O.isSelected())return Ve(O.getSelectedRange(),p=>{let{from:w,to:b}=p;return[w.row,w.col,b.row,b.col]})},this.getSelectedLast=function(){const p=this.getSelected();let w;return p&&p.length>0&&(w=p[p.length-1]),w},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){const p=this.getSelectedRange();let w;return p&&p.length>0&&(w=p[p.length-1]),w},this.emptySelectedCells=function(p){if(!O.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];A(O.getSelectedRange(),b=>{if(b.isSingleHeader())return;const N=b.getTopStartCorner(),V=b.getBottomEndCorner();de(N.row,V.row,j=>{de(N.col,V.col,X=>{this.getCellMeta(j,X).readOnly||w.push([j,X,null])})})}),w.length>0&&this.setDataAtCell(w,p)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const p=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(p,0),!this.isRenderSuspended()&&p===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(p){this.suspendRender();const w=p();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||p)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(p){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const b=p();return this.resumeExecution(w),b},this.batch=function(p){this.suspendRender(),this.suspendExecution();const w=p();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!s.view)return;const p=s.view,{width:w,height:b}=p.getLastSize(),{width:N,height:V}=s.rootElement.getBoundingClientRect(),j=N!==w||V!==b;s.runHooks("beforeRefreshDimensions",{width:w,height:b},{width:N,height:V},j)!==!1&&((j||p._wt.wtOverlays.scrollableElement===s.rootWindow)&&(p.setLastSize(N,V),s.render(),p.adjustElementsSize()),s.runHooks("afterRefreshDimensions",{width:w,height:b},{width:N,height:V},j))},this.updateData=function(p,w){iH(p,b=>{a=b},b=>{a=b,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),O.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:w,metaManager:S,firstRun:f})},this.loadData=function(p,w){iH(p,b=>{a=b},()=>{S.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),O.refresh(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:w,metaManager:S,firstRun:f})},this.getInitialColumnCount=function(){const p=y.columns;let w=0;if(Array.isArray(p))w=p.length;else if(st(p))if(s.dataType==="array"){const b=this.countSourceCols();for(let N=0;N<b;N+=1)p(N)&&(w+=1)}else(s.dataType==="object"||s.dataType==="function")&&(w=a.colToPropCache.length);else if(le(y.dataSchema)){const b=a.getSchema();w=Array.isArray(b)?b.length:jw(b)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(p,w,b,N){return Mt(p)?a.getAll():a.getRange(s._createCellCoords(p,w),s._createCellCoords(b,N),a.DESTINATION_RENDERER)},this.getCopyableText=function(p,w,b,N){return a.getCopyableText(s._createCellCoords(p,w),s._createCellCoords(b,N))},this.getCopyableData=function(p,w){return a.getCopyable(p,a.colToProp(w))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(p){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=(f?s.loadData:s.updateData).bind(this);let N=!1,V,j;if(le(p.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(p.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(p.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');p.language&&q(p.language);for(V in p)if(!(V==="data"||V==="language"))if(V==="className")ne("className",p.className);else if(V==="tableClassName"&&s.table)ne("tableClassName",p.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(re.getSingleton().isRegistered(V)||re.getSingleton().isDeprecated(V)){const x=p[V];st(x)?(re.getSingleton().addAsFixed(V,x,s),y[V]=x):Array.isArray(x)&&(re.getSingleton().add(V,x,s),y[V]=x)}else!w&&Qt(p,V)&&(M[V]=p[V]);p.data===void 0&&y.data===void 0?b(null,"updateSettings"):p.data!==void 0?b(p.data,"updateSettings"):p.columns!==void 0&&(a.createMap(),s.initIndexMappers());const X=s.countCols(),C=y.columns;if(C&&st(C)&&(N=!0),(p.cell!==void 0||p.cells!==void 0||p.columns!==void 0)&&S.clearCache(),X>0)for(V=0,j=0;V<X;V++){if(C){const x=N?C(V):C[j];x&&S.updateColumnMeta(j,x)}j+=1}le(p.cell)&&He(p.cell,x=>{s.setCellMetaObject(x.row,x.col,x)}),s.runHooks("afterCellMetaReset");let R=s.rootElement.style.height;R!==""&&(R=parseInt(s.rootElement.style.height,10));let _=p.height;if(st(_)&&(_=_()),w&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),_===null){const x=s.rootElement.getAttribute("data-initialstyle");x&&(x.indexOf("height")>-1||x.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",x):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else _!==void 0&&(s.rootElement.style.height=isNaN(_)?`${_}`:`${_}px`,s.rootElement.style.overflow="hidden");if(typeof p.width<"u"){let x=p.width;st(x)&&(x=x()),s.rootElement.style.width=isNaN(x)?`${x}`:`${x}px`}if(!w){if(s.view){s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames();const x=s.getCurrentThemeName();Qt(p,"themeName")&&x!==p.themeName&&s.useTheme(p.themeName)}s.runHooks("afterUpdateSettings",p)}u.adjustRowsAndCols(),s.view&&!f&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!w&&s.view&&(R===""||_===""||_===void 0)&&R!==_&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const p=s.getSelectedLast();if(y.getValue){if(st(y.getValue))return y.getValue.call(s);if(p)return s.getData()[p[0][0]][y.getValue]}else if(p)return s.getDataAtCell(p[0],p[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(p,w,b,N,V){u.alter(p,w,b,N,V)},this.getCell=function(p,w){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,N=w,V=p;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;N=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(p>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(p)))return null;V=this.rowIndexMapper.getRenderableFromVisualIndex(p)}return V===null||N===null||V===void 0||N===void 0?null:s.view.getCellAtCoords(s._createCellCoords(V,N),b)},this.getCoords=function(p){const w=this.view._wt.wtTable.getCoords(p);if(w===null)return null;const{row:b,col:N}=w;let V=b,j=N;return b>=0&&(V=this.rowIndexMapper.getVisualFromRenderableIndex(b)),N>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(N)),s._createCellCoords(V,j)},this.colToProp=function(p){return a.colToProp(p)},this.propToCol=function(p){return a.propToCol(p)},this.toVisualRow=p=>this.rowIndexMapper.getVisualFromPhysicalIndex(p),this.toVisualColumn=p=>this.columnIndexMapper.getVisualFromPhysicalIndex(p),this.toPhysicalRow=p=>this.rowIndexMapper.getPhysicalFromVisualIndex(p),this.toPhysicalColumn=p=>this.columnIndexMapper.getPhysicalFromVisualIndex(p),this.getDataAtCell=function(p,w){return a.get(p,a.colToProp(w))},this.getDataAtRowProp=function(p,w){return a.get(p,w)},this.getDataAtCol=function(p){const w=[],b=a.getRange(s._createCellCoords(0,p),s._createCellCoords(y.data.length-1,p),a.DESTINATION_RENDERER);for(let N=0;N<b.length;N+=1)for(let V=0;V<b[N].length;V+=1)w.push(b[N][V]);return w},this.getDataAtProp=function(p){const w=[],b=a.getRange(s._createCellCoords(0,a.propToCol(p)),s._createCellCoords(y.data.length-1,a.propToCol(p)),a.DESTINATION_RENDERER);for(let N=0;N<b.length;N+=1)for(let V=0;V<b[N].length;V+=1)w.push(b[N][V]);return w},this.getSourceData=function(p,w,b,N){let V;return p===void 0?V=l.getData():V=l.getByRange(s._createCellCoords(p,w),s._createCellCoords(b,N)),V},this.getSourceDataArray=function(p,w,b,N){let V;return p===void 0?V=l.getData(!0):V=l.getByRange(s._createCellCoords(p,w),s._createCellCoords(b,N),!0),V},this.getSourceDataAtCol=function(p){return l.getAtColumn(p)},this.setSourceDataAtCell=function(p,w,b,N){const V=Ie(p,w,b),j=this.hasHook("afterSetSourceDataAtCell"),X=[];j&&A(V,R=>{let[_,x,H]=R;X.push([_,x,l.getAtCell(_,x),H])}),A(V,R=>{let[_,x,H]=R;l.setAtCell(_,x,H)}),j&&this.runHooks("afterSetSourceDataAtCell",X,N),this.render();const C=s.getActiveEditor();C&&le(C.refreshValue)&&C.refreshValue()},this.getSourceDataAtRow=function(p){return l.getAtRow(p)},this.getSourceDataAtCell=function(p,w){return l.getAtCell(p,w)},this.getDataAtRow=function(p){return a.getRange(s._createCellCoords(p,0),s._createCellCoords(p,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(p,w,b,N){const V=p===void 0?[0,0,this.countRows(),this.countCols()]:[p,w,b,N],[j,X]=V;let[,,C,R]=V,_=null,x=null;C===void 0&&(C=j),R===void 0&&(R=X);let H="mixed";return de(Math.max(Math.min(j,C),0),Math.max(j,C),L=>{let B=!0;return de(Math.max(Math.min(X,R),0),Math.max(X,R),D=>(x=this.getCellMeta(L,D).type,_?B=_===x:_=x,B)),H=B?x:"mixed",B}),H},this.removeCellMeta=function(p,w,b){const[N,V]=[this.toPhysicalRow(p),this.toPhysicalColumn(w)];let j=S.getCellMetaKeyValue(N,V,b);s.runHooks("beforeRemoveCellMeta",p,w,b,j)!==!1&&(S.removeCellMeta(N,V,b),s.runHooks("afterRemoveCellMeta",p,w,b,j)),j=null},this.spliceCellsMeta=function(p){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var b=arguments.length,N=new Array(b>2?b-2:0),V=2;V<b;V++)N[V-2]=arguments[V];if(N.length>0&&!Array.isArray(N[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&S.removeRow(this.toPhysicalRow(p),w),N.length>0&&A(N.reverse(),j=>{S.createRow(this.toPhysicalRow(p)),A(j,(X,C)=>this.setCellMetaObject(p,C,X))}),s.render()},this.setCellMetaObject=function(p,w,b){typeof b=="object"&&He(b,(N,V)=>{this.setCellMeta(p,w,V,N)})},this.setCellMeta=function(p,w,b,N){if(s.runHooks("beforeSetCellMeta",p,w,b,N)===!1)return;let j=p,X=w;p<this.countRows()&&(j=this.toPhysicalRow(p)),w<this.countCols()&&(X=this.toPhysicalColumn(w)),S.setCellMeta(j,X,b,N),s.runHooks("afterSetCellMeta",p,w,b,N)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(p,w){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},N=this.toPhysicalRow(p),V=this.toPhysicalColumn(w);return N===null&&(N=p),V===null&&(V=w),S.getCellMeta(N,V,{visualRow:p,visualColumn:w,...b})},this.getColumnMeta=function(p){return S.getColumnMeta(this.toPhysicalColumn(p))},this.getCellMetaAtRow=function(p){return S.getCellsMetaAtRow(p)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(p,w){const b=typeof p=="number"?s.getCellMeta(p,w).renderer:p.renderer;return typeof b=="string"?Ap(b):Mt(b)?Ap("text"):b},this.getCellEditor=function(p,w){const b=typeof p=="number"?s.getCellMeta(p,w).editor:p.editor;return typeof b=="string"?Op(b):Mt(b)?Op("text"):b},this.getCellValidator=function(p,w){const b=typeof p=="number"?s.getCellMeta(p,w).validator:p.validator;return typeof b=="string"?CE(b):b},this.validateCells=function(p){this._validateCells(p)},this.validateRows=function(p,w){if(!Array.isArray(p))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,p)},this.validateColumns=function(p,w){if(!Array.isArray(p))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,p)},this._validateCells=function(p,w,b){const N=new Q;p&&(N.onQueueEmpty=p);let V=s.countRows()-1;for(;V>=0;){if(w!==void 0&&w.indexOf(V)===-1){V-=1;continue}let j=s.countCols()-1;for(;j>=0;){if(b!==void 0&&b.indexOf(j)===-1){j-=1;continue}N.addValidatorToQueue(),s.validateCell(s.getDataAtCell(V,j),s.getCellMeta(V,j),X=>{if(typeof X!="boolean")throw new Error("Validation error: result is not boolean");X===!1&&(N.valid=!1),N.removeValidatorFormQueue()},"validateCells"),j-=1}V-=1}N.checkIfQueueIsEmpty()},this.getRowHeader=function(p){let w=y.rowHeaders,b=p;return b!==void 0&&(b=s.runHooks("modifyRowHeader",b)),b===void 0?(w=[],de(s.countRows()-1,N=>{w.push(s.getRowHeader(N))})):Array.isArray(w)&&w[b]!==void 0?w=w[b]:st(w)?w=w(b):w&&typeof w!="string"&&typeof w!="number"&&(w=b+1),w},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let p=0,w=s.countCols();p<w;p++)if(s.getColHeader(p))return!0;return!1},this.getColHeader=function(p){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const b=s.runHooks("modifyColHeader",p);if(b===void 0){const C=[],R=s.countCols();for(let _=0;_<R;_++)C.push(s.getColHeader(_));return C}let N=y.colHeaders;const V=function(C){const R=[],_=s.countCols();let x=0;for(;x<_;x++)st(y.columns)&&y.columns(x)&&R.push(x);return R[C]},j=s.toPhysicalColumn(b),X=V(j);return y.colHeaders===!1?N=null:y.columns&&st(y.columns)&&y.columns(X)&&y.columns(X).title?N=y.columns(X).title:y.columns&&y.columns[j]&&y.columns[j].title?N=y.columns[j].title:Array.isArray(y.colHeaders)&&y.colHeaders[j]!==void 0?N=y.colHeaders[j]:st(y.colHeaders)?N=y.colHeaders(j):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(N=Jw(b)),N=s.runHooks("modifyColumnHeaderValue",N,p,w),N},this._getColWidthFromSettings=function(p){let w;if(p>=0&&(w=s.getCellMeta(0,p).width),(w===void 0||w===y.width)&&(w=y.colWidths),w!=null){switch(typeof w){case"object":w=w[p];break;case"function":w=w(p);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(p,w){let b=s._getColWidthFromSettings(p);return b=s.runHooks("modifyColWidth",b,p,w),b===void 0&&(b=Ec),b},this._getRowHeightFromSettings=function(p){const w=s.stylesHandler.getDefaultRowHeight();let b=y.rowHeights;if(b!=null){switch(typeof b){case"object":b=b[p];break;case"function":b=b(p);break}typeof b=="string"&&(b=parseInt(b,10))}return b!=null&&b<w?w:b},this.getRowHeight=function(p,w){let b=s._getRowHeightFromSettings(p);return b=s.runHooks("modifyRowHeight",b,p,w),b},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const p=y.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(p,w)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return m0(s.countRows()-1,b=>{if(s.isEmptyRow(b))w+=1;else if(p===!0)return!1}),w},this.countEmptyCols=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return m0(s.countCols()-1,b=>{if(s.isEmptyCol(b))w+=1;else if(p===!0)return!1}),w},this.isEmptyRow=function(p){return y.isEmptyRow.call(s,p)},this.isEmptyCol=function(p){return y.isEmptyCol.call(s,p)},this.selectCell=function(p,w,b,N){let V=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Mt(p)||Mt(w)?!1:this.selectCells([[p,w,b,N]],V,j)},this.selectCells=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&d.suspend();const N=O.selectCells(p);return N&&b&&s.listen(),d.resume(),N},this.selectColumns=function(p){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p,b=arguments.length>2?arguments[2]:void 0;return O.selectColumns(p,w,b)},this.selectRows=function(p){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p,b=arguments.length>2?arguments[2]:void 0;return O.selectRows(p,w,b)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p,b=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),O.selectAll(p,w,b)};const Le=(p,w)=>p.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(p,w){if(typeof p=="number"){var b;p={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(b=arguments[4])!==null&&b!==void 0?b:!0}}const{row:N,col:V,considerHiddenIndexes:j}=p??{};let X=N,C=V;if(st(w)&&this.addHookOnce("afterScroll",w),j===void 0||j){const H=Number.isInteger(N)&&N>=0,L=Number.isInteger(V)&&V>=0,B=H?Le(this.rowIndexMapper,N):void 0,D=L?Le(this.columnIndexMapper,V):void 0;if(B===null||D===null)return!1;X=H?s.rowIndexMapper.getRenderableFromVisualIndex(B):N,C=L?s.columnIndexMapper.getRenderableFromVisualIndex(D):V}const R=Number.isInteger(X),_=Number.isInteger(C);let x=!1;return R&&X>=0&&_&&C>=0?x=s.view.scrollViewport(s._createCellCoords(X,C),p.horizontalSnap,p.verticalSnap):R&&X>=0&&(_&&C<0||!_)?x=s.view.scrollViewportVertically(X,p.verticalSnap):_&&C>=0&&(R&&X<0||!R)&&(x=s.view.scrollViewportHorizontally(C,p.horizontalSnap)),st(w)&&(x?this.view.render():(this.removeHook("afterScroll",w),this._registerMicrotask(()=>w()))),x},this.scrollToFocusedCell=function(p){if(!this.selection.isSelected())return!1;st(p)&&this.addHookOnce("afterScroll",p);const{highlight:w}=this.getSelectedRangeLast(),b=this.scrollViewportTo(w.toObject());return b?this.view.render():st(p)&&(this.removeHook("afterScroll",p),this._registerMicrotask(()=>p())),b},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),P.clear(),S.clearCache(),eS.delete(this.guid),o.destroy(),c&&c.destroy(),s.rootContainer&&Ps(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),I.getItems().forEach(p=>{let[,w]=p;w.destroy()}),I.clear(),s.runHooks("afterDestroy")},!0),re.getSingleton().destroy(s),He(s,(p,w,b)=>{st(p)?b[w]=Ge(w):w!=="guid"&&(b[w]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,u=null,O=null,c=null,s=null};function Ge(p){return()=>{throw new Error(`The "${p}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(p){return I.getItem(Un(p))},this.getPluginName=function(p){return p===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:I.getId(p)},this.getInstance=function(){return s},this.addHook=function(p,w,b){re.getSingleton().add(p,w,s,b)},this.hasHook=function(p){return re.getSingleton().has(p,s)||re.getSingleton().has(p)},this.addHookOnce=function(p,w,b){re.getSingleton().once(p,w,s,b)},this.removeHook=function(p,w){re.getSingleton().remove(p,w,s)},this.runHooks=function(p,w,b,N,V,j,X){return re.getSingleton().run(s,p,w,b,N,V,j,X)},this.getTranslatedPhrase=function(p,w){return K$(y.language,p,w)},this.toHTML=()=>f0(this),this.toTableElement=()=>{const p=this.rootDocument.createElement("div");return p.insertAdjacentHTML("afterbegin",f0(this)),p.firstElementChild},this.timeouts=[],this.useTheme=p=>{const w=!!f;this.stylesHandler.useTheme(p);const b=this.stylesHandler.getThemeName();Ju(this)&&(me(this.rootWrapperElement,/ht-theme-.*/g),me(this.rootPortalElement,/ht-theme-.*/g),b&&(K(this.rootWrapperElement,b),K(this.rootPortalElement,b),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Je(`The "${b}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),w||(s.render(),s.scrollViewportTo(0,0),uH(this.rootContainer)&&(me(this.rootContainer,/ht-theme-.*/g),b&&K(this.rootContainer,b))),this.runHooks("afterSetTheme",b,w)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(p){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=p;typeof b=="function"&&(b=setTimeout(b,w)),this.timeouts.push(b)},this._clearTimeouts=function(){A(this.timeouts,p=>{clearTimeout(p)})},this.immediates=[],this._registerImmediate=function(p){this.immediates.push(setImmediate(p))},this._clearImmediates=function(){A(this.immediates,p=>{clearImmediate(p)})},this._registerMicrotask=function(p){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||p()})},this._getEditorManager=function(){return c};const St=H9({handleEvent(){return s.isListening()},beforeKeyDown:p=>this.runHooks("beforeKeyDown",p),afterKeyDown:p=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",p)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",p=>{p.ctrlKey===!1&&p.metaKey===!1&&St.releasePressedKeys()}),this.getShortcutManager=function(){return St},this.getFocusManager=function(){return h},yE().forEach(p=>{const w=$f(p);I.addItem(p,new w(this))}),p9(s),St.setActiveContextName("grid"),re.getSingleton().run(s,"construct")}function pH(t,e,n){t.addEventListener(e,n,!1)}function wH(t,e,n){t.removeEventListener(e,n,!1)}function Hg(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function fV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},i=t.body,r=t.createTextNode(""),s=t.createElement("span");let o;function a(){var h,d;r.textContent=n.textContent(o),s.style.position="absolute",s.style.fontSize=Hg(o).fontSize,s.style.fontFamily=Hg(o).fontFamily,s.style.whiteSpace="pre",i.appendChild(s);const f=parseInt(((h=Hg(o))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=Hg(o))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),m=s.clientWidth+f+g+1;i.removeChild(s);const v=o.style;v.height=`${n.minHeight}px`,n.minWidth>m?v.width=`${n.minWidth}px`:m>n.maxWidth?v.width=`${n.maxWidth}px`:v.width=`${m}px`;const S=o.scrollHeight?o.scrollHeight-1:0;n.minHeight>S?v.height=`${n.minHeight}px`:n.maxHeight<S?(v.height=`${n.maxHeight}px`,v.overflowY="visible"):v.height=`${S}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=o.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=o.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=o.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=o.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(r))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=h,u(d),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${n.minHeight}px`,o.style.minWidth=`${n.minWidth}px`,o.style.maxWidth=`${n.maxWidth}px`,o.style.overflowY="hidden"),f&&(pH(o,"input",a),pH(o,"keydown",l)),a()}return{init:c,resize:a,unObserve(){wH(o,"input",a),wH(o,"keydown",l)}}}function vH(t,e){const n=oE(e),i=e.value.split(`
`);let r=n,s=0;for(let o=0;o<i.length;o++){const a=i[o];o!==0&&(s+=i[o-1].length+1);const l=s+a.length;if(t==="home"?r=s:t==="end"&&(r=l),n<=l)break}kf(e,r)}function Ua(t,e,n){return(e=B9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B9(t){var e=j9(t,"string");return typeof e=="symbol"?e:e+""}function j9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const z9="ht_editor_visible",Dg="ht_editor_hidden",yH="textEditor",U9="text";class ou extends Uc{static get EDITOR_TYPE(){return U9}constructor(e){super(e),Ua(this,"eventManager",new cr(this)),Ua(this,"autoResize",fV(this.hot.rootDocument)),Ua(this,"TEXTAREA",void 0),Ua(this,"textareaStyle",void 0),Ua(this,"TEXTAREA_PARENT",void 0),Ua(this,"textareaParentStyle",void 0),Ua(this,"layerClass",void 0),this.eventManager=new cr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),_d(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,i,r,s,o){const a=this.state;if(super.prepare(e,n,i,r,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Ut.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Ut.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),kf(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),ve(this.TEXTAREA,[["data-hot-input",""],Oa(-1)]),K(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),K(this.TEXTAREA_PARENT,"handsontableInputHolder"),ye(this.TEXTAREA_PARENT,this.layerClass)&&me(this.TEXTAREA_PARENT,this.layerClass),K(this.TEXTAREA_PARENT,Dg),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){FF()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",me(this.TEXTAREA_PARENT,this.layerClass),K(this.TEXTAREA_PARENT,Dg)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;de(e.length-1,i=>{const r=e[i];if(ye(r,"handsontableEditor"))return n=!0,!1}),ye(this.TEXTAREA_PARENT,Dg)&&me(this.TEXTAREA_PARENT,Dg),n?(this.layerClass=z9,K(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),K(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Ut.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:i,width:r,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,s),minHeight:Math.min(o,a),maxWidth:s,maxHeight:a},!0)}bindEvents(){eE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Ut.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Ut.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>le(this.hot.getSelected()),group:yH},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;vH(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;vH(a,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(yH)}}const Y9="base",G9="htTextEllipsis";function zf(t,e,n,i,r,s,o){const a=o.ariaTags,l=[],u=[],c=[],h=[];o.className&&K(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&h.push(S1())):a&&c.push(S1()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&h.push(R1())):(u.push(o.invalidCellClassName),a&&c.push(R1()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),o.textEllipsis&&l.push(G9),me(e,u),K(e,l),iu(e,c),ve(e,h)}zf.RENDERER_TYPE=Y9;const q9="text";function Io(t,e,n,i,r,s,o){zf.apply(this,[t,e,n,i,r,s,o]);let a=s;!a&&o.placeholder&&(a=o.placeholder),a=bt(a),o.trimWhitespace&&(a=a.trim()),Ra(e,a)}Io.RENDERER_TYPE=q9;const K9="text",gV={CELL_TYPE:K9,editor:ou,renderer:Io};Xi(gV);Se.editors={BaseEditor:Uc};function Se(t,e){const n=new dV(t,e||{},kE);return n.init(),n}Se.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new dV(t,e,kE)};Se.DefaultSettings=nV();Se.hooks=re.getSingleton();Se.CellCoords=jl;Se.CellRange=Vf;Se.packageName="handsontable";Se.buildDate="09/07/2025 09:58:41";Se.version="16.0.0";Se.languages={dictionaryKeys:r6,getLanguageDictionary:q$,getLanguagesDictionaries:u6,registerLanguageDictionary:G$,getTranslatedPhrase:K$};function CH(t,e,n){return(e=X9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X9(t){var e=Z9(t,"string");return typeof e=="symbol"?e:e+""}function Z9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bH="handsontableEditor",Q9="handsontable";class wM extends ou{constructor(){super(...arguments),CH(this,"isFlippedVertically",!1),CH(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return Q9}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),kf(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&tn(l,o.handsontable),this.htOptions=l}beginEditing(e,n){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,n,i)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let i=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;i=Math.max(i+a,0)}const r=this.getDropdownHeight(),s=e.getWorkspaceHeight()-i-n.height,o=r>s&&i>s+n.height;return o?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:o,spaceAbove:i,spaceBelow:s}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let i=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;i=Math.max(i+a,0)}const r=this.getDropdownWidth(),s=e.getWorkspaceWidth()-i+n.width,o=r>s&&i>s;return o?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:o,spaceInlineStart:i,spaceInlineEnd:s}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:bH,relativeToGroup:Ha,position:"before"},r=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||this.isFlippedVertically&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),wr(o),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&this.isFlippedVertically?a=o.countRows()-1:o.getSelectedLast()&&(this.isFlippedVertically?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),r(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!this.isFlippedVertically)a=0;else if(o.getSelectedLast()){if(this.isFlippedVertically)a=o.getSelectedLast()[0]+1;else if(!this.isFlippedVertically){const u=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(u,l+1)}}return r(a,s)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(bH)}}function J9(t,e){mV(t,e),e.add(t)}function SH(t,e,n){mV(t,e),e.set(t,n)}function mV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ng(t,e,n){return(e=e7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e7(t){var e=t7(t,"string");return typeof e=="symbol"?e:e+""}function t7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tS(t,e){return t.get(P0(t,e))}function P0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const n7="autocomplete";var nS=new WeakMap,RH=new WeakMap,iS=new WeakSet;class vM extends wM{constructor(){super(...arguments),J9(this,iS),Ng(this,"query",null),Ng(this,"strippedChoices",[]),Ng(this,"rawChoices",[]),SH(this,nS,this.hot.guid.slice(0,9)),SH(this,RH,Ff(()=>{this.focus()},100)),Ng(this,"sortByRelevance",function(e,n,i){const r=[],s=[],o=e.length;let a=n.length,l,u,c,h;if(o===0){for(c=0;c<a;c++)s.push(c);return s}for(c=0;c<a;c++){if(u=u0(bt(n[c])),i)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-o,r.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(r.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=r.length;c<a;c++)s.push(r[c].baseIndex);return s})}static get EDITOR_TYPE(){return n7}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),K(this.htContainer,"autocompleteEditor"),K(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[Aq(),Mq(),TF("listbox"),kq()])}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[lr("false"),Lq(`${tS(nS,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i?.length,{row:s,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",tS(RH,this)),this.htEditor.updateSettings({colWidths:e?[Gt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{Io(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:m,locale:v}=this.cellProperties,S=this.query;let y=bt(d),M,I;y&&!m&&(M=g===!0?y.indexOf(S):y.toLocaleLowerCase(v).indexOf(S.toLocaleLowerCase(v)),M!==-1&&(I=y.substr(M,S.length),y=y.replace(I,`<strong>${I}</strong>`))),n&&ve(l,[xq(),...i?[Wq(r)]:[],...i?[Bq(i.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=y},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{ve(h,[Z_()]),ve(this.TEXTAREA,...Fq(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(ve(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...fo()),ve(this.htEditor.rootElement,[EF(),$q("polite"),Vq("text"),["id",`${tS(nS,this)}-listbox-${s}-${o}`]]),ve(this.TEXTAREA,...lr("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[lr("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=oE(this.TEXTAREA),i=KF(this.TEXTAREA),r=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;r&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(o)?o.length:0;if(s===!1)u&&(a=o[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(r&&u<=h);h++)u?c.push(l[o[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(bd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),kf(this.TEXTAREA,n,n===i?void 0:i)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:i,spaceBelow:r}=e;return this.limitDropdownIfNeeded(n?i:r),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let i=0,r=0,s=null;do r=this.htEditor.stylesHandler.getDefaultRowHeight(),i+=r;while(i<e);s=i-r,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(i-r)}}updateDropdownDimensions(){const e=aE(),n=this.getTargetEditorWidth()+e,i=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:i}),P0(iS,this,_H).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),P0(iS,this,_H).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const r=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(r,s)=>s).reduce((r,s)=>{const o=this.hot.stylesHandler.getDefaultRowHeight()+(s===0?1:0);return r+o},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,i=Ve(e,s=>bt(s));return Ve(i,s=>n?s:u0(s))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),i={row:n?n.from.row:-1};let r=!1;return e===he.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),e===he.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(e){if(e$(e.keyCode)||e.keyCode===he.BACKSPACE||e.keyCode===he.DELETE||e.keyCode===he.INSERT){let n=10;if(e.keyCode===he.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function _H(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+Cn(this.hot.rootDocument)})}const i7="checkbox";class pV extends Uc{static get EDITOR_TYPE(){return i7}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');ye(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const ua=()=>window,ir=()=>window.document,I0=(t,e)=>window.setTimeout(t,e),hs=function(t,e,n,i){t.addEventListener(e,n,!!i)},Ys=function(t,e,n,i){t.removeEventListener(e,n,!!i)},r7=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Ai=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},rS=function(t,e){Ai(t,e)||(t.className=t.className===""?e:t.className+" "+e)},sS=function(t,e){t.className=r7((" "+t.className+" ").replace(" "+e+" "," "))},yM=function(t){return/Array/.test(Object.prototype.toString.call(t))},Li=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},s7=function(t){let e=t.getDay();return e===0||e===6},o7=function(t){return t%4===0&&t%100!==0||t%400===0},EH=function(t,e){return[31,o7(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},kg=function(t){Li(t)&&t.setHours(0,0,0,0)},Lg=function(t,e){return t.getTime()===e.getTime()},Fp=function(t,e,n){let i,r;for(i in e)r=t[i]!==void 0,r&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?Li(e[i])?n&&(t[i]=new Date(e[i].getTime())):yM(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=Fp({},e[i],n):(n||!r)&&(t[i]=e[i]);return t},TH=function(t,e,n){let i=ir().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=Fp(i,n),t.dispatchEvent(i)},MH=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Jr={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},xH=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},a7=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},l7=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),r=e,s=r-1,o=7,a=function(d){return(d+o-1)%o};t.setDate(n+s-a(i));let l=new Date(t.getFullYear(),0,r),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-s+a(l.getDay()))/o)},u7=function(t,e,n,i,r){let s=new Date(i,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():l7(s,r))+"</td>"},c7=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},h7=function(t){return"<tbody>"+t.join("")+"</tbody>"},d7=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+xH(t,e)+'">'+xH(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},f7=function(t,e,n,i,r,s){let o,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',f,g,m=!0,v=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(n===r?o-e:12+o-e)+'"'+(o===i?' selected="selected"':"")+(c&&o<u.minMonth||h&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",yM(u.yearRange)?(o=u.yearRange[0],a=u.yearRange[1]+1):(o=n-u.yearRange,a=1+n+u.yearRange),l=[];o<a&&o<=u.maxYear;o++)o>=u.minYear&&l.push('<option value="'+o+'"'+(o===n?' selected="selected"':"")+">"+o+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(i===0||u.minMonth>=i)&&(m=!1),h&&(i===11||u.maxMonth<=i)&&(v=!1),e===0&&(d+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(v?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},g7=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+d7(t)+h7(e)+"</table>"};function O0(t){let e=this,n=e.config(t);e._onMouseDown=function(r){if(!e._v)return;r=r||ua().event;let s=r.target||r.srcElement;if(s)if(Ai(s,"is-disabled")||(Ai(s,"pika-button")&&!Ai(s,"is-empty")&&!Ai(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),n.bound&&I0(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Ai(s,"pika-prev")?e.prevMonth():Ai(s,"pika-next")&&e.nextMonth()),Ai(s,"pika-select"))e._c=!0;else if(r.preventDefault)r.preventDefault();else return r.returnValue=!1,!1},e._onChange=function(r){r=r||ua().event;let s=r.target||r.srcElement;s&&(Ai(s,"pika-select-month")?e.gotoMonth(s.value):Ai(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(r){if(r=r||ua().event,e.isVisible())switch(r.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let r=this.moment(n.field.value,n.format,n.formatStrict);return r&&r.isValid()?r.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(r){let s;r.firedBy!==e&&(s=e._parseFieldValue(),Li(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let r=ir().activeElement;do if(Ai(r,"pika-single"))return;while(r=r.parentNode);e._c||(e._b=I0(function(){e.hide()},50)),e._c=!1},e._onClick=function(r){r=r||ua().event;let s=r.target||r.srcElement,o=s;if(s){!hasEventListeners&&Ai(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),hs(s,"change",e._onChange)));do if(Ai(o,"pika-single")||o===n.trigger)return;while(o=o.parentNode);e._v&&s!==n.trigger&&o!==n.trigger&&e.hide()}},e.el=ir().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),hs(e.el,"mousedown",e._onMouseDown,!0),hs(e.el,"touchend",e._onMouseDown,!0),hs(e.el,"change",e._onChange),n.keyboardInput&&hs(ir(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?ir().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),hs(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;Li(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",hs(n.trigger,"click",e._onInputClick),hs(n.trigger,"focus",e._onInputFocus),hs(n.trigger,"blur",e._onInputBlur)):this.show()}O0.prototype={config:function(t){this._o||(this._o=Fp({},Jr,!0));let e=Fp(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Li(e.minDate)||(e.minDate=!1),Li(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),yM(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Jr.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Li(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Li(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",TH(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Li(t))return;let n=this._o.minDate,i=this._o.maxDate;Li(n)&&t<n?t=n:Li(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),kg(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),TH(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Li(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,r;t==="add"?r=new Date(n.valueOf()+i):t==="subtract"&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=MH(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=MH({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(kg(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Jr.minDate,this._o.minYear=Jr.minYear,this._o.minMonth=Jr.minMonth,this._o.startRange=Jr.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(kg(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Jr.maxDate,this._o.maxYear=Jr.maxYear,this._o.maxMonth=Jr.maxMonth,this._o.endRange=Jr.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,i=e.maxYear,r=e.minMonth,s=e.maxMonth,o="",a;this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+f7(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&I0(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,i,r,s,o,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=ua().innerWidth||ir().documentElement.clientWidth,r=ua().innerHeight||ir().documentElement.clientHeight,s=ir().body.scrollTop||ir().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),o=l.left+ua().pageXOffset,a=l.bottom+ua().pageYOffset,(this._o.reposition&&o+e>i||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>r+s||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",rS(this.el,u?"left-aligned":"right-aligned"),rS(this.el,c?"bottom-aligned":"top-aligned"),sS(this.el,u?"right-aligned":"left-aligned"),sS(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,r=new Date,s=EH(t,e),o=new Date(t,e,1).getDay(),a=[],l=[];kg(r),i.firstDay>0&&(o-=i.firstDay,o<0&&(o+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=EH(h,u),g=s+o,m=g;for(;m>7;)m-=7;g+=7-m;let v=!1;for(let S=0,y=0;S<g;S++){let M=new Date(t,e,1+(S-o)),I=Li(this._d)?Lg(M,this._d):!1,P=Lg(M,r),E=i.events.indexOf(M.toDateString())!==-1,T=S<o||S>=s+o,$=1+(S-o),U=e,O=t,G=i.startRange&&Lg(i.startRange,M),q=i.endRange&&Lg(i.endRange,M),ne=i.startRange&&i.endRange&&i.startRange<M&&M<i.endRange,Q=i.minDate&&M<i.minDate||i.maxDate&&M>i.maxDate||i.disableWeekends&&s7(M)||i.disableDayFn&&i.disableDayFn(M);T&&(S<o?($=f+$,U=u,O=h):($=$-s,U=c,O=d));let te={day:$,month:U,year:O,hasEvent:E,isSelected:I,isToday:P,isDisabled:Q,isEmpty:T,isStartRange:G,isEndRange:q,isInRange:ne,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&I&&(v=!0),l.push(a7(te)),++y===7&&(i.showWeekNumber&&l.unshift(u7(this,S-o,e,t,i.firstWeekOfYearMinDays)),a.push(c7(l,i.isRTL,i.pickWholeWeek,v)),l=[],y=0,v=!1)}return g7(i,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),sS(this.el,"is-hidden"),this._o.bound&&(hs(ir(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Ys(ir(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),rS(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Ys(this.el,"mousedown",this._onMouseDown,!0),Ys(this.el,"touchend",this._onMouseDown,!0),Ys(this.el,"change",this._onChange),t.keyboardInput&&Ys(ir(),"keydown",this._onKeyChange),t.field&&(Ys(t.field,"change",this._onInputChange),t.bound&&(Ys(t.trigger,"click",this._onInputClick),Ys(t.trigger,"focus",this._onInputFocus),Ys(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function m7(t,e){p7(t,e),e.add(t)}function p7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PH(t,e,n){return(e=w7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w7(t){var e=v7(t,"string");return typeof e=="symbol"?e:e+""}function v7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wV="date",IH="dateEditor",y7="DD/MM/YYYY";var Fg=new WeakSet;class vV extends ou{constructor(){super(...arguments),m7(this,Fg),PH(this,"parentDestroyed",!1),PH(this,"$datePicker",null)}static get EDITOR_TYPE(){return wV}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof O0!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),K(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{ye(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:IH})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(IH),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=oS(Fg,this,aS).call(this),i=this.hot.view.isMouseDown(),r=e?gE(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new O0(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Z),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,Z(s,n,!0).isValid()&&this.$datePicker.setMoment(Z(s,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,Z(s,n,!0).isValid()&&this.$datePicker.setMoment(Z(s,n),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&Nf(i,this.cellProperties.datePickerConfig);const r=i.onSelect,s=i.onClose;return i.field=n,i.trigger=n,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=(e=i.format)!==null&&e!==void 0?e:oS(Fg,this,aS).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=o=>{let a=o;isNaN(a.getTime())||(a=Z(a).format(oS(Fg,this,aS).call(this))),this.setValue(a),r&&r(),Fr()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},i}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Ut.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(n=s.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),u=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),c=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+en(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Gt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function aS(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:y7}const C7="dropdown";class yV extends vM{static get EDITOR_TYPE(){return C7}prepare(e,n,i,r,s,o){o.filter=!1,o.strict=!0,super.prepare(e,n,i,r,s,o)}}const b7="numeric";class CV extends ou{static get EDITOR_TYPE(){return b7}}function S7(t,e,n){return(e=R7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R7(t){var e=_7(t,"string");return typeof e=="symbol"?e:e+""}function _7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const E7="password";class bV extends ou{constructor(){super(...arguments),S7(this,"autoResize",fV(this.hot.rootDocument,{textContent:e=>"â¢".repeat(e.value.length)}))}static get EDITOR_TYPE(){return E7}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Ps(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...Oa(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const lS="ht_editor_visible",OH="selectEditor",T7="select";class SV extends Uc{static get EDITOR_TYPE(){return T7}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...nu()),e.appendChild(this.hot.rootDocument.createTextNode("â¼")),K(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ye(this.selectWrapper,lS)&&me(this.selectWrapper,lS),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Ps(this.select),He(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,ru(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)n[e[i]]=e[i];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Ut.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:i,height:r}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${r}px`,s.width=`${i}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${n}px`,s.margin="0px",K(this.selectWrapper,lS)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={group:OH};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(OH)}}const M7="time";class RV extends ou{static get EDITOR_TYPE(){return M7}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o),this.TEXTAREA.dir="ltr"}}function x7(){wi(Uc),wi(vM),wi(pV),wi(vV),wi(yV),wi(wM),wi(CV),wi(bV),wi(SV),wi(ou),wi(RV)}const P7="html";function CM(t,e,n,i,r,s,o){zf.apply(this,[t,e,n,i,r,s,o]),ru(e,s??"",!1)}CM.RENDERER_TYPE=P7;const I7="autocomplete";function Gc(t,e,n,i,r,s,o){const{rootDocument:a}=t,l=o.allowHtml?CM:Io,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...nu()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[t,e,n,i,r,s,o]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),K(e,"htAutocomplete"),!t.acArrowListener){const h=new cr(t);t.acArrowListener=function(d){ye(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Gc.RENDERER_TYPE=I7;const O7="dropdown";function bM(t,e,n,i,r,s,o){Gc.apply(this,[t,e,n,i,r,s,o])}bM.RENDERER_TYPE=O7;const AH=new WeakMap,HH=new WeakMap,A7="htBadValue",xc="data-row",Pc="data-col",H7="checkboxRenderer",_V="checkbox";re.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:i,type:r,row:s,column:o,prop:a}=e;if(r===_V){if(i){const{value:l,property:u}=i;let c=n;if(l)c=typeof l=="function"?l(s,o,a,n):l;else if(u){const h=this.getDataAtRowProp(s,u);c=h!==null?h:n}t=c}return t}});function SM(t,e,n,i,r,s,o){const{rootDocument:a}=t,l=t.getSettings().ariaTags;zf.apply(this,[t,e,n,i,r,s,o]),D7(t);let u=N7(a);const c=o.label;let h=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),Ps(e),s===o.checkedTemplate||bt(s).toLocaleLowerCase(o.locale)===bt(o.checkedTemplate).toLocaleLowerCase(o.locale)?u.checked=!0:s===o.uncheckedTemplate||bt(s).toLocaleLowerCase(o.locale)===bt(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?u.checked=!1:Wt(s)?K(u,"noValue"):(u.style.display="none",K(u,A7),h=!0),ve(u,[[xc,n],[Pc,i]]),l&&ve(u,[bc(u.checked?t.getTranslatedPhrase(cM):t.getTranslatedPhrase(hM)),PF(u.checked),Pq()]),!h&&c){let m="";if(c.value)m=typeof c.value=="function"?c.value.call(this,n,i,r,s):c.value;else if(c.property){const S=t.getDataAtRowProp(n,c.property);m=S!==null?S:""}const v=k7(a,m,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(v),e.appendChild(u)):(v.appendChild(u),u=v):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(v)):(v.insertBefore(u,v.firstChild),u=v))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),AH.has(t)||(AH.set(t,!0),d());function d(){const v=t.getShortcutManager().getContext("grid"),S={group:H7,relativeToGroup:Ha,position:"before"};v.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var y;return(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const y=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&y?.highlight.isCell()&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var y;return(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight.isCell()}}],S)}function f(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=t.getSelectedRange(),S=[],y=new Map;let M=[],I=0;if(v){for(let P=0;P<v.length;P++){const{row:E,col:T}=v[P].getTopStartCorner(),{row:$,col:U}=v[P].getBottomEndCorner();for(let O=E;O<=$;O+=1)for(let G=T;G<=U;G+=1){const q=t.getCellMeta(O,G);if(q.hidden)continue;const ne={checkedTemplate:q.checkedTemplate,uncheckedTemplate:q.uncheckedTemplate};if(q.type!=="checkbox"){m===!0&&!q.readOnly&&(y.has(S.length)?y.set(S.length,[...y.get(S.length),[O,G,null]]):y.set(S.length,[[O,G,null]]));continue}if(q.readOnly===!0)continue;typeof q.checkedTemplate>"u"&&(q.checkedTemplate=!0),typeof q.uncheckedTemplate>"u"&&(q.uncheckedTemplate=!1);const Q=t.getDataAtCell(O,G);m===!1?[q.checkedTemplate,q.checkedTemplate.toString()].includes(Q)?M.push([O,G,q.uncheckedTemplate,ne]):[q.uncheckedTemplate,q.uncheckedTemplate.toString(),null,void 0].includes(Q)&&M.push([O,G,q.checkedTemplate,ne]):M.push([O,G,q.uncheckedTemplate,ne]),I+=1}S.push(I),I=0}M.every(P=>{let[,,E]=P;return E===M[0][2]})?M=M.map(P=>{let[E,T,$]=P;return[E,T,$]}):M=M.map(P=>{let[E,T,,$]=P;return[E,T,$.checkedTemplate]}),M.length>0&&S.forEach((P,E)=>{let T=M.splice(0,P);y.size&&y.has(E)&&(T=[...T,...y.get(E)]),t.setDataAtCell(T)})}}function g(){const m=t.getSelectedRange();if(m){for(let v=0;v<m.length;v++){const S=m[v].getTopStartCorner(),y=m[v].getBottomEndCorner();for(let M=S.row;M<=y.row;M++)for(let I=S.col;I<=y.col;I++){if(t.getCellMeta(M,I).readOnly)continue;const E=t.getCell(M,I);if(Es(E)&&E.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}SM.RENDERER_TYPE=_V;function D7(t){let e=HH.get(t);if(!e){const{rootElement:n}=t;e=new cr(t),e.addEventListener(n,"click",i=>F7(i,t)),e.addEventListener(n,"mouseup",i=>L7(i,t)),e.addEventListener(n,"change",i=>$7(i,t)),HH.set(t,e)}return e}function N7(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function k7(t,e,n){const i=t.createElement("label");i.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const r=t.createTextNode(e);if(n){const s=t.createElement("span");s.appendChild(r),i.appendChild(s)}else i.appendChild(r);return i.cloneNode(!0)}function L7(t,e){const{target:n}=t;RM(n)&&(!n.hasAttribute(xc)||!n.hasAttribute(Pc)||setTimeout(e.listen,10))}function F7(t,e){const{target:n}=t;if(!RM(n)||!n.hasAttribute(xc)||!n.hasAttribute(Pc))return;const i=parseInt(n.getAttribute(xc),10),r=parseInt(n.getAttribute(Pc),10);e.getCellMeta(i,r).readOnly&&t.preventDefault()}function $7(t,e){const{target:n}=t;if(!RM(n)||!n.hasAttribute(xc)||!n.hasAttribute(Pc))return;const i=parseInt(n.getAttribute(xc),10),r=parseInt(n.getAttribute(Pc),10),s=e.getCellMeta(i,r);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(i,r,o)}}function RM(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const V7="handsontable";function _M(t,e,n,i,r,s,o){Gc.apply(this,[t,e,n,i,r,s,o])}_M.RENDERER_TYPE=V7;var W7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function B7(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var uS,DH;function j7(){return DH||(DH=1,uS={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),uS}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var cS,NH;function EV(){if(NH)return cS;NH=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let m="",v=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(v!==l)return-1*n(v,u,c,h,d,f);for(let E=0;E<t.length;E++){let T=t[E];if(m=l.replace(RegExp(`([0-9 ])(${T.key})$`),"$1"),m!==l)return n(m,u,c,h,d,f)*T.factor}if(m=l.replace("%",""),m!==l)return n(m,u,c,h,d,f)/100;let S=parseFloat(l);if(isNaN(S))return;let y=h(S);if(y&&y!=="."&&(m=l.replace(new RegExp(`${e(y)}$`),""),m!==l))return n(m,u,c,h,d,f);let M={};Object.keys(f).forEach(E=>{M[f[E]]=E});let I=Object.keys(M).sort().reverse(),P=I.length;for(let E=0;E<P;E++){let T=I[E],$=M[T];if(m=l.replace(T,""),m!==l){let U;switch($){case"thousand":U=Math.pow(10,3);break;case"million":U=Math.pow(10,6);break;case"billion":U=Math.pow(10,9);break;case"trillion":U=Math.pow(10,12);break}return n(m,u,c,h,d,f)*U}}}function i(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function r(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let m=i(l,u,c);return n(m,u,c,h,d,f)}function s(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function o(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=MM();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),m=c.currentAbbreviations(),v;if(typeof l=="string")s(l,h)?v=o(l):v=r(l,h,d,f,g,m);else if(typeof l=="number")v=l;else return;if(v!==void 0)return v}return cS={unformat:a},cS}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var hS,kH;function EM(){if(kH)return hS;kH=1;let t=EV();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],r=["prefix","infix","postfix"],s=["sign","parenthesis"],o={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(v,S)=>S.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:v=>v.output==="byte"},characteristic:{type:"number",restriction:v=>v>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(v,S)=>S.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:r},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:v=>v>=0,message:"value must be positive"},{restriction:(v,S)=>!S.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:v=>v>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(v,S)=>S.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:v=>v.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:o,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(v,S){let y=d(v),M=g(S);return y&&M}function d(v){return t.unformat(v)!==void 0}function f(v,S,y,M=!1){let I=Object.keys(v).map(P=>{if(!S[P])return console.error(`${y} Invalid key: ${P}`),!1;let E=v[P],T=S[P];if(typeof T=="string"&&(T={type:T}),T.type==="format"){if(!f(E,u,`[Validate ${P}]`,!0))return!1}else if(typeof E!==T.type)return console.error(`${y} ${P} type mismatched: "${T.type}" expected, "${typeof E}" provided`),!1;if(T.restrictions&&T.restrictions.length){let $=T.restrictions.length;for(let U=0;U<$;U++){let{restriction:O,message:G}=T.restrictions[U];if(!O(E,v))return console.error(`${y} ${P} invalid value: ${G}`),!1}}return T.restriction&&!T.restriction(E,v)?(console.error(`${y} ${P} invalid value: ${T.message}`),!1):T.validValues&&T.validValues.indexOf(E)===-1?(console.error(`${y} ${P} invalid value: must be among ${JSON.stringify(T.validValues)}, "${E}" provided`),!1):!(T.children&&!f(E,T.children,`[Validate ${P}]`))});return M||I.push(...Object.keys(S).map(P=>{let E=S[P];if(typeof E=="string"&&(E={type:E}),E.mandatory){let T=E.mandatory;if(typeof T=="function"&&(T=T(v)),T&&v[P]===void 0)return console.error(`${y} Missing mandatory key "${P}"`),!1}return!0})),I.reduce((P,E)=>P&&E,!0)}function g(v){return f(v,u,"[Validate format]")}function m(v){return f(v,c,"[Validate language]")}return hS={validate:h,validateFormat:g,validateInput:d,validateLanguage:m},hS}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function z7(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function U7(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function Y7(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function G7(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function q7(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function K7(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function X7(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function Z7(t,e){let n=t.split(".")[1];if(n){let i=n.match(/0+/);i&&(e.mantissa=i[0].length)}}function Q7(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function J7(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function eZ(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function tZ(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function nZ(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function iZ(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function rZ(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function sZ(t,e={}){return typeof t!="string"?t:(t=z7(t,e),t=U7(t,e),Y7(t,e),K7(t,e),X7(t,e),nZ(t,e),J7(t,e),eZ(t,e),Z7(t,e),tZ(t,e),Q7(t,e),G7(t,e),q7(t,e),iZ(t,e),rZ(t,e),e)}var TM={parseFormat:sZ};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var dS,LH;function MM(){if(LH)return dS;LH=1;const t=j7(),e=EM(),n=TM;let i={},r,s={},o=null,a={};function l(c){r=c}function u(){return s[r]}return i.languages=()=>Object.assign({},s),i.currentLanguage=()=>r,i.currentBytes=()=>u().bytes||{},i.currentCurrency=()=>u().currency,i.currentAbbreviations=()=>u().abbreviations,i.currentDelimiters=()=>u().delimiters,i.currentOrdinal=()=>u().ordinal,i.currentDefaults=()=>Object.assign({},u().defaults,a),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().timeFormat),i.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},i.getZeroFormat=()=>o,i.setZeroFormat=c=>o=typeof c=="string"?c:null,i.hasZeroFormat=()=>o!==null,i.languageData=c=>{if(c){if(s[c])return s[c];throw new Error(`Unknown tag "${c}"`)}return u()},i.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");s[c.languageTag]=c,h&&l(c.languageTag)},i.setLanguage=(c,h=t.languageTag)=>{if(!s[c]){let d=c.split("-")[0],f=Object.keys(s).find(g=>g.split("-")[0]===d);if(!s[f]){l(h);return}l(f);return}l(c)},i.registerLanguage(t),r=t.languageTag,dS=i,dS}function oZ(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function aZ(t,e){t.forEach(n=>{let i;try{i=oZ(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}i&&e.registerLanguage(i)})}var lZ=t=>({loadLanguagesInNode:e=>aZ(e,t)}),TV={exports:{}};(function(t){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(E){var T,$,U,O=w.prototype={constructor:w,toString:null,valueOf:null},G=new w(1),q=20,ne=4,Q=-7,te=21,Me=-1e7,Ce=1e7,Ie=!1,at=1,Le=0,Ge={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},St="0123456789abcdefghijklmnopqrstuvwxyz",p=!0;function w(C,R){var _,x,H,L,B,D,F,W,z=this;if(!(z instanceof w))return new w(C,R);if(R==null){if(C&&C._isBigNumber===!0){z.s=C.s,!C.c||C.e>Ce?z.c=z.e=null:C.e<Me?z.c=[z.e=0]:(z.e=C.e,z.c=C.c.slice());return}if((D=typeof C=="number")&&C*0==0){if(z.s=1/C<0?(C=-C,-1):1,C===~~C){for(L=0,B=C;B>=10;B/=10,L++);L>Ce?z.c=z.e=null:(z.e=L,z.c=[C]);return}W=String(C)}else{if(!i.test(W=String(C)))return U(z,W,D);z.s=W.charCodeAt(0)==45?(W=W.slice(1),-1):1}(L=W.indexOf("."))>-1&&(W=W.replace(".","")),(B=W.search(/e/i))>0?(L<0&&(L=B),L+=+W.slice(B+1),W=W.substring(0,B)):L<0&&(L=W.length)}else{if(y(R,2,St.length,"Base"),R==10&&p)return z=new w(C),j(z,q+z.e+1,ne);if(W=String(C),D=typeof C=="number"){if(C*0!=0)return U(z,W,D,R);if(z.s=1/C<0?(W=W.slice(1),-1):1,w.DEBUG&&W.replace(/^0\.0*|\./,"").length>15)throw Error(a+C)}else z.s=W.charCodeAt(0)===45?(W=W.slice(1),-1):1;for(_=St.slice(0,R),L=B=0,F=W.length;B<F;B++)if(_.indexOf(x=W.charAt(B))<0){if(x=="."){if(B>L){L=F;continue}}else if(!H&&(W==W.toUpperCase()&&(W=W.toLowerCase())||W==W.toLowerCase()&&(W=W.toUpperCase()))){H=!0,B=-1,L=0;continue}return U(z,String(C),D,R)}D=!1,W=$(W,R,10,z.s),(L=W.indexOf("."))>-1?W=W.replace(".",""):L=W.length}for(B=0;W.charCodeAt(B)===48;B++);for(F=W.length;W.charCodeAt(--F)===48;);if(W=W.slice(B,++F)){if(F-=B,D&&w.DEBUG&&F>15&&(C>c||C!==s(C)))throw Error(a+z.s*C);if((L=L-B-1)>Ce)z.c=z.e=null;else if(L<Me)z.c=[z.e=0];else{if(z.e=L,z.c=[],B=(L+1)%u,L<0&&(B+=u),B<F){for(B&&z.c.push(+W.slice(0,B)),F-=u;B<F;)z.c.push(+W.slice(B,B+=u));B=u-(W=W.slice(B)).length}else B-=F;for(;B--;W+="0");z.c.push(+W)}}else z.c=[z.e=0]}w.clone=g,w.ROUND_UP=0,w.ROUND_DOWN=1,w.ROUND_CEIL=2,w.ROUND_FLOOR=3,w.ROUND_HALF_UP=4,w.ROUND_HALF_DOWN=5,w.ROUND_HALF_EVEN=6,w.ROUND_HALF_CEIL=7,w.ROUND_HALF_FLOOR=8,w.EUCLID=9,w.config=w.set=function(C){var R,_;if(C!=null)if(typeof C=="object"){if(C.hasOwnProperty(R="DECIMAL_PLACES")&&(_=C[R],y(_,0,f,R),q=_),C.hasOwnProperty(R="ROUNDING_MODE")&&(_=C[R],y(_,0,8,R),ne=_),C.hasOwnProperty(R="EXPONENTIAL_AT")&&(_=C[R],_&&_.pop?(y(_[0],-f,0,R),y(_[1],0,f,R),Q=_[0],te=_[1]):(y(_,-f,f,R),Q=-(te=_<0?-_:_))),C.hasOwnProperty(R="RANGE"))if(_=C[R],_&&_.pop)y(_[0],-f,-1,R),y(_[1],1,f,R),Me=_[0],Ce=_[1];else if(y(_,-f,f,R),_)Me=-(Ce=_<0?-_:_);else throw Error(o+R+" cannot be zero: "+_);if(C.hasOwnProperty(R="CRYPTO"))if(_=C[R],_===!!_)if(_)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ie=_;else throw Ie=!_,Error(o+"crypto unavailable");else Ie=_;else throw Error(o+R+" not true or false: "+_);if(C.hasOwnProperty(R="MODULO_MODE")&&(_=C[R],y(_,0,9,R),at=_),C.hasOwnProperty(R="POW_PRECISION")&&(_=C[R],y(_,0,f,R),Le=_),C.hasOwnProperty(R="FORMAT"))if(_=C[R],typeof _=="object")Ge=_;else throw Error(o+R+" not an object: "+_);if(C.hasOwnProperty(R="ALPHABET"))if(_=C[R],typeof _=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(_))p=_.slice(0,10)=="0123456789",St=_;else throw Error(o+R+" invalid: "+_)}else throw Error(o+"Object expected: "+C);return{DECIMAL_PLACES:q,ROUNDING_MODE:ne,EXPONENTIAL_AT:[Q,te],RANGE:[Me,Ce],CRYPTO:Ie,MODULO_MODE:at,POW_PRECISION:Le,FORMAT:Ge,ALPHABET:St}},w.isBigNumber=function(C){if(!C||C._isBigNumber!==!0)return!1;if(!w.DEBUG)return!0;var R,_,x=C.c,H=C.e,L=C.s;e:if({}.toString.call(x)=="[object Array]"){if((L===1||L===-1)&&H>=-f&&H<=f&&H===s(H)){if(x[0]===0){if(H===0&&x.length===1)return!0;break e}if(R=(H+1)%u,R<1&&(R+=u),String(x[0]).length==R){for(R=0;R<x.length;R++)if(_=x[R],_<0||_>=l||_!==s(_))break e;if(_!==0)return!0}}}else if(x===null&&H===null&&(L===null||L===1||L===-1))return!0;throw Error(o+"Invalid BigNumber: "+C)},w.maximum=w.max=function(){return N(arguments,-1)},w.minimum=w.min=function(){return N(arguments,1)},w.random=function(){var C=9007199254740992,R=Math.random()*C&2097151?function(){return s(Math.random()*C)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(_){var x,H,L,B,D,F=0,W=[],z=new w(G);if(_==null?_=q:y(_,0,f),B=r(_/u),Ie)if(crypto.getRandomValues){for(x=crypto.getRandomValues(new Uint32Array(B*=2));F<B;)D=x[F]*131072+(x[F+1]>>>11),D>=9e15?(H=crypto.getRandomValues(new Uint32Array(2)),x[F]=H[0],x[F+1]=H[1]):(W.push(D%1e14),F+=2);F=B/2}else if(crypto.randomBytes){for(x=crypto.randomBytes(B*=7);F<B;)D=(x[F]&31)*281474976710656+x[F+1]*1099511627776+x[F+2]*4294967296+x[F+3]*16777216+(x[F+4]<<16)+(x[F+5]<<8)+x[F+6],D>=9e15?crypto.randomBytes(7).copy(x,F):(W.push(D%1e14),F+=7);F=B/7}else throw Ie=!1,Error(o+"crypto unavailable");if(!Ie)for(;F<B;)D=R(),D<9e15&&(W[F++]=D%1e14);for(B=W[--F],_%=u,B&&_&&(D=h[u-_],W[F]=s(B/D)*D);W[F]===0;W.pop(),F--);if(F<0)W=[L=0];else{for(L=-1;W[0]===0;W.splice(0,1),L-=u);for(F=1,D=W[0];D>=10;D/=10,F++);F<u&&(L-=u-F)}return z.e=L,z.c=W,z}}(),w.sum=function(){for(var C=1,R=arguments,_=new w(R[0]);C<R.length;)_=_.plus(R[C++]);return _},$=function(){var C="0123456789";function R(_,x,H,L){for(var B,D=[0],F,W=0,z=_.length;W<z;){for(F=D.length;F--;D[F]*=x);for(D[0]+=L.indexOf(_.charAt(W++)),B=0;B<D.length;B++)D[B]>H-1&&(D[B+1]==null&&(D[B+1]=0),D[B+1]+=D[B]/H|0,D[B]%=H)}return D.reverse()}return function(_,x,H,L,B){var D,F,W,z,Y,oe,ae,Re,We=_.indexOf("."),Be=q,_e=ne;for(We>=0&&(z=Le,Le=0,_=_.replace(".",""),Re=new w(x),oe=Re.pow(_.length-We),Le=z,Re.c=R(P(v(oe.c),oe.e,"0"),10,H,C),Re.e=Re.c.length),ae=R(_,x,H,B?(D=St,C):(D=C,St)),W=z=ae.length;ae[--z]==0;ae.pop());if(!ae[0])return D.charAt(0);if(We<0?--W:(oe.c=ae,oe.e=W,oe.s=L,oe=T(oe,Re,Be,_e,H),ae=oe.c,Y=oe.r,W=oe.e),F=W+Be+1,We=ae[F],z=H/2,Y=Y||F<0||ae[F+1]!=null,Y=_e<4?(We!=null||Y)&&(_e==0||_e==(oe.s<0?3:2)):We>z||We==z&&(_e==4||Y||_e==6&&ae[F-1]&1||_e==(oe.s<0?8:7)),F<1||!ae[0])_=Y?P(D.charAt(1),-Be,D.charAt(0)):D.charAt(0);else{if(ae.length=F,Y)for(--H;++ae[--F]>H;)ae[F]=0,F||(++W,ae=[1].concat(ae));for(z=ae.length;!ae[--z];);for(We=0,_="";We<=z;_+=D.charAt(ae[We++]));_=P(_,W,D.charAt(0))}return _}}(),T=function(){function C(x,H,L){var B,D,F,W,z=0,Y=x.length,oe=H%d,ae=H/d|0;for(x=x.slice();Y--;)F=x[Y]%d,W=x[Y]/d|0,B=ae*F+W*oe,D=oe*F+B%d*d+z,z=(D/L|0)+(B/d|0)+ae*W,x[Y]=D%L;return z&&(x=[z].concat(x)),x}function R(x,H,L,B){var D,F;if(L!=B)F=L>B?1:-1;else for(D=F=0;D<L;D++)if(x[D]!=H[D]){F=x[D]>H[D]?1:-1;break}return F}function _(x,H,L,B){for(var D=0;L--;)x[L]-=D,D=x[L]<H[L]?1:0,x[L]=D*B+x[L]-H[L];for(;!x[0]&&x.length>1;x.splice(0,1));}return function(x,H,L,B,D){var F,W,z,Y,oe,ae,Re,We,Be,_e,be,it,oi,ks,Cr,gn,Rt,Ot=x.s==H.s?1:-1,vt=x.c,et=H.c;if(!vt||!vt[0]||!et||!et[0])return new w(!x.s||!H.s||(vt?et&&vt[0]==et[0]:!et)?NaN:vt&&vt[0]==0||!et?Ot*0:Ot/0);for(We=new w(Ot),Be=We.c=[],W=x.e-H.e,Ot=L+W+1,D||(D=l,W=m(x.e/u)-m(H.e/u),Ot=Ot/u|0),z=0;et[z]==(vt[z]||0);z++);if(et[z]>(vt[z]||0)&&W--,Ot<0)Be.push(1),Y=!0;else{for(ks=vt.length,gn=et.length,z=0,Ot+=2,oe=s(D/(et[0]+1)),oe>1&&(et=C(et,oe,D),vt=C(vt,oe,D),gn=et.length,ks=vt.length),oi=gn,_e=vt.slice(0,gn),be=_e.length;be<gn;_e[be++]=0);Rt=et.slice(),Rt=[0].concat(Rt),Cr=et[0],et[1]>=D/2&&Cr++;do{if(oe=0,F=R(et,_e,gn,be),F<0){if(it=_e[0],gn!=be&&(it=it*D+(_e[1]||0)),oe=s(it/Cr),oe>1)for(oe>=D&&(oe=D-1),ae=C(et,oe,D),Re=ae.length,be=_e.length;R(ae,_e,Re,be)==1;)oe--,_(ae,gn<Re?Rt:et,Re,D),Re=ae.length,F=1;else oe==0&&(F=oe=1),ae=et.slice(),Re=ae.length;if(Re<be&&(ae=[0].concat(ae)),_(_e,ae,be,D),be=_e.length,F==-1)for(;R(et,_e,gn,be)<1;)oe++,_(_e,gn<be?Rt:et,be,D),be=_e.length}else F===0&&(oe++,_e=[0]);Be[z++]=oe,_e[0]?_e[be++]=vt[oi]||0:(_e=[vt[oi]],be=1)}while((oi++<ks||_e[0]!=null)&&Ot--);Y=_e[0]!=null,Be[0]||Be.splice(0,1)}if(D==l){for(z=1,Ot=Be[0];Ot>=10;Ot/=10,z++);j(We,L+(We.e=z+W*u-1)+1,B,Y)}else We.e=W,We.r=+Y;return We}}();function b(C,R,_,x){var H,L,B,D,F;if(_==null?_=ne:y(_,0,8),!C.c)return C.toString();if(H=C.c[0],B=C.e,R==null)F=v(C.c),F=x==1||x==2&&(B<=Q||B>=te)?I(F,B):P(F,B,"0");else if(C=j(new w(C),R,_),L=C.e,F=v(C.c),D=F.length,x==1||x==2&&(R<=L||L<=Q)){for(;D<R;F+="0",D++);F=I(F,L)}else if(R-=B,F=P(F,L,"0"),L+1>D){if(--R>0)for(F+=".";R--;F+="0");}else if(R+=L-D,R>0)for(L+1==D&&(F+=".");R--;F+="0");return C.s<0&&H?"-"+F:F}function N(C,R){for(var _,x,H=1,L=new w(C[0]);H<C.length;H++)x=new w(C[H]),(!x.s||(_=S(L,x))===R||_===0&&L.s===R)&&(L=x);return L}function V(C,R,_){for(var x=1,H=R.length;!R[--H];R.pop());for(H=R[0];H>=10;H/=10,x++);return(_=x+_*u-1)>Ce?C.c=C.e=null:_<Me?C.c=[C.e=0]:(C.e=_,C.c=R),C}U=function(){var C=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,_=/^\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,H=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(L,B,D,F){var W,z=D?B:B.replace(H,"");if(x.test(z))L.s=isNaN(z)?null:z<0?-1:1;else{if(!D&&(z=z.replace(C,function(Y,oe,ae){return W=(ae=ae.toLowerCase())=="x"?16:ae=="b"?2:8,!F||F==W?oe:Y}),F&&(W=F,z=z.replace(R,"$1").replace(_,"0.$1")),B!=z))return new w(z,W);if(w.DEBUG)throw Error(o+"Not a"+(F?" base "+F:"")+" number: "+B);L.s=null}L.c=L.e=null}}();function j(C,R,_,x){var H,L,B,D,F,W,z,Y=C.c,oe=h;if(Y){e:{for(H=1,D=Y[0];D>=10;D/=10,H++);if(L=R-H,L<0)L+=u,B=R,F=Y[W=0],z=s(F/oe[H-B-1]%10);else if(W=r((L+1)/u),W>=Y.length)if(x){for(;Y.length<=W;Y.push(0));F=z=0,H=1,L%=u,B=L-u+1}else break e;else{for(F=D=Y[W],H=1;D>=10;D/=10,H++);L%=u,B=L-u+H,z=B<0?0:s(F/oe[H-B-1]%10)}if(x=x||R<0||Y[W+1]!=null||(B<0?F:F%oe[H-B-1]),x=_<4?(z||x)&&(_==0||_==(C.s<0?3:2)):z>5||z==5&&(_==4||x||_==6&&(L>0?B>0?F/oe[H-B]:0:Y[W-1])%10&1||_==(C.s<0?8:7)),R<1||!Y[0])return Y.length=0,x?(R-=C.e+1,Y[0]=oe[(u-R%u)%u],C.e=-R||0):Y[0]=C.e=0,C;if(L==0?(Y.length=W,D=1,W--):(Y.length=W+1,D=oe[u-L],Y[W]=B>0?s(F/oe[H-B]%oe[B])*D:0),x)for(;;)if(W==0){for(L=1,B=Y[0];B>=10;B/=10,L++);for(B=Y[0]+=D,D=1;B>=10;B/=10,D++);L!=D&&(C.e++,Y[0]==l&&(Y[0]=1));break}else{if(Y[W]+=D,Y[W]!=l)break;Y[W--]=0,D=1}for(L=Y.length;Y[--L]===0;Y.pop());}C.e>Ce?C.c=C.e=null:C.e<Me&&(C.c=[C.e=0])}return C}function X(C){var R,_=C.e;return _===null?C.toString():(R=v(C.c),R=_<=Q||_>=te?I(R,_):P(R,_,"0"),C.s<0?"-"+R:R)}return O.absoluteValue=O.abs=function(){var C=new w(this);return C.s<0&&(C.s=1),C},O.comparedTo=function(C,R){return S(this,new w(C,R))},O.decimalPlaces=O.dp=function(C,R){var _,x,H,L=this;if(C!=null)return y(C,0,f),R==null?R=ne:y(R,0,8),j(new w(L),C+L.e+1,R);if(!(_=L.c))return null;if(x=((H=_.length-1)-m(this.e/u))*u,H=_[H])for(;H%10==0;H/=10,x--);return x<0&&(x=0),x},O.dividedBy=O.div=function(C,R){return T(this,new w(C,R),q,ne)},O.dividedToIntegerBy=O.idiv=function(C,R){return T(this,new w(C,R),0,1)},O.exponentiatedBy=O.pow=function(C,R){var _,x,H,L,B,D,F,W,z,Y=this;if(C=new w(C),C.c&&!C.isInteger())throw Error(o+"Exponent not an integer: "+X(C));if(R!=null&&(R=new w(R)),D=C.e>14,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!C.c||!C.c[0])return z=new w(Math.pow(+X(Y),D?C.s*(2-M(C)):+X(C))),R?z.mod(R):z;if(F=C.s<0,R){if(R.c?!R.c[0]:!R.s)return new w(NaN);x=!F&&Y.isInteger()&&R.isInteger(),x&&(Y=Y.mod(R))}else{if(C.e>9&&(Y.e>0||Y.e<-1||(Y.e==0?Y.c[0]>1||D&&Y.c[1]>=24e7:Y.c[0]<8e13||D&&Y.c[0]<=9999975e7)))return L=Y.s<0&&M(C)?-0:0,Y.e>-1&&(L=1/L),new w(F?1/L:L);Le&&(L=r(Le/u+2))}for(D?(_=new w(.5),F&&(C.s=1),W=M(C)):(H=Math.abs(+X(C)),W=H%2),z=new w(G);;){if(W){if(z=z.times(Y),!z.c)break;L?z.c.length>L&&(z.c.length=L):x&&(z=z.mod(R))}if(H){if(H=s(H/2),H===0)break;W=H%2}else if(C=C.times(_),j(C,C.e+1,1),C.e>14)W=M(C);else{if(H=+X(C),H===0)break;W=H%2}Y=Y.times(Y),L?Y.c&&Y.c.length>L&&(Y.c.length=L):x&&(Y=Y.mod(R))}return x?z:(F&&(z=G.div(z)),R?z.mod(R):L?j(z,Le,ne,B):z)},O.integerValue=function(C){var R=new w(this);return C==null?C=ne:y(C,0,8),j(R,R.e+1,C)},O.isEqualTo=O.eq=function(C,R){return S(this,new w(C,R))===0},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(C,R){return S(this,new w(C,R))>0},O.isGreaterThanOrEqualTo=O.gte=function(C,R){return(R=S(this,new w(C,R)))===1||R===0},O.isInteger=function(){return!!this.c&&m(this.e/u)>this.c.length-2},O.isLessThan=O.lt=function(C,R){return S(this,new w(C,R))<0},O.isLessThanOrEqualTo=O.lte=function(C,R){return(R=S(this,new w(C,R)))===-1||R===0},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&this.c[0]==0},O.minus=function(C,R){var _,x,H,L,B=this,D=B.s;if(C=new w(C,R),R=C.s,!D||!R)return new w(NaN);if(D!=R)return C.s=-R,B.plus(C);var F=B.e/u,W=C.e/u,z=B.c,Y=C.c;if(!F||!W){if(!z||!Y)return z?(C.s=-R,C):new w(Y?B:NaN);if(!z[0]||!Y[0])return Y[0]?(C.s=-R,C):new w(z[0]?B:ne==3?-0:0)}if(F=m(F),W=m(W),z=z.slice(),D=F-W){for((L=D<0)?(D=-D,H=z):(W=F,H=Y),H.reverse(),R=D;R--;H.push(0));H.reverse()}else for(x=(L=(D=z.length)<(R=Y.length))?D:R,D=R=0;R<x;R++)if(z[R]!=Y[R]){L=z[R]<Y[R];break}if(L&&(H=z,z=Y,Y=H,C.s=-C.s),R=(x=Y.length)-(_=z.length),R>0)for(;R--;z[_++]=0);for(R=l-1;x>D;){if(z[--x]<Y[x]){for(_=x;_&&!z[--_];z[_]=R);--z[_],z[x]+=l}z[x]-=Y[x]}for(;z[0]==0;z.splice(0,1),--W);return z[0]?V(C,z,W):(C.s=ne==3?-1:1,C.c=[C.e=0],C)},O.modulo=O.mod=function(C,R){var _,x,H=this;return C=new w(C,R),!H.c||!C.s||C.c&&!C.c[0]?new w(NaN):!C.c||H.c&&!H.c[0]?new w(H):(at==9?(x=C.s,C.s=1,_=T(H,C,0,3),C.s=x,_.s*=x):_=T(H,C,0,at),C=H.minus(_.times(C)),!C.c[0]&&at==1&&(C.s=H.s),C)},O.multipliedBy=O.times=function(C,R){var _,x,H,L,B,D,F,W,z,Y,oe,ae,Re,We,Be,_e=this,be=_e.c,it=(C=new w(C,R)).c;if(!be||!it||!be[0]||!it[0])return!_e.s||!C.s||be&&!be[0]&&!it||it&&!it[0]&&!be?C.c=C.e=C.s=null:(C.s*=_e.s,!be||!it?C.c=C.e=null:(C.c=[0],C.e=0)),C;for(x=m(_e.e/u)+m(C.e/u),C.s*=_e.s,F=be.length,Y=it.length,F<Y&&(Re=be,be=it,it=Re,H=F,F=Y,Y=H),H=F+Y,Re=[];H--;Re.push(0));for(We=l,Be=d,H=Y;--H>=0;){for(_=0,oe=it[H]%Be,ae=it[H]/Be|0,B=F,L=H+B;L>H;)W=be[--B]%Be,z=be[B]/Be|0,D=ae*W+z*oe,W=oe*W+D%Be*Be+Re[L]+_,_=(W/We|0)+(D/Be|0)+ae*z,Re[L--]=W%We;Re[L]=_}return _?++x:Re.splice(0,1),V(C,Re,x)},O.negated=function(){var C=new w(this);return C.s=-C.s||null,C},O.plus=function(C,R){var _,x=this,H=x.s;if(C=new w(C,R),R=C.s,!H||!R)return new w(NaN);if(H!=R)return C.s=-R,x.minus(C);var L=x.e/u,B=C.e/u,D=x.c,F=C.c;if(!L||!B){if(!D||!F)return new w(H/0);if(!D[0]||!F[0])return F[0]?C:new w(D[0]?x:H*0)}if(L=m(L),B=m(B),D=D.slice(),H=L-B){for(H>0?(B=L,_=F):(H=-H,_=D),_.reverse();H--;_.push(0));_.reverse()}for(H=D.length,R=F.length,H-R<0&&(_=F,F=D,D=_,R=H),H=0;R;)H=(D[--R]=D[R]+F[R]+H)/l|0,D[R]=l===D[R]?0:D[R]%l;return H&&(D=[H].concat(D),++B),V(C,D,B)},O.precision=O.sd=function(C,R){var _,x,H,L=this;if(C!=null&&C!==!!C)return y(C,1,f),R==null?R=ne:y(R,0,8),j(new w(L),C,R);if(!(_=L.c))return null;if(H=_.length-1,x=H*u+1,H=_[H]){for(;H%10==0;H/=10,x--);for(H=_[0];H>=10;H/=10,x++);}return C&&L.e+1>x&&(x=L.e+1),x},O.shiftedBy=function(C){return y(C,-c,c),this.times("1e"+C)},O.squareRoot=O.sqrt=function(){var C,R,_,x,H,L=this,B=L.c,D=L.s,F=L.e,W=q+4,z=new w("0.5");if(D!==1||!B||!B[0])return new w(!D||D<0&&(!B||B[0])?NaN:B?L:1/0);if(D=Math.sqrt(+X(L)),D==0||D==1/0?(R=v(B),(R.length+F)%2==0&&(R+="0"),D=Math.sqrt(+R),F=m((F+1)/2)-(F<0||F%2),D==1/0?R="5e"+F:(R=D.toExponential(),R=R.slice(0,R.indexOf("e")+1)+F),_=new w(R)):_=new w(D+""),_.c[0]){for(F=_.e,D=F+W,D<3&&(D=0);;)if(H=_,_=z.times(H.plus(T(L,H,W,1))),v(H.c).slice(0,D)===(R=v(_.c)).slice(0,D))if(_.e<F&&--D,R=R.slice(D-3,D+1),R=="9999"||!x&&R=="4999"){if(!x&&(j(H,H.e+q+2,0),H.times(H).eq(L))){_=H;break}W+=4,D+=4,x=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(j(_,_.e+q+2,1),C=!_.times(_).eq(L));break}}return j(_,_.e+q+1,ne,C)},O.toExponential=function(C,R){return C!=null&&(y(C,0,f),C++),b(this,C,R,1)},O.toFixed=function(C,R){return C!=null&&(y(C,0,f),C=C+this.e+1),b(this,C,R)},O.toFormat=function(C,R,_){var x,H=this;if(_==null)C!=null&&R&&typeof R=="object"?(_=R,R=null):C&&typeof C=="object"?(_=C,C=R=null):_=Ge;else if(typeof _!="object")throw Error(o+"Argument not an object: "+_);if(x=H.toFixed(C,R),H.c){var L,B=x.split("."),D=+_.groupSize,F=+_.secondaryGroupSize,W=_.groupSeparator||"",z=B[0],Y=B[1],oe=H.s<0,ae=oe?z.slice(1):z,Re=ae.length;if(F&&(L=D,D=F,F=L,Re-=L),D>0&&Re>0){for(L=Re%D||D,z=ae.substr(0,L);L<Re;L+=D)z+=W+ae.substr(L,D);F>0&&(z+=W+ae.slice(L)),oe&&(z="-"+z)}x=Y?z+(_.decimalSeparator||"")+((F=+_.fractionGroupSize)?Y.replace(new RegExp("\\d{"+F+"}\\B","g"),"$&"+(_.fractionGroupSeparator||"")):Y):z}return(_.prefix||"")+x+(_.suffix||"")},O.toFraction=function(C){var R,_,x,H,L,B,D,F,W,z,Y,oe,ae=this,Re=ae.c;if(C!=null&&(D=new w(C),!D.isInteger()&&(D.c||D.s!==1)||D.lt(G)))throw Error(o+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+X(D));if(!Re)return new w(ae);for(R=new w(G),W=_=new w(G),x=F=new w(G),oe=v(Re),L=R.e=oe.length-ae.e-1,R.c[0]=h[(B=L%u)<0?u+B:B],C=!C||D.comparedTo(R)>0?L>0?R:W:D,B=Ce,Ce=1/0,D=new w(oe),F.c[0]=0;z=T(D,R,0,1),H=_.plus(z.times(x)),H.comparedTo(C)!=1;)_=x,x=H,W=F.plus(z.times(H=W)),F=H,R=D.minus(z.times(H=R)),D=H;return H=T(C.minus(_),x,0,1),F=F.plus(H.times(W)),_=_.plus(H.times(x)),F.s=W.s=ae.s,L=L*2,Y=T(W,x,L,ne).minus(ae).abs().comparedTo(T(F,_,L,ne).minus(ae).abs())<1?[W,x]:[F,_],Ce=B,Y},O.toNumber=function(){return+X(this)},O.toPrecision=function(C,R){return C!=null&&y(C,1,f),b(this,C,R,2)},O.toString=function(C){var R,_=this,x=_.s,H=_.e;return H===null?x?(R="Infinity",x<0&&(R="-"+R)):R="NaN":(C==null?R=H<=Q||H>=te?I(v(_.c),H):P(v(_.c),H,"0"):C===10&&p?(_=j(new w(_),q+H+1,ne),R=P(v(_.c),_.e,"0")):(y(C,2,St.length,"Base"),R=$(P(v(_.c),H,"0"),10,C,x,!0)),x<0&&_.c[0]&&(R="-"+R)),R},O.valueOf=O.toJSON=function(){return X(this)},O._isBigNumber=!0,E!=null&&w.set(E),w}function m(E){var T=E|0;return E>0||E===T?T:T-1}function v(E){for(var T,$,U=1,O=E.length,G=E[0]+"";U<O;){for(T=E[U++]+"",$=u-T.length;$--;T="0"+T);G+=T}for(O=G.length;G.charCodeAt(--O)===48;);return G.slice(0,O+1||1)}function S(E,T){var $,U,O=E.c,G=T.c,q=E.s,ne=T.s,Q=E.e,te=T.e;if(!q||!ne)return null;if($=O&&!O[0],U=G&&!G[0],$||U)return $?U?0:-ne:q;if(q!=ne)return q;if($=q<0,U=Q==te,!O||!G)return U?0:!O^$?1:-1;if(!U)return Q>te^$?1:-1;for(ne=(Q=O.length)<(te=G.length)?Q:te,q=0;q<ne;q++)if(O[q]!=G[q])return O[q]>G[q]^$?1:-1;return Q==te?0:Q>te^$?1:-1}function y(E,T,$,U){if(E<T||E>$||E!==s(E))throw Error(o+(U||"Argument")+(typeof E=="number"?E<T||E>$?" out of range: ":" not an integer: ":" not a primitive number: ")+String(E))}function M(E){var T=E.c.length-1;return m(E.e/u)==T&&E.c[T]%2!=0}function I(E,T){return(E.length>1?E.charAt(0)+"."+E.slice(1):E)+(T<0?"e":"e+")+T}function P(E,T,$){var U,O;if(T<0){for(O=$+".";++T;O+=$);E=O+E}else if(U=E.length,++T>U){for(O=$,T-=U;--T;O+=$);E+=O}else T<U&&(E=E.slice(0,T)+"."+E.slice(T));return E}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(W7)})(TV);var MV=TV.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Or=MM(),uZ=EM(),cZ=TM,hZ=MV,Tn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Uf={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:xV,decimalSuffixes:$p}=Or.currentBytes(),xM={general:{scale:1024,suffixes:$p},binary:{scale:1024,suffixes:xV},decimal:{scale:1e3,suffixes:$p}};function dZ(t,e={},n){if(typeof e=="string"&&(e=cZ.parseFormat(e)),!uZ.validateFormat(e))return"ERROR: invalid format";let r=e.prefix||"",s=e.postfix||"",o=fZ(t,e,n);return o=AZ(o,r),o=HZ(o,s),o}function fZ(t,e,n){switch(e.output){case"currency":return e=ec(e,Or.currentCurrencyDefaultFormat()),bZ(t,e,Or);case"percent":return e=ec(e,Or.currentPercentageDefaultFormat()),CZ(t,e,Or,n);case"byte":return e=ec(e,Or.currentByteDefaultFormat()),wZ(t,e,Or,n);case"time":return e=ec(e,Or.currentTimeDefaultFormat()),yZ(t);case"ordinal":return e=ec(e,Or.currentOrdinalDefaultFormat()),vZ(t,e,Or);case"number":default:return Yf({instance:t,providedFormat:e})}}function gZ(t){let e=xM.decimal;return lv(t._value,e.suffixes,e.scale).suffix}function mZ(t){let e=xM.binary;return lv(t._value,e.suffixes,e.scale).suffix}function pZ(t){let e=xM.general;return lv(t._value,e.suffixes,e.scale).suffix}function lv(t,e,n){let i=e[0],r=Math.abs(t);if(r>=n){for(let s=1;s<e.length;++s){let o=Math.pow(n,s),a=Math.pow(n,s+1);if(r>=o&&r<a){i=e[s],t=t/o;break}}i===e[0]&&(t=t/Math.pow(n,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function wZ(t,e,n,i){let r=e.base||"binary",s=Object.assign({},Uf,e);const{binarySuffixes:o,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||$p,marker:"bd"},binary:{scale:1024,suffixes:o||xV,marker:"b"},decimal:{scale:1e3,suffixes:a||$p,marker:"d"}}[r],{value:c,suffix:h}=lv(t._value,u.suffixes,u.scale);return`${Yf({instance:i(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${h}`}function vZ(t,e,n){let i=n.currentOrdinal(),r=Object.assign({},Uf,e),s=Yf({instance:t,providedFormat:e,state:n}),o=i(t._value);return`${s}${r.spaceSeparated?" ":""}${o}`}function yZ(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${i<10?"0":""}${i}`}function CZ(t,e,n,i){let r=e.prefixSymbol,s=Yf({instance:i(t._value*100),providedFormat:e,state:n}),o=Object.assign({},Uf,e);return r?`%${o.spaceSeparated?" ":""}${s}`:`${s}${o.spaceSeparated?" ":""}%`}function bZ(t,e,n){const i=n.currentCurrency();let r=Object.assign({},e),s=Object.assign({},Uf,r),o,a="",l=!!s.totalLength||!!s.forceAverage||s.average,u=r.currencyPosition||i.position,c=r.currencySymbol||i.symbol;const h=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;r.lowPrecision===void 0&&(r.lowPrecision=!1),h&&(a=" "),u==="infix"&&(o=a+c+a);let d=Yf({instance:t,providedFormat:r,state:n,decimalSeparator:o});return u==="prefix"&&(t._value<0&&s.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&s.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!s.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function SZ({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:i,spaceSeparated:r=!1,totalLength:s=0,roundingFunction:o=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&i[e]&&Tn[e]?(a=i[e],t=t/Tn[e]):l>=Tn.trillion||n&&o(l/Tn.trillion)===1?(a=i.trillion,t=t/Tn.trillion):l<Tn.trillion&&l>=Tn.billion||n&&o(l/Tn.billion)===1?(a=i.billion,t=t/Tn.billion):l<Tn.billion&&l>=Tn.million||n&&o(l/Tn.million)===1?(a=i.million,t=t/Tn.million):(l<Tn.million&&l>=Tn.thousand||n&&o(l/Tn.thousand)===1)&&(a=i.thousand,t=t/Tn.thousand),a&&(a=(r?" ":"")+a),s){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(s-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function RZ({value:t,characteristicPrecision:e}){let[n,i]=t.toExponential().split("e"),r=+n;if(!e)return{value:r,abbreviation:`e${i}`};let s=1;return s<e&&(r=r*Math.pow(10,e-s),i=+i-(e-s),i=i>=0?`+${i}`:i),{value:r,abbreviation:`e${i}`}}function $g(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function _Z(t,e){let n=t.toString(),[i,r]=n.split("e"),[s,o=""]=i.split(".");if(+r>0)n=s+o+$g(r-o.length);else{let a=".";+s<0?a=`-0${a}`:a=`0${a}`;let l=($g(-r-1)+Math.abs(s)+o).substr(0,e);l.length<e&&(l+=$g(e-l.length)),n=a+l}return+r>0&&e>0&&(n+=`.${$g(e)}`),n}function EZ(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?_Z(t,e):new hZ(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function TZ(t,e,n,i,r,s){if(i===-1)return t;let o=EZ(e,i,s),[a,l=""]=o.toString().split(".");if(l.match(/^0+$/)&&(n||r))return a;let u=l.match(/0+$/);return r&&u?`${a}.${l.toString().slice(0,u.index)}`:o.toString()}function MZ(t,e,n,i){let r=t,[s,o]=r.toString().split(".");if(s.match(/^-?0$/)&&n)return o?`${s.replace("0","")}.${o}`:s.replace("0","");const a=e<0&&s.indexOf("-")===0;if(a&&(s=s.slice(1),r=r.slice(1)),s.length<i){let l=i-s.length;for(let u=0;u<l;u++)r=`0${r}`}return a&&(r=`-${r}`),r.toString()}function xZ(t,e){let n=[],i=0;for(let r=t;r>0;r--)i===e&&(n.unshift(r),i=0),i++;return n}function PZ(t,e,n,i,r){let s=i.currentDelimiters(),o=s.thousands;r=r||s.decimal;let a=s.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),xZ(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+o+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+r+c:l=u,l}function IZ(t,e){return t+e}function OZ(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function AZ(t,e){return e+t}function HZ(t,e){return t+e}function Yf({instance:t,providedFormat:e,state:n=Or,decimalSeparator:i,defaults:r=n.currentDefaults()}){let s=t._value;if(s===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(s))return s.toString();let o=Object.assign({},Uf,r,e),a=o.totalLength,l=a?0:o.characteristic,u=o.optionalCharacteristic,c=o.forceAverage,h=o.lowPrecision,d=!!a||!!c||o.average,f=a?-1:d&&e.mantissa===void 0?0:o.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:o.optionalMantissa,m=o.trimMantissa,v=o.thousandSeparated,S=o.spaceSeparated,y=o.negative,M=o.forceSign,I=o.exponential,P=o.roundingFunction,E="";if(d){let $=SZ({value:s,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:S,roundingFunction:P,totalLength:a});s=$.value,E+=$.abbreviation,a&&(f=$.mantissaPrecision)}if(I){let $=RZ({value:s,characteristicPrecision:l});s=$.value,E=$.abbreviation+E}let T=TZ(s.toString(),s,g,f,m,P);return T=MZ(T,s,u,l),T=PZ(T,s,v,n,i),(d||I)&&(T=IZ(T,E)),(M||s<0)&&(T=OZ(T,s,y)),T}function ec(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var DZ=t=>({format:(...e)=>dZ(...e,t),getByteUnit:(...e)=>pZ(...e,t),getBinaryByteUnit:(...e)=>mZ(...e,t),getDecimalByteUnit:(...e)=>gZ(...e,t),formatOrDefault:ec});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const So=MV;function NZ(t,e,n){let i=new So(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new So(r),t._value=i.plus(r).toNumber(),t}function PV(t,e,n){let i=new So(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new So(r),t._value=i.minus(r).toNumber(),t}function kZ(t,e,n){let i=new So(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new So(r),t._value=i.times(r).toNumber(),t}function LZ(t,e,n){let i=new So(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new So(r),t._value=i.dividedBy(r).toNumber(),t}function FZ(t,e,n){let i=e;return n.isNumbro(e)&&(i=e._value),t._value=i,t}function $Z(t,e,n){let i=n(t._value);return PV(i,e,n),Math.abs(i._value)}var VZ=t=>({add:(e,n)=>NZ(e,n,t),subtract:(e,n)=>PV(e,n,t),multiply:(e,n)=>kZ(e,n,t),divide:(e,n)=>LZ(e,n,t),set:(e,n)=>FZ(e,n,t),difference:(e,n)=>$Z(e,n,t),BigNumber:So});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const WZ="2.5.0",Ns=MM(),BZ=EM(),jZ=lZ(qt),zZ=EV();let Ya=DZ(qt),bl=VZ(qt);const UZ=TM;class IV{constructor(e){this._value=e}clone(){return qt(this._value)}format(e={}){return Ya.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=UZ.parseFormat(e)),e=Ya.formatOrDefault(e,Ns.currentCurrencyDefaultFormat()),e.output="currency",Ya.format(this,e)}formatTime(e={}){return e.output="time",Ya.format(this,e)}binaryByteUnits(){return Ya.getBinaryByteUnit(this)}decimalByteUnits(){return Ya.getDecimalByteUnit(this)}byteUnits(){return Ya.getByteUnit(this)}difference(e){return bl.difference(this,e)}add(e){return bl.add(this,e)}subtract(e){return bl.subtract(this,e)}multiply(e){return bl.multiply(this,e)}divide(e){return bl.divide(this,e)}set(e){return bl.set(this,OV(e))}value(){return this._value}valueOf(){return this._value}}function OV(t){let e=t;return qt.isNumbro(t)?e=t._value:typeof t=="string"?e=qt.unformat(t):isNaN(t)&&(e=NaN),e}function qt(t){return new IV(OV(t))}qt.version=WZ;qt.isNumbro=function(t){return t instanceof IV};qt.language=Ns.currentLanguage;qt.registerLanguage=Ns.registerLanguage;qt.setLanguage=Ns.setLanguage;qt.languages=Ns.languages;qt.languageData=Ns.languageData;qt.zeroFormat=Ns.setZeroFormat;qt.defaultFormat=Ns.currentDefaults;qt.setDefaults=Ns.setDefaults;qt.defaultCurrencyFormat=Ns.currentCurrencyDefaultFormat;qt.validate=BZ.validate;qt.loadLanguagesInNode=jZ.loadLanguagesInNode;qt.unformat=zZ.unformat;qt.BigNumber=bl.BigNumber;var YZ=qt,Ga=B7(YZ);const GZ="numeric";function AV(t,e){if(Bn(t)){const n=e.numericFormat,i=n&&n.culture||"-",r=n&&n.pattern;if(typeof i<"u"&&!Ga.languages()[i]){const s=i.replace("-",""),o=Ga.allLanguages?Ga.allLanguages[i]:Ga[s];o&&Ga.registerLanguage(o)}Ga.setLanguage(i),t=Ga(t).format(r||"0")}return t}function PM(t,e,n,i,r,s,o){let a=s;if(Bn(a)){let u=[];if(Array.isArray(o.className))u=o.className;else{var l;const c=(l=o.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=AV(a,o),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),o.className=u.join(" "),e.dir="ltr"}Io(t,e,n,i,r,a,o)}PM.RENDERER_TYPE=GZ;const qZ="password";function IM(t,e,n,i,r,s,o){Io.apply(this,[t,e,n,i,r,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let u="";de(a-1,()=>{u+=l}),ru(e,u)}IM.RENDERER_TYPE=qZ;const KZ="select";function OM(t,e,n,i,r,s,o){Io.apply(this,[t,e,n,i,r,s,o])}OM.RENDERER_TYPE=KZ;const XZ="time";function AM(t,e,n,i,r,s,o){Io.apply(this,[t,e,n,i,r,s,o]),e.dir="ltr"}AM.RENDERER_TYPE=XZ;function ZZ(){Hi(Gc),Hi(zf),Hi(SM),Hi(bM),Hi(_M),Hi(CM),Hi(PM),Hi(IM),Hi(OM),Hi(Io),Hi(AM)}const QZ="autocomplete";function uv(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,FH(n,e)):FH(n,e)(this.source):e(!0)}uv.VALIDATOR_TYPE=QZ;function FH(t,e){const n=t;return function(i){let r=!1;for(let s=0,o=i.length;s<o;s++)if(n===i[s]){r=!0;break}e(r)}}function HV(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const JZ=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:HV},Symbol.toStringTag,{value:"Module"})),eQ="date";function HM(t,e){const n=a$(wV,this.instance);let i=t,r=!0;i==null&&(i="");let s=Z(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),o=Z(new Date(i)).isValid()||s;if(this.allowEmpty&&i===""&&(o=!0,s=!0),o||(r=!1),!o&&s&&(r=!0),o&&!s)if(this.correctFormat===!0){const a=tQ(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),r=!0}else r=!1;e(r)}HM.VALIDATOR_TYPE=eQ;function tQ(t,e){const n=Z(HV(t)),i=Z(t,e),r=t.search(/[A-Za-z]/g)>-1;let s;return n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||r?s=n:s=i,s.format(e)}const nQ="dropdown";function DM(t,e){uv.apply(this,[t,e])}DM.VALIDATOR_TYPE=nQ;const iQ="numeric";function NM(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Bn(t))}NM.VALIDATOR_TYPE=iQ;const rQ=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],sQ="time";function kM(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,r=t;r===null&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;const s=/^\d{1,2}$/.test(r);s&&(r+=":00");const o=Z(r,rQ,!0).isValid()?Z(r):Z(r,n);let a=o.isValid(),l=Z(r,n,!0).isValid()&&!s;if(this.allowEmpty&&r===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){const u=o.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),i=!0}else i=!1;e(i)}kM.VALIDATOR_TYPE=sQ;function oQ(){Ml(uv),Ml(DM),Ml(HM),Ml(NM),Ml(kM)}const aQ="autocomplete",lQ={CELL_TYPE:aQ,editor:vM,renderer:Gc,validator:uv},uQ="checkbox",cQ={CELL_TYPE:uQ,editor:pV,renderer:SM},hQ="date";function DV(t,e,n,i,r,s,o){Gc.apply(this,[t,e,n,i,r,s,o])}DV.RENDERER_TYPE=hQ;const dQ="date",fQ={CELL_TYPE:dQ,editor:vV,renderer:DV,validator:HM},gQ="dropdown",mQ={CELL_TYPE:gQ,editor:yV,renderer:bM,validator:DM,filter:!1,strict:!0},pQ="handsontable",wQ={CELL_TYPE:pQ,editor:wM,renderer:_M},vQ="numeric",yQ={CELL_TYPE:vQ,editor:CV,renderer:PM,validator:NM,dataType:"number"},CQ="password",bQ={CELL_TYPE:CQ,editor:bV,renderer:IM,copyable:!1},SQ="select",RQ={CELL_TYPE:SQ,editor:SV,renderer:OM},_Q="time",EQ={CELL_TYPE:_Q,editor:RV,renderer:AM,validator:kM};function TQ(){Xi(lQ),Xi(cQ),Xi(fQ),Xi(mQ),Xi(wQ),Xi(yQ),Xi(bQ),Xi(RQ),Xi(gV),Xi(EQ)}function MQ(t,e){NV(t,e),e.add(t)}function xQ(t,e,n){NV(t,e),e.set(t,n)}function NV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Su(t,e,n){return(e=PQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PQ(t){var e=IQ(t,"string");return typeof e=="symbol"?e:e+""}function IQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ru(t,e){return t.get(kV(t,e))}function kV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $H=new Map([["plugin",h3],["cell-type",tV],["editor",o$],["renderer",g$],["validator",m$]]),LV=Symbol("mainSetting"),OQ="base",Vg=[];let qa=null;var Ka=new WeakMap,VH=new WeakSet;class Ye{static get PLUGIN_KEY(){return OQ}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){MQ(this,VH),Su(this,"eventManager",new cr(this)),Su(this,"pluginName",null),Su(this,"pluginsInitializedCallbacks",[]),Su(this,"isPluginsReady",!1),Su(this,"enabled",!1),Su(this,"initialized",!1),xQ(this,Ka,{}),Ds(this,"hot",e,{writable:!1}),qa=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const r=[];if(n.forEach(s=>{const[o,a]=s.split(":");if(!$H.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);$H.get(o)(a)||r.push(` - ${a} (${o})`)}),r.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");Vg.push(s)}}if(qa||(qa=yE()),qa.indexOf(this.pluginName)>=0&&qa.splice(qa.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),qa.length===0){if(Vg.length>0){const r=[`${Vg.join(`
`)}
`,"You have to import and register them manually."].join("");throw Vg.length=0,new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const i=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||Ae(n))&&i[LV]===e){var r;return Array.isArray(n)?n:(r=n[e])!==null&&r!==void 0?r:i[e]}if(Ae(n)){var s;return(s=n[e])!==null&&s!==void 0?s:i[e]}return i[e]}addHook(e,n,i){Ru(Ka,this)[e]=Ru(Ka,this)[e]||[];const r=Ru(Ka,this)[e];this.hot.addHook(e,n,i),r.push(n),Ru(Ka,this)[e]=r}removeHooks(e){A(Ru(Ka,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Ru(Ka,this);He(e,(n,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){A(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=kV(VH,this,AQ).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),He(this,(n,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function AQ(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Xa(t,e,n){return(e=HQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HQ(t){var e=DQ(t,"string");return typeof e=="symbol"?e:e+""}function DQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let LM=class{constructor(e){Xa(this,"hot",null),Xa(this,"container",null),Xa(this,"injected",!1),Xa(this,"rows",[]),Xa(this,"columns",[]),Xa(this,"samples",null),Xa(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&K(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),A(this.rows,n=>{const{height:i}=n.table.getBoundingClientRect();e(n.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),A(this.columns,n=>{const{width:i}=n.table.getBoundingClientRect();e(n.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{A(i.strings,r=>{n.appendChild(this.createColElement(r.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(s=>{A(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),o.value,l),i.appendChild(c)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),n.appendChild(r)}this.samples.forEach(r=>{A(r.strings,s=>{const o=s.col,a=e.createElement("th");i.push([o,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),A(i,r=>{const[s,o]=r;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment();return this.samples.forEach(r=>{A(r.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),c.appendChild(u),i.appendChild(c)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const i=this.hot.rootDocument.createElement("col");let r=0;n>=0&&e>=0&&(r=this.hot.getCellMeta(n,e).colspan);let s=this.hot.getColWidth(e);if(r>1)for(let o=e+1;o<e+r;o++)s+=this.hot.getColWidth(o);return i.style.width=`${s}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("table"),s=n.createElement("thead"),o=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(u),s.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(s),this.isVertical()&&o.appendChild(l),r.appendChild(o),K(r,e),i.appendChild(r),{fragment:i,table:r,tHead:s,tBody:o,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return K(r,s),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Wg(t,e,n){return(e=NQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NQ(t){var e=kQ(t,"string");return typeof e=="symbol"?e:e+""}function kQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cv{static get SAMPLE_COUNT(){return 3}constructor(e){Wg(this,"samples",null),Wg(this,"dataFactory",null),Wg(this,"customSampleCount",null),Wg(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:cv.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,i){const r=new Map,{from:s,to:o}=typeof i=="number"?{from:i,to:i}:i;return de(s,o,a=>{const l=this.generateSample(e,n,a);r.set(a,l)}),r}generateSample(e,n,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const r=new Map,s=e==="row"?"col":"row",o=[];return de(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(i,a):this.dataFactory(a,i);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Ae(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${bt(u).length}`,r.has(d)||r.set(d,{needed:this.getSampleCount(),strings:[]});const f=r.get(d);f.needed&&(!(o.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[s]:a}),o.push(u),f.needed-=1)}),r}}function LQ(t,e){FV(t,e),e.add(t)}function fS(t,e,n){FV(t,e),e.set(t,n)}function FV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mh(t,e,n){return(e=FQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FQ(t){var e=$Q(t,"string");return typeof e=="symbol"?e:e+""}function $Q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ca(t,e){return t.get(Ci(t,e))}function Vp(t,e,n){return t.set(Ci(t,e),n),n}function Ci(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("modifyAutoColumnSizeSeed");const gS="autoColumnSize",VQ=10,WQ="autoColumnSize";var FM=new WeakMap,tc=new WeakMap,Ic=new WeakMap,Ni=new WeakSet;class Pd extends Ye{static get PLUGIN_KEY(){return gS}static get PLUGIN_PRIORITY(){return VQ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),LQ(this,Ni),Mh(this,"ghostTable",new LM(this.hot)),Mh(this,"samplesGenerator",new cv((n,i)=>{const r=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(n,i);let a="";o.spanned||(a=this.hot.getDataAtCell(n,i));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),Mh(this,"inProgress",!1),Mh(this,"measuredColumns",0),Mh(this,"columnWidthsMap",new Aa),fS(this,FM,!1),fS(this,tc,[]),fS(this,Ic,[]),this.hot.columnIndexMapper.registerMap(WQ,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,i,r)=>Ci(Ni,this,WH).call(this,n,i,r))}isEnabled(){return this.hot.getSettings()[gS]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Ci(Ni,e,zQ).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Ci(Ni,e,UQ).call(e,...r)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Ci(Ni,e,GQ).call(e,...r)}),this.addHook("beforeRender",()=>Ci(Ni,this,jQ).call(this)),this.addHook("modifyColWidth",(i,r)=>this.getColumnWidth(r,i)),this.addHook("init",()=>Ci(Ni,this,YQ).call(this)),super.enablePlugin()}updatePlugin(){Vp(Ic,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,i)=>Ci(Ni,this,WH).call(this,e,n,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;de(r.from,r.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Ci(Ni,this,$V).call(this,o,s)}),this.ghostTable.columns.length&&(Ci(Ni,this,VV).call(this),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){ef(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+Pd.CALCULATION_STEP,r)},e,n),i=i+Pd.CALCULATION_STEP+1,i<r?s=Jd(o):(ef(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),i=a+1),i<r?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[gS];let n=Pd.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return Ae(e)&&(n=e.syncLimit,q_(n)?n=wE(i,n):n>>=0),Math.min(n,i)}getColumnWidth(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n;return r===void 0&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof r=="number"&&(r=Math.max(r,Ec))),r}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,r,s)=>{const o=ca(tc,this).length;return(o-1<s||ca(tc,this)[s]!==r)&&i.push(this.hot.toVisualColumn(s)),o-1<s?ca(tc,this).push(r):ca(tc,this)[s]=r,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function BQ(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const i=this.hot.toPhysicalColumn(n);i!==null&&(this.hot._getColWidthFromSettings(i)||Ci(Ni,this,$V).call(this,n,e))}),this.ghostTable.columns.length&&(Ci(Ni,this,VV).call(this),this.ghostTable.clean())}function $V(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((i,r)=>this.ghostTable.addColumn(r,i))}function VV(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function jQ(){this.calculateVisibleColumnsWidth(),this.inProgress||(Ci(Ni,this,BQ).call(this,ca(Ic,this)),Vp(Ic,this,[]))}function zQ(t,e){e||this.recalculateAllColumnsWidth()}function UQ(t){const e=t.reduce((n,i)=>{let[,r]=i;const s=this.hot.propToCol(r);return Number.isInteger(s)&&n.indexOf(s)===-1&&n.push(s),n},[]);ca(Ic,this).push(...e)}function WH(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function YQ(){Vp(tc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Vp(FM,this,!0)}function GQ(t){if(!ca(FM,this))return;const e=t.reduce((n,i)=>{var r;const s=(r=i.address)===null||r===void 0?void 0:r.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);n.indexOf(o)===-1&&n.push(o)}return n},[]);ca(Ic,this).push(...e)}const Ol={horizontal:"horizontal",vertical:"vertical"};function qQ(t,e,n){let i,r,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",i=n(e[0],e[1]),r=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",i=n(e[0],t[3]+1),r=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",i=n(e[0],e[1]),r=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",i=n(t[2]+1,e[1]),r=n(e[2],e[3])),i&&i.normalize(),r&&r.normalize(),{directionOfDrag:s,startOfDragCoords:i,endOfDragCoords:r}}function KQ(t){const e={};return t===!0?(e.directions=Object.keys(Ol),e.autoInsertRow=!0):Ae(t)?(le(t.autoInsertRow)?t.direction===Ol.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Ol)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function XQ(t,e){ZQ(t,e),e.add(t)}function ZQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _u(t,e,n){return(e=QQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QQ(t){var e=JQ(t,"string");return typeof e=="symbol"?e:e+""}function JQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("modifyAutofillRange");re.getSingleton().register("beforeAutofill");re.getSingleton().register("afterAutofill");const BH="autofill",eJ=20,tJ=["fillHandle"],nJ="insert_row_below",iJ=200;var Eu=new WeakSet;class rJ extends Ye{constructor(){super(...arguments),XQ(this,Eu),_u(this,"addingStarted",!1),_u(this,"mouseDownOnCellCorner",!1),_u(this,"mouseDragOutside",!1),_u(this,"handleDraggedCells",0),_u(this,"directions",[]),_u(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return BH}static get PLUGIN_PRIORITY(){return eJ}static get SETTING_KEYS(){return[BH,...tJ]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>xh(Eu,this,oJ).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>xh(Eu,this,sJ).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>xh(Eu,this,aJ).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:i,endRow:r,endCol:s}]),a=[],l=[],u=[];return A(o,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),A(a,c=>{const h=[];A(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,n),Math.max(a.row,i),Math.max(a.col,r)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=qQ(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=s.clone(),m=this.hot._createCellRange(h,h,d),v=this.hot.runHooks("beforeAutofill",f,g,m,c);if(v===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let S=v;const y=v;if(["up","left"].indexOf(c)>-1&&!(y.length===1&&y[0].length===0))if(S=[],c==="up"){const M=d.row-h.row+1,I=M%y.length;for(let P=0;P<M;P++)S.push(y[(P+(y.length-I))%y.length])}else{const M=d.col-h.col+1,I=M%y[0].length;for(let P=0;P<y.length;P++){S.push([]);for(let E=0;E<M;E++)S[P].push(y[P][(E+(y[P].length-I))%y[P].length])}}this.hot.populateFromArray(h.row,h.col,S,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",S,g,m,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),i=n.getBottomEndCorner();let r=e;if(this.directions.includes(Ol.vertical)&&this.directions.includes(Ol.horizontal)){const s=n.getTopStartCorner();(i.col<=e.col||s.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||s.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(Ol.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(Ol.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(nJ,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},iJ)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),i=this.hot.countRows();let r;for(let s=e[2]+1;s<i;s++){for(let l=e[1];l<=e[3];l++){const u=n[s][l];if(!Wt(u))return-1}const o=n[s][e[1]-1],a=n[s][e[3]+1];(!Wt(o)||!Wt(a))&&(r=s)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ve(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,i=xn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+en(this.hot.table),r=xn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Gt(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>xh(Eu,this,lJ).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>xh(Eu,this,uJ).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=KQ(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function sJ(){this.selectAdjacent()&&this.fillIn()}function oJ(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function aJ(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function lJ(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function uJ(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function cJ(t,e){WV(t,e),e.add(t)}function jH(t,e,n){WV(t,e),e.set(t,n)}function WV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tu(t,e,n){return(e=hJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hJ(t){var e=dJ(t,"string");return typeof e=="symbol"?e:e+""}function dJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BV(t,e,n){return t.set(vs(t,e),n),n}function Wp(t,e){return t.get(vs(t,e))}function vs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mS="autoRowSize",fJ=40,gJ="autoRowSize";var af=new WeakMap,$M=new WeakMap,Js=new WeakSet;class Id extends Ye{static get PLUGIN_KEY(){return mS}static get PLUGIN_PRIORITY(){return fJ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),cJ(this,Js),Tu(this,"headerHeight",null),Tu(this,"ghostTable",new LM(this.hot)),Tu(this,"samplesGenerator",new cv((n,i)=>{const r=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(s)||n>=0&&i>=0&&this.hot.getCellMeta(n,i).hidden)return!1;let o;return n>=0?o=this.hot.getDataAtCell(n,i):n===-1&&(o=this.hot.getColHeader(i)),{value:o}})),Tu(this,"inProgress",!1),Tu(this,"measuredRows",0),Tu(this,"rowHeightsMap",new Aa),jH(this,af,[]),jH(this,$M,!1),this.hot.rowIndexMapper.registerMap(gJ,this.rowHeightsMap),this.addHook("beforeRowResize",(n,i,r)=>vs(Js,this,zH).call(this,n,i,r))}isEnabled(){const e=this.hot.getSettings()[mS];return e===!0||Ae(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return vs(Js,e,wJ).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return vs(Js,e,vJ).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return vs(Js,e,CJ).call(e,...r)}),this.addHook("beforeRender",()=>vs(Js,this,pJ).call(this)),this.addHook("modifyRowHeight",(i,r)=>this.getRowHeight(r,i)),this.addHook("init",()=>vs(Js,this,yJ).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,i)=>vs(Js,this,zH).call(this,e,n,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}de(r.from,r.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(i||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){ef(s),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+Id.CALCULATION_STEP,r)},e,n),i=i+Id.CALCULATION_STEP+1,i<r?s=Jd(o):(ef(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),i=a+1),i<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[mS];let n=Id.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return Ae(e)&&(n=e.syncLimit,q_(n)?n=wE(i,n):n>>=0),Math.min(n,i)}getRowHeight(e,n){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let r=n;return i!==null&&i>(n||0)&&(r=i),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{de(Math.min(n,i),Math.max(n,i),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function mJ(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((r,s)=>this.ghostTable.addRow(s,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,i)=>{const r=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function pJ(){this.calculateVisibleRowsHeight(),this.inProgress||(vs(Js,this,mJ).call(this,Wp(af,this)),BV(af,this,[]))}function zH(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function wJ(t,e){e||this.recalculateAllRowsHeight()}function vJ(t){const e=t.reduce((n,i)=>{let[r]=i;return n.indexOf(r)===-1&&n.push(r),n},[]);Wp(af,this).push(...e)}function yJ(){this.recalculateAllRowsHeight(),BV($M,this,!0)}function CJ(t){if(!Wp($M,this))return;const e=t.reduce((n,i)=>{var r;const s=(r=i.address)===null||r===void 0?void 0:r.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);n.indexOf(o)===-1&&n.push(o)}return n},[]);Wp(af,this).push(...e)}const{getListWithInsertedItems:bJ,getListWithRemovedItems:SJ}=L$("physicallyIndexed");class RJ extends su{constructor(){super(e=>e)}insert(e,n){const i=jE(this.indexedValues,n);this.indexedValues=bJ(i,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=SJ(this.indexedValues,e);this.indexedValues=BE(n,e),super.remove(e)}}const{getListWithInsertedItems:_J,getListWithRemovedItems:EJ}=L$("physicallyIndexed");class TJ extends su{constructor(){super(e=>e)}insert(e,n){this.indexedValues=_J(this.indexedValues,e,n,(i,r)=>this.getNextValue(r)),super.insert(e,n)}remove(e){this.indexedValues=EJ(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function MJ(t,e){xJ(t,e),e.add(t)}function xJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PJ(t,e,n){return(e=IJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IJ(t){var e=OJ(t,"string");return typeof e=="symbol"?e:e+""}function OJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AJ(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const UH="bindRowsWithHeaders",HJ=210,DJ="loose",YH=new Map([["loose",RJ],["strict",TJ]]);var GH=new WeakSet;class NJ extends Ye{constructor(){super(...arguments),MJ(this,GH),PJ(this,"headerIndexes",null)}static get PLUGIN_KEY(){return UH}static get PLUGIN_PRIORITY(){return HJ}isEnabled(){return!!this.hot.getSettings()[UH]}enablePlugin(){var e;if(this.enabled)return;const n=(e=YH.get(this.getSetting()))!==null&&e!==void 0?e:YH.get(DJ);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",i=>AJ(GH,this,kJ).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function kJ(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function LJ(t,e){jV(t,e),e.add(t)}function FJ(t,e,n){jV(t,e),e.set(t,n)}function jV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qH(t,e,n){return(e=$J(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $J(t){var e=VJ(t,"string");return typeof e=="symbol"?e:e+""}function VJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KH(t,e){return t.get(lc(t,e))}function pS(t,e,n){return t.set(lc(t,e),n),n}function lc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const op="collapsibleColumns",WJ=290,BJ=["nestedHeaders"],vc="collapsibleIndicator",XH=op,ZH=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Mu=new WeakMap,Ph=new WeakSet;class jJ extends Ye{constructor(){super(...arguments),LJ(this,Ph),qH(this,"nestedHeadersPlugin",null),qH(this,"headerStateManager",null),FJ(this,Mu,null)}static get PLUGIN_KEY(){return op}static get PLUGIN_PRIORITY(){return WJ}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[op,...BJ]}isEnabled(){return!!this.hot.getSettings()[op]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Je("You need to configure the Nested Headers plugin in order to use collapsible headers."),pS(Mu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>lc(Ph,this,YJ).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return lc(Ph,e,GJ).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return lc(Ph,e,zJ).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,s)=>lc(Ph,this,UJ).call(this,i,r,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),pS(Mu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(n,i))!==null&&e!==void 0?e:{};if(r)return s?this.expandSection({row:n,col:o}):this.collapseSection({row:n,col:o}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:XH,relativeToGroup:Ha,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(XH)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};de(0,e-1,o=>{const a=n.childNodes[o],l=i.childNodes[o],u=r?r.childNodes[o]:null;de(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${vc}`);s(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${vc}`),s(h)),r&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${vc}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=i;if(r===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!ZH.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const i=ba(e,f=>{let{row:g}=f;return g<0});let r=i.length>0;A(i,f=>{var g;let{row:m,col:v}=f;const{collapsible:S,isCollapsed:y}=(g=this.headerStateManager.getHeaderSettings(m,v))!==null&&g!==void 0?g:{};if(!S||y&&n==="collapse"||!y&&n==="expand")return r=!1,!1});const s=[],o=[];r&&A(i,f=>{let{row:g,col:m}=f;const{colspanCompensation:v,affectedColumns:S,rollbackModification:y}=this.headerStateManager.triggerNodeModification(n,g,m);v>0&&(o.push(...S),s.push(y))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=CF([...a,...o]):n==="expand"&&(l=ba(a,f=>!o.includes(f)));const u=ZH.get(n);if(this.hot.runHooks(u.beforeHook,a,l,r)===!1){A(s,f=>{f()});return}this.hot.batchExecution(()=>{A(o,f=>{KH(Mu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&o.includes(g)){const v=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,S=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;v!==null&&S!==null&&this.hot.selectCell(v,S)}}this.hot.runHooks(u.afterHook,a,l,r,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return KH(Mu,this).getHiddenIndexes()}destroy(){pS(Mu,this,null),super.destroy()}}function zJ(t,e,n){var i;const{collapsible:r,origColspan:s,isCollapsed:o}=(i=this.headerStateManager.getHeaderSettings(n,t))!==null&&i!==void 0?i:{},a=r&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${vc}`);if(iu(e,[lr("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),K(u,vc),e.querySelector("div:first-child").appendChild(u)),me(u,["collapsed","expanded"]),o?(K(u,"collapsed"),Ra(u,"+"),l&&ve(e,...lr(!1))):(K(u,"expanded"),Ra(u,"-"),l&&ve(e,...lr(!0))),l&&ve(u,...nu());else{var c;(c=u)===null||c===void 0||c.remove()}}function UJ(t,e){ye(t.target,vc)&&(ye(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ye(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),wr(t))}function YJ(){this.updatePlugin()}function GJ(t,e){e||this.updatePlugin()}function Za(t,e,n){return(e=qJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qJ(t){var e=KJ(t,"string");return typeof e=="symbol"?e:e+""}function KJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const XJ=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],ZJ=!1,QJ=!0,JJ=!0;class eee{constructor(e,n){Za(this,"hot",void 0),Za(this,"sortingStates",new tv),Za(this,"sortEmptyCells",ZJ),Za(this,"indicator",QJ),Za(this,"headerAction",JJ),Za(this,"compareFunctionFactory",void 0),Za(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Ae(e)&&He(e,(n,i)=>{XJ.includes(i)&&(this[i]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[i]=n;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Ae(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[i,r]=n;return{column:this.hot.toVisualColumn(i),...r}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function zV(t,e,n){const i=e.locale;return function(r,s){const{sortEmptyCells:o}=n;return typeof r=="string"&&(r=r.toLocaleLowerCase(i)),typeof s=="string"&&(s=s.toLocaleLowerCase(i)),r===s?Ts:Wt(r)?Wt(s)?Ts:o&&t==="asc"?$t:Vt:Wt(s)?o&&t==="asc"?Vt:$t:isNaN(r)&&!isNaN(s)?t==="asc"?Vt:$t:!isNaN(r)&&isNaN(s)||(isNaN(r)||isNaN(s)||(r=parseFloat(r),s=parseFloat(s)),r<s)?t==="asc"?$t:Vt:r>s?t==="asc"?Vt:$t:Ts}}const UV="default";function tee(t,e,n){return function(i,r){const s=parseFloat(i),o=parseFloat(r),{sortEmptyCells:a}=n;if(s===o||isNaN(s)&&isNaN(o))return Ts;if(a){if(Wt(i))return t==="asc"?$t:Vt;if(Wt(r))return t==="asc"?Vt:$t}return isNaN(s)?Vt:isNaN(o)?$t:s<o?t==="asc"?$t:Vt:s>o?t==="asc"?Vt:$t:Ts}}const nee="numeric";function iee(t,e,n){const i=e.checkedTemplate,r=e.uncheckedTemplate,{sortEmptyCells:s}=n;return function(o,a){const l=Wt(o),u=Wt(a),c=l?r:o,h=u?r:a,d=c===r||c===i,f=h===r||h===i;if(s===!1){if(l&&u===!1)return Vt;if(l===!1&&u)return $t}return d===!1&&f?t==="asc"?$t:Vt:d&&f===!1?t==="asc"?Vt:$t:d===!1&&f===!1?zV(t,e,n)(o,a):c===r&&h===i?t==="asc"?$t:Vt:c===i&&h===r?t==="asc"?Vt:$t:Ts}}const ree="checkbox";function see(t,e,n){return ZV(t,e.dateFormat,n)}const oee="date";function aee(t,e,n){return ZV(t,e.timeFormat,n)}const lee="time",{register:Gf,getItem:QH,hasItem:uee}=vr("sorting.compareFunctionFactory"),{register:YV,getItem:cee}=vr("sorting.mainSortComparator");function GV(t){return uee(t)?QH(t):QH(UV)}Gf(ree,iee);Gf(oee,see);Gf(UV,zV);Gf(nee,tee);Gf(lee,aee);const Ts=0,$t=-1,Vt=1;function hee(t,e){const n=cee(e);for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];t.sort(n(...r))}const Bp="asc",jp="desc",qV="colHeader";function dee(t){if(Ae(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Bp,jp].includes(n)}function fee(t){if(t.some(n=>dee(n)===!1))return!1;const e=t.map(n=>{let{column:i}=n;return i});return new Set(e).size===e.length}function JH(t){if(t!==jp)return t===Bp?jp:Bp}function KV(t){return t.querySelector(`.${qV}`)}function XV(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function VM(t,e,n){return t===-1&&e>=0&&_a(n)===!1}function ZV(t,e,n){return function(i,r){const{sortEmptyCells:s}=n;if(i===r)return Ts;if(Wt(i))return Wt(r)?Ts:s&&t==="asc"?$t:Vt;if(Wt(r))return s&&t==="asc"?Vt:$t;const o=Z(i,e),a=Z(r,e);return o.isValid()?a.isValid()?a.isAfter(o)?t==="asc"?$t:Vt:a.isBefore(o)?t==="asc"?Vt:$t:Ts:$t:Vt}}function gee(t,e){Je(ot`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const mee="ascending",pee="descending",QV="indicatorDisabled",JV="columnSorting",eW="sortAction",tW=new Map([[Bp,mee],[jp,pee]]);function wee(t,e,n,i){const r=[JV];if(i&&r.push(eW),n===!1)return r.push(QV),r;const s=t.getSortOrderOfColumn(e);return le(s)&&r.push(tW.get(s)),r}function vee(){return Array.from(tW.values()).concat(eW,QV,JV)}function yee(t,e){return function(n,i){const[,...r]=n,[,...s]=i;return function(a){const l=t[a],u=e[a],c=r[a],h=s[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:GV(u.type))(l,u,d)(c,h)}(0)}}function Cee(t,e){bee(t,e),e.add(t)}function bee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bg(t,e,n){return(e=See(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=Ree(t,"string");return typeof e=="symbol"?e:e+""}function Ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zp="columnSorting",_ee=50,Up="append",Eee="replace",eD=zp;YV(zp,yee);re.getSingleton().register("beforeColumnSort");re.getSingleton().register("afterColumnSort");const Ih=new WeakMap;var Sl=new WeakSet;class nW extends Ye{constructor(){super(...arguments),Cee(this,Sl),Bg(this,"columnStatesManager",null),Bg(this,"columnMetaCache",null),Bg(this,"pluginKey",zp),Bg(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return zp}static get PLUGIN_PRIORITY(){return _ee}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Ih.has(this.hot)&&Ih.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),gee(Ih.get(this.hot),this.pluginKey);return}this.enabled||(Ih.set(this.hot,this.pluginKey),this.columnStatesManager=new eee(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Aa(n=>{let i=this.hot.toVisualColumn(n);return i===null&&(i=n),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,i)=>nc(Sl,this,Tee).call(this,n,i)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return nc(Sl,e,xee).call(e,...i)}),this.addHook("afterOnCellMouseDown",(n,i)=>this.onAfterOnCellMouseDown(n,i)),this.addHook("afterInit",()=>nc(Sl,this,A0).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return nc(Sl,e,Mee).call(e,...i)}),this.hot.view&&nc(Sl,this,A0).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,i)=>{const r=KV(i);XV(n,i)===!1||r===null||this.updateHeaderClasses(r)};Ih.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:Ha,position:"before",group:eD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eD)}sort(e){const n=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",n,i,r)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new F$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",n,r?i:n,r),r&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return fee(e)&&e.every(i=>{let{column:r}=i;return r<=n&&r>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let{column:s,...o}=r;return{column:this.hot.toPhysicalColumn(s),...o}};n.initialConfig=Ve(e,i),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,i=r=>{let{column:s,...o}=r;return{column:this.hot.toVisualColumn(s),...o}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ve(n.initialConfig,i)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const r=JH(n);return le(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:JH()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Up;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(r){if(Mt(o))return[...s.slice(0,i),...s.slice(i+1)];if(n===Up)return[...s.slice(0,i),...s.slice(i+1),o];if(n===Eee)return[...s.slice(0,i),o,...s.slice(i+1)]}return le(o)?s.concat(o):s}getPluginColumnConfig(e){if(Ae(e)){const n=e[this.pluginKey];if(Ae(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(r);return Array.isArray(s.columns)?Object.assign(i,n,this.getPluginColumnConfig(s.columns[e])):st(s.columns)?Object.assign(i,n,this.getPluginColumnConfig(s.columns(e))):Object.assign(i,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),i=Object.create(n);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],i=this.hot.countRows(),r=u=>Ve(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(i);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(r(u)));const s=Ve(n,u=>u[0]);hee(n,this.pluginKey,Ve(e,u=>u.sortOrder),Ve(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<i;u+=1)n.push([u].concat(r(u)));const o=Ve(n,u=>u[0]),a=new Map(Ve(s,(u,c)=>[u,o[c]])),l=Ve(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ae(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Ae(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(me(e,vee()),this.enabled!==!1){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];K(e,wee(...i))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ye(e.target,qV)}onAfterOnCellMouseDown(e,n){if(VM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const i=this.hot.getActiveEditor(),r=this.getColumnNextConfig(n.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(r)}):this.sort(r)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function A0(){const t=this.getAllSavedSortSettings();if(Ae(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Tee(t,e){const n=KV(e);if(XV(t,e)===!1||n===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],r=i.indicator,s=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,r,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);ve(e,...Nq(o?`${o}ending`:"none"))}}function Mee(t){t===!0&&this.hot.view&&nc(Sl,this,A0).call(this)}function xee(t,e,n,i){VM(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function Qa(t,e,n){return(e=Pee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pee(t){var e=Iee(t,"string");return typeof e=="symbol"?e:e+""}function Iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oee{constructor(e,n){Qa(this,"plugin",void 0),Qa(this,"hot",void 0),Qa(this,"endpoints",[]),Qa(this,"settings",void 0),Qa(this,"settingsType","array"),Qa(this,"currentEndpoint",null),Qa(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),A(i,r=>{const s={};this.assignSetting(r,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,s,"reversedRowCoords",!1),this.assignSetting(r,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,s,"sourceColumn",r.destinationColumn),this.assignSetting(r,s,"type","sum"),this.assignSetting(r,s,"forceNumeric",!1),this.assignSetting(r,s,"suppressDataTypeErrors",!0),this.assignSetting(r,s,"customFunction",null),this.assignSetting(r,s,"readOnly",!0),this.assignSetting(r,s,"roundFloat",!1),n.push(s)}),n}assignSetting(e,n,i,r){if(i==="ranges"&&e[i]===void 0){n[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;n[i]=r}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}resetSetupBeforeStructureAlteration(e,n,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();A(s,o=>{r==="row"&&o.destinationRow>=n&&(e==="insert_row"?o.alterRowOffset=i:e==="remove_row"&&(o.alterRowOffset=-1*i)),r==="col"&&o.destinationColumn>=n&&(e==="insert_col"?o.alterColumnOffset=i:e==="remove_col"&&(o.alterColumnOffset=-1*i))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,n,i,r,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;A(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*i),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*i)}),this.resetAllEndpoints(u,!c),c?A(u,d=>{this.extendEndpointRanges(d,h,r[0],r.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):A(u,d=>{this.shiftEndpointCoordinates(d,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,i,r){A(e.ranges,s=>{s[1]&&(n>=s[0]&&n<=s[1]?i>s[1]?s[1]+=r:i<s[0]&&(s[0]-=r):i>=s[0]&&i<=s[1]&&(s[1]-=r,n<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,i=[],r=[];A(n,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));r.push(o)}),A(r,s=>{let o=[];A(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),i.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),i.push(o))})}),e.ranges=i}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,A(e.ranges,i=>{A(i,(r,s)=>{r>=n&&(i[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const s=r.alterRowOffset||0,o=r.alterColumnOffset||0;return r.destinationRow+s>=this.hot.countRows()||r.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],A(e,r=>{this.resetEndpointValue(r,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],A(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],A(e,(i,r,s)=>{`${i[2]||""}`!=`${i[3]}`&&A(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[r][1])===o.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),A(n,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const i=this.hot.getCellMeta(n,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?r:0)),""])}setEndpointValue(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(n==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Je("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function wS(t){return t==null||isNaN(t)}function Aee(t,e){Hee(t,e),e.add(t)}function Hee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dee(t,e,n){return(e=Nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nee(t){var e=kee(t,"string");return typeof e=="symbol"?e:e+""}function kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vS="columnSummary",Lee=220;var Oh=new WeakSet;class Fee extends Ye{constructor(){super(...arguments),Aee(this,Oh),Dee(this,"endpoints",null)}static get PLUGIN_KEY(){return vS}static get PLUGIN_PRIORITY(){return Lee}isEnabled(){return!!this.hot.getSettings()[vS]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[vS],this.endpoints=new Oee(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jg(Oh,e,$ee).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jg(Oh,e,Wee).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jg(Oh,e,Vee).call(e,...i)}),this.addHook("beforeCreateRow",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,i,null,r)),this.addHook("beforeCreateCol",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,i,null,r)),this.addHook("afterCreateCol",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,i,null,r)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jg(Oh,e,Bee).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return He(e.ranges,i=>{n+=this.getPartialSum(i,e.sourceColumn)}),n}getPartialSum(e,n){let i=0,r=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(r,n),s=wS(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}i+=s||0,r-=1}while(r>=e[0]);return Math.round(i*10**o)/10**o}calculateMinMax(e,n){let i=null;return He(e.ranges,r=>{const s=this.getPartialMinMax(r,e.sourceColumn,n);if(i===null&&s!==null&&(i=s),s!==null)switch(n){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}}),i===null?"Not enough data":i}getPartialMinMax(e,n,i){let r=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,n),o=wS(o)?null:o,r===null)r=o;else if(o!==null)switch(i){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}s-=1}while(s>=e[0]);return r}countEmpty(e,n){let i,r=0,s=e[1]||e[0];do i=this.getCellValue(s,n),i=wS(i)?null:i,i===null&&(r+=1),s-=1;while(s>=e[0]);return r}countEntries(e){let n=0;const i=e.ranges;return He(i,r=>{const s=r[1]===void 0?1:r[1]-r[0]+1,o=this.countEmpty(r,e.sourceColumn);n+=s,n-=o}),n}calculateAverage(e){const n=this.calculateSum(e),i=this.countEntries(e);return n/i}getCellValue(e,n){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(n);let s=this.hot.getSourceDataAtCell(e,n),o="";if(i!==null&&r!==null&&(o=this.hot.getCellMeta(i,r).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ot`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function $ee(){this.endpoints.initEndpoints()}function Vee(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function Wee(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Bee(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function jee(t,e){iW(t,e),e.add(t)}function yS(t,e,n){iW(t,e),e.set(t,n)}function iW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ic(t,e){return t.get(WM(t,e))}function H0(t,e,n){return t.set(WM(t,e),n),n}function WM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yp=new WeakMap,zg=new WeakMap,Ug=new WeakMap,tD=new WeakSet;class rW{constructor(){jee(this,tD),yS(this,Yp,!0),yS(this,zg,null),yS(this,Ug,new ResizeObserver(e=>WM(tD,this,zee).call(this,e)))}setObservedElement(e){H0(zg,this,e)}unobserve(){ic(Ug,this).unobserve(ic(zg,this))}observe(){H0(Yp,this,!0),ic(Ug,this).observe(ic(zg,this))}destroy(){ic(Ug,this).disconnect()}}function zee(t){if(ic(Yp,this)||!Array.isArray(t)||!t.length){H0(Yp,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:i,blockSize:r}=n[0];this.runLocalHooks("resize",i,r)})}ht(rW,In);function Do(t,e,n){Uee(t,e),e.set(t,n)}function Uee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dt(t,e){return t.get(sW(t,e))}function es(t,e,n){return t.set(sW(t,e),n),n}function sW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xu=new WeakMap,CS=new WeakMap,bS=new WeakMap,Gs=new WeakMap,No=new WeakMap,ko=new WeakMap,Yg=new WeakMap,Pu=new WeakMap;class Al{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,i){var r=this;Do(this,xu,void 0),Do(this,CS,void 0),Do(this,bS,!1),Do(this,Gs,null),Do(this,No,void 0),Do(this,ko,void 0),Do(this,Yg,!0),Do(this,Pu,new rW),es(xu,this,e),es(CS,this,i),es(bS,this,n),es(No,this,this.createEditor()),es(ko,this,dt(No,this).style),dt(Pu,this).setObservedElement(this.getInputElement()),dt(Pu,this).addLocalHook("resize",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){dt(ko,this).left=`${e}px`,dt(ko,this).top=`${n}px`}setSize(e,n){if(e&&n){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${n}px`}}getSize(){return{width:Gt(this.getInputElement()),height:en(this.getInputElement())}}observeSize(){dt(Pu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){dt(ko,this).display="block",es(Yg,this,!1)}hide(){dt(Pu,this).unobserve(),dt(Yg,this)||(dt(ko,this).display="none"),es(Yg,this,!0)}isVisible(){return dt(ko,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return dt(xu,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=dt(xu,this).createElement("div"),n=dt(xu,this).createElement("textarea");return e.style.display="none",es(Gs,this,dt(xu,this).createElement("div")),dt(Gs,this).setAttribute("dir",dt(bS,this)?"rtl":"ltr"),K(dt(Gs,this),Al.CLASS_EDITOR_CONTAINER),dt(CS,this).appendChild(dt(Gs,this)),K(e,Al.CLASS_EDITOR),K(n,Al.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),dt(Gs,this).appendChild(e),e}getInputElement(){return dt(No,this).querySelector(`.${Al.CLASS_INPUT}`)}getEditorElement(){return dt(No,this)}destroy(){const e=dt(Gs,this)?dt(Gs,this).parentNode:null;dt(No,this).parentNode.removeChild(dt(No,this)),es(No,this,null),es(ko,this,null),dt(Pu,this).destroy(),e&&e.removeChild(dt(Gs,this))}}ht(Al,In);function SS(t,e,n){return(e=Yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yee(t){var e=Gee(t,"string");return typeof e=="symbol"?e:e+""}function Gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qee=250,Kee=250;class oW{constructor(e){SS(this,"wasLastActionShow",!0),SS(this,"showDebounced",null),SS(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Kee)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qee;this.showDebounced=Ff(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}ht(oW,In);function Xee(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Zee(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ja(t,e){const n={};return A(t,i=>{i.forAll((r,s)=>{r>=0&&s>=0&&(n[r]||(n[r]=[]),n[r][s]=e(r,s))})}),n}function Xo(t,e,n,i,r){A(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&Qee(o,a,e,n,i,r)})})}function Qee(t,e,n,i,r,s){const o=r(t,e);let a=i;o.className&&(n==="vertical"?a=Xee(o.className,i):a=Zee(o.className,i)),s(t,e,"className",a)}function aW(t){return`<span class="selected">â</span>${t}`}function ap(t,e){let n=!1;return Array.isArray(t)&&A(t,i=>(i.forAll((r,s)=>{if(r>=0&&s>=0&&e(r,s))return n=!0,!1}),n)),n}function hv(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:r,left:s}=i.getBoundingClientRect();n.top=r,n.left=s}return n}const ke="---------";function Jee(){return{name:ke}}const er="alignment";function ete(){return{key:er,name(){return this.getTranslatedPhrase(gT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${er}:left`,name(){return this.getTranslatedPhrase(mT)},callback(){const t=this.getSelectedRange(),e=Ja(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),Xo(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${er}:center`,name(){return this.getTranslatedPhrase(pT)},callback(){const t=this.getSelectedRange(),e=Ja(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),Xo(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${er}:right`,name(){return this.getTranslatedPhrase(wT)},callback(){const t=this.getSelectedRange(),e=Ja(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),Xo(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${er}:justify`,name(){return this.getTranslatedPhrase(vT)},callback(){const t=this.getSelectedRange(),e=Ja(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),Xo(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{name:ke},{key:`${er}:top`,name(){return this.getTranslatedPhrase(yT)},callback(){const t=this.getSelectedRange(),e=Ja(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),Xo(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${er}:middle`,name(){return this.getTranslatedPhrase(CT)},callback(){const t=this.getSelectedRange(),e=Ja(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),Xo(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${er}:bottom`,name(){return this.getTranslatedPhrase(bT)},callback(){const t=this.getSelectedRange(),e=Ja(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),Xo(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1}]}}}const dv="clear_column";function tte(){return{key:dv,name(){return this.getTranslatedPhrase(eT)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,i)=>{if(n<0||i<0)return!0;const{readOnly:r}=this.getCellMeta(n,i);return r?!0:(e=!0,!1)}),!e}}}const qf="col_left";function nte(){return{key:qf,name(){return this.getTranslatedPhrase(qE)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Kf="col_right";function ite(){return{key:Kf,name(){return this.getTranslatedPhrase(KE)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Xf="make_read_only";function rte(){return{key:Xf,checkable:!0,ariaChecked(){return ap(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Dp)},name(){let t=this.getTranslatedPhrase(Dp);return ap(this.getSelectedRange(),(n,i)=>this.getCellMeta(n,i).readOnly)&&(t=aW(t)),t},callback(){const t=this.getSelectedRange(),e=ap(t,(n,i)=>this.getCellMeta(n,i).readOnly);A(t,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&this.setCellMeta(i,r,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const fv="redo";function ste(){return{key:fv,name(){return this.getTranslatedPhrase(JE)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Zf="remove_col";function ote(){return{key:Zf,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(ZE,e)},callback(){this.alter("remove_col",A6(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const gv="remove_row";function ate(){return{key:gv,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(XE,e)},callback(){this.alter("remove_row",H6(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const mv="row_above";function lte(){return{key:mv,name(){return this.getTranslatedPhrase(YE)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const pv="row_below";function ute(){return{key:pv,name(){return this.getTranslatedPhrase(GE)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const lf="no_items";function cte(){return{key:lf,name(){return this.getTranslatedPhrase(UE)},disabled:!0,isCommand:!1}}const wv="undo";function hte(){return{key:wv,name(){return this.getTranslatedPhrase(QE)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const dte=[mv,pv,qf,Kf,dv,gv,Zf,wv,fv,Xf,er,ke,lf],fte={[ke]:Jee,[lf]:cte,[mv]:lte,[pv]:ute,[qf]:nte,[Kf]:ite,[dv]:tte,[gv]:ate,[Zf]:ote,[wv]:hte,[fv]:ste,[Xf]:rte,[er]:ete};function lW(){const t={};return He(fte,(e,n)=>{t[n]=e()}),t}function gte(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(hT):this.getTranslatedPhrase(cT)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function mte(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(dT)},callback(){this.getSelectedRangeLast().forAll((n,i)=>{n>=0&&i>=0&&t.removeCommentAtCell(n,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function pte(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(fT);return ap(this.getSelectedRange(),(i,r)=>t.getCommentMeta(i,r,lp))?aW(e):e},callback(){this.getSelectedRangeLast().forAll((n,i)=>{if(n>=0&&i>=0){const r=!!t.getCommentMeta(n,i,lp);t.updateCommentMeta(n,i,{[lp]:!r})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function wte(t,e){uW(t,e),e.add(t)}function Iu(t,e,n){uW(t,e),e.set(t,n)}function uW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vte(t,e,n){return(e=yte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yte(t){var e=Cte(t,"string");return typeof e=="symbol"?e:e+""}function Cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ha(t,e,n){return t.set(Di(t,e),n),n}function Ne(t,e){return t.get(Di(t,e))}function Di(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Gp="comments",bte=60,so="comment",gd="value",cW="style",lp="readOnly",Ah=Gp,D0=`plugin:${Gp}`;var gt=new WeakMap,gs=new WeakMap,vv=new WeakMap,up=new WeakMap,N0=new WeakMap,qp=new WeakMap,qi=new WeakSet;class Ste extends Ye{constructor(){super(...arguments),wte(this,qi),vte(this,"range",{}),Iu(this,gt,null),Iu(this,gs,null),Iu(this,vv,!1),Iu(this,up,!1),Iu(this,N0,null),Iu(this,qp,"")}static get PLUGIN_KEY(){return Gp}static get PLUGIN_PRIORITY(){return bte}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Gp]}enablePlugin(){var e=this;this.enabled||(Ne(gt,this)||(ha(gt,this,new Al(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),Ne(gt,this).addLocalHook("resize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Di(qi,e,Ite).call(e,...i)}),this.hot.addHook("afterSetTheme",(n,i)=>{i||this.hide()})),Ne(gs,this)||ha(gs,this,new oW(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,i,r,s,o,a)=>Di(qi,this,Mte).call(this,n,a)),this.addHook("afterScroll",()=>Di(qi,this,Ote).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Di(qi,this,nD).call(this,n)),this.addHook("beforeCompositionStart",n=>Di(qi,this,nD).call(this,n)),Ne(gs,this).addLocalHook("hide",()=>this.hide()),Ne(gs,this).addLocalHook("show",(n,i)=>this.showAtCell(n,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Ne(gs,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),i=e.addContext(D0);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeLast();ha(up,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(D0),this.hot._registerTimeout(()=>{ha(up,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isCell()},group:Ah}),i.addShortcut({keys:[["Escape"]],callback:()=>{Ne(gt,this).setValue(Ne(qp,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ne(gt,this).isVisible()&&Ne(gt,this).isFocused(),group:Ah}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ne(gt,this).isVisible()&&Ne(gt,this).isFocused(),group:Ah}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{Ne(gt,this).setValue(Ne(gt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:Ah})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Ah)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>Di(qi,this,Ete).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Di(qi,this,Rte).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Di(qi,this,Tte).call(this)),this.eventManager.addEventListener(n,"focus",()=>Di(qi,this,Pte).call(this)),this.eventManager.addEventListener(n,"blur",()=>Di(qi,this,xte).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",i=>Di(qi,this,_te).call(this,i))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Sa(e.target,"TD","TBODY");return!!(n&&ye(n,"htCommentCell")&&Sa(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Ne(gt,this).getValue();let i="";e!=null?i=e:n!=null&&(i=n);const r=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(r,s,{[gd]:i}),this.hot.render()}setCommentAtCell(e,n,i){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,so),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(i)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,gd)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,gd)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:i}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Ne(gs,this).cancelHiding(),Ne(gt,this).setValue((e=r[so]?r[so][gd]:null)!==null&&e!==void 0?e:""),Ne(gt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Ne(gt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Ne(gt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:r,col:s}=this.range.from;let o=n.getRenderableFromVisualIndex(r),a=i.getRenderableFromVisualIndex(s);const l=o===null;Ne(gt,this).setPosition(0,0),o===null&&(o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1))),a===null&&(a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)));const u=o===null,c=a===null;o=o??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:o,col:a},!0),m=this.getCommentMeta(r,s,cW);m?Ne(gt,this).setSize(m.width,m.height):Ne(gt,this).resetSize();const v=c?0:f.getColumnWidth(a),S=l&&!u?en(g):0,{left:y,top:M,width:I,height:P}=g.getBoundingClientRect(),{width:E,height:T}=Ne(gt,this).getSize(),{innerWidth:$,innerHeight:U}=this.hot.rootWindow,O=this.hot.rootDocument.documentElement,G=Cn(this.hot.rootDocument),q=lE(this.hot.rootWindow)?G:0,ne=uE(this.hot.rootWindow)?G:0;let Q=y+h.scrollX+v,te=M+h.scrollY+S;this.hot.isRtl()&&(Q-=E+v),this.hot.isLtr()&&y+I+E>$-q?Q=y+h.scrollX-E-1:this.hot.isRtl()&&Q<-(O.scrollWidth-O.clientWidth)&&(Q=y+h.scrollX+v+1),M+T>U-ne&&(te-=T-P+1),Ne(gt,this).setPosition(Q,te),Ne(gt,this).setReadOnlyState(this.getCommentMeta(r,s,lp)),Ne(gt,this).observeSize()}focusEditor(){Ne(gt,this).focus()}updateCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n)[so];let s;r?(s=Yn(r),Nf(s,i)):s=i,this.hot.setCellMeta(e,n,so,s)}getCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n);if(r[so])return r[so][i]}addToContextMenu(e){e.items.push({name:ke},gte(this),mte(this),pte(this))}getEditorInputElement(){return Ne(gt,this).getInputElement()}destroy(){var e,n;(e=Ne(gt,this))===null||e===void 0||e.destroy(),(n=Ne(gs,this))===null||n===void 0||n.destroy(),super.destroy()}}function Rte(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Ne(vv,this)&&!this.targetIsCommentTextArea(t)){const e=Sa(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function _te(t){t.stopPropagation()}function Ete(t){const{rootDocument:e}=this.hot;if(!(Ne(vv,this)||Ne(gt,this).isFocused()||ye(t.target,"wtBorder")||Ne(N0,this)===t.target||!Ne(gt,this)))if(ha(N0,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Ne(gs,this).show(n)}else pa(t.target,e)&&!this.targetIsCommentTextArea(t)&&Ne(gs,this).hide()}function Tte(){ha(vv,this,!1)}function Mte(t,e){e[so]&&e[so][gd]&&K(t,e.commentedCellClassName)}function xte(){ha(qp,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Pte(){ha(qp,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(D0)}function Ite(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[cW]:{width:t,height:e}})}function nD(t){Ne(gt,this).isFocused()&&wr(t)}function Ote(){Ne(up,this)||this.hide()}function RS(t,e,n){return(e=Ate(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ate(t){var e=Hte(t,"string");return typeof e=="symbol"?e:e+""}function Hte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hW{constructor(e){RS(this,"hot",void 0),RS(this,"commands",{}),RS(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=Dte(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Qt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),i.unshift(s.join(":")),A(u,c=>c.apply(this.hot,i))}}function Dte(t,e){let n;return A(e,i=>{const r=i.key?i.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=i,!1}),n}function _S(t,e,n){return(e=Nte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nte(t){var e=kte(t,"string");return typeof e=="symbol"?e:e+""}function kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dW{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;_S(this,"hot",void 0),_S(this,"predefinedItems",lW()),_S(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,He(e,(i,r)=>{let s="";i.name===ke?(n[ke]=i,s=ke):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,n[r]=i,s=i.key):(n[i.key]=i,s=i.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Lte(e,this.defaultOrderPattern,this.predefinedItems)}}function Lte(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let r=t;return r&&r.items?r=r.items:Array.isArray(r)||(r=e),Ae(r)?He(r,(s,o)=>{let a=n[typeof s=="string"?s:o];a||(a=s),Ae(s)?tn(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),i.push(a)}):A(r,(s,o)=>{let a=n[s];!a&&dte.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),Ae(s)&&tn(a,s),a.key===void 0&&(a.key=o),i.push(a))}),i}function Lo(t,e,n){return(e=Fte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fte(t){var e=$te(t,"string");return typeof e=="symbol"?e:e+""}function $te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vte{constructor(e,n){Lo(this,"top",void 0),Lo(this,"topRelative",void 0),Lo(this,"left",void 0),Lo(this,"leftRelative",void 0),Lo(this,"scrollTop",void 0),Lo(this,"scrollLeft",void 0),Lo(this,"cellHeight",void 0),Lo(this,"cellWidth",void 0);const i=n.scrollY,r=n.scrollX;let s,o,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,o=s,l=a,s+=i,a+=r):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,o=s-i,l=a-r),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Hh(t,e,n){Wte(t,e),e.set(t,n)}function Wte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(fW(t,e))}function Gg(t,e,n){return t.set(fW(t,e),n),n}function fW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xn=new WeakMap,hi=new WeakMap,di=new WeakMap,ES=new WeakMap,Ou=new WeakMap;class Bte{constructor(e){Hh(this,Xn,void 0),Hh(this,hi,void 0),Hh(this,di,void 0),Hh(this,ES,!1),Hh(this,Ou,{above:0,below:0,left:0,right:0}),Gg(ES,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return xe(Ou,this)[e]=n,this}setElement(e){return Gg(Xn,this,e),this}setParentElement(e){return Gg(hi,this,e),this}updatePosition(e){Gg(di,this,new Vte(e,xe(Xn,this).ownerDocument.defaultView)),xe(ES,this)?(xe(di,this).fitsBelow(xe(Xn,this))?this.setPositionBelowCursor():xe(di,this).fitsAbove(xe(Xn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){xe(Xn,this).dir==="rtl"?xe(di,this).fitsOnLeft(xe(Xn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():xe(di,this).fitsOnRight(xe(Xn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=xe(Ou,this).above+xe(di,this).top-xe(Xn,this).offsetHeight;if(xe(hi,this)){const i=xe(hi,this).ownerDocument.defaultView.getComputedStyle(xe(hi,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),s=Number.parseInt(i.borderTop,10);e=xe(di,this).top+xe(di,this).cellHeight-xe(Xn,this).scrollHeight+r+s}xe(Xn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=xe(Ou,this).below+xe(di,this).top+1;if(xe(hi,this)){const i=xe(hi,this).ownerDocument.defaultView.getComputedStyle(xe(hi,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),s=Number.parseInt(i.borderTop,10);e=xe(di,this).top-r-s-1}xe(Xn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=xe(di,this).left;if(xe(hi,this)){const n=xe(hi,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(xe(hi,this).querySelector(".htCore")).borderRightWidth,10);e+=xe(di,this).cellWidth+i}else e+=xe(Ou,this).right;xe(Xn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=xe(Ou,this).left+xe(di,this).left-xe(Xn,this).offsetWidth;if(xe(hi,this)){const n=xe(hi,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(xe(hi,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}xe(Xn,this).style.left=`${e}px`}}function gW(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:r=()=>{}}=t;const s=new Set;let o=je(e,-1,m()-1);function a(S,y){const M=m()-1;return S<0&&(S=M),S>M&&(S=0),s.has(S)?-1:(s.add(S),i(S,!1)===!1&&(S=a(y===1?++S:--S,y)),S)}function l(S){S>-1&&S<m()&&i(S,!0)!==!1&&(o=S)}function u(S){S>-1&&S<m()&&(o=S)}function c(){return o}function h(){m()>0&&(s.clear(),o=a(0,1))}function d(){m()>0&&(s.clear(),o=a(m()-1,-1))}function f(){m()>0&&(s.clear(),o=a(++o,1))}function g(){m()>0&&(s.clear(),o=a(--o,-1))}function m(){return Math.max(n(),0)}function v(){s.clear(),o=e,r()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:g,getSize:m,clear:v}}function jte(t){return Ve(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function k0(t){return Qt(t,"submenu")}function L0(t){return new RegExp(ke,"i").test(t.name)}function cp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function iD(t){return Qt(t,"disableSelection")}function zte(t){return ye(t,"htSeparator")}function Ute(t){return ye(t,"htSubmenu")}function Yte(t){return ye(t,"htDisabled")}function Gte(t){return ye(t,"htSelectionDisabled")}function qte(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function mW(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function Kte(t,e){let n=t.slice(0);return n.reverse(),n=mW(n,e),n.reverse(),n}function Xte(t){const e=[];return A(t,(n,i)=>{i>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Zte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ke,n=t.slice(0);return n=mW(n,e),n=Kte(n,e),n=Xte(n),n}function Qte(t){return t.checkable===!0}function Jte(t){return gW({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||zte(i)||Yte(i)||Gte(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function ene(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(i):s.tabMoves;r.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const i=n.getSelectedLast();if(i){const r=t.openSubMenu(i[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const r=n.getSelectedLast();r&&(n.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const pW="menu",rD=pW;function tne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];i(ene(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;r(c,h)});function i(u,c){a(c).addShortcuts(u,{group:pW})}function r(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),i(u,c)}function s(){return[...n]}function o(u){return u?`${rD}:${u}`:rD}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=o(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(o(u))}return{addCustomShortcuts:r,getCustomShortcuts:s,getContext:a,listen:l}}function nne(t){return(e,n,i,r,s,o)=>{const a=e.getSourceDataAtRow(i),l=t.rootDocument.createElement("div"),u=typeof o=="function"?o.call(t):o,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Ps(n),K(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!cp(a,t)&&!iD(a)&&!L0(a);ve(n,[...Qte(a)?[Tq(),bc(c),PF(h)]:[Eq(),bc(u)],...d?[Oa(-1)]:[],...cp(a,t)?[Hq()]:[],...k0(a)?[lr(!1)]:[]])}n.className="",n.appendChild(l),L0(a)?K(n,"htSeparator"):typeof a.renderer=="function"?(K(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,i,r,s,u))):ru(l,u),cp(a,t)?K(n,"htDisabled"):iD(a)?K(n,"htSelectionDisabled"):k0(a)&&K(n,"htSubmenu")}}function TS(t,e,n){ine(t,e),e.set(t,n)}function ine(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ts(t,e,n){return(e=rne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rne(t){var e=sne(t,"string");return typeof e=="symbol"?e:e+""}function sne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MS(t,e,n){return t.set(wW(t,e),n),n}function Fo(t,e){return t.get(wW(t,e))}function wW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sD=215;var Au=new WeakMap,qg=new WeakMap,Kg=new WeakMap;class qc{get tableBorderWidth(){return Fo(Kg,this)===void 0&&this.hotMenu&&MS(Kg,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Fo(Kg,this)}constructor(e,n){var i=this;ts(this,"hot",void 0),ts(this,"options",void 0),ts(this,"eventManager",new cr(this)),ts(this,"container",void 0),ts(this,"positioner",void 0),ts(this,"hotMenu",null),ts(this,"hotSubMenus",{}),ts(this,"parentMenu",void 0),ts(this,"menuItems",null),ts(this,"origOutsideClickDeselects",null),TS(this,Au,void 0),TS(this,qg,void 0),TS(this,Kg,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:sD,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new Bte(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(r,s)=>{this.options.container!==this.hot.rootPortalElement&&(me(this.options.container,/ht-theme-.*/g),K(this.options.container,r)),s||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Wl(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Fo(Au,this)}getKeyboardShortcutsCtrl(){return Fo(qg,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Ff(a=>this.openSubMenu(a),300),n=this.options.minWidth||sD;let i=!1,r=ba(this.menuItems,a=>(a.key===lf&&(i=!0),qte(a,this.hot)));if(r.length<1&&!i)r.push(lW()[lf]);else if(r.length===0)return;r=Zte(r,ke);let s=!1;const o={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:nne(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?Fo(Au,this).setCurrentPage(l.row):Fo(Au,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),Mp()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Mp()||!_a(a))&&s&&this.hasSelectedItem()&&(Fr()||tE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),MS(Au,this,Jte(this.hotMenu)),MS(qg,this,tne(this)),Fo(qg,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Fo(Au,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const i=this.parentMenu.hotMenu.getCell(n[0],0);ve(i,[lr(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Ute(n))return!1;const i=this.hotMenu.getSourceDataAtRow(e),r=new qc(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&ve(n,[lr(!0)]),r}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];if(i){i.destroy(),delete this.hotSubMenus[n.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&ve(r,[lr(!1)])}}closeAllSubMenus(){A(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const i=this.hot.getSelectedRange(),r=i?jte(i):[];this.runLocalHooks("executeCommand",n.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,r,e)}isCommandPassive(e){return e.isCommand===!1||L0(e)||cp(e,this.hot)||k0(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,i=e.hider.style,r=e.holder.style,s=parseInt(i.width,10),o=fn(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?en(this.hotMenu.getCell(u,0)):0;return a+(l.name===ke?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(r.width=`${s+3}px`,r.height=`${o+3}px`):(r.width=`${s}px`,r.height=`${o}px`),i.height=r.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let i=e,r;return i&&(st(i)&&(i=i.call(this.hot),i===null||Mt(i)?i="":i=i.toString()),i=i.replace(/[^A-Za-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,r=n.querySelector(`.${this.options.className}.${i}`)),r||(r=n.createElement("div"),K(r,`htMenu handsontable ${this.options.className}`),i&&K(r,i),this.options.container.appendChild(r)),r}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&ve(this.hotMenu.rootElement,[_q(),Oa(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!pa(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!pa(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ye(e.target,"htCore")&&pa(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ht(qc,In);function one(t,e){ane(t,e),e.add(t)}function ane(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xS(t,e,n){return(e=lne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lne(t){var e=une(t,"string");return typeof e=="symbol"?e:e+""}function une(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const md="contextMenu",cne=70,oD=md;re.getSingleton().register("afterContextMenuDefaultOptions");re.getSingleton().register("beforeContextMenuShow");re.getSingleton().register("afterContextMenuShow");re.getSingleton().register("afterContextMenuHide");re.getSingleton().register("afterContextMenuExecute");var Dh=new WeakSet;class yv extends Ye{constructor(){super(...arguments),one(this,Dh),xS(this,"commandExecutor",new hW(this.hot)),xS(this,"itemsFactory",null),xS(this,"menu",null)}static get PLUGIN_KEY(){return md}static get PLUGIN_PRIORITY(){return cne}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[mv,pv,ke,qf,Kf,ke,gv,Zf,ke,wv,fv,ke,Xf,ke,er]}isEnabled(){return!!this.hot.getSettings()[md]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[md];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new qc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Xg(Dh,this,dne).call(this)),this.menu.addLocalHook("afterOpen",()=>Xg(Dh,this,fne).call(this)),this.menu.addLocalHook("afterClose",()=>Xg(Dh,this,gne).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return e.executeCommand.call(e,...r)}),this.addHook("afterOnCellContextMenu",i=>Xg(Dh,this,hne).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=hv(this.menu.container,this.hot.rootDocument);this.open({left:n.left+i.left,top:n.top+i.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:oD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(oD)}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const r=this.menu.tableBorderWidth>0;He(i,(s,o)=>{const a=["below","right"].includes(o)?s+1:s-1;this.menu.setOffset(o,r?s:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new dW(this.hot,yv.DEFAULT_ITEMS);const e=this.hot.getSettings()[md],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),A(i,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function hne(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;function r(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),ye(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||i)&&!r(s)&&!(ye(s,"current")&&ye(s,"wtBorder"))))return;const o=hv(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function dne(){this.hot.runHooks("beforeContextMenuShow",this)}function fne(){this.hot.runHooks("afterContextMenuShow",this)}function gne(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}yv.SEPARATOR={name:ke};function mne(t){return{key:"copy",name(){return this.getTranslatedPhrase(tT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function pne(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(rT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function wne(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(iT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function vne(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(nT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function yne(t){return{key:"cut",name(){return this.getTranslatedPhrase(sT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Cne{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class bne{constructor(){this.clipboardData=new Cne}preventDefault(){}composedPath(){return[]}}function Sne(t,e){vW(t,e),e.add(t)}function Hu(t,e,n){vW(t,e),e.set(t,n)}function vW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jn(t,e){return t.get(uc(t,e))}function Du(t,e,n){return t.set(uc(t,e),n),n}function uc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $o=new WeakMap,PS=new WeakMap,Nh=new WeakMap,F0=new WeakMap,$0=new WeakMap,kh=new WeakMap,Lh=new WeakSet;class Rne{constructor(e){let{countRows:n,countColumns:i,rowsLimit:r,columnsLimit:s,countColumnHeaders:o}=e;Sne(this,Lh),Hu(this,$o,void 0),Hu(this,PS,void 0),Hu(this,Nh,void 0),Hu(this,F0,void 0),Hu(this,$0,void 0),Hu(this,kh,void 0),Du(PS,this,n),Du(Nh,this,i),Du(F0,this,r),Du($0,this,s),Du(kh,this,o)}setSelectedRange(e){Du($o,this,e)}getCellsRange(){if(Jn(PS,this).call(this)===0||Jn(Nh,this).call(this)===0)return null;const{row:e,col:n}=Jn($o,this).getTopStartCorner(),{row:i,col:r}=Jn($o,this).getBottomEndCorner(),s=uc(Lh,this,_ne).call(this,e,i),o=uc(Lh,this,IS).call(this,n,r);return{isRangeTrimmed:i!==s||r!==o,startRow:e,startCol:n,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(Jn(Nh,this).call(this)===0||Jn(kh,this).call(this)===0)return null;const{col:e}=Jn($o,this).getTopStartCorner(),{col:n}=Jn($o,this).getBottomEndCorner(),i=uc(Lh,this,IS).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(Jn(Nh,this).call(this)===0||Jn(kh,this).call(this)===0)return null;const{col:e}=Jn($o,this).getTopStartCorner(),{col:n}=Jn($o,this).getBottomEndCorner(),i=uc(Lh,this,IS).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-Jn(kh,this).call(this),startCol:e,endRow:-1,endCol:i}}}function IS(t,e){return Math.min(e,Math.max(t+Jn($0,this).call(this)-1,t))}function _ne(t,e){return Math.min(e,Math.max(t+Jn(F0,this).call(this)-1,t))}function yW(t){const e=[],n=[];return A(t,i=>{const r=Math.min(i.startRow,i.endRow),s=Math.max(i.startRow,i.endRow);de(r,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);de(o,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Ene(t,e){CW(t,e),e.add(t)}function Vo(t,e,n){CW(t,e),e.set(t,n)}function CW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fh(t,e,n){return(e=Tne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tne(t){var e=Mne(t,"string");return typeof e=="symbol"?e:e+""}function Mne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yi(t,e){return t.get(bi(t,e))}function Pr(t,e,n){return t.set(bi(t,e),n),n}function bi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("afterCopyLimit");re.getSingleton().register("modifyCopyableRange");re.getSingleton().register("beforeCut");re.getSingleton().register("afterCut");re.getSingleton().register("beforePaste");re.getSingleton().register("afterPaste");re.getSingleton().register("beforeCopy");re.getSingleton().register("afterCopy");const OS="copyPaste",xne=80,Pne=["fragmentSelection"],aD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var V0=new WeakMap,W0=new WeakMap,B0=new WeakMap,Nu=new WeakMap,Zg=new WeakMap,Qg=new WeakMap,ku=new WeakMap,Kp=new WeakMap,ki=new WeakSet;class Ine extends Ye{constructor(){super(...arguments),Ene(this,ki),Fh(this,"columnsLimit",1/0),Fh(this,"rowsLimit",1/0),Fh(this,"pasteMode","overwrite"),Fh(this,"uiContainer",this.hot.rootDocument.body),Vo(this,V0,!1),Vo(this,W0,!1),Vo(this,B0,!1),Vo(this,Nu,"cells-only"),Vo(this,Zg,!1),Vo(this,Qg,!1),Vo(this,ku,new Rne({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Vo(this,Kp,!1),Fh(this,"copyableRanges",[])}static get PLUGIN_KEY(){return OS}static get SETTING_KEYS(){return[OS,...Pne]}static get PLUGIN_PRIORITY(){return xne}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[OS]}enablePlugin(){var e,n,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Pr(V0,this,this.getSetting("copyColumnHeaders")),Pr(W0,this,this.getSetting("copyColumnGroupHeaders")),Pr(B0,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",r=>bi(ki,this,Hne).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return bi(ki,i,Dne).call(i,...s)}),this.addHook("afterSelectionEnd",()=>bi(ki,this,Nne).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),Rc()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return bi(ki,i,kne).call(i,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return bi(ki,i,Lne).call(i,...s)}),this.addHook("afterSelection",()=>bi(ki,this,Fne).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Pr(Nu,this,e),Pr(Zg,this,!0),bi(ki,this,lD).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Pr(Qg,this,!0),bi(ki,this,lD).call(this,"cut")}getRangedCopyableData(e){return Md(this.getRangedData(e))}getRangedData(e){const n=[],{rows:i,columns:r}=yW(e);return A(i,s=>{const o=[];A(r,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),n.push(o)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const i=new bne;e&&i.clipboardData.setData("text/plain",e),n&&i.clipboardData.setData("text/html",n),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}yi(ku,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);yi(Nu,this)==="column-headers-only"?n.set("headers",yi(ku,this).getMostBottomColumnHeadersRange()):(yi(Nu,this)==="with-column-headers"?n.set("headers",yi(ku,this).getMostBottomColumnHeadersRange()):yi(Nu,this)==="with-column-group-headers"&&n.set("headers",yi(ku,this).getAllColumnHeadersRange()),n.set("cells",yi(ku,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>r!==null).map(r=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=r;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=n.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:s,endRow:o,endCol:a}=i;this.hot.runHooks("afterCopyLimit",o-r+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,r=e[0].length,s=[],{row:o,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=o,h=a,d=o,f=a;for(;s.length<i||c<=l;){const{skipRowOnPaste:g,visualRow:m}=this.hot.getCellMeta(c,a);if(c=m+1,g===!0)continue;d=m,h=a;const v=[],S=s.length%i;for(;v.length<r||h<=u;){const{skipColumnOnPaste:y,visualCol:M}=this.hot.getCellMeta(o,h);if(h=M+1,y===!0)continue;f=M;const I=v.length%r;v.push(e[S][I])}s.push(v)}return Pr(Kp,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,d,f]}onCopy(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!yi(Zg,this)||this.isEditorOpened()||Es(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!_d(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Pr(Zg,this,!1);const s=this.getRangedData(this.copyableRanges),o=bi(ki,this,One).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,o)){const l=Md(s);if(e&&e.clipboardData){const u=g0(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[aD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",s,this.copyableRanges,o)}Pr(Nu,this,"cells-only")}onCut(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!yi(Qg,this)||this.isEditorOpened()||Es(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!_d(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Pr(Qg,this,!1);const s=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",s,this.copyableRanges)){const a=Md(s);if(e&&e.clipboardData){const l=g0(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[aD,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Es(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!_d(n,this.hot.rootElement)))return;e.preventDefault();let s;if(e&&typeof e.clipboardData<"u"){const c=Vw(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?s=c$(c,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=F6(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[o,a,l,u]=this.populateValues(s);this.hot.selectCell(o,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function lD(t){if(Rc()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:i}=e.highlight,r=this.hot.getCell(n,i,!0);r&&ZF(r,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function One(t){const{rows:e}=yW(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function Ane(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&hE(i)}}}function bW(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i!=null&&i.hasAttribute("contenteditable")&&dE(i)}}}function Hne(t){t.items.push({name:"---------"},mne(this)),yi(V0,this)&&t.items.push(vne(this)),yi(W0,this)&&t.items.push(wne(this)),yi(B0,this)&&t.items.push(pne(this)),t.items.push(yne(this))}function Dne(t,e,n,i,r){yi(Kp,this)&&(r.value=!0),Pr(Kp,this,!1)}function Nne(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function kne(){bi(ki,this,bW).call(this)}function Lne(){bi(ki,this,Ane).call(this)}function Fne(){bi(ki,this,bW).call(this)}function SW(t,e){return`border_row${t}col${e}`}function pd(){return{width:1,color:"#000"}}function go(){return{hide:!0}}function $ne(){return{width:1,color:"#000",cornerVisible:!1}}function AS(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function $h(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function HS(t,e){return{id:SW(t,e),border:$ne(),row:t,col:e,top:go(),bottom:go(),start:go(),end:go()}}function Vne(t,e){return Qt(e,"border")&&e.border&&(t.border=e.border),Qt(e,"top")&&le(e.top)&&(e.top?(Ae(e.top)||(e.top=pd()),t.top=e.top):(e.top=go(),t.top=e.top)),Qt(e,"bottom")&&le(e.bottom)&&(e.bottom?(Ae(e.bottom)||(e.bottom=pd()),t.bottom=e.bottom):(e.bottom=go(),t.bottom=e.bottom)),Qt(e,"start")&&le(e.start)&&(e.start?(Ae(e.start)||(e.start=pd()),t.start=e.start):(e.start=go(),t.start=e.start)),Qt(e,"end")&&le(e.end)&&(e.end?(Ae(e.end)||(e.end=pd()),t.end=e.end):(e.end=go(),t.end=e.end)),t}function Ro(t,e){let n=!1;return A(t.getSelectedRange(),i=>{i.forAll((r,s)=>{if(r<0||s<0)return;const o=t.getCellMeta(r,s).borders;if(o)if(e){if(!Qt(o[e],"hide")||o[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Cv(t){return`<span class="selected">â</span>${t}`}function Wne(t){return t.some(e=>le(e.left)||le(e.right))}function Bne(t){return t.some(e=>le(e.start)||le(e.end))}const jne=new Map([["left","start"],["right","end"]]);function zne(t){var e;return(e=jne.get(t))!==null&&e!==void 0?e:t}function Une(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(ET);return Ro(this,"bottom")&&(e=Cv(e)),e},callback(e,n){const i=Ro(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function Yne(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(TT);return Ro(this,e)&&(n=Cv(n)),n},callback(n,i){const r=Ro(this,e);t.prepareBorder(i,e,r)}}}function Gne(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(MT)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Ro(this)}}}function qne(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(_T);return Ro(this,e)&&(n=Cv(n)),n},callback(n,i){const r=Ro(this,e);t.prepareBorder(i,e,r)}}}function Kne(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(RT);return Ro(this,"top")&&(e=Cv(e)),e},callback(e,n){const i=Ro(this,"top");t.prepareBorder(n,"top",i)}}}function Xne(t,e){Zne(t,e),e.add(t)}function Zne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qne(t,e,n){return(e=Jne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jne(t){var e=eie(t,"string");return typeof e=="symbol"?e:e+""}function eie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hp="customBorders",tie=90;var DS=new WeakSet;class nie extends Ye{constructor(){super(...arguments),Xne(this,DS),Qne(this,"savedBorders",[])}static get PLUGIN_KEY(){return hp}static get PLUGIN_PRIORITY(){return tie}isEnabled(){return!!this.hot.getSettings()[hp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>uD(DS,this,iie).call(this,e)),this.addHook("init",()=>uD(DS,this,rie).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let i=["top","bottom","start","end"],r=null;n&&(this.checkSettingsCohesion([n]),i=Object.keys(n),r=AS(n));const s=Tc(e),o=sf(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});A(e,a=>{o(a).forAll((l,u)=>{A(i,c=>{this.prepareBorderFromCustomAdded(l,u,r,zne(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Tc(e),i=sf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return A(e,s=>{i(s).forAll((o,a)=>{A(this.savedBorders,l=>{l.row===o&&l.col===a&&r.push($h(l))})})}),r}clearBorders(e){e?this.setBorders(e):(A(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,n,i,r){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||n>=o)return;let a=HS(e,n);i&&(a=Vne(a,i),A(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",$h(a)),this.insertBorderIntoSettings(a,r)}prepareBorderFromCustomAddedRange(e,n){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);de(e.from.row,i,s=>{de(e.from.col,r,o=>{const a=HS(s,o);let l=0;s===e.from.row&&Qt(n,"top")&&(l+=1,a.top=n.top),s===e.to.row&&Qt(n,"bottom")&&(l+=1,a.bottom=n.bottom),o===e.from.col&&Qt(n,"start")&&(l+=1,a.start=n.start),o===e.to.col&&Qt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(s,o,"borders",$h(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const i=SW(e,n);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,i,r){let s=this.hot.getCellMeta(e,n).borders;!s||s.border===void 0?s=HS(e,n):s=AS(s),r?(s[i]=go(),this.countHide(s)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(s,i,r)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",$h(s)))):(s[i]=pd(),this.checkCustomSelectionsFromContextMenu(s,i,r)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",$h(s)))}prepareBorder(e,n,i){A(e,r=>{let{start:s,end:o}=r;if(s.row===o.row&&s.col===o.col)n==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,n,i);else switch(n){case"noBorders":de(s.col,o.col,a=>{de(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":de(s.col,o.col,a=>{this.setBorder(s.row,a,n,i)});break;case"bottom":de(s.col,o.col,a=>{this.setBorder(o.row,a,n,i)});break;case"start":de(s.row,o.row,a=>{this.setBorder(a,s.col,n,i)});break;case"end":de(s.row,o.row,a=>{this.setBorder(a,o.col,n,i)});break}})}createCustomBorders(e){A(e,n=>{const i=AS(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,i):this.prepareBorderFromCustomAdded(n.row,n.col,i)})}countHide(e){const{top:n,bottom:i,start:r,end:s}=e;return fn([n,i,r,s],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ve(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){A(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){A(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ve(this.savedBorders,i=>i.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):A(this.savedBorders,(r,s)=>{if(e.id===r.id)return this.savedBorders[s]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,i){let r=!1;return A(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return A(o,a=>{a.toggleHiddenClass(n,i)}),r=!0,!1}}),r}checkCustomSelections(e,n,i){const r=this.countHide(e);let s=!1;return r===4?(this.removeAllBorders(e.row,e.col),s=!0):A(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=n,o.commit(),i){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);A(a,l=>{l.changeBorderStyle(i,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[hp];if(Array.isArray(e)){const n=Yn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Wne(e),i=Bne(e);if(n&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function iie(t){this.hot.getSettings()[hp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(ST)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Kne(this),qne(this),Une(this),Yne(this),Gne(this)]}})}function rie(){this.changeBorderSettings()}function sie(t,e){oie(t,e),e.add(t)}function oie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NS(t,e,n){return(e=aie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aie(t){var e=lie(t,"string");return typeof e=="symbol"?e:e+""}function lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hD="dragToScroll",uie=100;var kS=new WeakSet;class cie extends Ye{constructor(){super(...arguments),sie(this,kS),NS(this,"boundaries",null),NS(this,"callback",null),NS(this,"listening",!1)}static get PLUGIN_KEY(){return hD}static get PLUGIN_PRIORITY(){return uie}isEnabled(){return!!this.hot.getSettings()[hD]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>cD(kS,this,dD).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>cD(kS,this,dD).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let i=0,r=0;n<this.boundaries.top?r=n-this.boundaries.top:n>this.boundaries.bottom&&(r=n-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",i=>this.onMouseMove(i)),n=Wl(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function dD(t){if(_a(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,i)=>{var r,s;const o=(r=e.scrollLeft)!==null&&r!==void 0?r:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(n)*50,a+Math.sign(i)*20)}),this.listen()}function hie(t,e){RW(t,e),e.add(t)}function die(t,e,n){RW(t,e),e.set(t,n)}function RW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LS(t,e,n){return(e=fie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fie(t){var e=gie(t,"string");return typeof e=="symbol"?e:e+""}function gie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mie(t,e){return t.get(tr(t,e))}function _W(t,e,n){return t.set(tr(t,e),n),n}function tr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("afterDropdownMenuDefaultOptions");re.getSingleton().register("beforeDropdownMenuShow");re.getSingleton().register("afterDropdownMenuShow");re.getSingleton().register("afterDropdownMenuHide");re.getSingleton().register("afterDropdownMenuExecute");const dp="dropdownMenu",pie=230,uf="changeType",FS=dp;var bv=new WeakMap,Ar=new WeakSet;class Sv extends Ye{static get PLUGIN_KEY(){return dp}static get PLUGIN_PRIORITY(){return pie}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[qf,Kf,ke,Zf,ke,dv,ke,Xf,ke,er]}constructor(e){super(e),hie(this,Ar),LS(this,"commandExecutor",new hW(this.hot)),LS(this,"itemsFactory",null),LS(this,"menu",null),die(this,bv,!1),this.hot.addHook("afterGetColHeader",(n,i)=>tr(Ar,this,vie).call(this,n,i))}isEnabled(){return this.hot.getSettings()[dp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new dW(this.hot,Sv.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return tr(Ar,e,_ie).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return tr(Ar,e,Rie).call(e,...s)});const n=this.hot.getSettings()[dp],i={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new qc(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>tr(Ar,this,yie).call(this)),this.menu.addLocalHook("afterOpen",()=>tr(Ar,this,Cie).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>tr(Ar,this,bie).call(this,s)),this.menu.addLocalHook("afterClose",()=>tr(Ar,this,Sie).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),A(r,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:r}=this.hot.getSelectedRangeLast(),s=hv(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,r.col,!0).querySelector(`.${uf}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:FS},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isCell()&&!this.menu.isOpened()},group:FS}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FS)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>tr(Ar,this,wie).call(this,e))}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),He(i,(r,s)=>{this.menu.setOffset(s,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function EW(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function wie(t){if(ye(t.target,uf)){const e=hv(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),_W(bv,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function vie(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,r=Array.prototype.indexOf.call(i,n);if(t<0||r!==i.length-1)return;const s=e.querySelector(`.${uf}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=uf,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(ve(o,[nu(),bc(" ")]),ve(e,[TF("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function yie(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Cie(){this.hot.runHooks("afterDropdownMenuShow",this),tr(Ar,this,EW).call(this,this.menu)}function bie(t){tr(Ar,this,EW).call(this,t)}function Sie(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Rie(t){return mie(bv,this)?null:t}function _ie(t){ye(t.target,uf)&&_W(bv,this,!0)}Sv.SEPARATOR={name:ke};function fD(t,e,n){return(e=Eie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eie(t){var e=Tie(t,"string");return typeof e=="symbol"?e:e+""}function Tie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mie{constructor(e){fD(this,"hot",void 0),fD(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:i,endCol:r}=this._getDataRange(),s=this.options,o=[];return de(e,i,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(de(n,r,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();de(n,i,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(r[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();de(n,i,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(r[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[i=0,r=0,s=n,o=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),s=Math.min(s,n),o=Math.min(o,e),{startRow:i,startCol:r,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function gD(t,e,n){return(e=xie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xie(t){var e=Pie(t,"string");return typeof e=="symbol"?e:e+""}function Pie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){gD(this,"dataProvider",void 0),gD(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=zr(this.constructor.DEFAULT_OPTIONS);const i=new Date;return n=tn(zr(BM.DEFAULT_OPTIONS),n),n=tn(n,e),n.filename=K_(n.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),n}}function Iie(t,e){Oie(t,e),e.add(t)}function Oie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TW="\r",Aie='"',Hie=`
`,Die="=",Nie="+",kie="-",Lie="@",Fie="	";var $S=new WeakSet;class $ie extends BM{constructor(){super(...arguments),Iie(this,$S)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return r&&(i=Ve(i,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),o&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),A(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=bt(e);return r===""||(i&&(n=!0),i instanceof RegExp?r=mD($S,this,Wie).call(this,r,i):typeof i=="function"?r=i(r):i&&(r=mD($S,this,Vie).call(this,r)),(n||r.indexOf(TW)>=0||r.indexOf(Aie)>=0||r.indexOf(Hie)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`)),r}}function Vie(t){return t.startsWith(Die)||t.startsWith(Nie)||t.startsWith(kie)||t.startsWith(Lie)||t.startsWith(Fie)||t.startsWith(TW)?`'${t}`:t}function Wie(t,e){return e.test(t)?`'${t}`:t}const Bie="csv",j0={[Bie]:$ie};function jie(t,e,n){return typeof j0[t]=="function"?new j0[t](e,n):null}const zie="exportFile",Uie=240;class Yie extends Ye{static get PLUGIN_KEY(){return zie}static get PLUGIN_PRIORITY(){return Uie}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,s=this._createTypeFormatter(e,n),o=this._createBlob(s),a=r.URL||r.webkitURL,l=i.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!j0[e])throw new Error(`Export format type "${e}" is not supported.`);return jie(e,new Mie(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Lu(t,e,n){return(e=Gie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gie(t){var e=qie(t,"string");return typeof e=="symbol"?e:e+""}function qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qf{constructor(e,n){let{id:i,stateless:r=!0}=n;Lu(this,"hot",void 0),Lu(this,"id",void 0),Lu(this,"elements",[]),Lu(this,"hidden",!1),Lu(this,"stateId",""),Lu(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new tv)}getElements(){return this.elements}reset(){A(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),A(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ht(Qf,In);const cf={};function Ea(t,e){if(!cf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=cf[t];let r=e;return i.inputValuesDecorator&&(r=i.inputValuesDecorator(r)),function(s){return n.apply(s.meta.instance,[].concat([s],[r]))}}function Hl(t){if(!cf[t])throw Error(`Filter condition "${t}" does not exist.`);return cf[t].descriptor}function sn(t,e,n){n.key=t,cf[t]={condition:e,descriptor:n}}const _n="none";function Kie(){return!0}sn(_n,Kie,{name:nv,inputsCount:0,showOperators:!1});const Od="empty";function Xie(t){return Wt(t.value)}sn(Od,Xie,{name:DT,inputsCount:0,showOperators:!0});const fp="not_empty";function Zie(t,e){return!Ea(Od,e)(t)}sn(fp,Zie,{name:NT,inputsCount:0,showOperators:!0});const Ad="eq";function Qie(t,e){let[n]=e;return bt(t.value).toLocaleLowerCase(t.meta.locale)===bt(n)}sn(Ad,Qie,{name:kT,inputsCount:1,showOperators:!0});const gp="neq";function Jie(t,e){return!Ea(Ad,e)(t)}sn(gp,Jie,{name:LT,inputsCount:1,showOperators:!0});const MW="gt";function ere(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}sn(MW,ere,{name:BT,inputsCount:1,showOperators:!0});const xW="gte";function tre(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}sn(xW,tre,{name:jT,inputsCount:1,showOperators:!0});const PW="lt";function nre(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}sn(PW,nre,{name:zT,inputsCount:1,showOperators:!0});const IW="lte";function ire(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}sn(IW,ire,{name:UT,inputsCount:1,showOperators:!0});const jM="date_after";function rre(t,e){let[n]=e;const i=Z(t.value,t.meta.dateFormat),r=Z(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)>=0}sn(jM,rre,{name:qT,inputsCount:1,showOperators:!0});const zM="date_before";function sre(t,e){let[n]=e;const i=Z(t.value,t.meta.dateFormat),r=Z(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)<=0}sn(zM,sre,{name:KT,inputsCount:1,showOperators:!0});const Xp="between";function ore(t,e){let[n,i]=e,r=n,s=i;if(t.meta.type==="numeric"){const o=parseFloat(r,10),a=parseFloat(s,10);r=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=Ea(zM,[s]),a=Ea(jM,[r]);return o(t)&&a(t)}return t.value>=r&&t.value<=s}sn(Xp,ore,{name:YT,inputsCount:2,showOperators:!0});const OW="not_between";function are(t,e){return!Ea(Xp,e)(t)}sn(OW,are,{name:GT,inputsCount:2,showOperators:!0});const AW="begins_with";function lre(t,e){let[n]=e;return bt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(bt(n))}sn(AW,lre,{name:FT,inputsCount:1,showOperators:!0});const HW="ends_with";function ure(t,e){let[n]=e;return bt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(bt(n))}sn(HW,ure,{name:$T,inputsCount:1,showOperators:!0});const UM="contains";function cre(t,e){let[n]=e;return bt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(bt(n))>=0}sn(UM,cre,{name:VT,inputsCount:1,showOperators:!0});const DW="not_contains";function hre(t,e){return!Ea(UM,e)(t)}sn(DW,hre,{name:WT,inputsCount:1,showOperators:!0});const NW="date_tomorrow";function dre(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}sn(NW,dre,{name:ZT,inputsCount:0});const kW="date_today";function fre(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}sn(kW,fre,{name:XT,inputsCount:0});const LW="date_yesterday";function gre(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}sn(LW,gre,{name:QT,inputsCount:0});HF();function mre(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Jf(t){const e=new Set(t);return function(n){return e.has(n)}}function YM(t){return t??""}function z0(t){return Array.from(new Set(t)).map(e=>YM(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function pD(t,e,n,i){const r=[],s=t===e;let o;return s||(o=Jf(e)),t.forEach(a=>{let l=!1;(s||o(a))&&(l=!0);const u={checked:l,value:a,visualValue:mre(a,n)};i&&i(u),r.push(u)}),r}const Dl="by_value";function pre(t,e){let[n]=e;return n(t.value)}sn(Dl,pre,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Jf(e)]},showOperators:!1});const hf={};function wre(t){if(!hf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=hf[t].func;return function(n,i){return e(n,i)}}function vre(t){return hf[t].name}function GM(t,e,n){hf[t]={name:e,func:n}}const va="conjunction",yre=tM;function Cre(t,e){return t.every(n=>n.func(e))}GM(va,yre,Cre);const Zp="disjunction",bre=iv;function Sre(t,e){return t.some(n=>n.func(e))}GM(Zp,bre,Sre);const qM="disjunctionWithExtraCondition",Rre=iv;function _re(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}GM(qM,Rre,_re);const Ere="numeric",FW="text",Tre="date",wD={[Ere]:[_n,ke,Od,fp,ke,Ad,gp,ke,MW,xW,PW,IW,Xp,OW],[FW]:[_n,ke,Od,fp,ke,Ad,gp,ke,AW,HW,ke,UM,DW],[Tre]:[_n,ke,Od,fp,ke,Ad,gp,ke,zM,jM,Xp,ke,NW,kW,LW]};function Mre(t){const e=[];let n=t;return wD[n]||(n=FW),A(wD[n],i=>{let r;i===ke?r={name:ke}:r=zr(Hl(i)),e.push(r)}),e}function Vh(t,e,n){return(e=xre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xre(t){var e=Pre(t,"string");return typeof e=="symbol"?e:e+""}function Pre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const VS="built",WS="building",vD=["click","input","keydown","keypress","keyup","focus","blur","change"];let Wr=class $W{static get DEFAULTS(){return zr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Vh(this,"hot",void 0),Vh(this,"eventManager",new cr(this)),Vh(this,"options",void 0),Vh(this,"_element",void 0),Vh(this,"buildState",void 0),this.hot=e,this.options=tn($W.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===WS?this._element:this.buildState===VS?(this.update(),this._element):(this.buildState=WS,this.build(),this.buildState=VS,this._element)}isBuilt(){return this.buildState===VS}translateIfPossible(e){return typeof e=="string"&&e.startsWith(si)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,i)=>{this.eventManager.addEventListener(n,i,r=>this.runLocalHooks(i,r,this))};if(this.buildState||(this.buildState=WS),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&K(this._element,this.options.className),this.options.children.length)A(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),He(this.options,(i,r)=>{n[r]!==void 0&&r!=="className"&&r!=="tagName"&&r!=="children"&&(n[r]=this.translateIfPossible(i))}),this._element.appendChild(n),A(vD,i=>e(n,i))}else A(vD,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ht(Wr,In);function Ire(t,e){VW(t,e),e.add(t)}function Ore(t,e,n){VW(t,e),e.set(t,n)}function VW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jg(t,e){return t.get(KM(t,e))}function Are(t,e,n){return t.set(KM(t,e),n),n}function KM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fu=new WeakMap,yD=new WeakSet;class ya extends Wr{static get DEFAULTS(){return zr({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,tn(ya.DEFAULTS,n)),Ire(this,yD),Ore(this,Fu,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>KM(yD,this,Hre).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Are(Fu,this,this._element.firstChild),K(this._element,"htUIInput"),K(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Jg(Fu,this).type=this.options.type,Jg(Fu,this).placeholder=this.translateIfPossible(this.options.placeholder),Jg(Fu,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Jg(Fu,this).focus()}}function Hre(t){this.options.value=t.target.value}function Dre(t,e){WW(t,e),e.add(t)}function Wh(t,e,n){WW(t,e),e.set(t,n)}function WW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $u(t,e,n){return t.set(Hd(t,e),n),n}function Dt(t,e){return t.get(Hd(t,e))}function Hd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pn=new WeakMap,em=new WeakMap,tm=new WeakMap,BS=new WeakMap,nm=new WeakMap,im=new WeakSet;class df extends Wr{static get DEFAULTS(){return zr({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,tn(df.DEFAULTS,n)),Dre(this,im),Wh(this,pn,null),Wh(this,em,[]),Wh(this,tm,void 0),Wh(this,BS,void 0),Wh(this,nm,void 0),this.registerHooks()}getMenu(){return Dt(pn,this)}registerHooks(){this.addLocalHook("click",()=>Hd(im,this,Lre).call(this))}setItems(e){$u(em,this,this.translateNames(e)),Dt(pn,this)&&Dt(pn,this).setMenuItems(Dt(em,this))}translateNames(e){return A(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),$u(pn,this,new qc(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Dt(pn,this).setMenuItems(Dt(em,this));const e=new Wr(this.hot,{className:"htUISelectCaption"}),n=new Wr(this.hot,{className:"htUISelectDropdown"});$u(tm,this,e),$u(BS,this,e.element),$u(nm,this,n),this.hot.getSettings().ariaTags&&(ve(n.element,[nu()]),ve(this._element,[EF()])),A([e,n],i=>this._element.appendChild(i.element)),Dt(pn,this).addLocalHook("select",i=>Hd(im,this,Nre).call(this,i)),Dt(pn,this).addLocalHook("afterClose",()=>Hd(im,this,kre).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Dt(pn,this).hot.getTranslatedPhrase(nv),Dt(BS,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Dt(pn,this)&&(Dt(pn,this).open(),Dt(pn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Dt(pn,this).getNavigator().toFirstItem(),Dt(pn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Dt(pn,this)&&Dt(pn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Dt(pn,this)&&(Dt(pn,this).destroy(),$u(pn,this,null)),Dt(tm,this)&&Dt(tm,this).destroy(),Dt(nm,this)&&Dt(nm,this).destroy(),super.destroy()}}function Nre(t){t.name!==ke&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function kre(){this.runLocalHooks("afterClose")}function Lre(){this.openOptions()}function Fre(t,e){$re(t,e),e.add(t)}function $re(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CD(t,e,n){return(e=Vre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vre(t){var e=Wre(t,"string");return typeof e=="symbol"?e:e+""}function Wre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jS=new WeakSet;class U0 extends Qf{constructor(e,n){super(e,{id:n.id,stateless:!1}),Fre(this,jS),CD(this,"name",""),CD(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new df(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ya(this.hot,{placeholder:aM})),this.elements.push(new ya(this.hot,{placeholder:lM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>bD(jS,this,Bre).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),A(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>bD(jS,this,jre).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=zr(e.command);n.name.startsWith(Bt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),A(e.args,(i,r)=>{if(r>n.inputsCount-1)return!1;const s=this.getInputElement(r);s.setValue(i),s[n.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Hl(_n),n=[];return A(this.getInputElements(),(i,r)=>{e.inputsCount>r&&n.push(i.getValue())}),{command:e,args:n}}updateState(e,n){const i=Hl(e?e.name:_n);this.state.setValueAtIndex(n,{command:i,args:e?e.args:[]}),e||A(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof df)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ya)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,s,o)=>{K(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&K(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return K(a,"htFiltersMenuLabel"),a.textContent=o,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||A(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Hl(_n)];if(e!==null){const{visualIndex:i}=e;n=Mre(this.hot.getDataType(0,i,this.hot.countRows(),i))}A(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Bre(t){A(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function jre(t){jc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),wr(t))}function SD(t,e,n){zre(t,e),e.set(t,n)}function zre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bh(t,e){return t.get(BW(t,e))}function RD(t,e,n){return t.set(BW(t,e),n),n}function BW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vu=new WeakMap,zS=new WeakMap;class Qp extends Wr{static get DEFAULTS(){return zr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,tn(Qp.DEFAULTS,n)),SD(this,Vu,void 0),SD(this,zS,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),RD(zS,this,e),RD(Vu,this,this._element.firstChild),Bh(Vu,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Bh(zS,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Bh(Vu,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Bh(Vu,this).checked=e)}focus(){this.isBuilt()&&Bh(Vu,this).focus()}}function Ure(t,e){Yre(t,e),e.add(t)}function Yre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gre(t,e,n){return(e=qre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qre(t){var e=Kre(t,"string");return typeof e=="symbol"?e:e+""}function Kre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xre(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _D=0;var ED=new WeakSet;class Zre extends Qf{constructor(e,n){super(e,{id:n.id,stateless:!1}),Ure(this,ED),Gre(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(K(n.parentNode,"htFiltersMenuOperators"),A(this.elements,i=>n.appendChild(i.element)),n)}}buildOperatorsElement(){const e=[va,Zp];A(e,n=>{const i=new Qp(this.hot,{name:"operator",label:{htmlFor:n,textContent:vre(n)},value:n,checked:n===e[_D],id:n});i.addLocalHook("change",r=>Xre(ED,this,Qre).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(ot`Radio button with index ${e} doesn't exist.`);A(this.elements,(n,i)=>{n.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Qp&&n.isChecked());return e?e.getValue():va}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&A(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:va,n=arguments.length>1?arguments[1]:void 0,i=e;i===qM&&(i=Zp),this.state.setValueAtIndex(n,i)}reset(){this.setChecked(_D)}}function Qre(t){this.setState(t.target.value)}function Jre(t,e,n){ese(t,e),e.set(t,n)}function ese(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function US(t,e){return t.get(jW(t,e))}function tse(t,e,n){return t.set(jW(t,e),n),n}function jW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jh=new WeakMap;class ff extends Wr{static get DEFAULTS(){return zr({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,tn(ff.DEFAULTS,n)),Jre(this,jh,void 0)}build(){super.build(),tse(jh,this,this._element.firstChild)}update(){this.isBuilt()&&(US(jh,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&US(jh,this).focus()}activate(){US(jh,this).click()}}function nse(t,e){zW(t,e),e.add(t)}function Wu(t,e,n){zW(t,e),e.set(t,n)}function zW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pe(t,e){return t.get(cc(t,e))}function Er(t,e,n){return t.set(cc(t,e),n),n}function cc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TD="multipleSelect.itemBox";var Hr=new WeakMap,Xt=new WeakMap,YS=new WeakMap,qs=new WeakMap,Wo=new WeakMap,Bo=new WeakMap,zh=new WeakSet;class gf extends Wr{static get DEFAULTS(){return zr({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,tn(gf.DEFAULTS,n)),nse(this,zh),Wu(this,Hr,[]),Wu(this,Xt,void 0),Wu(this,YS,void 0),Wu(this,qs,void 0),Wu(this,Wo,void 0),Wu(this,Bo,void 0),Er(qs,this,new ya(this.hot,{placeholder:oM,className:"htUIMultipleSelectSearch"})),Er(Wo,this,new ff(this.hot,{textContent:nM,className:"htUISelectAll"})),Er(Bo,this,new ff(this.hot,{textContent:iM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Pe(Xt,this)}registerHooks(){Pe(qs,this).addLocalHook("keydown",e=>cc(zh,this,rse).call(this,e)),Pe(qs,this).addLocalHook("input",e=>cc(zh,this,ise).call(this,e)),Pe(Wo,this).addLocalHook("click",e=>cc(zh,this,sse).call(this,e)),Pe(Bo,this).addLocalHook("click",e=>cc(zh,this,ose).call(this,e))}setItems(e){var n;Er(Hr,this,e),(n=Pe(Xt,this))===null||n===void 0||n.loadData(Pe(Hr,this))}setLocale(e){Er(YS,this,e)}getLocale(){return Pe(YS,this)}getItems(){return[...Pe(Hr,this)]}getValue(){return lse(Pe(Hr,this))}getSearchInputElement(){return Pe(qs,this)}getSelectAllElement(){return Pe(Wo,this)}getClearAllElement(){return Pe(Bo,this)}isSelectedAllValues(){return Pe(Hr,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),i=new Wr(this.hot,{className:"htUISelectionControls",children:[Pe(Wo,this),Pe(Bo,this)]});this._element.appendChild(Pe(qs,this).element),this._element.appendChild(i.element),this._element.appendChild(n);const r=s=>{var o;if(!this._element)return;(o=Pe(Xt,this))===null||o===void 0||o.destroy(),K(s,"htUIMultipleSelectHot"),Er(Xt,this,new this.hot.constructor(s,{data:Pe(Hr,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Pe(Xt,this).listen()},modifyColWidth:u=>{const c=Pe(Xt,this).container.scrollWidth-Cn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Pe(Xt,this).init();const l=Pe(Xt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:TD}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Pe(Xt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:TD})};r(n),this.hot._registerTimeout(()=>r(n),100)}focus(){this.isBuilt()&&Pe(Xt,this).listen()}reset(){Pe(qs,this).reset(),Pe(Wo,this).reset(),Pe(Bo,this).reset()}update(){this.isBuilt()&&(Pe(Xt,this).loadData(ase(Pe(Hr,this),this.options.value)),super.update())}destroy(){var e;(e=Pe(Xt,this))===null||e===void 0||e.destroy(),Pe(qs,this).destroy(),Pe(Bo,this).destroy(),Pe(Wo,this).destroy(),Er(qs,this,null),Er(Bo,this,null),Er(Wo,this,null),Er(Xt,this,null),Er(Hr,this,null),super.destroy()}}function ise(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Pe(Hr,this)]:n=Pe(Hr,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Pe(Xt,this).loadData(n)}function rse(t){this.runLocalHooks("keydown",t,this),fE(jc,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),wr(t),Pe(Xt,this).listen(),Pe(Xt,this).selectCell(0,0))}function sse(t){const e=[];t.preventDefault(),Pe(Xt,this).getSourceData().forEach((n,i)=>{n.checked=!0,e.push(LE(n,i)[0])}),Pe(Xt,this).setSourceDataAtCell(e)}function ose(t){const e=[];t.preventDefault(),Pe(Xt,this).getSourceData().forEach((n,i)=>{n.checked=!1,e.push(LE(n,i)[0])}),Pe(Xt,this).setSourceDataAtCell(e)}function ase(t,e){const n=Jf(e);return t.map(i=>(i.checked=n(i.value),i))}function lse(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function use(t,e){cse(t,e),e.add(t)}function cse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hse(t,e,n){return(e=dse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dse(t){var e=fse(t,"string");return typeof e=="symbol"?e:e+""}function fse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Uh=new WeakSet;class gse extends Qf{constructor(e,n){super(e,{id:n.id,stateless:!1}),use(this,Uh),hse(this,"name",""),this.name=n.name,this.elements.push(new gf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>rm(Uh,this,mse).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>rm(Uh,this,pse).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Dl){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?_n:Dl},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(i,r,s,o,a)=>{const[l]=ba(r,h=>h.name===Dl),u={},c=this.hot.getTranslatedPhrase(Np);if(l){const h=o(i,a),d=Ve(h,y=>y.value),f=new Map(h.map(y=>[y.value,this.hot.getCellMeta(y.meta.visualRow,y.meta.visualCol)])),g=z0(d);s&&(l.args[0]=s);const m=[],v=pD(g,l.args[0],c,y=>{y.checked&&m.push(y.value),rm(Uh,this,MD).call(this,y,f)}),S=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,S).locale,u.args=[m],u.command=Hl(Dl),u.itemsSnapshot=v}else u.args=[],u.command=Hl(_n);this.state.setValueAtIndex(i,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof gf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,s,o)=>{K(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return K(a,"htFiltersMenuLabel"),a.textContent=o,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||A(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Np),n=this._getColumnVisibleValues(),i=n.map(l=>l.value),r=new Map(n.map(l=>[l.value,l.meta])),s=z0(i),o=pD(s,s,e,l=>{rm(Uh,this,MD).call(this,l,r)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ve(this.hot.getDataAtCol(e.visualIndex),(n,i)=>({value:YM(n),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function mse(t){jc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),wr(t))}function MD(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function pse(t,e){switch(e.type){case"numeric":return AV(t,e);default:return t}}var UW;function wse(t,e){vse(t,e),e.add(t)}function vse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yse(t,e,n){return(e=Cse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cse(t){var e=bse(t,"string");return typeof e=="symbol"?e:e+""}function bse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sse(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xD=new WeakSet;class mf extends Qf{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),wse(this,xD),yse(this,"name",""),this.name=n.name,this.elements.push(new ya(this.hot,{type:"button",value:rM,className:"htUIButton htUIButtonOK",identifier:mf.BUTTON_OK})),this.elements.push(new ya(this.hot,{type:"button",value:sM,className:"htUIButton htUIButtonCancel",identifier:mf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){A(this.elements,e=>{e.addLocalHook("click",(n,i)=>Sse(xD,this,Rse).call(this,n,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(K(n.parentNode,"htFiltersMenuActionBar"),A(this.elements,i=>n.appendChild(i.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}UW=mf;function Rse(t,e){e.options.identifier===UW.BUTTON_OK?this.accept():this.cancel()}function GS(t,e,n){return(e=_se(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _se(t){var e=Ese(t,"string");return typeof e=="symbol"?e:e+""}function Ese(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const PD="ConditionCollection.filteringStates";class XM{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;GS(this,"hot",void 0),GS(this,"isMapRegistrable",void 0),GS(this,"filteringStates",new tv),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(PD,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var i;const r=this.filteringStates.getValueAtIndex(n),s=(i=r?.conditions)!==null&&i!==void 0?i:[],o=r?.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:va;return e.length?wre(i)(e,n):!0}addCondition(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:va,r=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(s):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==i)throw Error(ot`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Mt(hf[i]))throw new Error(ot`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:o,func:Ea(a,o)}]},r):u.push({name:a,args:o,func:Ea(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[i,{operation:r,conditions:s}]=n;return e.push({column:i,operation:r,conditions:s.map(o=>{let{name:a,args:l}=o;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(i=>this.addCondition(n.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const i=this.getConditions(e);return n?i.some(r=>r.name===n):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(PD),this.filteringStates=null,this.clearLocalHooks()}}ht(XM,In);function ID(t,e,n){return(e=Tse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tse(t){var e=Mse(t,"string");return typeof e=="symbol"?e:e+""}function Mse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YW{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];ID(this,"conditionCollection",void 0),ID(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return A(this.conditionCollection.getFilteredColumns(),(n,i)=>{let r=this.columnDataFactory(n);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(n,r)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return A(n,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,n){const i=[];return A(n,r=>{const s=r.meta.visualRow;e[s]!==void 0&&(i[s]=e[s])}),i}}function xse(t,e){Pse(t,e),e.add(t)}function Pse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function el(t,e,n){return(e=Ise(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ise(t){var e=Ose(t,"string");return typeof e=="symbol"?e:e+""}function Ose(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sm=new WeakSet;class GW{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];xse(this,sm),el(this,"hot",void 0),el(this,"conditionCollection",void 0),el(this,"columnDataFactory",void 0),el(this,"changes",[]),el(this,"grouping",!1),el(this,"latestEditedColumnPosition",-1),el(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>qS(sm,this,Ase).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>qS(sm,this,Hse).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>qS(sm,this,Dse).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,A(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=r.slice(0,s),a=r.slice(s);a.length&&a[0].column===e&&a.shift();const l=JF(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new XM(i.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const m=i.columnDataFactory(h);let v;f.isEmpty()?v=m:v=new YW(f,y=>i.columnDataFactory(y)).filter(),v=Ve(v,y=>y.meta.visualRow);const S=Jf(v);return f.destroy(),ba(m,y=>S(y.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),He(this,(e,n)=>{this[n]=null})}}function Ase(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Hse(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Dse(){A(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ht(GW,In);function Nse(t){return gW({initialPage:0,size:()=>t.length,onItemSelect:(n,i)=>{const r=t[n];if(r instanceof gf)return i;if(r.element&&!Bl(r.element))return!1;r.focus()}})}const Yh="filters";function kse(t,e){let n=-1,i;const r=Nse(e),s=h=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(Yh),r.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof Wr&&(h.addLocalHook("click",s(h)),h.addLocalHook("focus",s(h)),h.addLocalHook("afterClose",s(h)))}),l(t);function o(h){const d=i.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();r.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Yh),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Yh)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const m=i.getNavigator();m.getCurrentPage()>-1&&(n=m.getCurrentPage()),m.clear(),g.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const m=e[r.getCurrentPage()];m instanceof df&&(m.openOptions(),g.preventDefault()),m instanceof ff&&(m.activate(),g.preventDefault()),m instanceof Wr||g.preventDefault()}}],Yh)}function a(){i.focus(),i.getKeyboardShortcutsCtrl().listen(Yh)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||r.clear()}),h.addLocalHook("afterSubmenuOpen",o),h.addLocalHook("afterOpen",o),i=h}function u(){return i}function c(){return n}return{...r,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function Lse(t,e){qW(t,e),e.add(t)}function KS(t,e,n){qW(t,e),e.set(t,n)}function qW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gh(t,e,n){return(e=Fse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fse(t){var e=$se(t,"string");return typeof e=="symbol"?e:e+""}function $se(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mp(t,e,n){return t.set(mi(t,e),n),n}function nr(t,e){return t.get(mi(t,e))}function mi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Y0="filters",Vse=250,OD=Y0;var eo=new WeakMap,G0=new WeakMap,xl=new WeakMap,xi=new WeakSet;class Wse extends Ye{static get PLUGIN_KEY(){return Y0}static get PLUGIN_PRIORITY(){return Vse}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,Lse(this,xi),Gh(this,"dropdownMenuPlugin",null),Gh(this,"conditionCollection",null),Gh(this,"conditionUpdateObserver",null),Gh(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Gh(this,"filtersRowsMap",null),KS(this,eo,void 0),KS(this,G0,new WeakSet),KS(this,xl,[]),this.hot.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return mi(xi,n,qse).call(n,...r)})}isEnabled(){return!!this.hot.getSettings()[Y0]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new jf),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,i=n&&n.uiContainer||this.hot.rootPortalElement,r=a=>(a.addLocalHook("accept",()=>mi(xi,this,AD).call(this,"accept")),a.addLocalHook("cancel",()=>mi(xi,this,AD).call(this,"cancel")),a.addLocalHook("change",l=>mi(xi,this,Gse).call(this,a,l)),a),s=()=>`${this.hot.getTranslatedPhrase(JT)}:`,o=()=>`${this.hot.getTranslatedPhrase(eM)}:`;if(!this.components.get("filter_by_condition")){const a=new U0(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:i});a.addLocalHook("afterClose",()=>mi(xi,this,HD).call(this)),this.components.set("filter_by_condition",r(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Zre(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new U0(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});a.addLocalHook("afterClose",()=>mi(xi,this,HD).call(this)),this.components.set("filter_by_condition2",r(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new gse(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new mf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new XM(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new GW(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>mi(xi,this,Kse).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return mi(xi,e,Yse).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>mi(xi,this,Use).call(this)),this.addHook("afterDropdownMenuShow",()=>mi(xi,this,jse).call(this)),this.addHook("afterDropdownMenuHide",()=>mi(xi,this,zse).call(this)),this.addHook("afterChange",a=>mi(xi,this,Bse).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!nr(eo,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=nr(eo,this).getMenu(),c=u.getNavigator(),h=nr(eo,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];mp(eo,this,kse(this.dropdownMenuPlugin.menu,a));const l=u=>{nr(eo,this).listen(),u.preventDefault(),jc(u.keyCode,"TAB")&&(u.shiftKey?nr(eo,this).toPreviousItem():nr(eo,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,i)=>{n.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:OD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(OD)}addCondition(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:va;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:n},args:i},r)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const s=this.exportConditions(),o=this.hot.runHooks("beforeFilter",s,nr(xl,this));if(o!==!1&&i){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=Ve(n.filter(),u=>u.meta.visualRow);const l=Jf(r);de(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),A(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!r.length&&this.hot.deselectCell(),mp(xl,this,this.exportConditions())}else o!==!1&&!i?(mp(xl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(nr(xl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),o!==!1&&(this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),i=[];return A(this.hot.getSourceDataAtCol(n),(r,s)=>{var o;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(s,n),m=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),n))!==null&&o!==void 0?o:r;i.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:YM(m)})}),i}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),i=z0(n);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var n;const i=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,i,r){let s=e;return s===Zp&&n.command.key!==_n&&i.command.key!==_n&&r.command.key!==_n?s=qM:r.command.key!==_n&&(n.command.key===_n||i.command.key===_n)&&(s=va),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new YW(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return A(r,o=>{A(n.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?r.showRows(l):r.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Bse(t){t&&A(t,e=>{const[,n]=e,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function jse(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function zse(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Use(){const t=this.dropdownMenuPlugin.menu;nr(G0,this).has(t)||nr(eo,this).setMenu(t),nr(G0,this).add(t)}function Yse(t){t.items.push({name:ke}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function AD(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:r}=i,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(r);u===-1&&(u=void 0),this.conditionCollection.removeConditions(r),s.command.key!==_n&&(this.conditionCollection.addCondition(r,s,l,u),o.command.key!==_n&&this.conditionCollection.addCondition(r,o,l,u)),a.command.key!==_n&&this.conditionCollection.addCondition(r,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(r)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Gse(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===U0&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function HD(){this.setListeningDropdownMenu()}function qse(t,e,n){const i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)&&n===this.hot.view.getColumnHeadersCount()-1?K(e,"htFiltersActive"):me(e,"htFiltersActive")}function Kse(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:i},conditionArgsChange:r}=t;Array.isArray(r)&&mp(xl,this,nr(xl,this).map(a=>(a.column===i&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...r]])}),a)));const s=n.filter(a=>a.name===Dl),o=n.filter(a=>a.name!==Dl);if(s.length>=2||o.length>=3)Je(ot`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(o[0],i),this.components.get("filter_by_condition2").updateState(o[1],i),this.components.get("filter_operators").updateState(a,i),this.components.get("filter_by_value").updateState(t)}}const KW="internal-use-in-handsontable",q0={licenseKey:KW,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function XW(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[jn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function ZW(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Xse(t){var e;const n=t[jn],i=ZW(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=XW(t);return{...q0,...i,...r}}function Zse(t){var e;const n=t[jn],i=ZW(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=XW(t);return{...i,...r}}function Qse(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Rv(){const t="engine_relationship",e=vr(jn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function ZM(){const t="shared_engine_usage",e=vr(jn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Jse(t){const e=t.getSettings(),n=e[jn],i=n?.engine;if(n===!0||Mt(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var r;return eoe((r=i.hyperformula)!==null&&r!==void 0?r:i,e,t)}else if(typeof i=="object"&&Mt(i.hyperformula)){const s=Rv(),o=ZM().get(i);return s.has(i)||s.set(i,[]),s.get(i).push(t),o&&o.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:KW}),(i.getConfig().leapYear1900!==q0.leapYear1900||Bw(i.getConfig().nullDate,q0.nullDate)===!1)&&Je(ot`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function eoe(t,e,n){const i=e[jn],r=Xse(e),s=Rv(),o=ZM();toe(t,i.functions),noe(t,i.language);const a=t.buildEmpty(r);return s.set(a,[n]),o.set(a,[n.guid]),ioe(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function DD(t){var e;const n=Rv(),i=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(r=>[r.getPlugin("formulas").sheetId,r]))}function ND(t,e){if(t){const n=Rv(),i=n.get(t),r=ZM(),s=r.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&n.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(r.delete(t),t.destroy()))}}function toe(t,e){e&&e.forEach(n=>{const{name:i,plugin:r,translations:s}=n;try{t.registerFunction(i,r,s)}catch(o){Je(o.message)}})}function noe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(i){Je(i.message)}}}function ioe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:i,expression:r,scope:s,options:o}=n;try{t.addNamedExpression(i,r,s,o)}catch(a){Je(a.message)}}),t.resumeEvaluation())}function roe(t,e){return(Mt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const QW="DD/MM/YYYY";function soe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function ooe(t){return soe(t)?t.substr(1):t}function aoe(t){return typeof t=="string"&&t.startsWith("=")}function QM(t,e){return typeof t=="string"&&e==="date"}function JW(t,e){return Z(t,e,!0).isValid()}function eB(t,e){return Z(t,e,!0).format(QW)}function loe(t,e){return Z(t,QW,!0).format(e)}function tB(t,e){const i=new Date(Date.UTC(0,0,t+-1));return Z(i).format(e)}function uoe(t,e,n){const i=Array.from(Array(n).keys()).filter(s=>t.includes(s)===!1);if(e===0){var r;return(r=i[e])!==null&&r!==void 0?r:0}return i[e-1]+1}function coe(t,e){const n=[];return t.forEach(i=>{const r={from:i,to:e};n.forEach(s=>{const o=s.from>s.to,a=s.to<=r.from;s.from>r.from&&a&&o&&(r.from+=1)}),r.from>=e&&(e+=1),n.push(r)}),n}function hoe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(r=>{const s=r.from<r.to;r.from>e.from&&s&&(r.from-=1)})}),t}function JM(t,e,n){const i=coe(t,uoe(t,e,n));return hoe(i)}function tl(t,e,n){doe(t,e),e.set(t,n)}function doe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Et(t,e){return t.get(nB(t,e))}function jo(t,e,n){return t.set(nB(t,e),n),n}function nB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qh=new WeakMap,zo=new WeakMap,Pi=new WeakMap,om=new WeakMap,XS=new WeakMap,ZS=new WeakMap,am=new WeakMap;class kD{constructor(e,n,i){tl(this,qh,void 0),tl(this,zo,void 0),tl(this,Pi,void 0),tl(this,om,[]),tl(this,XS,[]),tl(this,ZS,void 0),tl(this,am,[]),jo(qh,this,e),jo(zo,this,n),jo(Pi,this,i)}setRemovedHfIndexes(e){return jo(am,this,e.map(n=>{const i=Et(zo,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(i)})),Et(am,this)}getRemovedHfIndexes(){return Et(am,this)}getHfIndexFromVisualIndex(e){const n=Et(zo,this).getIndexesSequence(),i=Et(zo,this).getNotTrimmedIndexes();return n.indexOf(i[e],e)}syncMoves(e){const i=`move${Un(Et(qh,this))}s`;Et(Pi,this).getEngine().batch(()=>{e.forEach(r=>{const s=r.from!==r.to,o=r.from+1!==r.to;s&&o&&Et(Pi,this).getEngine()[i](Et(Pi,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,n,i){i!==!1&&(jo(XS,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),jo(ZS,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Et(Pi,this).isPerformingUndoRedo()||e===!1||n===!1)return;const i=JM(Et(XS,this),Et(ZS,this),Et(zo,this).getNumberOfIndexes());Et(Pi,this).getSheetId()===null?Et(Pi,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${Un(Et(qh,this))}Order`;return n=>{if(Et(Pi,this).isPerformingUndoRedo())return;const i=Et(zo,this).getIndexesSequence();if(n==="update"&&i.length>0){const r=Et(om,this).map(l=>i.indexOf(l)),s=Et(Pi,this).getEngine().getSheetDimensions(Et(Pi,this).getSheetId());let o;Et(qh,this)==="row"?o=s.height:o=s.width;const a=r.length;for(let l=a;l<o;l+=1)r.push(l);Et(Pi,this).getEngine()[e](Et(Pi,this).getSheetId(),r)}jo(om,this,i)}}init(){jo(om,this,Et(zo,this).getIndexesSequence())}}function nl(t,e,n){foe(t,e),e.set(t,n)}function foe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ks(t,e){return t.get(iB(t,e))}function il(t,e,n){return t.set(iB(t,e),n),n}function iB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lm=new WeakMap,um=new WeakMap,QS=new WeakMap,JS=new WeakMap,eR=new WeakMap,tR=new WeakMap,nR=new WeakMap;class goe{constructor(e,n,i){nl(this,lm,void 0),nl(this,um,void 0),nl(this,QS,void 0),nl(this,JS,!1),nl(this,eR,!1),nl(this,tR,null),nl(this,nR,null),il(lm,this,new kD("row",e,this)),il(um,this,new kD("column",n,this)),il(QS,this,i)}getForAxis(e){return e==="row"?Ks(lm,this):Ks(um,this)}setPerformUndo(e){il(JS,this,e)}setPerformRedo(e){il(eR,this,e)}isPerformingUndoRedo(){return Ks(JS,this)||Ks(eR,this)}getSheetId(){return Ks(nR,this)}getEngine(){return Ks(tR,this)}getPostponeAction(){return Ks(QS,this)}setupSyncEndpoint(e,n){il(tR,this,e),il(nR,this,n),Ks(lm,this).init(),Ks(um,this).init()}}function moe(t,e){rB(t,e),e.add(t)}function rl(t,e,n){return(e=poe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function poe(t){var e=woe(t,"string");return typeof e=="symbol"?e:e+""}function woe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iR(t,e,n){rB(t,e),e.set(t,n)}function rB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ta(t,e,n){return t.set(qe(t,e),n),n}function $l(t,e){return t.get(qe(t,e))}function qe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jn="formulas",voe=["maxRows","maxColumns","language"],yoe=260;re.getSingleton().register("afterNamedExpressionAdded");re.getSingleton().register("afterNamedExpressionRemoved");re.getSingleton().register("afterSheetAdded");re.getSingleton().register("afterSheetRemoved");re.getSingleton().register("afterSheetRenamed");re.getSingleton().register("afterFormulasValuesUpdate");const Kc=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var _o=new WeakMap,_v=new WeakMap,Kh=new WeakMap,Qe=new WeakSet;class Coe extends Ye{constructor(){var e;super(...arguments),e=this,moe(this,Qe),iR(this,_o,!1),iR(this,_v,!1),iR(this,Kh,[["valuesUpdated",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return qe(Qe,e,koe).call(e,...i)}],["namedExpressionAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return qe(Qe,e,Loe).call(e,...i)}],["namedExpressionRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return qe(Qe,e,Foe).call(e,...i)}],["sheetAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return qe(Qe,e,$oe).call(e,...i)}],["sheetRenamed",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return qe(Qe,e,Voe).call(e,...i)}],["sheetRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return qe(Qe,e,Woe).call(e,...i)}]]),rl(this,"staticRegister",vr("formulas")),rl(this,"engine",null),rl(this,"sheetId",null),rl(this,"sheetName",null),rl(this,"indexSyncer",null),rl(this,"rowAxisSyncer",null),rl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return jn}static get PLUGIN_PRIORITY(){return yoe}static get SETTING_KEYS(){return[jn,...voe]}isEnabled(){return!!this.hot.getSettings()[jn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Jse(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Je("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&qe(Qe,this,Dd).call(this,i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,LD).call(n,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,FD).call(n,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,LD).call(n,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,FD).call(n,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,_oe).call(n,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Eoe).call(n,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,boe).call(n,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Toe).call(n,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,$D).call(n,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,$D).call(n,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Moe).call(n,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,xoe).call(n,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Ooe).call(n,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Aoe).call(n,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Poe).call(n,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Ioe).call(n,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Hoe).call(n,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Doe).call(n,...r)}),this.indexSyncer=new goe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,s,o)=>{this.rowAxisSyncer.storeMovesInformation(i,r,o)}),this.hot.addHook("beforeColumnMove",(i,r,s,o)=>{this.columnAxisSyncer.storeMovesInformation(i,r,o)}),this.hot.addHook("afterRowMove",(i,r,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(i,r,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Roe).call(n,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Noe).call(n,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qe(Qe,n,Soe).call(n,...r)}),$l(Kh,this).forEach(i=>{let[r,s]=i;return this.engine.on(r,s)}),super.enablePlugin()}}disablePlugin(){$l(Kh,this).forEach(e=>{let[n,i]=e;return this.engine.off(n,i)}),ND(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Zse(this.hot.getSettings());Qse(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const i=this.hot.getSettings()[jn];if(le(i)&&le(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[jn].sheetName;if(r&&this.engine.doesSheetExist(r))this.switchSheet(this.sheetName);else{const s=this.addSheet(r??void 0,this.hot.getSourceDataArray());qe(Qe,this,Dd).call(this,s)}}super.updatePlugin(e)}destroy(){$l(Kh,this).forEach(e=>{var n;let[i,r]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(i,r)}),Ta(Kh,this,null),ND(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!N$(n))return Je("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Je("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(i),n),i}catch(i){return Je(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){mE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}qe(Qe,this,Dd).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Un(jn)}.switchSheet`)}getCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(n);return r!==null&&s!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var s;const o=r==null||(s=r.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(i.has(o)||i.add(o))}),DD(this.engine).forEach((r,s)=>{if((n||s!==this.sheetId)&&i.has(s)){var o;r.render(),(o=r.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=s=>{var o;const{row:a,col:l,sheet:u}=(o=s?.address)!==null&&o!==void 0?o:{};return le(u)?`${u}:${a}x${l}`:""},r=new Set(n.map(s=>i(s)));e.forEach(s=>{var o,a;const{row:l,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=i(s);if(c!==void 0&&!r.has(h)){const d=DD(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){Je(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const s=this.hot.getCellMeta(e,n);return QM(i,s.type)&&(JW(i,s.dateFormat)?i=eB(i,s.dateFormat):aoe(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}}function Dd(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function boe(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},s=this.hot.getCellMeta(e,i);let o=this.engine.getCellValue(r);return s.type==="date"&&Bn(o)&&(o=tB(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function Soe(t,e,n){const{row:i,col:r}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:m}=h.start,{row:v,col:S}=h.end,y=v-g+1,M=S-m+1;for(let I=0;I<f.length;I+=1)for(let P=0;P<f[I].length;P+=1){const E=f[I][P],T=g+I%y,$=m+P%M,U=this.hot.getCellMeta(T,$);QM(E,U.type)&&(E.startsWith("'")?f[I][P]=E.slice(1):this.isFormulaCellType(T,$,this.sheetId)===!1&&(f[I][P]=loe(E,U.dateFormat)))}return f}function LD(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Un(jn))||Ta(_v,this,Mt(this.hot.getSettings().data))}function Roe(){if($l(_v,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,i)=>{n.forEach((r,s)=>{const o=this.hot.getCellMeta(i,s,{skipMetaExtension:!0}),a=o.dateFormat;QM(r,o.type)&&(JW(r,a)?t[i][s]=eB(r,a):r.startsWith("=")||(t[i][s]=`'${r}`))})}),Ta(_o,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Ta(_o,this,!1)}function FD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Un(jn)))return;const i=roe(this.engine,this.hot.getSettings()[jn].sheetName);if(qe(Qe,this,Dd).call(this,i),n!=="updateSettings")if($l(_v,this))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Ta(_o,this,!0);const s=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Ta(_o,this,!1)}}}function _oe(t,e,n,i){if(i!=="get"||$l(_o,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const r=this.getCellType(t,e);if(r==="VALUE"||r==="EMPTY"){n.value=ooe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let o=this.engine.getCellValue(s);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&Bn(o)&&(o=tB(o,a.dateFormat)),n.value=typeof o=="object"&&o!==null?o.value:o}function Eoe(t,e,n,i){if(i!=="get"||$l(_o,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(r===null||s===null)return;const o=this.getCellType(r,s);if(o==="VALUE"||o==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function $D(t,e){if(Kc(e))return;const n=[],i=[],r=this.engine.batch(()=>{t.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(o),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(o,u,l):n.push([o,u,l]),i.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{n.forEach(o=>{let[a,l,u]=o;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function Toe(t,e){if(Kc(e))return;const n=[],i=[];t.forEach(r=>{let[s,o,,a]=r;const l=this.hot.propToCol(o);if(!Bn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Je(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}i.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function Moe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function xoe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Poe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function Ioe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function Ooe(t,e,n){if(Kc(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function Aoe(t,e,n){if(Kc(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function Hoe(t,e,n,i){if(Kc(i))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{r.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function Doe(t,e,n,i){if(Kc(i))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{r.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function Noe(t,e,n){var i;Ta(_o,this,!0);const r=this.hot.getSourceDataArray(n,0,n+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());Ta(_o,this,!1),r.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+o,sheet:this.sheetId},[[a]])})})}function koe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Loe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Foe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function $oe(t){this.hot.runHooks("afterSheetAdded",t)}function Voe(t,e){qe(Qe,this,Dd).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function Woe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Boe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(IT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,n.col),0),r=Math.max(e.col,n.col),s=[];for(let l=i;l<=r;l+=1)s.push(l);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function joe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(OT,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],s=e[e.length-1];r=(n=this.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,s=(i=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-r+1===this.countCols()||this.selectColumns(r,s)},disabled:!1,hidden(){const n=Ve(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().col,s=i.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(r),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(r!==s){const h=s-r+1,d=l-a+1;if(h>d){const f=u.slice(r,s+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return A(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function zoe(t,e){sB(t,e),e.add(t)}function Uoe(t,e,n){sB(t,e),e.set(t,n)}function sB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sl(t,e){return t.get(Jo(t,e))}function VD(t,e,n){return t.set(Jo(t,e),n),n}function Jo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeHideColumns");re.getSingleton().register("afterHideColumns");re.getSingleton().register("beforeUnhideColumns");re.getSingleton().register("afterUnhideColumns");const WD="hiddenColumns",Yoe=310;var ns=new WeakMap,ol=new WeakSet;class Goe extends Ye{constructor(){super(...arguments),zoe(this,ol),Uoe(this,ns,null)}static get PLUGIN_KEY(){return WD}static get PLUGIN_PRIORITY(){return Yoe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[WD]}enablePlugin(){var e=this;this.enabled||(VD(ns,this,new ev),sl(ns,this).addLocalHook("init",()=>Jo(ol,this,Joe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,sl(ns,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Jo(ol,e,Qoe).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>Jo(ol,this,Koe).call(this,n,i,r)),this.addHook("modifyColWidth",(n,i)=>Jo(ol,this,qoe).call(this,n,i),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Jo(ol,e,Zoe).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Jo(ol,this,Xoe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;const s=sl(ns,this).getValues().slice(),o=e.length>0;if(i&&o){const l=e.map(u=>this.hot.toPhysicalColumn(u));A(l,u=>{s[u]=!1}),r=fn(s,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,r,i&&o)!==!1&&(i&&o&&sl(ns,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,i&&o,i&&r.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{A(e,o=>{sl(ns,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",n,r,i,i&&r.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideColumns(n)}getHiddenColumns(){return Ve(sl(ns,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return sl(ns,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){A(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){VD(ns,this,null),super.destroy()}}function qoe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Koe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenColumn");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Xoe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,s,o)=>{e.push({startRow:i,endRow:r,startCol:s,endCol:o})};return A(t,i=>{let r=!0,s=0;de(i.startCol,i.endCol,o=>{this.isHidden(o)?(r||n(i.startRow,i.endRow,s,o-1),r=!0):(r&&(s=o),o===i.endCol&&n(i.startRow,i.endRow,s,o),r=!1)})}),e}function Zoe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),K(e,n)}function Qoe(t){t.items.push({name:ke},Boe(this),joe(this))}function Joe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function eae(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(AT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,n.row),0),r=Math.max(e.row,n.row),s=[];for(let l=i;l<=r;l+=1)s.push(l);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function tae(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(HT,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],s=e[e.length-1];r=(n=this.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,s=(i=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-r+1===this.countRows()||this.selectRows(r,s)},disabled:!1,hidden(){const n=Ve(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().row,s=i.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(r),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(r!==s){const h=s-r+1,d=l-a+1;if(h>d){const f=u.slice(r,s+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return A(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function nae(t,e){oB(t,e),e.add(t)}function iae(t,e,n){oB(t,e),e.set(t,n)}function oB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function al(t,e){return t.get(ea(t,e))}function BD(t,e,n){return t.set(ea(t,e),n),n}function ea(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeHideRows");re.getSingleton().register("afterHideRows");re.getSingleton().register("beforeUnhideRows");re.getSingleton().register("afterUnhideRows");const jD="hiddenRows",rae=320;var is=new WeakMap,ll=new WeakSet;class sae extends Ye{constructor(){super(...arguments),nae(this,ll),iae(this,is,null)}static get PLUGIN_KEY(){return jD}static get PLUGIN_PRIORITY(){return rae}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[jD]}enablePlugin(){var e=this;this.enabled||(BD(is,this,new ev),al(is,this).addLocalHook("init",()=>ea(ll,this,hae).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,al(is,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ea(ll,e,cae).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>ea(ll,this,aae).call(this,n,i,r)),this.addHook("modifyRowHeight",(n,i)=>ea(ll,this,oae).call(this,n,i)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ea(ll,e,uae).call(e,...i)}),this.addHook("modifyCopyableRange",n=>ea(ll,this,lae).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;const s=al(is,this).getValues().slice(),o=e.length>0;if(i&&o){const l=e.map(u=>this.hot.toPhysicalRow(u));A(l,u=>{s[u]=!1}),r=fn(s,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,r,i&&o)!==!1&&(i&&o&&al(is,this).setValues(s),this.hot.runHooks("afterUnhideRows",n,r,i&&o,i&&r.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{A(e,o=>{al(is,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",n,r,i,i&&r.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideRows(n)}getHiddenRows(){return Ve(al(is,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return al(is,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){A(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){BD(is,this,null),super.destroy()}}function oae(t,e){return this.isHidden(e)?0:t}function aae(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenRow");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function lae(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,s,o)=>{e.push({startRow:i,endRow:r,startCol:s,endCol:o})};return A(t,i=>{let r=!0,s=0;de(i.startRow,i.endRow,o=>{this.isHidden(o)?(r||n(s,o-1,i.startCol,i.endCol),r=!0):(r&&(s=o),o===i.endRow&&n(s,o,i.startCol,i.endCol),r=!1)})}),e}function uae(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),K(e,n)}function cae(t){t.items.push({name:ke},eae(this),tae(this))}function hae(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function dae(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(oT)},callback(e,n){const[{start:{col:i}}]=n;t.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function fae(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(aT)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function gae(t,e){aB(t,e),e.add(t)}function mae(t,e,n){aB(t,e),e.set(t,n)}function aB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function K0(t,e){return t.get(Jp(t,e))}function rR(t,e,n){return t.set(Jp(t,e),n),n}function Jp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeColumnFreeze");re.getSingleton().register("afterColumnFreeze");re.getSingleton().register("beforeColumnUnfreeze");re.getSingleton().register("afterColumnUnfreeze");const zD="manualColumnFreeze",pae=110;var Rl=new WeakMap,sR=new WeakSet;class wae extends Ye{constructor(){super(...arguments),gae(this,sR),mae(this,Rl,!1)}static get PLUGIN_KEY(){return zD}static get PLUGIN_PRIORITY(){return pae}isEnabled(){return!!this.hot.getSettings()[zD]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Jp(sR,this,vae).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Jp(sR,this,yae).call(this,e,n)),super.enablePlugin())}disablePlugin(){rR(Rl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;K0(Rl,this)||rR(Rl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;K0(Rl,this)||rR(Rl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function vae(t){t.items.push({name:"---------"},dae(this),fae(this))}function yae(t,e){if(K0(Rl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(i=>i<n))return!1}}function cm(t,e,n){return(e=Cae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cae(t){var e=bae(t,"string");return typeof e=="symbol"?e:e+""}function bae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oR=0,UD=1,YD=2,Bu="px";let lB=class{constructor(e){cm(this,"hot",void 0),cm(this,"_element",null),cm(this,"state",oR),cm(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=YD}build(){this.state===oR&&(this._element=this.hot.rootDocument.createElement("div"),this.state=UD)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=oR}isAppended(){return this.state===YD}isBuilt(){return this.state>=UD}setPosition(e,n){Bn(e)&&(this._element.style.top=e+Bu),Bn(n)&&(this._element.style[this.inlineProperty]=n+Bu)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Bn(e)&&(this._element.style.width=e+Bu),Bn(n)&&(this._element.style.height=n+Bu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Bn(e)&&(this._element.style.marginTop=e+Bu),Bn(n)&&(this._element.style[`margin${Un(this.inlineProperty)}`]=n+Bu)}getOffset(){const e=this._element.style,n=`margin${Un(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Sae="ht__manualColumnMove--backlight";let Rae=class extends lB{build(){super.build(),K(this._element,Sae)}};const _ae="ht__manualColumnMove--guideline";let Eae=class extends lB{build(){super.build(),K(this._element,_ae)}};function Tae(t,e){uB(t,e),e.add(t)}function Tr(t,e,n){uB(t,e),e.set(t,n)}function uB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Si(t,e,n){return t.set(ta(t,e),n),n}function ce(t,e){return t.get(ta(t,e))}function ta(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeColumnMove");re.getSingleton().register("afterColumnMove");const aR="manualColumnMove",Mae=120,GD="ht__manualColumnMove",ew="show-ui",X0="on-moving--columns",Z0="after-selection--columns";var ti=new WeakMap,ra=new WeakMap,mo=new WeakMap,pp=new WeakMap,da=new WeakMap,ei=new WeakMap,hm=new WeakMap,Zi=new WeakMap,rc=new WeakMap,tw=new WeakMap,Nd=new WeakMap,ul=new WeakSet;class xae extends Ye{constructor(){super(...arguments),Tae(this,ul),Tr(this,ti,new Rae(this.hot)),Tr(this,ra,new Eae(this.hot)),Tr(this,mo,[]),Tr(this,pp,0),Tr(this,da,!1),Tr(this,ei,{}),Tr(this,hm,void 0),Tr(this,Zi,void 0),Tr(this,rc,void 0),Tr(this,tw,void 0),Tr(this,Nd,void 0)}static get PLUGIN_KEY(){return aR}static get PLUGIN_PRIORITY(){return Mae}isEnabled(){return!!this.hot.getSettings()[aR]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ta(ul,e,Pae).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ta(ul,e,Oae).call(e,...i)}),this.addHook("afterScrollVertically",()=>ta(ul,this,Hae).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ta(ul,e,Dae).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),K(this.hot.rootElement,GD),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){me(this.hot.rootElement,GD),this.unregisterEvents(),ce(ti,this).destroy(),ce(ra,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const i=ce(hm,this),r=this.isMovePossible(e,n),s=this.hot.runHooks("beforeColumnMove",e,n,i,r);if(Si(hm,this,void 0),s===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,n);const o=r&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,i,r,o),o}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const i=this.countFinalIndex(e,n);return Si(hm,this,n),this.moveColumns(e,i)}isMovePossible(e,n){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,s=n<0,o=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||s||o||a)}isColumnOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=fn(e,(r,s)=>(s<n&&(r+=1),r),0);return n-i}getColumnsWidth(e,n){const i=this.hot.columnIndexMapper;let r=0;for(let s=e;s<=n;s+=1){const o=i.getRenderableFromVisualIndex(s);s<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(r+=this.hot.view._wt.wtTable.getColumnWidth(o)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[aR];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const i=[];return de(e,n,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ce(Zi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ce(Zi,this)-1);const o=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ce(ti,this).getOffset().start,u=ce(ti,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,m=Gt(this.hot.rootElement),v=g.innerWidth-ce(rc,this)-m;h=g.innerWidth-ce(ei,this).eventPageX-v-(i.scrollX===void 0?r:0)}else h=ce(ei,this).eventPageX-(ce(rc,this)-(i.scrollX===void 0?r:0));if(ce(tw,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ce(Zi,this))&&(s+=r),s+=c,ce(Zi,this)<0)ce(Nd,this)>0?ce(ei,this).col=0:ce(ei,this).col=e>0?e-1:e;else if(ce(ei,this).TD.offsetWidth/2+s<=h){const g=ce(Zi,this)>=ce(pp,this)?ce(pp,this)-1:ce(Zi,this);ce(ei,this).col=g+1,s+=ce(ei,this).TD.offsetWidth}else ce(ei,this).col=ce(Zi,this);let d=h,f=s;h+u+l>=o?d=o-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),s>=o-1?f=o-1:f===0?f=1:i.scrollX!==void 0&&ce(Zi,this)<ce(Nd,this)&&(f-=ce(rc,this)<=i.scrollX?ce(rc,this):0),ce(ti,this).setPosition(null,d),ce(ra,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ta(ul,this,Iae).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ta(ul,this,Aae).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ce(ti,this).build(),ce(ra,this).build()}destroy(){ce(ti,this).destroy(),ce(ra,this).destroy(),super.destroy()}}function Pae(t,e,n,i){const r=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=ye(t.target,"sortAction");if(!o||!s||ce(da,this)||t.button!==0||a){Si(da,this,!1),ce(mo,this).length=0,me(this.hot.rootElement,[X0,ew]);return}const l=ce(ra,this).isBuilt()&&!ce(ra,this).isAppended(),u=ce(ti,this).isBuilt()&&!ce(ti,this).isAppended();l&&u&&(ce(ra,this).appendTo(r.hider),ce(ti,this).appendTo(r.hider));const{from:c,to:h}=o,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){i.column=!0,Si(da,this,!0);const g=n.firstChild?i$(t,n.firstChild).x:t.offsetX;ce(ei,this).eventPageX=t.pageX,Si(Zi,this,e.col),ce(ei,this).TD=n,ce(ei,this).col=e.col,Si(mo,this,this.prepareColumnsToMoving(d,f)),Si(tw,this,!!this.hot.getSettings().rowHeaders),Si(pp,this,this.hot.countCols()),Si(Nd,this,this.hot.getSettings().fixedColumnsStart),Si(rc,this,xn(this.hot.rootElement).left);const m=ce(tw,this)?-1:0,v=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,S=e.col<ce(Nd,this),y=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),M=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),I=this.getColumnsWidth(d,e.col-1)+M,P=this.getColumnsWidth(m,d-1)+(S?y:0)+I;ce(ti,this).setPosition(v,P),ce(ti,this).setSize(this.getColumnsWidth(d,f),r.hider.offsetHeight-v),ce(ti,this).setOffset(null,-I),K(this.hot.rootElement,X0)}else me(this.hot.rootElement,Z0),Si(da,this,!1),ce(mo,this).length=0}function Iae(t){ce(da,this)&&(ce(ei,this).eventPageX=t.pageX,this.refreshPositions())}function Oae(t,e,n,i){!this.hot.getSelectedRangeLast()||!ce(da,this)||(ce(mo,this).indexOf(e.col)>-1?me(this.hot.rootElement,ew):K(this.hot.rootElement,ew),i.row=!0,i.column=!0,i.cell=!0,Si(Zi,this,e.col),ce(ei,this).TD=n)}function Aae(){const t=ce(ei,this).col,e=ce(mo,this).length;if(Si(Zi,this,void 0),Si(da,this,!1),me(this.hot.rootElement,[X0,ew,Z0]),this.hot.selection.isSelectedByColumnHeader()&&K(this.hot.rootElement,Z0),e<1||t===void 0)return;const n=ce(mo,this)[0],i=this.hot.toPhysicalColumn(n),r=this.dragColumns(ce(mo,this),t);if(ce(mo,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(i),o=s+e-1;this.hot.selectColumns(s,o)}}function Hae(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,i=e+n;ce(ti,this).setPosition(i),ce(ti,this).setSize(null,t.hider.offsetHeight-i)}function Dae(){this.moveBySettingsOrLoad()}function Nae(t,e){cB(t,e),e.add(t)}function Dn(t,e,n){cB(t,e),e.set(t,n)}function cB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yt(t,e,n){return t.set(Dr(t,e),n),n}function se(t,e){return t.get(Dr(t,e))}function Dr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nw="manualColumnResize",kae=130,qD="manualColumnWidths";var oo=new WeakMap,dm=new WeakMap,Fi=new WeakMap,iw=new WeakMap,Ss=new WeakMap,Lae=new WeakMap,yc=new WeakMap,fm=new WeakMap,gi=new WeakMap,to=new WeakMap,Gl=new WeakMap,rw=new WeakMap,kd=new WeakMap,Ld=new WeakMap,Vi=new WeakMap,Fd=new WeakMap,rs=new WeakSet;class Fae extends Ye{static get PLUGIN_KEY(){return nw}static get PLUGIN_PRIORITY(){return kae}constructor(e){super(e),Nae(this,rs),Dn(this,oo,null),Dn(this,dm,null),Dn(this,Fi,[]),Dn(this,iw,null),Dn(this,Ss,null),Dn(this,Lae,null),Dn(this,yc,null),Dn(this,fm,null),Dn(this,gi,this.hot.rootDocument.createElement("DIV")),Dn(this,to,this.hot.rootDocument.createElement("DIV")),Dn(this,Gl,null),Dn(this,rw,!1),Dn(this,kd,0),Dn(this,Ld,null),Dn(this,Vi,void 0),Dn(this,Fd,void 0),K(se(gi,this),"manualColumnResizer"),K(se(to,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[nw]}enablePlugin(){var e=this;this.enabled||(Yt(Vi,this,new Aa),se(Vi,this).addLocalHook("init",()=>Dr(rs,this,$ae).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,se(Vi,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Dr(rs,e,Uae).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Dr(rs,e,Yae).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Dr(rs,e,Gae).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Yt(Fd,this,se(Vi,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",qD,se(Vi,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",qD,e),e.value}setManualSize(e,n){const i=Math.max(n,20),r=this.hot.toPhysicalColumn(e);return se(Vi,this).setValueAtIndex(r,i),i}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);se(Vi,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Yt(oo,this,e);const{_wt:n}=this.hot.view,i=n.wtTable.getCoords(se(oo,this)),r=i.col;if(r<0)return;const s=en(se(oo,this)),o=se(oo,this).getBoundingClientRect(),a=r<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(se(oo,this),i.row,i.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(se(oo,this),i.row,i.col)),Yt(dm,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),Yt(Fi,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();A(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;de(d,f,g=>{se(Fi,this).includes(g)||se(Fi,this).push(g)})})}se(Fi,this).includes(se(dm,this))||Yt(Fi,this,[se(dm,this)]),Yt(fm,this,l.start-6),Yt(yc,this,parseInt(o.width,10)),se(gi,this).style.top=`${l.top}px`,se(gi,this).style[this.inlineDir]=`${se(fm,this)+se(yc,this)}px`,se(gi,this).style.height=`${s}px`,this.hot.rootElement.appendChild(se(gi,this))}refreshHandlePosition(){se(gi,this).style[this.inlineDir]=`${se(fm,this)+se(iw,this)}px`}setupGuidePosition(){const e=parseInt(en(se(gi,this)),10),n=parseInt(se(gi,this).style.top,10)+e,i=this.hot.view.getTableHeight();K(se(gi,this),"active"),K(se(to,this),"active"),se(to,this).style.top=`${n}px`,this.refreshGuidePosition(),se(to,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(se(to,this))}refreshGuidePosition(){se(to,this).style[this.inlineDir]=se(gi,this).style[this.inlineDir]}hideHandleAndGuide(){me(se(gi,this),"active"),me(se(to,this),"active")}checkIfColumnHeader(e){const n=Sa(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const s=this.hot.runHooks("beforeColumnResize",se(Ss,this),i,!0);s!==void 0&&Yt(Ss,this,s),this.setManualSize(i,se(Ss,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Ss,this),i,!0),r&&e()};se(kd,this)>=2&&(se(Fi,this).length>1?(A(se(Fi,this),r=>{n(r)}),e()):A(se(Fi,this),r=>{n(r,!0)})),Yt(kd,this,0),Yt(Ld,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",i=>Dr(rs,this,Vae).call(this,i)),this.eventManager.addEventListener(n,"mousedown",i=>Dr(rs,this,Wae).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>Dr(rs,this,Bae).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Dr(rs,this,jae).call(this)),this.eventManager.addEventListener(se(gi,this),"contextmenu",()=>Dr(rs,this,zae).call(this))}destroy(){super.destroy()}}function $ae(){const t=this.hot.getSettings()[nw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,i)=>{se(Vi,this).setValueAtIndex(i,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,i)=>{se(Vi,this).setValueAtIndex(i,n)})},!0),Yt(Fd,this,t)):t===!0&&Array.isArray(se(Fd,this))&&this.hot.batchExecution(()=>{se(Fd,this).forEach((n,i)=>{se(Vi,this).setValueAtIndex(i,n)})},!0)}function Vae(t){if(!cE(t.target)&&se(rw,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(se(Gl,this)||this.setupHandlePosition(e))}}function Wae(t){t.target.parentNode===this.hot.rootElement&&ye(t.target,"manualColumnResizer")&&(this.setupHandlePosition(se(oo,this)),this.setupGuidePosition(),Yt(Gl,this,!0),se(Ld,this)===null&&(Yt(Ld,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(se(Ld,this))),Yt(kd,this,se(kd,this)+1),this.startX=t.pageX,Yt(Ss,this,se(yc,this)))}function Bae(t){if(se(Gl,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Yt(iw,this,se(yc,this)+e),A(se(Fi,this),n=>{Yt(Ss,this,this.setManualSize(n,se(iw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function jae(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeColumnResize",se(Ss,this),n,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Ss,this),n,!1)};se(Gl,this)&&(this.hideHandleAndGuide(),Yt(Gl,this,!1),se(Ss,this)!==se(yc,this)&&(se(Fi,this).length>1?(A(se(Fi,this),i=>{e(i)}),t()):A(se(Fi,this),i=>{e(i,!0)})),this.setupHandlePosition(se(oo,this)))}function zae(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(se(gi,this)),this.hot.rootElement.removeChild(se(to,this)),Yt(Gl,this,!1),Yt(rw,this,!0),this.hot._registerImmediate(()=>{Yt(rw,this,!1)})}function Uae(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),r=se(Vi,this).getValueAtIndex(i);this.hot.getSettings()[nw]&&r&&(n=r)}return n}function Yae(t,e){const n=se(Vi,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Gae(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function lR(t,e,n){return(e=qae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qae(t){var e=Kae(t,"string");return typeof e=="symbol"?e:e+""}function Kae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uR=0,KD=1,XD=2,ju="px";let hB=class{constructor(e){lR(this,"hot",void 0),lR(this,"_element",null),lR(this,"state",uR),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=XD}build(){this.state===uR&&(this._element=this.hot.rootDocument.createElement("div"),this.state=KD)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=uR}isAppended(){return this.state===XD}isBuilt(){return this.state>=KD}setPosition(e,n){e!==void 0&&(this._element.style.top=e+ju),n!==void 0&&(this._element.style.left=n+ju)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+ju),n&&(this._element.style.height=n+ju)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+ju),n&&(this._element.style.marginLeft=n+ju)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Xae="ht__manualRowMove--backlight";class Zae extends hB{build(){super.build(),K(this._element,Xae)}}const Qae="ht__manualRowMove--guideline";class Jae extends hB{build(){super.build(),K(this._element,Qae)}}function ele(t,e){dB(t,e),e.add(t)}function zu(t,e,n){dB(t,e),e.set(t,n)}function dB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nl(t,e,n){return t.set(na(t,e),n),n}function Ee(t,e){return t.get(na(t,e))}function na(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeRowMove");re.getSingleton().register("afterRowMove");const cR="manualRowMove",tle=140,ZD="ht__manualRowMove",sw="show-ui",Q0="on-moving--rows",J0="after-selection--rows";var ni=new WeakMap,sa=new WeakMap,po=new WeakMap,fa=new WeakMap,Ri=new WeakMap,gm=new WeakMap,cl=new WeakSet;class nle extends Ye{constructor(){super(...arguments),ele(this,cl),zu(this,ni,new Zae(this.hot)),zu(this,sa,new Jae(this.hot)),zu(this,po,[]),zu(this,fa,void 0),zu(this,Ri,{}),zu(this,gm,void 0)}static get PLUGIN_KEY(){return cR}static get PLUGIN_PRIORITY(){return tle}isEnabled(){return!!this.hot.getSettings()[cR]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return na(cl,e,ile).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return na(cl,e,sle).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>na(cl,this,ale).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return na(cl,e,lle).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),K(this.hot.rootElement,ZD),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){me(this.hot.rootElement,ZD),this.unregisterEvents(),Ee(ni,this).destroy(),Ee(sa,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const i=Ee(gm,this),r=this.isMovePossible(e,n),s=this.hot.runHooks("beforeRowMove",e,n,i,r);if(Nl(gm,this,void 0),s===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,n);const o=r&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,i,r,o),o}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const i=this.countFinalIndex(e,n);return Nl(gm,this,n),this.moveRows(e,i)}isMovePossible(e,n){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,s=n<0,o=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||s||o||a)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=fn(e,(r,s)=>(s<n&&(r+=1),r),0);return n-i}getRowsHeight(e,n){const i=this.hot.rowIndexMapper;let r=0;for(let s=e;s<=n;s++){const o=i.getRenderableFromVisualIndex(s);o!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(o)||this.hot.stylesHandler.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[cR];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:i,to:r}=e,s=Math.min(i.row,r.row),o=Math.max(i.row,r.row);return de(s,o,a=>{n.push(a)}),n}refreshPositions(){const e=Ee(Ri,this).coords,n=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=Ee(Ri,this).TD,a=this.hot.rootElement,l=xn(a),u=_c(a),c=s.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Ee(Ri,this).eventPageY-d+c,g=s.hider.offsetHeight,m=s.TBODY.offsetTop,v=Ee(ni,this).getOffset().top,S=Ee(ni,this).getSize().height,y=o.offsetHeight/2,M=o.offsetHeight;let I=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const P=f>=I+y;this.isFixedRowTop(e.row)&&(I+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Ee(Ri,this).row=n>0?n-1:n:P?(Ee(Ri,this).row=e.row+1,I+=e.row===0?M-1:M):Ee(Ri,this).row=e.row;let E=f,T=I;f+S+v>=g?E=g-S-v:f+v<m&&(E=m+Math.abs(v)),I>=g-1&&(T=g-1),Ee(ni,this).setPosition(E),Ee(sa,this).setPosition(T)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>na(cl,this,rle).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>na(cl,this,ole).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ee(ni,this).build(),Ee(sa,this).build()}destroy(){Ee(ni,this).destroy(),Ee(sa,this).destroy(),super.destroy()}}function ile(t,e,n,i){const{wtTable:r,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||Ee(fa,this)||t.button!==0){Nl(fa,this,!1),Ee(po,this).length=0,me(this.hot.rootElement,[Q0,sw]);return}const l=Ee(sa,this).isBuilt()&&!Ee(sa,this).isAppended(),u=Ee(ni,this).isBuilt()&&!Ee(ni,this).isAppended();l&&u&&(Ee(sa,this).appendTo(r.hider),Ee(ni,this).appendTo(r.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){i.row=!0,Nl(fa,this,!0),Ee(Ri,this).eventPageY=t.pageY,Ee(Ri,this).coords=e,Ee(Ri,this).TD=n,Nl(po,this,this.prepareRowsToMoving());const g=r.holder.scrollLeft+s.getRowHeaderWidth(),m=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Ee(ni,this).setPosition(null,g),Ee(ni,this).setSize(r.hider.offsetWidth-g,this.getRowsHeight(d,f)),Ee(ni,this).setOffset(-m,null),K(this.hot.rootElement,Q0),this.refreshPositions()}else me(this.hot.rootElement,J0),Nl(fa,this,!1),Ee(po,this).length=0}function rle(t){Ee(fa,this)&&(Ee(Ri,this).eventPageY=t.pageY,this.refreshPositions())}function sle(t,e,n,i){!this.hot.getSelectedRangeLast()||!Ee(fa,this)||(Ee(po,this).indexOf(e.row)>-1?me(this.hot.rootElement,sw):K(this.hot.rootElement,sw),i.row=!0,i.column=!0,i.cell=!0,Ee(Ri,this).coords=e,Ee(Ri,this).TD=n)}function ole(){const t=Ee(Ri,this).row,e=Ee(po,this).length;if(Nl(fa,this,!1),me(this.hot.rootElement,[Q0,sw,J0]),this.hot.selection.isSelectedByRowHeader()&&K(this.hot.rootElement,J0),e<1||t===void 0)return;const n=Ee(po,this)[0],i=this.hot.toPhysicalRow(n),r=this.dragRows(Ee(po,this),t);if(Ee(po,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(i),o=s+e-1;this.hot.selectRows(s,o)}}function ale(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,i=e+n;Ee(ni,this).setPosition(null,i),Ee(ni,this).setSize(t.hider.offsetWidth-i)}function lle(){this.moveBySettingsOrLoad()}function ule(t,e){fB(t,e),e.add(t)}function Nn(t,e,n){fB(t,e),e.set(t,n)}function fB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e,n){return t.set(ao(t,e),n),n}function ie(t,e){return t.get(ao(t,e))}function ao(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ow="manualRowResize",cle=30,QD="manualRowHeights";var ms=new WeakMap,mm=new WeakMap,$i=new WeakMap,$d=new WeakMap,oa=new WeakMap,ex=new WeakMap,Cc=new WeakMap,pm=new WeakMap,Qn=new WeakMap,ds=new WeakMap,ql=new WeakMap,aw=new WeakMap,Vd=new WeakMap,Wd=new WeakMap,kr=new WeakMap,Bd=new WeakMap,Uo=new WeakSet;class hle extends Ye{static get PLUGIN_KEY(){return ow}static get PLUGIN_PRIORITY(){return cle}constructor(e){super(e),ule(this,Uo),Nn(this,ms,null),Nn(this,mm,null),Nn(this,$i,[]),Nn(this,$d,null),Nn(this,oa,null),Nn(this,ex,null),Nn(this,Cc,null),Nn(this,pm,null),Nn(this,Qn,this.hot.rootDocument.createElement("DIV")),Nn(this,ds,this.hot.rootDocument.createElement("DIV")),Nn(this,ql,!1),Nn(this,aw,!1),Nn(this,Vd,0),Nn(this,Wd,null),Nn(this,kr,void 0),Nn(this,Bd,void 0),K(ie(Qn,this),"manualRowResizer"),K(ie(ds,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ow]}enablePlugin(){this.enabled||(Ft(kr,this,new Aa),ie(kr,this).addLocalHook("init",()=>ao(Uo,this,vle).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ie(kr,this)),this.addHook("modifyRowHeight",(e,n)=>ao(Uo,this,wle).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ft(Bd,this,ie(kr,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",QD,ie(kr,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",QD,e),e.value}setManualSize(e,n){const i=this.hot.toPhysicalRow(e),r=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return ie(kr,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return ie($d,this)}setupHandlePosition(e){Ft(ms,this,e);const{view:n}=this.hot,{_wt:i}=n,r=i.wtTable.getCoords(ie(ms,this)),s=r.row;if(s<0)return;const o=Gt(ie(ms,this)),a=ie(ms,this).getBoundingClientRect(),l=s<i.getSetting("fixedRowsTop"),u=s>=n.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let c;l?c=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(ms,this),r.row,r.col):u&&(c=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ie(ms,this),r.row,r.col)),c||(c=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ie(ms,this),r.row,r.col)),Ft(mm,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Ft($i,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();A(d,f=>{const g=f.getTopStartCorner().row,m=f.getBottomStartCorner().row;de(g,m,v=>{ie($i,this).includes(v)||ie($i,this).push(v)})})}ie($i,this).includes(ie(mm,this))||Ft($i,this,[ie(mm,this)]),Ft(pm,this,c.top-6),Ft(Cc,this,parseInt(a.height,10)),ie(Qn,this).style.top=`${ie(pm,this)+ie(Cc,this)}px`,ie(Qn,this).style[this.inlineDir]=`${c.start}px`,ie(Qn,this).style.width=`${o}px`,this.hot.rootElement.appendChild(ie(Qn,this))}refreshHandlePosition(){ie(Qn,this).style.top=`${ie(pm,this)+ie($d,this)}px`}setupGuidePosition(){const e=parseInt(Gt(ie(Qn,this)),10),n=parseInt(ie(Qn,this).style[this.inlineDir],10)+e,i=this.hot.view.getTableWidth();K(ie(Qn,this),"active"),K(ie(ds,this),"active"),ie(ds,this).style.top=ie(Qn,this).style.top,ie(ds,this).style[this.inlineDir]=`${n}px`,ie(ds,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(ie(ds,this))}refreshGuidePosition(){ie(ds,this).style.top=ie(Qn,this).style.top}hideHandleAndGuide(){me(ie(Qn,this),"active"),me(ie(ds,this),"active")}checkIfRowHeader(e){const n=Sa(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ie(oa,this)<n?n:ie(oa,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);s!==void 0&&Ft(oa,this,s),this.setManualSize(i,ie(oa,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};ie(Vd,this)>=2&&(ie($i,this).length>1?(A(ie($i,this),r=>{n(r)}),e()):A(ie($i,this),r=>{n(r,!0)})),Ft(Vd,this,0),Ft(Wd,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>ao(Uo,this,dle).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>ao(Uo,this,fle).call(this,i)),this.eventManager.addEventListener(n,"mousemove",i=>ao(Uo,this,gle).call(this,i)),this.eventManager.addEventListener(n,"mouseup",()=>ao(Uo,this,mle).call(this)),this.eventManager.addEventListener(ie(Qn,this),"contextmenu",()=>ao(Uo,this,ple).call(this))}destroy(){super.destroy()}}function dle(t){if(!cE(t.target)&&ie(aw,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ie(ql,this)||this.setupHandlePosition(e))}}function fle(t){ye(t.target,"manualRowResizer")&&(this.setupHandlePosition(ie(ms,this)),this.setupGuidePosition(),Ft(ql,this,!0),ie(Wd,this)===null&&(Ft(Wd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(Wd,this))),Ft(Vd,this,ie(Vd,this)+1),Ft(ex,this,t.pageY),Ft(oa,this,ie(Cc,this)))}function gle(t){ie(ql,this)&&(Ft($d,this,ie(Cc,this)+(t.pageY-ie(ex,this))),A(ie($i,this),e=>{Ft(oa,this,this.setManualSize(e,ie($d,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function mle(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ie(ql,this)&&(this.hideHandleAndGuide(),Ft(ql,this,!1),ie(oa,this)!==ie(Cc,this)&&(ie($i,this).length>1?(A(ie($i,this),i=>{e(i)}),t()):A(ie($i,this),i=>{e(i,!0)})),this.setupHandlePosition(ie(ms,this)))}function ple(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(Qn,this)),this.hot.rootElement.removeChild(ie(ds,this)),Ft(ql,this,!1),Ft(aw,this,!0),this.hot._registerImmediate(()=>{Ft(aw,this,!1)})}function wle(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),r=ie(kr,this).getValueAtIndex(i);this.hot.getSettings()[ow]&&r&&(n=r)}return n}function vle(){const t=this.hot.getSettings()[ow],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,i)=>{ie(kr,this).setValueAtIndex(i,n)}):Array.isArray(t)?(t.forEach((n,i)=>{ie(kr,this).setValueAtIndex(i,n)}),Ft(Bd,this,t)):t===!0&&Array.isArray(ie(Bd,this))&&ie(Bd,this).forEach((n,i)=>{ie(kr,this).setValueAtIndex(i,n)})},!0)}var JD={},eN;function yle(){if(eN)return JD;eN=1;var t=Kw();return t("flatMap"),JD}yle();var tN={},nN={},hR,iN;function Cle(){if(iN)return hR;iN=1;var t=cn(),e=dn(),n=Os(),i=y_();return hR=function(r,s){(!s||typeof r!="string")&&e(r);var o=i(r);return n(e(o!==void 0?t(o,r):r))},hR}var rN;function ble(){if(rN)return nN;rN=1;var t=wt(),e=cn(),n=Ti(),i=dn(),r=Os(),s=Cle(),o=S_(),a=Mi(),l=xa(),u=R_(),c=Ia(),h=!l&&!u("flatMap",function(){}),d=!l&&!h&&c("flatMap",TypeError),f=l||h||d,g=o(function(){for(var m=this.iterator,v=this.mapper,S,y;;){if(y=this.inner)try{if(S=i(e(y.next,y.iterator)),!S.done)return S.value;this.inner=null}catch(M){a(m,"throw",M)}if(S=i(e(this.next,m)),this.done=!!S.done)return;try{this.inner=s(v(S.value,this.counter++),!1)}catch(M){a(m,"throw",M)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(v){i(this);try{n(v)}catch(S){a(this,"throw",S)}return d?e(d,this,v):new g(r(this),{mapper:v,inner:null})}}),nN}var sN;function Sle(){return sN||(sN=1,ble()),tN}Sle();function Rle(t,e,n){_le(t,e),e.set(t,n)}function _le(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hl(t,e,n){return(e=Ele(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ele(t){var e=Tle(t,"string");return typeof e=="symbol"?e:e+""}function Tle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oN(t,e){return t.get(gB(t,e))}function wm(t,e,n){return t.set(gB(t,e),n),n}function gB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dl=new WeakMap;class ps{constructor(e,n,i,r,s,o){hl(this,"row",void 0),hl(this,"col",void 0),hl(this,"rowspan",void 0),hl(this,"colspan",void 0),hl(this,"removed",!1),hl(this,"cellCoordsFactory",void 0),hl(this,"cellRangeFactory",void 0),Rle(this,dl,null),this.row=e,this.col=n,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:i,rowspan:r,colspan:s}=e;return ot`The merged cell declared with {row: ${n}, col: ${i},\x20
      rowspan: ${r}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:i}=e;return ot`The merged cell declared at [${n}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:i}=e;return ot`The merged cell declared at [${n}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:i}=e;return ot`The merged cell declared at [${n}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:i,rowspan:r,colspan:s}=e;return n<0||i<0||r<0||s<0}static isSingleCell(e){let{rowspan:n,colspan:i}=e;return i===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:i}=e;return i===0||n===0}static isOutOfBounds(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),wm(dl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const i=e[0]||e[1],r=n+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(n,r),l=Math.max(n,r),u=this[o],c=this[o]+this[s]-1;if(u>=n&&(this[o]+=i),i>0)n<=c&&n>u&&(this[s]+=i);else if(i<0){if(a<=u&&l>=c)return this.removed=!0,wm(dl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(i)-h;this[o]-=d+i,this[s]-=h}else if(u<=a&&c>=l)this[s]+=i;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[s]-=h}}return wm(dl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return oN(dl,this)||wm(dl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),oN(dl,this)}}function Mle(t,e){xle(t,e),e.add(t)}function xle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vm(t,e,n){return(e=Ple(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ple(t){var e=Ile(t,"string");return typeof e=="symbol"?e:e+""}function Ile(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yo=new WeakSet;class lw{constructor(e){Mle(this,Yo),vm(this,"plugin",void 0),vm(this,"mergedCells",[]),vm(this,"mergedCellsMatrix",new Map),vm(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:i}=e;return ot`The merged cell declared at [${n}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(n))!==null&&i!==void 0?i:!1}getByRange(e){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),o=this.mergedCells.length;let a=!1;for(let l=0;l<o;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=r&&h>=i&&h+f-1<=s){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(r=>{const{row:s,col:o,colspan:a,rowspan:l}=r;for(let u=s;u<s+l;u++)for(let c=o;c<o+a;c++)n.add(`r${u},c${c}`)}),e.filter(r=>{const{row:s,col:o,colspan:a,rowspan:l}=r,u=new Set;let c=!1;for(let h=s;h<s+l;h++){for(let d=o;d<o+a;d++){const f=`r${h},c${d}`;if(n.has(f)){Je(lw.IS_OVERLAPPING_WARNING(r)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:r}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=i;l<=s;l++)for(let u=r;u<=o;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,r=e.col,s=e.rowspan,o=e.colspan,a=new ps(i,r,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,r),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),fl(Yo,this,aN).call(this,a),a):(u&&Je(lw.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const i=this.get(e,n),r=i?this.mergedCells.indexOf(i):-1;return i&&r!==-1?(this.mergedCells.splice(r,1),fl(Yo,this,Ole).call(this,i),i):!1}clear(){A(this.mergedCells,e=>{let{row:n,col:i,rowspan:r,colspan:s}=e;de(n,n+r,o=>{de(i,i+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const i=this.get(e,n);if(!i)return!1;const{row:r,col:s,rowspan:o,colspan:a}=i,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=je(u,r,r+o-1),d=je(c,s,s+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,s)}getStartMostColumnIndex(e,n){const i=fl(Yo,this,ym).call(this,e,"col",-1);let r=n;for(let s=0;s<i.length;s++)if(i[s]<=n){r=i[s];break}return r}getEndMostColumnIndex(e,n){const i=fl(Yo,this,ym).call(this,e,"col",1);let r=n;for(let s=0;s<i.length;s++)if(i[s]>=n){r=i[s];break}return r}getTopMostRowIndex(e,n){const i=fl(Yo,this,ym).call(this,e,"row",-1);let r=n;for(let s=0;s<i.length;s++)if(i[s]<=n){r=i[s];break}return r}getBottomMostRowIndex(e,n){const i=fl(Yo,this,ym).call(this,e,"row",1);let r=n;for(let s=0;s<i.length;s++)if(i[s]>=n){r=i[s];break}return r}shiftCollections(e,n,i){const r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i;break}const s=[];this.mergedCells.forEach(o=>{o.shift(r,n),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{fl(Yo,this,aN).call(this,o)})}}function ym(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,r=n===1?t.getTopStartCorner():t.getBottomEndCorner(),s=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=r.row;n===1?o<=s.row:o>=s.row;o+=n)for(let a=r.col;n===1?a<=s.col:a>=s.col;a+=n){const l=e==="row"?o:a,u=this.get(o,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),i.has(l)||i.set(l,new Set),i.get(l).add(c)}return Array.from(new Set(Array.from(i.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function aN(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Ole(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function dR(t,e,n){return(e=Ale(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ale(t){var e=Hle(t,"string");return typeof e=="symbol"?e:e+""}function Hle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dle{constructor(e){dR(this,"plugin",void 0),dR(this,"mergedCellsCollection",void 0),dR(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}snapDragArea(e,n,i,r){const s=n.slice(0),o=this.getAutofillSize(e,n,i),[a,l,u,c]=e,d=["up","down"].indexOf(i)>-1?u-a+1:c-l+1,f=Math.floor(o/d)*d,g=o-f,m=this.getFarthestCollection(e,n,i,r);if(m){if(i==="down"){const v=m.row+m.rowspan-a-g;s[2]+v>=this.plugin.hot.countRows()?s[2]-=g:s[2]+=g?v:0}else if(i==="right"){const v=m.col+m.colspan-l-g;s[3]+v>=this.plugin.hot.countCols()?s[3]-=g:s[3]+=g?v:0}else if(i==="up"){const v=u-g-m.row+1;s[0]+v<0?s[0]+=g:s[0]-=g?v:0}else if(i==="left"){const v=c-g-m.col+1;s[1]+v<0?s[1]+=g:s[1]-=g?v:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),tn(this.currentFillData,e)}getAutofillSize(e,n,i){const[r,s,o,a]=e,[l,u,c,h]=n;switch(i){case"up":return r-l;case"down":return c-o;case"left":return s-u;case"right":return h-a;default:return null}}getDragArea(e,n,i){const[r,s,o,a]=e,[l,u,c,h]=n;switch(i){case"up":return[l,u,r-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[o+1,s,c+f,a]}case"left":return[l,u,o,s-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[r,a+f,c,h]}default:return null}}getFarthestCollection(e,n,i,r){const[s,o,a,l]=e,u=["up","down"].indexOf(i)>-1,c=u?a:l,h=u?s:o,d=this.getAutofillSize(e,n,i),f=u?a-s+1:l-o+1,g=Math.floor(d/f)*f,m=d-g;let v=null,S=null,y=null;switch(i){case"up":v="includesVertically",y=c-m+1;break;case"left":v="includesHorizontally",y=c-m+1;break;case"down":v="includesVertically",y=h+m-1;break;case"right":v="includesHorizontally",y=h+m-1;break}return A(r,M=>{M[v](y)&&M.isFarther(S,i)&&(S=M)}),S}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,s=(u,c)=>{switch(r){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let o=0,a=null,l=1;do for(let u=0;u<i.length;u+=1){if(a=i[u],o=l*this.currentFillData.cycleLength,s(a,o))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan},!0);break}u===i.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},i={min:null,max:null};return A(e,r=>{const s=r[0],o=this.plugin.hot.propToCol(r[1]);(n.min===null||s<n.min)&&(n.min=s),(n.max===null||s>n.max)&&(n.max=s),(i.min===null||o<i.min)&&(i.min=o),(i.max===null||o>i.max)&&(i.max=o)}),{from:{row:n.min,column:i.min},to:{row:n.max,column:i.max}}}dragAreaOverlapsCollections(e,n,i){const r=this.getDragArea(e,n,i),[s,o,a,l]=r,u=this.plugin.hot._createCellCoords(s,o),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:i==="up"||i==="down"?!f.every(g=>{let{colspan:m}=g;return m===h.getWidth()}):!f.every(g=>{let{rowspan:m}=g;return m===h.getHeight()})}}function fR(t,e,n){return(e=Nle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nle(t){var e=kle(t,"string");return typeof e=="symbol"?e:e+""}function kle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lle{constructor(e){fR(this,"plugin",void 0),fR(this,"hot",void 0),fR(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,i,r){const s=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(s<=c.row&&o<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const i=[];if(!n||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let s=0;s<e.colspan;s+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+s));for(let r=0;r<i.length;r+=1){const s=[];for(let o=0;o<n.length;o+=1)s[o]=n[o].includes(i[r]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function Fle(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(uT)}return this.getTranslatedPhrase(lT)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?ps.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function jd(t,e,n){return(e=$le(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $le(t){var e=Vle(t,"string");return typeof e=="symbol"?e:e+""}function Vle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lN{constructor(e){jd(this,"data",void 0),jd(this,"next",null),jd(this,"prev",null),this.data=e}}class Cm{constructor(){jd(this,"first",null),jd(this,"last",null)}push(e){const n=new lN(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.last;this.last=n,n.prev=i,i.next=n}return n}unshift(e){const n=new lN(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.first;this.first=n,n.next=i,i.prev=n}}inorder(e){let n=this.first;for(;n;){const i=e(n);if(n===this.last||i===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,i,r;for(;n;){if(n.data===e)return i=n.next,r=n.prev,i&&(i.prev=r),r&&(r.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){r&&(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,i;for(;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}function Wle(t,e){mB(t,e),e.add(t)}function gl(t,e,n){mB(t,e),e.set(t,n)}function mB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(t,e){return t.get(uw(t,e))}function Ii(t,e,n){return t.set(uw(t,e),n),n}function uw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ss=new WeakMap,os=new WeakMap,as=new WeakMap,ls=new WeakMap,e_=new WeakMap,bm=new WeakMap,Sm=new WeakMap,gR=new WeakSet;class Ble{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:i,columnIndexMapper:r}=e;Wle(this,gR),gl(this,ss,new Cm),gl(this,os,new Cm),gl(this,as,null),gl(this,ls,null),gl(this,e_,null),gl(this,bm,null),gl(this,Sm,null),Ii(e_,this,n),Ii(bm,this,i),Ii(Sm,this,r)}getCurrentVerticalNode(){return rt(ls,this).data}getFirstVerticalNode(){return rt(os,this).first.data}getNextVerticalNode(){return rt(ls,this).next.data}getPrevVerticalNode(){return rt(ls,this).prev.data}getCurrentHorizontalNode(){return rt(as,this).data}getFirstHorizontalNode(){return rt(ss,this).first.data}getNextHorizontalNode(){return rt(as,this).next.data}getPrevHorizontalNode(){return rt(as,this).prev.data}setPrevNodeAsActive(){Ii(ls,this,rt(ls,this).prev),Ii(as,this,rt(as,this).prev)}setNextNodeAsActive(){Ii(ls,this,rt(ls,this).next),Ii(as,this,rt(as,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),i=e.getBottomEndCorner(),r=new WeakSet;Ii(ss,this,new Cm);for(let o=n.row;o<=i.row;o++)if(!rt(bm,this).isHidden(o))for(let a=n.col;a<=i.col;a++){if(rt(Sm,this).isHidden(a))continue;const l=uw(gR,this,uN).call(this,e,rt(ss,this),r,o,a);l&&Ii(as,this,l)}rt(ss,this).first&&(rt(ss,this).first.prev=rt(ss,this).last,rt(ss,this).last.next=rt(ss,this).first);const s=new WeakSet;Ii(os,this,new Cm);for(let o=n.col;o<=i.col;o++)if(!rt(Sm,this).isHidden(o))for(let a=n.row;a<=i.row;a++){if(rt(bm,this).isHidden(a))continue;const l=uw(gR,this,uN).call(this,e,rt(os,this),s,a,o);l&&Ii(ls,this,l)}rt(os,this).first&&(rt(os,this).first.prev=rt(os,this).last,rt(os,this).last.next=rt(os,this).first)}setActiveNode(e,n){return rt(ss,this).inorder(i=>{const{rowStart:r,rowEnd:s,colStart:o,colEnd:a}=i.data;if(e>=r&&e<=s&&n>=o&&n<=a)return Ii(as,this,i),!1}),rt(os,this).inorder(i=>{const{rowStart:r,rowEnd:s,colStart:o,colEnd:a}=i.data;if(e>=r&&e<=s&&n>=o&&n<=a)return Ii(ls,this,i),!1}),this}}function uN(t,e,n,i,r){const s=t.getTopStartCorner(),o=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=rt(e_,this).call(this,i,r);if(l&&n.has(l))return null;const u={colStart:r,colEnd:r,rowStart:i,rowEnd:i};if(l){if(n.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return i===a.row&&r===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function pB(t,e,n){const{rowIndexMapper:i,stylesHandler:r}=t,s=r.getDefaultRowHeight();let o=0;for(let l=e;l<e+n;l++)if(!i.isHidden(l)){var a;o+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:s,l===0&&!r.isClassicTheme()&&(o+=1)}return o}function jle(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e,r=new Map;function s(){}function o(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!Ae(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),Rc()&&r.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${r.get(l)}px`,r.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[m,v]=t.translateMergedCellToRenderable(h,g,d,f),S=t.getSetting("virtualized");if(Rc()&&d===0&&!e.getSettings().rowHeaders){const O=pB(e,h,g);r.set(l,O/g)}const y=n.getRenderableFromVisualIndex(l),M=i.getRenderableFromVisualIndex(u),I=m-y+1,P=v-M+1;let E=n.getNearestNotHiddenIndex(h,1),T=i.getNearestNotHiddenIndex(d,1);if(S){const O=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(O)||(E=Math.max(E,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(O)||(T=Math.max(T,e.getFirstRenderedVisibleColumn()))}const $=Math.min(g,I),U=Math.min(f,P);E===l&&T===u?(a.setAttribute("rowspan",$),a.setAttribute("colspan",U)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:s,after:o}}function zle(t,e){wB(t,e),e.add(t)}function Rm(t,e,n){wB(t,e),e.set(t,n)}function wB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mR(t,e,n){return(e=Ule(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ule(t){var e=Yle(t,"string");return typeof e=="symbol"?e:e+""}function Yle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pf(t,e,n){return t.set(lt(t,e),n),n}function pt(t,e){return t.get(lt(t,e))}function lt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeMergeCells");re.getSingleton().register("afterMergeCells");re.getSingleton().register("beforeUnmergeCells");re.getSingleton().register("afterUnmergeCells");const t_="mergeCells",Gle=150,cN=t_;var sr=new WeakMap,or=new WeakMap,Rs=new WeakMap,hN=new WeakMap,ft=new WeakSet;class qle extends Ye{constructor(){super(...arguments),zle(this,ft),mR(this,"mergedCellsCollection",null),mR(this,"autofillCalculations",null),mR(this,"selectionCalculations",null),Rm(this,sr,null),Rm(this,or,{row:0,col:0}),Rm(this,Rs,new Ble({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Rm(this,hN,jle(this))}static get PLUGIN_KEY(){return t_}static get PLUGIN_PRIORITY(){return Gle}static get DEFAULT_SETTINGS(){return{[LV]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[t_]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new lw(this),this.autofillCalculations=new Dle(this),this.selectionCalculations=new Lle(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,Kle).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,Zle).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,Qle).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,Jle).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,eue).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,fN).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,fN).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,nue).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,iue).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,rue).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,dN).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,dN).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,Xle).call(e,...i)}),this.addHook("afterRenderer",function(){return pt(hN,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,tue).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,sue).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,oue).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,aue).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,lue).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,uue).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,cue).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,hue).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,due).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,fue).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,gue).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,mue).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,pue).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,wue).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lt(ft,e,vue).call(e,...i)}),this.addHook("beforeUndoStackChange",(n,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!J_())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:s}=i;for(let o=r+1;o<r+s;o++)n.push(o)}),n=[...new Set(n)],n.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>s?.name==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(r);o&&(o.style.background=nf(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{var r;i.style.background=(r=nf(i,"backgroundColor"))===null||r===void 0?void 0:r.replace(", 0.99)",")")})},1)}validateSetting(e){return e?ps.containsNegativeValues(e)?(Je(ps.NEGATIVE_VALUES_WARNING(e)),!1):ps.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Je(ps.IS_OUT_OF_BOUNDS_WARNING(e)),!1):ps.isSingleCell(e)?(Je(ps.IS_SINGLE_CELL(e)),!1):ps.containsZeroSpan(e)?(Je(ps.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(r=>this.validateSetting(r)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];n.forEach(r=>{const{row:s,col:o,rowspan:a,colspan:l}=r,u=this.hot._createCellCoords(s,o),c=this.hot._createCellCoords(s+a-1,o+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=s;d<s+a;d++)for(let f=o;f<o+l;f++)(d!==s||f!==o)&&i.push([d,f,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:r.row,col:r.col,rowspan:s.row-r.row+1,colspan:s.col-r.col+1},a=[];let l=null;return this.canMergeRange(o,n)?(this.hot.runHooks("beforeMergeCells",e,n),de(0,o.rowspan-1,c=>{de(0,o.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+c,o.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,n)?(i?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),A(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),de(0,r.rowspan-1,s=>{de(0,r.colspan-1,o=>{this.hot.removeCellMeta(r.row+s,r.col+o,"hidden"),this.hot.removeCellMeta(r.row+s,r.col+o,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:i}=e.clone().normalize(),r=this.mergedCellsCollection.get(n.row,n.col);r.row===n.row&&r.col===n.col&&r.row+r.rowspan-1===i.row&&r.col+r.colspan-1===i.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,i,r){const s=this.hot._createCellCoords(e,n),o=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,n,i,r){const s=this.hot._createCellCoords(e,n),o=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:cN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cN)}modifyViewportRowStart(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(r,s);if(Ae(o)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(r,s);if(Ae(o)){const a=o.row+o.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(s,r);if(Ae(o)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(s,r);if(Ae(o)){const a=o.col+o.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,i,r){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;n===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+n-1,-1),r===0?l=o.getNearestNotHiddenIndex(i,1):l=o.getNearestNotHiddenIndex(i+r-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,c=i>=0?o.getRenderableFromVisualIndex(l):i;return[u,c]}}function Kle(){this.generateFromSettings(),this.hot.render()}function Xle(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),i=n.getTopStartCorner(),r=n.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(i.row===e[s].row&&i.col===e[s].col&&r.row===e[s].row+e[s].rowspan-1&&r.col===e[s].col+e[s].colspan-1)return!1}return t}function Zle(t){pt(or,this).row=t.row,pt(or,this).col=t.col}function Qle(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot;pt(sr,this)&&(r.getRenderableFromVisualIndex(pt(sr,this).row)!==null&&(n.row=pt(sr,this).row),i.getRenderableFromVisualIndex(pt(sr,this).col)!==null&&(n.col=pt(sr,this).col),pf(sr,this,null));const s=this.mergedCellsCollection.get(n.row,n.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(t.col<0){const c=n.col>=o&&n.col<=a?o-1:a,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=o&&n.col<=a?a+1:o,h=i.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=s.row,u=s.row+s.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=r.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Jle(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:i}=e,{columnIndexMapper:r,rowIndexMapper:s}=this.hot,o=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;o(i.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=r.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;o(i.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=r.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;o(a,i.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;o(a,i.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function eue(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){pf(sr,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);pf(sr,this,e.clone()),n&&e.assign(n)}function dN(t,e,n,i){if(t<0||e<0)return;const r=this.mergedCellsCollection.get(t,e);if(!r)return;const{row:s,col:o,colspan:a,rowspan:l}=r,u=s,c=o,h=s+l-1,d=o+a-1;if(i==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),m=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[je(g,u,h),je(m,c,d),je(this.hot.getLastRenderedVisibleRow(),u,h),je(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function tue(t){t.items.push({name:"---------"},Fle(this))}function fN(){pf(sr,this,null)}function nue(){if(pt(sr,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=pt(sr,this).clone().normalize();pt(Rs,this).setActiveNode(i.row,i.col),pt(or,this).row>0||pt(or,this).col>0?pt(Rs,this).setPrevNodeAsActive():(n==="E-W"&&pt(or,this).col<0||e==="S-N"&&pt(or,this).row<0)&&pt(Rs,this).setNextNodeAsActive()}function iue(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:r}=this.hot;let s=null,o=null;if(pt(or,this).col<0){const{rowEnd:a,colEnd:l}=pt(Rs,this).getPrevHorizontalNode();o=i.getNearestNotHiddenIndex(l,-1),s=r.getNearestNotHiddenIndex(a,-1)}else if(pt(or,this).col>0){const{rowStart:a,colStart:l}=pt(Rs,this).getNextHorizontalNode();o=i.getNearestNotHiddenIndex(l,1),s=r.getNearestNotHiddenIndex(a,1)}else if(pt(or,this).row<0){const{rowEnd:a,colEnd:l}=pt(Rs,this).getPrevVerticalNode();o=i.getNearestNotHiddenIndex(l,-1),s=r.getNearestNotHiddenIndex(a,-1)}else if(pt(or,this).row>0){const{rowStart:a,colStart:l}=pt(Rs,this).getNextVerticalNode();o=i.getNearestNotHiddenIndex(l,1),s=r.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}pt(Rs,this).setActiveNode(t,e),pf(or,this,{row:0,col:0})}function rue(){this.hot.getSelectedRangeLast().isHeader()||pt(Rs,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function sue(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function oue(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function aue(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function lue(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const i=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(i,i,r),o=this.mergedCellsCollection.getWithinRange(s);return o.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,o)}function uue(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function cue(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function hue(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function due(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function fue(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function gue(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(n);A(i,r=>{n.getBottomEndCorner().row===r.getLastRow()&&n.getBottomEndCorner().col===r.getLastColumn()&&(t[2]=r.row,t[3]=r.col)})}}function mue(t,e,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function pue(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function wue(t,e,n,i){if(!(i instanceof MouseEvent))return;const r=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(r);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&r.isEqual(this.hot._createCellRange(o,o,a))}function vue(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let i,r;if(n==="master")i=this.hot.getFirstRenderedVisibleColumn(),r=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const o=this.hot._createCellCoords(e,i),a=this.hot._createCellCoords(e,r),l=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,pB(this.hot,e,g))}),t}function yue(t,e){return function(n,i){const[,...r]=n,[,...s]=i;return function o(a){const l=t[a],u=e[a],c=r[a],h=s[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:GV(u.type))(l,u,d)(c,h);if(g===Ts){const m=a+1;if(typeof e[m]<"u")return o(m)}return g}(0)}}const vB="sort";function Cue(t,e,n){const i=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${vB}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function bue(t){const e=t.className.split(" "),n=new RegExp(`^${vB}-[0-9]{1,2}$`);return e.filter(i=>n.test(i))}function Sue(t,e,n){return(e=Rue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rue(t){var e=_ue(t,"string");return typeof e=="symbol"?e:e+""}function _ue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cw="multiColumnSorting",Eue=170,gN=cw;YV(cw,yue);class Tue extends nW{constructor(){super(...arguments),Sue(this,"pluginKey",cw)}static get PLUGIN_KEY(){return cw}static get PLUGIN_PRIORITY(){return Eue}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Up)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:Ha,position:"before",group:gN})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gN)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),me(e,bue(e)),this.enabled!==!1&&K(e,Cue(...i))}onAfterOnCellMouseDown(e,n){VM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Up))):this.sort(this.getColumnNextConfig(n.col)))}}function mN(t,e,n){return(e=Mue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mue(t){var e=xue(t,"string");return typeof e=="symbol"?e:e+""}function xue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Pue="multipleSelectionHandles",Iue=160;class Oue extends Ye{constructor(){super(...arguments),mN(this,"dragged",[]),mN(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Pue}static get PLUGIN_PRIORITY(){return Iue}isEnabled(){return Fr()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(r);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",r=>{let s;if(ye(r.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},r.preventDefault(),!1;if(ye(r.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",r=>{if(ye(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(ye(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",r=>{const{rootDocument:s}=this.hot;let o,a,l,u,c,h;if(e.dragged.length===0)return;const d=s.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),r.preventDefault())})}getCurrentRangeCoords(e,n,i,r,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":s==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,o.col)};break;case"SE-NW":s==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,o.col)});break}break;case"NW-SE":switch(r){case"NE-SW":s==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":s==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":s==="top"?c={start:n,end:o}:c.end=n;break;case"SW-NE":s==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(r){case"NW-SE":s==="bottom"?c={start:this.hot._createCellCoords(n.row,o.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(o.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":s==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,o.col),end:this.hot._createCellCoords(o.row,n.col)};break;case"SE-NW":s==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(o.row,n.col)}:s==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(c.end=n);break;case"SE-NW":s==="top"?c.end=n:c={start:n,end:o};break}break}return c}isDragged(){return this.dragged.length>0}}function n_(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:r=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:s,crossHiddenColumns:r,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:u}}function yB(){return{label:"",isPlaceholder:!0}}function Aue(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;A(t,r=>{const s=[];let o=0;n.push(s),A(r,a=>{const l=n_();if(Ae(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=bt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=bt(a);o+=l.origColspan;let u=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,u=!0),s.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)s.push(yB());return!u})});const i=Math.max(...Ve(n,r=>r.length));return A(n,r=>{if(r.length<i){const s=Ve(new Array(i-r.length),()=>n_());r.splice(r.length,0,...s)}}),n}function pR(t,e,n){Hue(t,e),e.set(t,n)}function Hue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(t,e){return t.get(CB(t,e))}function Xh(t,e,n){return t.set(CB(t,e),n),n}function CB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pN=["label","collapsible"];var Xs=new WeakMap,ml=new WeakMap,wR=new WeakMap;class Due{constructor(){pR(this,Xs,[]),pR(this,ml,0),pR(this,wR,1/0)}setColumnsLimit(e){Xh(wR,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Xh(Xs,this,Aue(e,Mr(wR,this))),Xh(ml,this,Mr(Xs,this).length)}getData(){return Mr(Xs,this)}mergeWith(e){A(e,n=>{let{row:i,col:r,...s}=n;const o=this.getHeaderSettings(i,r);o!==null&&tn(o,s,pN)})}map(e){A(Mr(Xs,this),n=>{A(n,i=>{const r=e({...i});Ae(r)&&tn(i,r,pN)})})}getHeaderSettings(e,n){var i;if(e>=Mr(ml,this)||e<0)return null;const r=Mr(Xs,this)[e];return Array.isArray(r)===!1||n>=r.length?null:(i=r[n])!==null&&i!==void 0?i:null}getHeadersSettings(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=Mr(ml,this)||e<0)return r;const s=Mr(Xs,this)[e];let o=0;for(let a=n;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),o===i)break;if(o>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return Mr(ml,this)}getColumnsCount(){return Mr(ml,this)>0?Mr(Xs,this)[0].length:0}clear(){Xh(Xs,this,[]),Xh(ml,this,0)}}function vR(t,e,n){return(e=Nue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nue(t){var e=kue(t,"string");return typeof e=="symbol"?e:e+""}function kue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bB="DF-pre-order";function SB(t,e){let n=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(n===!1)return!1;n=SB.call(this.childs[i],t,e)}return n}const Lue="DF-post-order";function RB(t,e){for(let n=0;n<this.childs.length;n++)if(RB.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const _B="BF";function Fue(t,e){const n=[this];function i(){if(n.length===0)return;const r=n.shift();n.push(...r.childs),t.call(e,r)!==!1&&i()}i()}const $ue=_B,wN=new Map([[bB,SB],[Lue,RB],[_B,Fue]]);class hw{constructor(e){vR(this,"data",{}),vR(this,"parent",null),vR(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new hw({...e.data});for(let i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$ue;if(!wN.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);wN.get(n).call(this,e,this)}walkUp(e){const n=this,i=r=>{e.call(n,r)!==!1&&r.parent!==null&&i(r.parent)};i(this)}}function yR(t,e,n){Vue(t,e),e.set(t,n)}function Vue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zn(t,e){return t.get(EB(t,e))}function Wue(t,e,n){return t.set(EB(t,e),n),n}function EB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Uu=new WeakMap,pl=new WeakMap,Yu=new WeakMap;class Bue{constructor(e){yR(this,Uu,new Map),yR(this,pl,new Map),yR(this,Yu,null),Wue(Yu,this,e)}getRoots(){return Array.from(Zn(Uu,this).values())}getRootByColumn(e){let n;return Zn(pl,this).has(e)&&(n=Zn(Uu,this).get(Zn(pl,this).get(e))),n}getNode(e,n){const i=this.getRootByColumn(n);if(!i)return;const r=n-Zn(pl,this).get(n);let s=0,o;return i.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(r>=s&&r<=s+l-1)return o=a,o.data.isRoot=n===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;Zn(pl,this).clear(),A(Zn(Uu,this),n=>{let[,{data:{colspan:i}}]=n;for(let r=e;r<e+i;r++)Zn(pl,this).set(r,e);e+=i})}buildTree(){this.clear();const e=Zn(Yu,this).getColumnsCount();let n=0;for(;n<e;){const i=Zn(Yu,this).getHeaderSettings(0,n),r=new hw;Zn(Uu,this).set(n,r),this.buildLeaves(r,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Zn(Yu,this).getHeadersSettings(i,n,r);i+=1,A(s,o=>{const a={...o,headerLevel:i-1,columnIndex:n};let l;i===1?(e.data=a,l=e):(l=new hw(a),e.addChild(l)),i<Zn(Yu,this).getLayersCount()&&this.buildLeaves(l,n,i,o.origColspan),n+=o.origColspan})}clear(){Zn(Uu,this).clear(),Zn(pl,this).clear()}}function TB(t,e){t.walkDown(n=>{let{data:i,childs:r}=n;if(!i.isHidden&&(e(i.columnIndex),r.length===0))for(let s=1;s<i.colspan;s++)e(i.columnIndex+s)})}function dw(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function fw(t){return dw(t,"origColspan")===t.data.origColspan}function tx(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(fw(t))return tx(n[0]);e.isCollapsed=!1;const r=n.slice(1),s=new Set;let o=0;if(r.length>0)A(r,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,TB(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;o=l-a;for(let c=1;c<l;c++)s.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):fw(a)&&(l.isCollapsed=dw(a,"isCollapsed"))}),{rollbackModification:()=>nx(t),affectedColumns:Array.from(s),colspanCompensation:o}}function nx(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(fw(t))return nx(i[0]);n.isCollapsed=!0;const s=i.slice(1),o=new Set;if(s.length>0)A(s,l=>{TB(l,u=>{o.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;o.add(h)}}const a=n.colspan-((e=dw(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):fw(l)&&(u.isCollapsed=dw(l,"isCollapsed"))}),{rollbackModification:()=>tx(t),affectedColumns:Array.from(o),colspanCompensation:a}}function jue(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ot`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:s}}=r;if(s)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:s}=r;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function zue(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ot`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:s}}=r;if(s)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:s}=r;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const vN=new Map([["collapse",nx],["expand",tx],["hide-column",jue],["show-column",zue]]);function Uue(t,e,n){if(!vN.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return vN.get(t)(e,n)}function _m(t){const e=[];return A(t,n=>{n.walkDown(i=>{const r=i.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=r,u=Gue(e,a);let c=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||c)u.push(yB());else{const f=Yue(r);f.isRoot=!0,u.push(f),c=!0}})}),e}function Yue(t){const{crossHiddenColumns:e,...n}=n_(t);return n}function Gue(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function CR(t,e,n){que(t,e),e.set(t,n)}function que(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zh(t,e,n){return t.set(MB(t,e),n),n}function Nt(t,e){return t.get(MB(t,e))}function MB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var us=new WeakMap,fi=new WeakMap,wl=new WeakMap;class Kue{constructor(){CR(this,us,new Due),CR(this,fi,new Bue(Nt(us,this))),CR(this,wl,[[]])}setState(e){Nt(us,this).setData(e);let n=!1;try{Nt(fi,this).buildTree()}catch{Nt(fi,this).clear(),Nt(us,this).clear(),n=!0}return Zh(wl,this,_m(Nt(fi,this).getRoots())),n}setColumnsLimit(e){Nt(us,this).setColumnsLimit(e)}mergeStateWith(e){const n=Ve(e,i=>{let{row:r,...s}=i;return{row:r<0?this.rowCoordsToLevel(r):r,...s}});Nt(us,this).mergeWith(n),Nt(fi,this).buildTree(),Zh(wl,this,_m(Nt(fi,this).getRoots()))}mapState(e){Nt(us,this).map(e),Nt(fi,this).buildTree(),Zh(wl,this,_m(Nt(fi,this).getRoots()))}mapNodes(e){return fn(Nt(fi,this).getRoots(),(n,i)=>(i.walkDown(r=>{const s=e(r.data);s!==void 0&&n.push(s)}),n),[])}triggerNodeModification(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));const r=Nt(fi,this).getNode(n,i);let s;return r&&(s=Uue(e,r,i),Zh(wl,this,_m(Nt(fi,this).getRoots()))),s}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=Nt(wl,this)[e])===null||r===void 0?void 0:r[n])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,n){const i=this.getHeaderTreeNode(e,n);return i?{...i.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=Nt(fi,this).getNode(e,n);return i||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let r=!1,s=null;for(let o=e;o<=n;o++){const a=Nt(fi,this).getRootByColumn(o);if(!a)break;r=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=i&&u>=e&&u+h-1<=n&&(s===null||c<s)&&(s=c)},bB)}return r&&s===null?-1:this.levelToRowCoords(s??0)}findLeftMostColumnIndex(e,n){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0};if(r)return n;let s=n-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,n){var i;const{isRoot:r,origColspan:s}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return n+s-1;let o=n+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return Nt(us,this).getLayersCount()}getColumnsCount(){return Nt(us,this).getColumnsCount()}clear(){Zh(wl,this,[]),Nt(us,this).clear(),Nt(fi,this).clear()}}function Qh(t,e,n){return(e=Xue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xue(t){var e=Zue(t,"string");return typeof e=="symbol"?e:e+""}function Zue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Que{constructor(e,n){Qh(this,"hot",void 0),Qh(this,"nestedHeaderSettingsGetter",void 0),Qh(this,"layersCount",0),Qh(this,"container",void 0),Qh(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),i=n.length;this.widthsMap.clear();for(let r=0;r<i;r++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(o,n[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:i}=this.hot,r=n.createDocumentFragment(),s=n.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=i.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;o&&(g+='<button class="changeType"></button>'),ru(d,g),d.colSpan=f.colspan,u.appendChild(d)}}s.appendChild(u)}r.appendChild(s),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}function Jue(t,e){xB(t,e),e.add(t)}function yN(t,e,n){return(e=ece(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ece(t){var e=tce(t,"string");return typeof e=="symbol"?e:e+""}function tce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jh(t,e,n){xB(t,e),e.set(t,n)}function xB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wo(t,e,n){return t.set(kt(t,e),n),n}function $e(t,e){return t.get(kt(t,e))}function kt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const CN="nestedHeaders",nce=280;var ut=new WeakMap,Go=new WeakMap,zd=new WeakMap,Ev=new WeakMap,gw=new WeakMap,jt=new WeakSet;class ice extends Ye{constructor(){super(...arguments),Jue(this,jt),Jh(this,ut,new Kue),Jh(this,Go,null),Jh(this,zd,null),Jh(this,Ev,!1),Jh(this,gw,null),yN(this,"ghostTable",new Que(this.hot,(e,n)=>this.getHeaderSettings(e,n))),yN(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return CN}static get PLUGIN_PRIORITY(){return nce}isEnabled(){return!!this.hot.getSettings()[CN]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Je(ot`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>kt(jt,this,yce).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,Cce).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,ace).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,lce).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,uce).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,cce).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,hce).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,dce).call(e,...r)}),this.addHook("afterSelection",()=>kt(jt,this,Em).call(this)),this.addHook("afterSelectionFocusSet",()=>kt(jt,this,Em).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,rce).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>kt(jt,this,gce).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,pce).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,wce).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,sce).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,oce).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,fce).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,mce).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return kt(jt,e,vce).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>kt(jt,this,Em).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>kt(jt,this,Em).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();$e(ut,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=$e(ut,this).setState(e)),this.detectedOverlappedHeaders&&Je(ot`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,i)=>{const r=n===!0?"hide-column":"show-column";$e(ut,this).triggerColumnModification(r,i)}),!$e(Go,this)&&this.enabled&&wo(Go,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(i=>{let{op:r,index:s,newValue:o}=i;if(r==="replace"){const a=o===!0?"hide-column":"show-column";$e(ut,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),$e(ut,this).clear(),$e(Go,this).unsubscribe(),wo(Go,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return $e(ut,this)}getLayersCount(){return $e(ut,this).getLayersCount()}getHeaderSettings(e,n){return $e(ut,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<n;o++){const a=i.childNodes[o];if(!a)break;const l=r.childNodes[o],u=s?s.childNodes[o]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),me(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),me(l.childNodes[c],"hiddenHeader")),s&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),me(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(r);u===null&&(u=r),s.removeAttribute("colspan"),me(s,"hiddenHeader"),me(s,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(o=$e(ut,this).getHeaderSettings(e,u))!==null&&o!==void 0?o:{};if(d||h)K(s,"hiddenHeader");else if(c>1){var g,m,v;const{wtOverlays:S}=l._wt,y=(g=S.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(s),M=(m=S.inlineStartOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s);((v=S.topOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(s))&&u<i&&K(s,"hiddenHeaderText");const P=y||M?Math.min(c,i-r):c;P>1&&s.setAttribute("colspan",P)}if(this.hot.view.appendColHeader(u,s,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const S=s.querySelector("div.relative");S&&f&&f.length>0&&(me(S,this.hot.getColumnMeta(u).headerClassName),K(S,f))}}}getColumnHeaderValue(e,n){var i;const{isHidden:r,isPlaceholder:s}=(i=$e(ut,this).getHeaderSettings(n,e))!==null&&i!==void 0?i:{};return s||r?"":this.hot.getColHeader(e,n)}destroy(){wo(ut,this,null),$e(Go,this)!==null&&($e(Go,this).unsubscribe(),wo(Go,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return $e(ut,this).getHeaderTreeNodeData(e.row,e.col)}}function Em(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const r=$e(ut,this).findLeftMostColumnIndex(n.row,n.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=r,s.visualCellRange.from.col=r,s.visualCellRange.to.col=r,s.commit()}}function rce(t,e){var n;const i=this.hot.getSelectedRangeLast();if(!i)return t;const{highlight:r}=i,{navigableHeaders:s}=this.hot.getSettings(),o=this.hot.selection.isSelectedByColumnHeader(),a=s?r.row:(n=$e(gw,this))===null||n===void 0?void 0:n.row,l=o?t:r.col,u=a<0&&l>=0;if(wo(gw,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=$e(ut,this).findLeftMostColumnIndex(a,l),g=$e(ut,this).findRightMostColumnIndex(a,l),m=g-f+1;if(f<c&&g>h)return f;if(o){let v=null;return f>=c&&g>h?m>d?(e.value="start",v=f):(e.value="end",v=g):f<c&&g<=h&&(m>d?(e.value="end",v=g):(e.value="start",v=f)),v}return f<=c?f:g}function sce(t,e,n){const i=$e(ut,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:r,selectionType:s,selectionWidth:o}=n,{isRoot:a,colspan:l}=$e(ut,this).getHeaderSettings(e,t);if(s===ME){if(!a)return i.columnIndex}else if(s===M$&&(l>o-r||!a))return null;return t}function oce(t,e,n){let{columnHeadersCount:i}=n;if(i!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:u}=e[s],c=l-o+1,h=a-u+1;if(o>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=o;f<=l;f++){var r;const g=c+f,m=d-a;if(m===0)continue;((r=$e(ut,this).getHeaderTreeNodeData(f,d))===null||r===void 0?void 0:r.isRoot)===!1&&(t[g][m]="")}}}function ace(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function lce(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;wo(zd,this,e.clone()),wo(Ev,this,!0);const{selection:i}=this.hot,r=i.isSelected()?i.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=n,l=!i.inInSelection(e);t.shiftKey&&r?e.col<r.from.col?s.push(r.getTopEndCorner().col,o,e.row):e.col>r.from.col?s.push(r.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(qw(t)||_a(t)&&l||n$(t))&&s.push(o,o+a-1,e.row),i.selectColumns(...s)}function uce(t,e,n,i){if(!this.hot.view.isMouseDown()||i.column)return;const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;const{columnIndex:s,origColspan:o}=r,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;i.column=!0,i.cell=!0;const h=[],d=je(e.row,-1/0,-1);e.col<c.col?h.push(u.col,s,d):e.col>c.col?h.push(l.col,s+o-1,d):h.push(s,s+o-1,d),this.hot.selection.selectColumns(...h)}function cce(){wo(Ev,this,!1)}function hce(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!$e(Ev,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:r,origColspan:s}=$e(ut,this).getHeaderTreeNodeData($e(zd,this).row,$e(zd,this).col);if(e.setHighlight($e(zd,this)),s>e.getWidth()||r<n||r+s-1>i){const o=$e(ut,this).findTopMostEntireHeaderLevel(je(n,r,r+s-1),je(i,r,r+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function dce(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const r=$e(ut,this).findLeftMostColumnIndex(n.row,n.col),s=$e(ut,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const o=e.col>=r&&e.col<=s?r-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const o=e.col>=r&&e.col<=s?s+1:r,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function fce(t,e,n){const i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),s=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});wo(gw,this,n.clone()),e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function gce(t){if($e(ut,this).getLayersCount()>0){t.length=0;for(let e=0;e<$e(ut,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function mce(t){const e=$e(ut,this).getLayersCount();let n=t.startColumn,i=!!e;for(let r=0;r<e;r++){const s=$e(ut,this).findLeftMostColumnIndex(r,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(i=!1),Bn(o)&&o<t.startColumn){n=o;break}}t.startColumn=i?$e(ut,this).getHeaderTreeNodeData(0,n).columnIndex:n}function pce(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function wce(t,e,n){var i;const{label:r}=(i=$e(ut,this).getHeaderTreeNodeData(n,e))!==null&&i!==void 0?i:{label:""};return r}function vce(t,e){if(t<0)return this.hot.getCell(t,$e(ut,this).findLeftMostColumnIndex(t,e),!0)}function yce(){this.updatePlugin()}function Cce(t,e){e||this.updatePlugin()}function ed(t,e,n){return(e=bce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bce(t){var e=Sce(t,"string");return typeof e=="symbol"?e:e+""}function Sce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rce{constructor(e,n){ed(this,"hot",void 0),ed(this,"data",null),ed(this,"plugin",void 0),ed(this,"parentReference",new WeakMap),ed(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},de(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,i){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&A(e.__children,r=>{this.cacheNode(r,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,i,r){let s=!1,o=n;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),i!=null&&o===i?{result:a,end:!0}:r!=null&&a===r?{result:o,end:!0}:(o+=1,a.__children&&A(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,i,r),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return He(this.data[0],(n,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(A(i.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let i=n;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),i||(i=this.mockNode()),s.__children.push(i),this.rewriteCache();const o=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,n,i){let r=i,s;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[n]);r=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,r,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),s=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(r,s+1,null);break;case"above":this.addChildAtIndex(r,s,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(de(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);r.push(this.getDataObject(f))}),de(0,r.length-2,d=>{this.detachFromParent(r[d],!1)}),i=r[r.length-1]):i=e;const s=this.getRowIndex(i),o=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,o+1,this.plugin.pluginName),u.__children.push(i)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),n&&this.hot.render()}filterData(e,n,i){const r=[];A(i,s=>{r.push(this.getDataObject(s))}),A(r,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,n,i){const r=this.getDataObject(e-1);let s=null,o=e;r&&r.__children&&r.__children.length===0?(s=r,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?i?s.__children.splice(o,n,...i):s.__children.splice(o,n):i?this.data.splice(o,n,...i):this.data.splice(o,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,i=n;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,i,r){const s=n===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),u=e>n;let c=s?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=s||i||r?c.__children.length:this.getRowIndexWithinParent(n),d=o===c;c.__children.splice(h,0,l[0]),o.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function bN(t,e,n){return(e=_ce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ce(t){var e=Ece(t,"string");return typeof e=="symbol"?e:e+""}function Ece(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ix{constructor(e,n){bN(this,"hot",void 0),bN(this,"plugin",void 0),this.hot=n,this.plugin=e}}class ys extends ix{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const i=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(i),s=this.dataManager.getDataObject(i),o=n.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(A(l,c=>{c&&o.removeChild(c)}),K(n,ys.CSS_CLASSES.indicatorContainer),r){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);o.innerHTML="",de(0,r-1,()=>{const d=c.createElement("SPAN");K(d,ys.CSS_CLASSES.emptyIndicator),o.appendChild(d)}),o.appendChild(h)}if(this.dataManager.hasChildren(s)){const c=this.hot.rootDocument.createElement("DIV");u&&ve(c,[nu()]),K(n,ys.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(K(c,`${ys.CSS_CLASSES.button} ${ys.CSS_CLASSES.expandButton}`),u&&ve(n,[lr(!1)])):(K(c,`${ys.CSS_CLASSES.button} ${ys.CSS_CLASSES.collapseButton}`),u&&ve(n,[lr(!0)])),o.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let i=11;this.hot.stylesHandler.isClassicTheme()||(i=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class Tce extends ix{constructor(e,n){var i;super(e,n),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),A(i.lastCollapsedRows,(a,l)=>{a>=r&&a<s&&(i.lastCollapsedRows[l]=a+o)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,s)=>{de(r,r+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&A(s.__children,l=>{r.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(r,!0,!1),i&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];A(e,s=>{r.push(...this.collapseChildren(s,!1,!1))}),i&&this.trimRows(r),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return A(e,s=>{r.push(s),n&&this.collapseChildRows(s,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);A(r.__children,s=>{const o=this.dataManager.getRowIndex(s);n.push(o),this.collapseChildRows(o,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return A(e,s=>{r.push(s),n&&this.expandChildRows(s,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);A(r.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);n.push(o),this.expandChildRows(o,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&A(s.__children,l=>{const u=this.dataManager.getRowIndex(l);r.push(u)}),a=this.expandRows(r,!0,!1),i&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];A(e,s=>{r.push(...this.expandChildren(s,!1,!1))}),i&&this.untrimRows(r),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];A(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];A(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{A(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{A(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&A(n.__children,r=>{const s=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return i=!1,!1}),i}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const i=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const i=this.translateTrimmedRow(n.row);ye(e.target,ys.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),wr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Mce(t,e,n){xce(t,e),e.set(t,n)}function xce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pce(t,e,n){return(e=Ice(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ice(t){var e=Oce(t,"string");return typeof e=="symbol"?e:e+""}function Oce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ace(t,e){return t.get(Hce(t,e))}function Hce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var SN=new WeakMap;class Dce extends ix{constructor(){super(...arguments),Pce(this,"dataManager",this.plugin.dataManager),Mce(this,SN,{row_above:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(xT)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(PT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return de(0,e.items.length-1,i=>{if(i===0)return A(n,(r,s)=>{e.items.splice(i+s,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return de(0,e.items.length-1,n=>{const i=Ace(SN,this)[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}function Tm(t,e,n){return(e=Nce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nce(t){var e=kce(t,"string");return typeof e=="symbol"?e:e+""}function kce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lce{constructor(e){Tm(this,"plugin",void 0),Tm(this,"hot",void 0),Tm(this,"dataManager",void 0),Tm(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const o=i===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let l=!0;const u=e.map(g=>{if(!l)return!1;const m=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(m,a),m}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(o,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,r,r&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:i,dropIndex:r,movePossible:s}=e;let o=!1;return Mt(r)&&(Je(ot`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,i,r,s,!1),o=!0),o}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}shiftCollapsibleParentsLocations(e,n,i){i||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,i){const r=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,n,this.movedToCollapsed,r)})})}moveCellsMeta(e,n){const i=[],r=Math.max(...e)<n;e.forEach(s=>{i.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(r?i.length:0),0,...i)}selectCells(e,n){const i=e.length;let r=0,s=0;if(this.movedToCollapsed){let o=null;e[i-1]<n?o=this.dataManager.translateTrimmedRow(n-i):o=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(o===null?this.hot.countSourceRows()-1:o-1),l=this.dataManager.getRowIndex(a);r=this.dataManager.untranslateTrimmedRow(l),s=r}else e[i-1]<n?(s=n-1,r=s-i+1):(r=n,s=r+i-1);this.hot.selectCells([[r,0,s,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}}function Fce(t,e){PB(t,e),e.add(t)}function RN(t,e,n){PB(t,e),e.set(t,n)}function PB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bR(t,e,n){return(e=$ce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ce(t){var e=Vce(t,"string");return typeof e=="symbol"?e:e+""}function Vce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wp(t,e){return t.get(vn(t,e))}function mw(t,e,n){return t.set(vn(t,e),n),n}function vn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pw="nestedRows",Wce=300,_N=pw,Bce="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Tv=new WeakMap,Gu=new WeakMap,Rn=new WeakSet;class jce extends Ye{constructor(){super(...arguments),Fce(this,Rn),bR(this,"dataManager",null),bR(this,"headersUI",null),bR(this,"collapsedRowsMap",null),RN(this,Tv,!1),RN(this,Gu,!1)}static get PLUGIN_KEY(){return pw}static get PLUGIN_PRIORITY(){return Wce}isEnabled(){return!!this.hot.getSettings()[pw]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new jf),this.dataManager=new Rce(this,this.hot),this.collapsingUI=new Tce(this,this.hot),this.headersUI=new ys(this,this.hot),this.contextMenuUI=new Dce(this,this.hot),this.rowMoveController=new Lce(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,ihe).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,rhe).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,Yce).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,Gce).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,qce).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,Uce).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,Zce).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,Xce).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,Qce).call(e,...i)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,Jce).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,ehe).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,the).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,Kce).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,nhe).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vn(Rn,e,zce).call(e,...i)}),this.addHook("beforeLoadData",n=>vn(Rn,this,EN).call(this,n)),this.addHook("beforeUpdateData",n=>vn(Rn,this,EN).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:_N,relativeToGroup:Ha,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_N)}disableCoreAPIModifiers(){mw(Gu,this,!0)}enableCoreAPIModifiers(){mw(Gu,this,!1)}onModifyRowData(e){if(!wp(Gu,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!wp(Gu,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,i){return wp(Gu,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,i),!1)}destroy(){super.destroy()}}function zce(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function Uce(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Yce(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),mw(Tv,this,!0),this.dataManager.getData().slice()}function Gce(t){return this.contextMenuUI.appendOptions(t)}function qce(t,e){this.headersUI.appendLevelIndicators(t,e)}function Kce(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Xce(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{mw(Tv,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Zce(t,e,n){const i=Array.from(n.reduce((r,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return r.add(s),Array.isArray(o)&&o.forEach(a=>r.add(this.dataManager.getRowIndex(a))),r}return r.add(s)},new Set));n.length=0,n.push(...i)}function Qce(){this.collapsingUI.collapsedRowsStash.stash()}function Jce(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function ehe(){this.collapsingUI.collapsedRowsStash.stash()}function the(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function nhe(){this.dataManager.rewriteCache()}function ihe(){this.headersUI.updateRowHeaderWidth()}function rhe(t,e){wp(Tv,this)&&(e.skipRender=!0)}function EN(t){if(!k$(t)){mE(Bce),this.hot.getSettings()[pw]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function SR(t,e,n){return(e=she(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function she(t){var e=ohe(t,"string");return typeof e=="symbol"?e:e+""}function ohe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ahe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;SR(this,"rootWindow",void 0),SR(this,"prefix",void 0),SR(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const i=typeof e>"u"?n:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){A(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function lhe(t,e,n){return(e=uhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uhe(t){var e=che(t,"string");return typeof e=="symbol"?e:e+""}function che(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}re.getSingleton().register("persistentStateSave");re.getSingleton().register("persistentStateLoad");re.getSingleton().register("persistentStateReset");const TN="persistentState",hhe=0;class dhe extends Ye{constructor(){super(...arguments),lhe(this,"storage",void 0)}static get PLUGIN_KEY(){return TN}static get PLUGIN_PRIORITY(){return hhe}isEnabled(){return!!this.hot.getSettings()[TN]}enablePlugin(){this.enabled||(this.storage||(this.storage=new ahe(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function fhe(t,e){ghe(t,e),e.add(t)}function ghe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RR(t,e,n){return(e=mhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mhe(t){var e=phe(t,"string");return typeof e=="symbol"?e:e+""}function phe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _R="search",whe=190,vhe="htSearchResult",yhe=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},Che=function(t,e,n){return Mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Mt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var ER=new WeakSet;class bhe extends Ye{constructor(){super(...arguments),fhe(this,ER),RR(this,"callback",yhe),RR(this,"queryMethod",Che),RR(this,"searchResultClass",vhe)}static get PLUGIN_KEY(){return _R}static get PLUGIN_PRIORITY(){return whe}isEnabled(){return this.hot.getSettings()[_R]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[_R];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return MN(ER,e,xN).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return MN(ER,e,xN).call(e,...r)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return de(0,r-1,l=>{de(0,s-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||i)(e,c,h);if(g){const m={row:l,col:u,data:c};o.push(m)}d&&d(a,l,u,c,g)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ae(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function xN(t,e,n,i,r,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function Mm(t,e,n){return(e=She(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function She(t){var e=Rhe(t,"string");return typeof e=="symbol"?e:e+""}function Rhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IB{constructor(e){Mm(this,"viewportWidth",void 0),Mm(this,"overwriteColumnWidthFn",void 0),Mm(this,"baseWidths",new Map),Mm(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class _he extends IB{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,r=[],s=[];let o=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*i),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=Ec?(r.push([d,g]),a+=g):f!==g&&(r.push([d,g]),s.push(d),o-=g)}),o<=Ec){this.stretchedWidths.clear();return}const l=o/a;let u=-1,c=0;r.forEach((h,d)=>{let[f,g]=h,m=g;s.includes(f)||(m=Math.round(g*l)),this.stretchedWidths.set(f,m),u=f,d<r.length-1&&(c+=m)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function PN(t,e,n){Ehe(t,e),e.set(t,n)}function Ehe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TR(t,e){return t.get(OB(t,e))}function xm(t,e,n){return t.set(OB(t,e),n),n}function OB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pm=new WeakMap,td=new WeakMap;class The extends IB{constructor(){super(...arguments),PN(this,Pm,0),PN(this,td,-1)}prepare(e){super.prepare(e),xm(Pm,this,0),xm(td,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),xm(td,this,e),xm(Pm,this,n)}calculate(){if(TR(td,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,r)=>{let[,s]=r;return i+s},0),n=Math.max(this.viewportWidth-e+TR(Pm,this),0);this.stretchedWidths.set(TR(td,this),n)}}function Mhe(t,e){AB(t,e),e.add(t)}function Im(t,e,n){AB(t,e),e.set(t,n)}function AB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(t,e){return t.get(hc(t,e))}function MR(t,e,n){return t.set(hc(t,e),n),n}function hc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xhe="stretchColumns";var Fn=new WeakMap,qu=new WeakMap,xR=new WeakMap,Om=new WeakMap,nd=new WeakSet;class Phe{constructor(e){Mhe(this,nd),Im(this,Fn,void 0),Im(this,qu,void 0),Im(this,xR,new Map([["all",new _he(hc(nd,this,IN).bind(this))],["last",new The(hc(nd,this,IN).bind(this))]])),Im(this,Om,"none"),MR(Fn,this,e),MR(qu,this,zt(Fn,this).columnIndexMapper.createAndRegisterIndexMap(xhe,"physicalIndexToValue"))}useStrategy(e){MR(Om,this,zt(xR,this).has(e)?e:"none")}refreshStretching(){if(zt(Om,this)==="none"){zt(qu,this).clear();return}zt(Fn,this).batchExecution(()=>{zt(qu,this).clear();const e=zt(xR,this).get(zt(Om,this));let i=zt(Fn,this).view.getViewportWidth();hc(nd,this,Ihe).call(this)&&(i-=Cn(zt(Fn,this).rootDocument)),e.prepare({viewportWidth:i});for(let r=0;r<zt(Fn,this).countCols();r++)zt(Fn,this).columnIndexMapper.isHidden(zt(Fn,this).toPhysicalColumn(r))||e.setColumnBaseWidth(r,hc(nd,this,Ohe).call(this,r));e.calculate(),e.getWidths().forEach(r=>{let[s,o]=r;zt(qu,this).setValueAtIndex(zt(Fn,this).toPhysicalColumn(s),o)})},!0)}getStretchedWidth(e){return zt(qu,this).getValueAtIndex(zt(Fn,this).toPhysicalColumn(e))}}function Ihe(){const{view:t,stylesHandler:e}=zt(Fn,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),i=zt(Fn,this).countRows(),r=e.getDefaultRowHeight();let s=0,o=!1;for(let l=0;l<i;l++){var a;if(s+=((a=zt(Fn,this).getRowHeight(l))!==null&&a!==void 0?a:r)+(l===0?1:0),s>n){o=!0;break}}return o}function Ohe(t){var e;return(e=zt(Fn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Ec}function IN(t,e){return zt(Fn,this).runHooks("beforeStretchingColumnWidth",t,e)}function Ahe(t,e){HB(t,e),e.add(t)}function PR(t,e,n){HB(t,e),e.set(t,n)}function HB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IR(t,e,n){return t.set(ww(t,e),n),n}function no(t,e){return t.get(ww(t,e))}function ww(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Hhe="stretchColumns",Dhe=155;var sc=new WeakMap,Am=new WeakMap,id=new WeakMap,OR=new WeakSet;class Nhe extends Ye{constructor(){super(...arguments),Ahe(this,OR),PR(this,sc,new Phe(this.hot)),PR(this,Am,null),PR(this,id,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:r}=i;no(Am,this)!==null&&no(Am,this)!==r.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),IR(Am,this,r.width)})})}))}static get PLUGIN_KEY(){return Hhe}static get PLUGIN_PRIORITY(){return Dhe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(no(sc,this).useStrategy(this.hot.getSettings().stretchH),no(id,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ww(OR,e,Lhe).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ww(OR,e,khe).call(e,...i)},10),super.enablePlugin())}updatePlugin(){no(sc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),no(id,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return no(sc,this).getStretchedWidth(e)}destroy(){no(id,this).disconnect(),IR(id,this,null),IR(sc,this,null),super.destroy()}}function khe(t,e,n){if(n===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function Lhe(t){t&&no(sc,this).refreshStretching()}function Fhe(t,e){$he(t,e),e.add(t)}function $he(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hm(t,e,n){return(e=Vhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vhe(t){var e=Whe(t,"string");return typeof e=="symbol"?e:e+""}function Whe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bhe="touchScroll",jhe=200;var Dm=new WeakSet;class zhe extends Ye{constructor(){super(...arguments),Fhe(this,Dm),Hm(this,"scrollbars",[]),Hm(this,"clones",[]),Hm(this,"lockedCollection",!1),Hm(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Bhe}static get PLUGIN_PRIORITY(){return jhe}static get SETTING_KEYS(){return!0}isEnabled(){return Q_()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>AR(Dm,this,Uhe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>AR(Dm,this,Yhe).call(this)),this.addHook("afterMomentumScroll",()=>AR(Dm,this,Ghe).call(this))}}function Uhe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}function Yhe(){this.freezeOverlays=!0,A(this.clones,t=>{K(t,"hide-tween")})}function Ghe(){this.freezeOverlays=!1,A(this.clones,t=>{me(t,"hide-tween"),K(t,"show-tween")}),this.hot._registerTimeout(()=>{A(this.clones,t=>{me(t,"show-tween")})},400),A(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function qhe(t,e){Khe(t,e),e.add(t)}function Khe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xhe(t,e,n){return(e=Zhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zhe(t){var e=Qhe(t,"string");return typeof e=="symbol"?e:e+""}function Qhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jhe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vp="trimRows",ede=330;var ON=new WeakSet;class tde extends Ye{constructor(){super(...arguments),qhe(this,ON),Xhe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return vp}static get PLUGIN_PRIORITY(){return ede}isEnabled(){return!!this.hot.getSettings()[vp]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new jf),this.trimmedRowsMap.addLocalHook("init",()=>Jhe(ON,this,nde).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[vp];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),A(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{A(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",n,r,i,i&&r.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;i&&o&&(A(e,l=>{s[l]=!1}),r=fn(s,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,r,i&&o)!==!1&&(i&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",n,r,i&&o,i&&r.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<n)}destroy(){super.destroy()}}function nde(){const t=this.hot.getSettings()[vp];Array.isArray(t)&&this.hot.batchExecution(()=>{A(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function ide(t,e,n){return(e=rde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rde(t){var e=sde(t,"string");return typeof e=="symbol"?e:e+""}function sde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yr{constructor(e){ide(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Nm(t,e,n){return(e=ode(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ode(t){var e=ade(t,"string");return typeof e=="symbol"?e:e+""}function ade(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rx extends yr{constructor(e){let{stateBefore:n,range:i,type:r,alignment:s}=e;super("cell_alignment"),Nm(this,"stateBefore",void 0),Nm(this,"range",void 0),Nm(this,"type",void 0),Nm(this,"alignment",void 0),this.stateBefore=n,this.range=i,this.type=r,this.alignment=s}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(i,r,s,o)=>{n.done(()=>new rx({stateBefore:i,range:r,type:s,alignment:o}))})}undo(e,n){A(this.range,i=>{i.forAll((r,s)=>{r>=0&&s>=0&&e.setCellMeta(r,s,"className",this.stateBefore[r][s]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Xo(this.range,this.type,this.alignment,(i,r)=>e.getCellMeta(i,r),(i,r,s,o)=>e.setCellMeta(i,r,s,o)),e.addHookOnce("afterViewRender",n),e.render()}}function AN(t,e,n){return(e=lde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lde(t){var e=ude(t,"string");return typeof e=="symbol"?e:e+""}function ude(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sx extends yr{constructor(e){let{columns:n,finalIndex:i}=e;super("col_move"),AN(this,"columns",void 0),AN(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(i,r)=>{i!==!1&&n.done(()=>new sx({columns:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),JM(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),i.moveColumn(a,o)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function HN(t,e,n){return(e=cde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cde(t){var e=hde(t,"string");return typeof e=="symbol"?e:e+""}function hde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ox extends yr{constructor(e){let{currentSortState:n,newSortState:i}=e;super("col_sort"),HN(this,"previousSortState",void 0),HN(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(i,r,s)=>{s&&n.done(()=>new ox({currentSortState:i,newSortState:r}))})}undo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),s=r.isEnabled()?r:i;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),n()}redo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),n()}}function DN(t,e,n){return(e=dde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dde(t){var e=fde(t,"string");return typeof e=="symbol"?e:e+""}function fde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ax extends yr{constructor(e){let{index:n,amount:i}=e;super("insert_col"),DN(this,"index",void 0),DN(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(i,r,s)=>{n.done(()=>new ax({index:i,amount:r}),s)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function NN(t,e,n){return(e=gde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gde(t){var e=mde(t,"string");return typeof e=="symbol"?e:e+""}function mde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lx extends yr{constructor(e){let{index:n,amount:i}=e;super("insert_row"),NN(this,"index",void 0),NN(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(i,r,s)=>{n.done(()=>new lx({index:i,amount:r}),s)})}undo(e,n){const i=e.countRows(),r=e.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function km(t,e,n){return(e=pde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pde(t){var e=wde(t,"string");return typeof e=="symbol"?e:e+""}function wde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ux extends yr{constructor(e){let{changes:n,selected:i,countCols:r,countRows:s}=e;super("change"),km(this,"changes",void 0),km(this,"selected",void 0),km(this,"countCols",void 0),km(this,"countRows",void 0),this.changes=n,this.selected=i,this.countCols=r,this.countRows=s}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(i,r){const s=i&&i.length;if(!s||!i.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=i.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new ux({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,r)})}undo(e,n){const i=Yn(this.changes);for(let o=0,a=i.length;o<a;o++)i[o].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(i,null,null,"UndoRedo.undo");const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const s=e.countCols()-this.countCols;s>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,s,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const i=Yn(this.changes);for(let r=0,s=i.length;r<s;r++)i[r].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function kN(t,e,n){return(e=vde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vde(t){var e=yde(t,"string");return typeof e=="symbol"?e:e+""}function yde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cx extends yr{constructor(e){let{conditionsStack:n,previousConditionsStack:i}=e;super("filter"),kN(this,"conditionsStack",void 0),kN(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=i}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(i,r)=>{n.done(()=>new cx({conditionsStack:i,previousConditionsStack:r}))})}undo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.previousConditionsStack),i.filter()}redo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.conditionsStack),i.filter()}}function Cde(t,e,n){return(e=bde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bde(t){var e=Sde(t,"string");return typeof e=="symbol"?e:e+""}function Sde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hx extends yr{constructor(e){let{data:n,cellRange:i}=e;super("merge_cells"),Cde(this,"cellRange",void 0),this.cellRange=i,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(i,r)=>{if(r)return;const s=i.getTopStartCorner(),o=i.getBottomEndCorner(),a=e.getData(s.row,s.col,o.row,o.col);n.done(()=>new hx({data:a,cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange)}}function DB(t,e,n,i,r){const s=["visualRow","visualCol","row","col","prop"],o=s.length,a=[];return de(i,r,l=>{de(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==o){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return s.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Zs(t,e,n){return(e=Rde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rde(t){var e=_de(t,"string");return typeof e=="symbol"?e:e+""}function _de(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dx extends yr{constructor(e){let{index:n,indexes:i,data:r,amount:s,headers:o,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Zs(this,"index",void 0),Zs(this,"indexes",void 0),Zs(this,"data",void 0),Zs(this,"amount",void 0),Zs(this,"headers",void 0),Zs(this,"columnPositions",void 0),Zs(this,"rowPositions",void 0),Zs(this,"fixedColumnsStart",void 0),Zs(this,"removedCellMetas",void 0),this.index=n,this.indexes=i,this.data=r,this.amount=s,this.headers=o,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(i,r,s,o)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+i)%e.countCols(),c=u+r-1,h=[],d=[],f=[];return de(l.length-1,g=>{const m=[],v=l[g];de(u,c,S=>{m.push(v[e.toPhysicalColumn(S)])}),h.push(m)}),de(r-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&de(r-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new dx({index:u,indexes:f,data:h,amount:r,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:DB(e,0,e.countRows(),u,c)})};n.done(a,o)})}undo(e,n){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),s=(c,h,d)=>d[this.indexes.indexOf(r[h])],o=this.data.length,a=[];for(let c=0;c<o;c++)a.push(Ve(this.data[c],s));const l=Ve(this.headers,s),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),A(e.getSourceDataArray(),(c,h)=>{A(r,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&A(l,(c,h)=>{e.getSettings().colHeaders[r[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Ku(t,e,n){return(e=Ede(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ede(t){var e=Tde(t,"string");return typeof e=="symbol"?e:e+""}function Tde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fx extends yr{constructor(e){let{index:n,data:i,fixedRowsBottom:r,fixedRowsTop:s,rowIndexesSequence:o,removedCellMetas:a}=e;super("remove_row"),Ku(this,"index",void 0),Ku(this,"data",void 0),Ku(this,"fixedRowsBottom",void 0),Ku(this,"fixedRowsTop",void 0),Ku(this,"rowIndexesSequence",void 0),Ku(this,"removedCellMetas",void 0),this.index=n,this.data=i,this.fixedRowsBottom=r,this.fixedRowsTop=s,this.rowIndexesSequence=o,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(i,r,s,o)=>{const a=()=>{const l=e.toPhysicalRow(i),u=l+r-1,c=Yn(e.getSourceData(l,0,l+r-1,e.countSourceCols()-1));return new fx({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:DB(e,l,u,0,e.countCols()-1)})};n.done(a,o)})}undo(e,n){const i=e.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,o)=>{Object.keys(s).forEach(a=>{const l=parseInt(a,10);r.push([this.index+o,isNaN(l)?a:l,s[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(s=>{let[o,a,l]=s;e.setCellMetaObject(o,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function LN(t,e,n){return(e=Mde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mde(t){var e=xde(t,"string");return typeof e=="symbol"?e:e+""}function xde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gx extends yr{constructor(e){let{rows:n,finalIndex:i}=e;super("row_move"),LN(this,"rows",void 0),LN(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(i,r)=>{i!==!1&&n.done(()=>new gx({rows:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),JM(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),i.moveRow(a,o)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Pde(t,e,n){return(e=Ide(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ide(t){var e=Ode(t,"string");return typeof e=="symbol"?e:e+""}function Ode(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mx extends yr{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),Pde(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(i,r)=>{r||n.done(()=>new mx({cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange,!0)}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0),e.render()}}function Ade(t,e){[rx,sx,ox,ax,lx,ux,cx,hx,dx,fx,gx,mx].forEach(n=>n.startRegisteringEvents(t,e))}function Hde(t,e){Dde(t,e),e.add(t)}function Dde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HR(t,e,n){return(e=Nde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nde(t){var e=kde(t,"string");return typeof e=="symbol"?e:e+""}function kde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const FN="undoRedo",Lde="undoRedo",Fde=1e3;re.getSingleton().register("beforeUndo");re.getSingleton().register("afterUndo");re.getSingleton().register("beforeRedo");re.getSingleton().register("afterRedo");const $N=new Set;var Lm=new WeakSet;class $de extends Ye{static get PLUGIN_KEY(){return Lde}static get PLUGIN_PRIORITY(){return Fde}static get SETTING_KEYS(){return!0}constructor(e){super(e),Hde(this,Lm),HR(this,"doneActions",[]),HR(this,"undoneActions",[]),HR(this,"ignoreNewActions",!1),Ade(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return DR(Lm,e,Vde).call(e,...i)}),this.registerShortcuts(),DR(Lm,this,Wde).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),DR(Lm,this,Bde).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),r={runOnlyIf:s=>!s.altKey,group:FN};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FN)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const r=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",r,n)===!1)return;const o=e(),a=this.undoneActions.slice();this.doneActions.push(o),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=Yn(n);if(this.hot.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const s=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",s),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=Yn(n);if(this.hot.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const s=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",s),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function Vde(t,e){e==="loadData"&&this.clear()}function Wde(){const t=e=>{$N.has(e)||(Je(ot`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),$N.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Bde(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function jde(){Ue(Pd),Ue(rJ),Ue(Id),Ue(NJ),Ue(jJ),Ue(nW),Ue(Fee),Ue(Ste),Ue(yv),Ue(Ine),Ue(nie),Ue(cie),Ue(Sv),Ue(Yie),Ue(Wse),Ue(Coe),Ue(Goe),Ue(sae),Ue(wae),Ue(xae),Ue(Fae),Ue(nle),Ue(hle),Ue(qle),Ue(Tue),Ue(Oue),Ue(ice),Ue(jce),Ue(dhe),Ue(bhe),Ue(Nhe),Ue(zhe),Ue(tde),Ue($de)}function zde(){x7(),ZZ(),oQ(),TQ(),jde()}function Ude(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const i=this.first();let r=i.data("handsontable");if(typeof n!="string"){const u=n||{};return r?r.updateSettings(u):(r=new t.Core(i[0],u),i.data("handsontable",r),r.init()),i}let s;if(r)if(typeof r[n]<"u"){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];s=r[n].call(r,...a),n==="destroy"&&i.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return s})}var NR,kR,LR,FR,$R;zde();Ude(Se);Se.__GhostTable=LM;Se._getListenersCounter=DK;Se._getRegisteredMapsCounter=$4;Se.EventManager=cr;const Yde=[dq,Kq,_4,JZ,Yq,lK,pq,t3,Uq,vq,hK,e3],Gde=[rK,dK];Se.helper={};Se.dom={};A(Yde,t=>{A(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.helper[e]=t[e])})});A(Gde,t=>{A(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.dom[e]=t[e])})});Se.cellTypes=(NR=Se.cellTypes)!==null&&NR!==void 0?NR:{};A(j6(),t=>{Se.cellTypes[t]=mM(t)});Se.cellTypes.registerCellType=Xi;Se.cellTypes.getCellType=mM;Se.editors=(kR=Se.editors)!==null&&kR!==void 0?kR:{};A(xK(),t=>{Se.editors[`${Un(t)}Editor`]=Op(t)});Se.editors.registerEditor=wi;Se.editors.getEditor=Op;Se.renderers=(LR=Se.renderers)!==null&&LR!==void 0?LR:{};A(p3(),t=>{const e=Ap(t);t==="base"&&(Se.renderers.cellDecorator=e),Se.renderers[`${Un(t)}Renderer`]=e});Se.renderers.registerRenderer=Hi;Se.renderers.getRenderer=Ap;Se.validators=(FR=Se.validators)!==null&&FR!==void 0?FR:{};A(y3(),t=>{Se.validators[`${Un(t)}Validator`]=CE(t)});Se.validators.registerValidator=Ml;Se.validators.getValidator=CE;Se.plugins=($R=Se.plugins)!==null&&$R!==void 0?$R:{};A(yE(),t=>{Se.plugins[t]=$f(t)});Se.plugins[`${Un(Ye.PLUGIN_KEY)}Plugin`]=Ye;Se.plugins.registerPlugin=Ue;Se.plugins.getPlugin=$f;/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function eg(t){return t+.5|0}const ga=(t,e,n)=>Math.max(Math.min(t,n),e);function wd(t){return ga(eg(t*2.55),0,255)}function Ca(t){return ga(eg(t*255),0,255)}function lo(t){return ga(eg(t/2.55)/100,0,1)}function VN(t){return ga(eg(t*100),0,100)}const Ki={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},i_=[..."0123456789ABCDEF"],qde=t=>i_[t&15],Kde=t=>i_[(t&240)>>4]+i_[t&15],Fm=t=>(t&240)>>4===(t&15),Xde=t=>Fm(t.r)&&Fm(t.g)&&Fm(t.b)&&Fm(t.a);function Zde(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Ki[t[1]]*17,g:255&Ki[t[2]]*17,b:255&Ki[t[3]]*17,a:e===5?Ki[t[4]]*17:255}:(e===7||e===9)&&(n={r:Ki[t[1]]<<4|Ki[t[2]],g:Ki[t[3]]<<4|Ki[t[4]],b:Ki[t[5]]<<4|Ki[t[6]],a:e===9?Ki[t[7]]<<4|Ki[t[8]]:255})),n}const Qde=(t,e)=>t<255?e(t):"";function Jde(t){var e=Xde(t)?qde:Kde;return t?"#"+e(t.r)+e(t.g)+e(t.b)+Qde(t.a,e):void 0}const efe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function NB(t,e,n){const i=e*Math.min(n,1-n),r=(s,o=(s+t/30)%12)=>n-i*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function tfe(t,e,n){const i=(r,s=(r+t/60)%6)=>n-n*e*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function nfe(t,e,n){const i=NB(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)i[r]*=1-e-n,i[r]+=e;return i}function ife(t,e,n,i,r){return t===r?(e-n)/i+(e<n?6:0):e===r?(n-t)/i+2:(t-e)/i+4}function px(t){const n=t.r/255,i=t.g/255,r=t.b/255,s=Math.max(n,i,r),o=Math.min(n,i,r),a=(s+o)/2;let l,u,c;return s!==o&&(c=s-o,u=a>.5?c/(2-s-o):c/(s+o),l=ife(n,i,r,c,s),l=l*60+.5),[l|0,u||0,a]}function wx(t,e,n,i){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,i)).map(Ca)}function vx(t,e,n){return wx(NB,t,e,n)}function rfe(t,e,n){return wx(nfe,t,e,n)}function sfe(t,e,n){return wx(tfe,t,e,n)}function kB(t){return(t%360+360)%360}function ofe(t){const e=efe.exec(t);let n=255,i;if(!e)return;e[5]!==i&&(n=e[6]?wd(+e[5]):Ca(+e[5]));const r=kB(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?i=rfe(r,s,o):e[1]==="hsv"?i=sfe(r,s,o):i=vx(r,s,o),{r:i[0],g:i[1],b:i[2],a:n}}function afe(t,e){var n=px(t);n[0]=kB(n[0]+e),n=vx(n),t.r=n[0],t.g=n[1],t.b=n[2]}function lfe(t){if(!t)return;const e=px(t),n=e[0],i=VN(e[1]),r=VN(e[2]);return t.a<255?`hsla(${n}, ${i}%, ${r}%, ${lo(t.a)})`:`hsl(${n}, ${i}%, ${r}%)`}const WN={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},BN={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function ufe(){const t={},e=Object.keys(BN),n=Object.keys(WN);let i,r,s,o,a;for(i=0;i<e.length;i++){for(o=a=e[i],r=0;r<n.length;r++)s=n[r],a=a.replace(s,WN[s]);s=parseInt(BN[o],16),t[a]=[s>>16&255,s>>8&255,s&255]}return t}let $m;function cfe(t){$m||($m=ufe(),$m.transparent=[0,0,0,0]);const e=$m[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const hfe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function dfe(t){const e=hfe.exec(t);let n=255,i,r,s;if(e){if(e[7]!==i){const o=+e[7];n=e[8]?wd(o):ga(o*255,0,255)}return i=+e[1],r=+e[3],s=+e[5],i=255&(e[2]?wd(i):ga(i,0,255)),r=255&(e[4]?wd(r):ga(r,0,255)),s=255&(e[6]?wd(s):ga(s,0,255)),{r:i,g:r,b:s,a:n}}}function ffe(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${lo(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const VR=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Xu=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function gfe(t,e,n){const i=Xu(lo(t.r)),r=Xu(lo(t.g)),s=Xu(lo(t.b));return{r:Ca(VR(i+n*(Xu(lo(e.r))-i))),g:Ca(VR(r+n*(Xu(lo(e.g))-r))),b:Ca(VR(s+n*(Xu(lo(e.b))-s))),a:t.a+n*(e.a-t.a)}}function Vm(t,e,n){if(t){let i=px(t);i[e]=Math.max(0,Math.min(i[e]+i[e]*n,e===0?360:1)),i=vx(i),t.r=i[0],t.g=i[1],t.b=i[2]}}function LB(t,e){return t&&Object.assign(e||{},t)}function jN(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Ca(t[3]))):(e=LB(t,{r:0,g:0,b:0,a:1}),e.a=Ca(e.a)),e}function mfe(t){return t.charAt(0)==="r"?dfe(t):ofe(t)}class wf{constructor(e){if(e instanceof wf)return e;const n=typeof e;let i;n==="object"?i=jN(e):n==="string"&&(i=Zde(e)||cfe(e)||mfe(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=LB(this._rgb);return e&&(e.a=lo(e.a)),e}set rgb(e){this._rgb=jN(e)}rgbString(){return this._valid?ffe(this._rgb):void 0}hexString(){return this._valid?Jde(this._rgb):void 0}hslString(){return this._valid?lfe(this._rgb):void 0}mix(e,n){if(e){const i=this.rgb,r=e.rgb;let s;const o=n===s?.5:n,a=2*o-1,l=i.a-r.a,u=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;s=1-u,i.r=255&u*i.r+s*r.r+.5,i.g=255&u*i.g+s*r.g+.5,i.b=255&u*i.b+s*r.b+.5,i.a=o*i.a+(1-o)*r.a,this.rgb=i}return this}interpolate(e,n){return e&&(this._rgb=gfe(this._rgb,e._rgb,n)),this}clone(){return new wf(this.rgb)}alpha(e){return this._rgb.a=Ca(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=eg(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Vm(this._rgb,2,e),this}darken(e){return Vm(this._rgb,2,-e),this}saturate(e){return Vm(this._rgb,1,e),this}desaturate(e){return Vm(this._rgb,1,-e),this}rotate(e){return afe(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */const pfe=(()=>{let t=0;return()=>t++})();function xt(t){return t==null}function Pn(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function ct(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function hr(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function cs(t,e){return hr(t)?t:e}function Xe(t,e){return typeof t>"u"?e:t}const wfe=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Tt(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function $n(t,e,n,i){let r,s,o;if(Pn(t))for(s=t.length,r=0;r<s;r++)e.call(n,t[r],r);else if(ct(t))for(o=Object.keys(t),s=o.length,r=0;r<s;r++)e.call(n,t[o[r]],o[r])}function zN(t,e){let n,i,r,s;if(!t||!e||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;++n)if(r=t[n],s=e[n],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function vw(t){if(Pn(t))return t.map(vw);if(ct(t)){const e=Object.create(null),n=Object.keys(t),i=n.length;let r=0;for(;r<i;++r)e[n[r]]=vw(t[n[r]]);return e}return t}function FB(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function vfe(t,e,n,i){if(!FB(t))return;const r=e[t],s=n[t];ct(r)&&ct(s)?vf(r,s,i):e[t]=vw(s)}function vf(t,e,n){const i=Pn(e)?e:[e],r=i.length;if(!ct(t))return t;n=n||{};const s=n.merger||vfe;let o;for(let a=0;a<r;++a){if(o=i[a],!ct(o))continue;const l=Object.keys(o);for(let u=0,c=l.length;u<c;++u)s(l[u],t,o,n)}return t}function Ud(t,e){return vf(t,e,{merger:yfe})}function yfe(t,e,n){if(!FB(t))return;const i=e[t],r=n[t];ct(i)&&ct(r)?Ud(i,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=vw(r))}const UN={"":t=>t,x:t=>t.x,y:t=>t.y};function Cfe(t){const e=t.split("."),n=[];let i="";for(const r of e)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}function bfe(t){const e=Cfe(t);return n=>{for(const i of e){if(i==="")break;n=n&&n[i]}return n}}function yw(t,e){return(UN[e]||(UN[e]=bfe(e)))(t)}function yx(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Cw=t=>typeof t<"u",Ma=t=>typeof t=="function",YN=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function Sfe(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const En=Math.PI,Ms=2*En,Rfe=Ms+En,bw=Number.POSITIVE_INFINITY,_fe=En/180,$r=En/2,vl=En/4,GN=En*2/3,$B=Math.log10,Oc=Math.sign;function Yd(t,e,n){return Math.abs(t-e)<n}function qN(t){const e=Math.round(t);t=Yd(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor($B(t))),i=t/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function Efe(t){const e=[],n=Math.sqrt(t);let i;for(i=1;i<n;i++)t%i===0&&(e.push(i),e.push(t/i));return n===(n|0)&&e.push(n),e.sort((r,s)=>r-s).pop(),e}function Tfe(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function yf(t){return!Tfe(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function Mfe(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function xfe(t,e,n){let i,r,s;for(i=0,r=t.length;i<r;i++)s=t[i][n],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function kl(t){return t*(En/180)}function Pfe(t){return t*(180/En)}function KN(t){if(!hr(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function Ife(t,e){const n=e.x-t.x,i=e.y-t.y,r=Math.sqrt(n*n+i*i);let s=Math.atan2(i,n);return s<-.5*En&&(s+=Ms),{angle:s,distance:r}}function XN(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Ofe(t,e){return(t-e+Rfe)%Ms-En}function Zo(t){return(t%Ms+Ms)%Ms}function VB(t,e,n,i){const r=Zo(t),s=Zo(e),o=Zo(n),a=Zo(s-r),l=Zo(o-r),u=Zo(r-s),c=Zo(r-o);return r===s||r===o||i&&s===o||a>l&&u<c}function _s(t,e,n){return Math.max(e,Math.min(n,t))}function Afe(t){return _s(t,-32768,32767)}function vd(t,e,n,i=1e-6){return t>=Math.min(e,n)-i&&t<=Math.max(e,n)+i}function Cx(t,e,n){n=n||(o=>t[o]<e);let i=t.length-1,r=0,s;for(;i-r>1;)s=r+i>>1,n(s)?r=s:i=s;return{lo:r,hi:i}}const Ll=(t,e,n,i)=>Cx(t,n,i?r=>{const s=t[r][e];return s<n||s===n&&t[r+1][e]===n}:r=>t[r][e]<n),Hfe=(t,e,n)=>Cx(t,n,i=>t[i][e]>=n);function Dfe(t,e,n){let i=0,r=t.length;for(;i<r&&t[i]<e;)i++;for(;r>i&&t[r-1]>n;)r--;return i>0||r<t.length?t.slice(i,r):t}const WB=["push","pop","shift","splice","unshift"];function Nfe(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),WB.forEach(n=>{const i="_onData"+yx(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...s){const o=r.apply(this,s);return t._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...s)}),o}})})}function ZN(t,e){const n=t._chartjs;if(!n)return;const i=n.listeners,r=i.indexOf(e);r!==-1&&i.splice(r,1),!(i.length>0)&&(WB.forEach(s=>{delete t[s]}),delete t._chartjs)}function kfe(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const BB=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function jB(t,e){let n=[],i=!1;return function(...r){n=r,i||(i=!0,BB.call(window,()=>{i=!1,t.apply(e,n)}))}}function Lfe(t,e){let n;return function(...i){return e?(clearTimeout(n),n=setTimeout(t,e,i)):t.apply(this,i),e}}const bx=t=>t==="start"?"left":t==="end"?"right":"center",Vn=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,Ffe=(t,e,n,i)=>t===(i?"left":"right")?n:t==="center"?(e+n)/2:e;function $fe(t,e,n){const i=e.length;let r=0,s=i;if(t._sorted){const{iScale:o,vScale:a,_parsed:l}=t,u=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,c=o.axis,{min:h,max:d,minDefined:f,maxDefined:g}=o.getUserBounds();if(f){if(r=Math.min(Ll(l,c,h).lo,n?i:Ll(e,c,o.getPixelForValue(h)).lo),u){const m=l.slice(0,r+1).reverse().findIndex(v=>!xt(v[a.axis]));r-=Math.max(0,m)}r=_s(r,0,i-1)}if(g){let m=Math.max(Ll(l,o.axis,d,!0).hi+1,n?0:Ll(e,c,o.getPixelForValue(d),!0).hi+1);if(u){const v=l.slice(m-1).findIndex(S=>!xt(S[a.axis]));m+=Math.max(0,v)}s=_s(m,r,i)-r}else s=i-r}return{start:r,count:s}}function Vfe(t){const{xScale:e,yScale:n,_scaleRanges:i}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!i)return t._scaleRanges=r,!0;const s=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,r),s}const Wm=t=>t===0||t===1,QN=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Ms/n)),JN=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Ms/n)+1,Gd={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*$r)+1,easeOutSine:t=>Math.sin(t*$r),easeInOutSine:t=>-.5*(Math.cos(En*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Wm(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Wm(t)?t:QN(t,.075,.3),easeOutElastic:t=>Wm(t)?t:JN(t,.075,.3),easeInOutElastic(t){return Wm(t)?t:t<.5?.5*QN(t*2,.1125,.45):.5+.5*JN(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Gd.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Gd.easeInBounce(t*2)*.5:Gd.easeOutBounce(t*2-1)*.5+.5};function Sx(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function ek(t){return Sx(t)?t:new wf(t)}function WR(t){return Sx(t)?t:new wf(t).saturate(.5).darken(.1).hexString()}const Wfe=["x","y","borderWidth","radius","tension"],Bfe=["color","borderColor","backgroundColor"];function jfe(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:Bfe},numbers:{type:"number",properties:Wfe}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function zfe(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const tk=new Map;function Ufe(t,e){e=e||{};const n=t+JSON.stringify(e);let i=tk.get(n);return i||(i=new Intl.NumberFormat(t,e),tk.set(n,i)),i}function zB(t,e,n){return Ufe(e,n).format(t)}const Yfe={values(t){return Pn(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const i=this.chart.options.locale;let r,s=t;if(n.length>1){const u=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),s=Gfe(t,n)}const o=$B(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),zB(t,i,l)}};function Gfe(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var UB={formatters:Yfe};function qfe(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:UB.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Kl=Object.create(null),r_=Object.create(null);function qd(t,e){if(!e)return t;const n=e.split(".");for(let i=0,r=n.length;i<r;++i){const s=n[i];t=t[s]||(t[s]=Object.create(null))}return t}function BR(t,e,n){return typeof e=="string"?vf(qd(t,e),n):vf(qd(t,""),e)}class Kfe{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>WR(r.backgroundColor),this.hoverBorderColor=(i,r)=>WR(r.borderColor),this.hoverColor=(i,r)=>WR(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return BR(this,e,n)}get(e){return qd(this,e)}describe(e,n){return BR(r_,e,n)}override(e,n){return BR(Kl,e,n)}route(e,n,i,r){const s=qd(this,e),o=qd(this,i),a="_"+n;Object.defineProperties(s,{[a]:{value:s[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],u=o[r];return ct(l)?Object.assign({},u,l):Xe(l,u)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var Jt=new Kfe({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[jfe,zfe,qfe]);function Xfe(t){return!t||xt(t.size)||xt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function nk(t,e,n,i,r){let s=e[r];return s||(s=e[r]=t.measureText(r).width,n.push(r)),s>i&&(i=s),i}function yl(t,e,n){const i=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*i)/i+r}function ik(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Zfe(t,e,n,i){YB(t,e,n,i,null)}function YB(t,e,n,i,r){let s,o,a,l,u,c,h,d;const f=e.pointStyle,g=e.rotation,m=e.radius;let v=(g||0)*_fe;if(f&&typeof f=="object"&&(s=f.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){t.save(),t.translate(n,i),t.rotate(v),t.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),t.restore();return}if(!(isNaN(m)||m<=0)){switch(t.beginPath(),f){default:r?t.ellipse(n,i,r/2,m,0,0,Ms):t.arc(n,i,m,0,Ms),t.closePath();break;case"triangle":c=r?r/2:m,t.moveTo(n+Math.sin(v)*c,i-Math.cos(v)*m),v+=GN,t.lineTo(n+Math.sin(v)*c,i-Math.cos(v)*m),v+=GN,t.lineTo(n+Math.sin(v)*c,i-Math.cos(v)*m),t.closePath();break;case"rectRounded":u=m*.516,l=m-u,o=Math.cos(v+vl)*l,h=Math.cos(v+vl)*(r?r/2-u:l),a=Math.sin(v+vl)*l,d=Math.sin(v+vl)*(r?r/2-u:l),t.arc(n-h,i-a,u,v-En,v-$r),t.arc(n+d,i-o,u,v-$r,v),t.arc(n+h,i+a,u,v,v+$r),t.arc(n-d,i+o,u,v+$r,v+En),t.closePath();break;case"rect":if(!g){l=Math.SQRT1_2*m,c=r?r/2:l,t.rect(n-c,i-l,2*c,2*l);break}v+=vl;case"rectRot":h=Math.cos(v)*(r?r/2:m),o=Math.cos(v)*m,a=Math.sin(v)*m,d=Math.sin(v)*(r?r/2:m),t.moveTo(n-h,i-a),t.lineTo(n+d,i-o),t.lineTo(n+h,i+a),t.lineTo(n-d,i+o),t.closePath();break;case"crossRot":v+=vl;case"cross":h=Math.cos(v)*(r?r/2:m),o=Math.cos(v)*m,a=Math.sin(v)*m,d=Math.sin(v)*(r?r/2:m),t.moveTo(n-h,i-a),t.lineTo(n+h,i+a),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o);break;case"star":h=Math.cos(v)*(r?r/2:m),o=Math.cos(v)*m,a=Math.sin(v)*m,d=Math.sin(v)*(r?r/2:m),t.moveTo(n-h,i-a),t.lineTo(n+h,i+a),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o),v+=vl,h=Math.cos(v)*(r?r/2:m),o=Math.cos(v)*m,a=Math.sin(v)*m,d=Math.sin(v)*(r?r/2:m),t.moveTo(n-h,i-a),t.lineTo(n+h,i+a),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o);break;case"line":o=r?r/2:Math.cos(v)*m,a=Math.sin(v)*m,t.moveTo(n-o,i-a),t.lineTo(n+o,i+a);break;case"dash":t.moveTo(n,i),t.lineTo(n+Math.cos(v)*(r?r/2:m),i+Math.sin(v)*m);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function Cf(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function Rx(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function _x(t){t.restore()}function Qfe(t,e,n,i,r){if(!e)return t.lineTo(n.x,n.y);if(r==="middle"){const s=(e.x+n.x)/2;t.lineTo(s,e.y),t.lineTo(s,n.y)}else r==="after"!=!!i?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function Jfe(t,e,n,i){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function ege(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),xt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function tge(t,e,n,i,r){if(r.strikethrough||r.underline){const s=t.measureText(i),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,l=n-s.actualBoundingBoxAscent,u=n+s.actualBoundingBoxDescent,c=r.strikethrough?(l+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,c),t.lineTo(a,c),t.stroke()}}function nge(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function bf(t,e,n,i,r,s={}){const o=Pn(e)?e:[e],a=s.strokeWidth>0&&s.strokeColor!=="";let l,u;for(t.save(),t.font=r.string,ege(t,s),l=0;l<o.length;++l)u=o[l],s.backdrop&&nge(t,s.backdrop),a&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),xt(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(u,n,i,s.maxWidth)),t.fillText(u,n,i,s.maxWidth),tge(t,n,i,u,s),i+=Number(r.lineHeight);t.restore()}function ige(t,e){const{x:n,y:i,w:r,h:s,radius:o}=e;t.arc(n+o.topLeft,i+o.topLeft,o.topLeft,1.5*En,En,!0),t.lineTo(n,i+s-o.bottomLeft),t.arc(n+o.bottomLeft,i+s-o.bottomLeft,o.bottomLeft,En,$r,!0),t.lineTo(n+r-o.bottomRight,i+s),t.arc(n+r-o.bottomRight,i+s-o.bottomRight,o.bottomRight,$r,0,!0),t.lineTo(n+r,i+o.topRight),t.arc(n+r-o.topRight,i+o.topRight,o.topRight,0,-$r,!0),t.lineTo(n+o.topLeft,i)}const rge=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,sge=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function oge(t,e){const n=(""+t).match(rge);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const age=t=>+t||0;function GB(t,e){const n={},i=ct(e),r=i?Object.keys(e):e,s=ct(t)?i?o=>Xe(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)n[o]=age(s(o));return n}function lge(t){return GB(t,{top:"y",right:"x",bottom:"y",left:"x"})}function uge(t){return GB(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Eo(t){const e=lge(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function vo(t,e){t=t||{},e=e||Jt.font;let n=Xe(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let i=Xe(t.style,e.style);i&&!(""+i).match(sge)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const r={family:Xe(t.family,e.family),lineHeight:oge(Xe(t.lineHeight,e.lineHeight),n),size:n,style:i,weight:Xe(t.weight,e.weight),string:""};return r.string=Xfe(r),r}function Bm(t,e,n,i){let r,s,o;for(r=0,s=t.length;r<s;++r)if(o=t[r],o!==void 0&&o!==void 0)return o}function cge(t,e,n){const{min:i,max:r}=t,s=wfe(e,(r-i)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(i,-Math.abs(s)),max:o(r,s)}}function Xc(t,e){return Object.assign(Object.create(t),e)}function Ex(t,e=[""],n,i,r=()=>t[0]){const s=n||t;typeof i>"u"&&(i=ZB("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:s,_fallback:i,_getTarget:r,override:a=>Ex([a,...t],e,s,i)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return KB(a,l,()=>vge(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return sk(a).includes(l)},ownKeys(a){return sk(a)},set(a,l,u){const c=a._storage||(a._storage=r());return a[l]=c[l]=u,delete a._keys,!0}})}function Ac(t,e,n,i){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:qB(t,i),setContext:s=>Ac(t,s,n,i),override:s=>Ac(t.override(s),e,n,i)};return new Proxy(r,{deleteProperty(s,o){return delete s[o],delete t[o],!0},get(s,o,a){return KB(s,o,()=>dge(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(s,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(s,o,a){return t[o]=a,delete s[o],!0}})}function qB(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:i=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:i,isScriptable:Ma(n)?n:()=>n,isIndexable:Ma(i)?i:()=>i}}const hge=(t,e)=>t?t+yx(e):e,Tx=(t,e)=>ct(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function KB(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const i=n();return t[e]=i,i}function dge(t,e,n){const{_proxy:i,_context:r,_subProxy:s,_descriptors:o}=t;let a=i[e];return Ma(a)&&o.isScriptable(e)&&(a=fge(e,a,t,n)),Pn(a)&&a.length&&(a=gge(e,a,t,o.isIndexable)),Tx(e,a)&&(a=Ac(a,r,s&&s[e],o)),a}function fge(t,e,n,i){const{_proxy:r,_context:s,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(s,o||i);return a.delete(t),Tx(t,l)&&(l=Mx(r._scopes,r,t,l)),l}function gge(t,e,n,i){const{_proxy:r,_context:s,_subProxy:o,_descriptors:a}=n;if(typeof s.index<"u"&&i(t))return e[s.index%e.length];if(ct(e[0])){const l=e,u=r._scopes.filter(c=>c!==l);e=[];for(const c of l){const h=Mx(u,r,t,c);e.push(Ac(h,s,o&&o[t],a))}}return e}function XB(t,e,n){return Ma(t)?t(e,n):t}const mge=(t,e)=>t===!0?e:typeof t=="string"?yw(e,t):void 0;function pge(t,e,n,i,r){for(const s of e){const o=mge(n,s);if(o){t.add(o);const a=XB(o._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==i)return a}else if(o===!1&&typeof i<"u"&&n!==i)return null}return!1}function Mx(t,e,n,i){const r=e._rootScopes,s=XB(e._fallback,n,i),o=[...t,...r],a=new Set;a.add(i);let l=rk(a,o,n,s||n,i);return l===null||typeof s<"u"&&s!==n&&(l=rk(a,o,s,l,i),l===null)?!1:Ex(Array.from(a),[""],r,s,()=>wge(e,n,i))}function rk(t,e,n,i,r){for(;n;)n=pge(t,e,n,i,r);return n}function wge(t,e,n){const i=t._getTarget();e in i||(i[e]={});const r=i[e];return Pn(r)&&ct(n)?n:r||{}}function vge(t,e,n,i){let r;for(const s of e)if(r=ZB(hge(s,t),n),typeof r<"u")return Tx(t,r)?Mx(n,i,t,r):r}function ZB(t,e){for(const n of e){if(!n)continue;const i=n[t];if(typeof i<"u")return i}}function sk(t){let e=t._keys;return e||(e=t._keys=yge(t._scopes)),e}function yge(t){const e=new Set;for(const n of t)for(const i of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(i);return Array.from(e)}const Cge=Number.EPSILON||1e-14,Hc=(t,e)=>e<t.length&&!t[e].skip&&t[e],QB=t=>t==="x"?"y":"x";function bge(t,e,n,i){const r=t.skip?e:t,s=e,o=n.skip?e:n,a=XN(s,r),l=XN(o,s);let u=a/(a+l),c=l/(a+l);u=isNaN(u)?0:u,c=isNaN(c)?0:c;const h=i*u,d=i*c;return{previous:{x:s.x-h*(o.x-r.x),y:s.y-h*(o.y-r.y)},next:{x:s.x+d*(o.x-r.x),y:s.y+d*(o.y-r.y)}}}function Sge(t,e,n){const i=t.length;let r,s,o,a,l,u=Hc(t,0);for(let c=0;c<i-1;++c)if(l=u,u=Hc(t,c+1),!(!l||!u)){if(Yd(e[c],0,Cge)){n[c]=n[c+1]=0;continue}r=n[c]/e[c],s=n[c+1]/e[c],a=Math.pow(r,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),n[c]=r*o*e[c],n[c+1]=s*o*e[c])}}function Rge(t,e,n="x"){const i=QB(n),r=t.length;let s,o,a,l=Hc(t,0);for(let u=0;u<r;++u){if(o=a,a=l,l=Hc(t,u+1),!a)continue;const c=a[n],h=a[i];o&&(s=(c-o[n])/3,a[`cp1${n}`]=c-s,a[`cp1${i}`]=h-s*e[u]),l&&(s=(l[n]-c)/3,a[`cp2${n}`]=c+s,a[`cp2${i}`]=h+s*e[u])}}function _ge(t,e="x"){const n=QB(e),i=t.length,r=Array(i).fill(0),s=Array(i);let o,a,l,u=Hc(t,0);for(o=0;o<i;++o)if(a=l,l=u,u=Hc(t,o+1),!!l){if(u){const c=u[e]-l[e];r[o]=c!==0?(u[n]-l[n])/c:0}s[o]=a?u?Oc(r[o-1])!==Oc(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}Sge(t,r,s),Rge(t,s,e)}function jm(t,e,n){return Math.max(Math.min(t,n),e)}function Ege(t,e){let n,i,r,s,o,a=Cf(t[0],e);for(n=0,i=t.length;n<i;++n)o=s,s=a,a=n<i-1&&Cf(t[n+1],e),s&&(r=t[n],o&&(r.cp1x=jm(r.cp1x,e.left,e.right),r.cp1y=jm(r.cp1y,e.top,e.bottom)),a&&(r.cp2x=jm(r.cp2x,e.left,e.right),r.cp2y=jm(r.cp2y,e.top,e.bottom)))}function Tge(t,e,n,i,r){let s,o,a,l;if(e.spanGaps&&(t=t.filter(u=>!u.skip)),e.cubicInterpolationMode==="monotone")_ge(t,r);else{let u=i?t[t.length-1]:t[0];for(s=0,o=t.length;s<o;++s)a=t[s],l=bge(u,a,t[Math.min(s+1,o-(i?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,u=a}e.capBezierPoints&&Ege(t,n)}function xx(){return typeof window<"u"&&typeof document<"u"}function Px(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Sw(t,e,n){let i;return typeof t=="string"?(i=parseInt(t,10),t.indexOf("%")!==-1&&(i=i/100*e.parentNode[n])):i=t,i}const Mv=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function Mge(t,e){return Mv(t).getPropertyValue(e)}const xge=["top","right","bottom","left"];function Vl(t,e,n){const i={};n=n?"-"+n:"";for(let r=0;r<4;r++){const s=xge[r];i[s]=parseFloat(t[e+"-"+s+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const Pge=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function Ige(t,e){const n=t.touches,i=n&&n.length?n[0]:t,{offsetX:r,offsetY:s}=i;let o=!1,a,l;if(Pge(r,s,t.target))a=r,l=s;else{const u=e.getBoundingClientRect();a=i.clientX-u.left,l=i.clientY-u.top,o=!0}return{x:a,y:l,box:o}}function _l(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:i}=e,r=Mv(n),s=r.boxSizing==="border-box",o=Vl(r,"padding"),a=Vl(r,"border","width"),{x:l,y:u,box:c}=Ige(t,n),h=o.left+(c&&a.left),d=o.top+(c&&a.top);let{width:f,height:g}=e;return s&&(f-=o.width+a.width,g-=o.height+a.height),{x:Math.round((l-h)/f*n.width/i),y:Math.round((u-d)/g*n.height/i)}}function Oge(t,e,n){let i,r;if(e===void 0||n===void 0){const s=t&&Px(t);if(!s)e=t.clientWidth,n=t.clientHeight;else{const o=s.getBoundingClientRect(),a=Mv(s),l=Vl(a,"border","width"),u=Vl(a,"padding");e=o.width-u.width-l.width,n=o.height-u.height-l.height,i=Sw(a.maxWidth,s,"clientWidth"),r=Sw(a.maxHeight,s,"clientHeight")}}return{width:e,height:n,maxWidth:i||bw,maxHeight:r||bw}}const zm=t=>Math.round(t*10)/10;function Age(t,e,n,i){const r=Mv(t),s=Vl(r,"margin"),o=Sw(r.maxWidth,t,"clientWidth")||bw,a=Sw(r.maxHeight,t,"clientHeight")||bw,l=Oge(t,e,n);let{width:u,height:c}=l;if(r.boxSizing==="content-box"){const d=Vl(r,"border","width"),f=Vl(r,"padding");u-=f.width+d.width,c-=f.height+d.height}return u=Math.max(0,u-s.width),c=Math.max(0,i?u/i:c-s.height),u=zm(Math.min(u,o,l.maxWidth)),c=zm(Math.min(c,a,l.maxHeight)),u&&!c&&(c=zm(u/2)),(e!==void 0||n!==void 0)&&i&&l.height&&c>l.height&&(c=l.height,u=zm(Math.floor(c*i))),{width:u,height:c}}function ok(t,e,n){const i=e||1,r=Math.floor(t.height*i),s=Math.floor(t.width*i);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==i||o.height!==r||o.width!==s?(t.currentDevicePixelRatio=i,o.height=r,o.width=s,t.ctx.setTransform(i,0,0,i,0,0),!0):!1}const Hge=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};xx()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function ak(t,e){const n=Mge(t,e),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function El(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function Dge(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:i==="middle"?n<.5?t.y:e.y:i==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function Nge(t,e,n,i){const r={x:t.cp2x,y:t.cp2y},s={x:e.cp1x,y:e.cp1y},o=El(t,r,n),a=El(r,s,n),l=El(s,e,n),u=El(o,a,n),c=El(a,l,n);return El(u,c,n)}const kge=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,i){return n-i},leftForLtr(n,i){return n-i}}},Lge=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function jR(t,e,n){return t?kge(e,n):Lge()}function Fge(t,e){let n,i;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=i)}function $ge(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function JB(t){return t==="angle"?{between:VB,compare:Ofe,normalize:Zo}:{between:vd,compare:(e,n)=>e-n,normalize:e=>e}}function lk({start:t,end:e,count:n,loop:i,style:r}){return{start:t%n,end:e%n,loop:i&&(e-t+1)%n===0,style:r}}function Vge(t,e,n){const{property:i,start:r,end:s}=n,{between:o,normalize:a}=JB(i),l=e.length;let{start:u,end:c,loop:h}=t,d,f;if(h){for(u+=l,c+=l,d=0,f=l;d<f&&o(a(e[u%l][i]),r,s);++d)u--,c--;u%=l,c%=l}return c<u&&(c+=l),{start:u,end:c,loop:h,style:t.style}}function Wge(t,e,n){if(!n)return[t];const{property:i,start:r,end:s}=n,o=e.length,{compare:a,between:l,normalize:u}=JB(i),{start:c,end:h,loop:d,style:f}=Vge(t,e,n),g=[];let m=!1,v=null,S,y,M;const I=()=>l(r,M,S)&&a(r,M)!==0,P=()=>a(s,S)===0||l(s,M,S),E=()=>m||I(),T=()=>!m||P();for(let $=c,U=c;$<=h;++$)y=e[$%o],!y.skip&&(S=u(y[i]),S!==M&&(m=l(S,r,s),v===null&&E()&&(v=a(S,r)===0?$:U),v!==null&&T()&&(g.push(lk({start:v,end:$,loop:d,count:o,style:f})),v=null),U=$,M=S));return v!==null&&g.push(lk({start:v,end:h,loop:d,count:o,style:f})),g}function Bge(t,e){const n=[],i=t.segments;for(let r=0;r<i.length;r++){const s=Wge(i[r],t.points,e);s.length&&n.push(...s)}return n}function jge(t,e,n,i){let r=0,s=e-1;if(n&&!i)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(s+=r);s>r&&t[s%e].skip;)s--;return s%=e,{start:r,end:s}}function zge(t,e,n,i){const r=t.length,s=[];let o=e,a=t[e],l;for(l=e+1;l<=n;++l){const u=t[l%r];u.skip||u.stop?a.skip||(i=!1,s.push({start:e%r,end:(l-1)%r,loop:i}),e=o=u.stop?l:null):(o=l,a.skip&&(e=l)),a=u}return o!==null&&s.push({start:e%r,end:o%r,loop:i}),s}function Uge(t,e){const n=t.points,i=t.options.spanGaps,r=n.length;if(!r)return[];const s=!!t._loop,{start:o,end:a}=jge(n,r,s,i);if(i===!0)return uk(t,[{start:o,end:a,loop:s}],n,e);const l=a<o?a+r:a,u=!!t._fullLoop&&o===0&&a===r-1;return uk(t,zge(n,o,l,u),n,e)}function uk(t,e,n,i){return!i||!i.setContext||!n?e:Yge(t,e,n,i)}function Yge(t,e,n,i){const r=t._chart.getContext(),s=ck(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=n.length,u=[];let c=s,h=e[0].start,d=h;function f(g,m,v,S){const y=a?-1:1;if(g!==m){for(g+=l;n[g%l].skip;)g-=y;for(;n[m%l].skip;)m+=y;g%l!==m%l&&(u.push({start:g%l,end:m%l,loop:v,style:S}),c=S,h=m%l)}}for(const g of e){h=a?h:g.start;let m=n[h%l],v;for(d=h+1;d<=g.end;d++){const S=n[d%l];v=ck(i.setContext(Xc(r,{type:"segment",p0:m,p1:S,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:o}))),Gge(v,c)&&f(h,d-1,g.loop,c),m=S,c=v}h<d-1&&f(h,d-1,g.loop,c)}return u}function ck(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Gge(t,e){if(!e)return!1;const n=[],i=function(r,s){return Sx(s)?(n.includes(s)||n.push(s),n.indexOf(s)):s};return JSON.stringify(t,i)!==JSON.stringify(e,i)}function Um(t,e,n){return t.options.clip?t[n]:e[n]}function qge(t,e){const{xScale:n,yScale:i}=t;return n&&i?{left:Um(n,e,"left"),right:Um(n,e,"right"),top:Um(i,e,"top"),bottom:Um(i,e,"bottom")}:e}function Kge(t,e){const n=e._clip;if(n.disabled)return!1;const i=qge(e,t.chartArea);return{left:n.left===!1?0:i.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:i.right+(n.right===!0?0:n.right),top:n.top===!1?0:i.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:i.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Xge{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,i,r){const s=n.listeners[r],o=n.duration;s.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(i-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=BB.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const s=i.items;let o=s.length-1,a=!1,l;for(;o>=0;--o)l=s[o],l._active?(l._total>i.duration&&(i.duration=l._total),l.tick(e),a=!0):(s[o]=s[s.length-1],s.pop());a&&(r.draw(),this._notify(r,i,e,"progress")),s.length||(i.running=!1,this._notify(r,i,e,"complete"),i.initial=!1),n+=s.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let i=n.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,i)),i}listen(e,n,i){this._getAnims(e).listeners[n].push(i)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const i=n.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var io=new Xge;const hk="transparent",Zge={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const i=ek(t||hk),r=i.valid&&ek(e||hk);return r&&r.valid?r.mix(i,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class Qge{constructor(e,n,i,r){const s=n[i];r=Bm([e.to,r,s,e.from]);const o=Bm([e.from,s,r]);this._active=!0,this._fn=e.fn||Zge[e.type||typeof o],this._easing=Gd[e.easing]||Gd.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=i,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,i){if(this._active){this._notify(!1);const r=this._target[this._prop],s=i-this._start,o=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=Bm([e.to,n,r,e.from]),this._from=Bm([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,i=this._duration,r=this._prop,s=this._from,o=this._loop,a=this._to;let l;if(this._active=s!==a&&(o||n<i),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=s;return}l=n/i%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(s,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,i)=>{e.push({res:n,rej:i})})}_notify(e){const n=e?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][n]()}}class Jge{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!ct(e))return;const n=Object.keys(Jt.animation),i=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const s=e[r];if(!ct(s))return;const o={};for(const a of n)o[a]=s[a];(Pn(s.properties)&&s.properties||[r]).forEach(a=>{(a===r||!i.has(a))&&i.set(a,o)})})}_animateOptions(e,n){const i=n.options,r=tme(e,i);if(!r)return[];const s=this._createAnimations(r,i);return i.$shared&&eme(e.options.$animations,i).then(()=>{e.options=i},()=>{}),s}_createAnimations(e,n){const i=this._properties,r=[],s=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const u=o[l];if(u.charAt(0)==="$")continue;if(u==="options"){r.push(...this._animateOptions(e,n));continue}const c=n[u];let h=s[u];const d=i.get(u);if(h)if(d&&h.active()){h.update(d,c,a);continue}else h.cancel();if(!d||!d.duration){e[u]=c;continue}s[u]=h=new Qge(d,e,u,c),r.push(h)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const i=this._createAnimations(e,n);if(i.length)return io.add(this._chart,i),!0}}function eme(t,e){const n=[],i=Object.keys(e);for(let r=0;r<i.length;r++){const s=t[i[r]];s&&s.active()&&n.push(s.wait())}return Promise.all(n)}function tme(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function dk(t,e){const n=t&&t.options||{},i=n.reverse,r=n.min===void 0?e:0,s=n.max===void 0?e:0;return{start:i?s:r,end:i?r:s}}function nme(t,e,n){if(n===!1)return!1;const i=dk(t,n),r=dk(e,n);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function ime(t){let e,n,i,r;return ct(t)?(e=t.top,n=t.right,i=t.bottom,r=t.left):e=n=i=r=t,{top:e,right:n,bottom:i,left:r,disabled:t===!1}}function ej(t,e){const n=[],i=t._getSortedDatasetMetas(e);let r,s;for(r=0,s=i.length;r<s;++r)n.push(i[r].index);return n}function fk(t,e,n,i={}){const r=t.keys,s=i.mode==="single";let o,a,l,u;if(e===null)return;let c=!1;for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(c=!0,i.all)continue;break}u=t.values[l],hr(u)&&(s||e===0||Oc(e)===Oc(u))&&(e+=u)}return!c&&!i.all?0:e}function rme(t,e){const{iScale:n,vScale:i}=e,r=n.axis==="x"?"x":"y",s=i.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,u,c;for(l=0,u=o.length;l<u;++l)c=o[l],a[l]={[r]:c,[s]:t[c]};return a}function zR(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function sme(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function ome(t){const{min:e,max:n,minDefined:i,maxDefined:r}=t.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function ame(t,e,n){const i=t[e]||(t[e]={});return i[n]||(i[n]={})}function gk(t,e,n,i){for(const r of e.getMatchingVisibleMetas(i).reverse()){const s=t[r.index];if(n&&s>0||!n&&s<0)return r.index}return null}function mk(t,e){const{chart:n,_cachedMeta:i}=t,r=n._stacks||(n._stacks={}),{iScale:s,vScale:o,index:a}=i,l=s.axis,u=o.axis,c=sme(s,o,i),h=e.length;let d;for(let f=0;f<h;++f){const g=e[f],{[l]:m,[u]:v}=g,S=g._stacks||(g._stacks={});d=S[u]=ame(r,c,m),d[a]=v,d._top=gk(d,o,!0,i.type),d._bottom=gk(d,o,!1,i.type);const y=d._visualValues||(d._visualValues={});y[a]=v}}function UR(t,e){const n=t.scales;return Object.keys(n).filter(i=>n[i].axis===e).shift()}function lme(t,e){return Xc(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function ume(t,e,n){return Xc(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function rd(t,e){const n=t.controller.index,i=t.vScale&&t.vScale.axis;if(i){e=e||t._parsed;for(const r of e){const s=r._stacks;if(!s||s[i]===void 0||s[i][n]===void 0)return;delete s[i][n],s[i]._visualValues!==void 0&&s[i]._visualValues[n]!==void 0&&delete s[i]._visualValues[n]}}}const YR=t=>t==="reset"||t==="none",pk=(t,e)=>e?t:Object.assign({},t),cme=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:ej(n,!0),values:null};class tj{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=zR(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&rd(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,i=this.getDataset(),r=(h,d,f,g)=>h==="x"?d:h==="r"?g:f,s=n.xAxisID=Xe(i.xAxisID,UR(e,"x")),o=n.yAxisID=Xe(i.yAxisID,UR(e,"y")),a=n.rAxisID=Xe(i.rAxisID,UR(e,"r")),l=n.indexAxis,u=n.iAxisID=r(l,s,o,a),c=n.vAxisID=r(l,o,s,a);n.xScale=this.getScaleForId(s),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(u),n.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&ZN(this._data,this),e._stacked&&rd(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),i=this._data;if(ct(n)){const r=this._cachedMeta;this._data=rme(n,r)}else if(i!==n){if(i){ZN(i,this);const r=this._cachedMeta;rd(r),r._parsed=[]}n&&Object.isExtensible(n)&&Nfe(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const s=n._stacked;n._stacked=zR(n.vScale,n),n.stack!==i.stack&&(r=!0,rd(n),n.stack=i.stack),this._resyncElements(e),(r||s!==n._stacked)&&(mk(this,n._parsed),n._stacked=zR(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:i,_data:r}=this,{iScale:s,_stacked:o}=i,a=s.axis;let l=e===0&&n===r.length?!0:i._sorted,u=e>0&&i._parsed[e-1],c,h,d;if(this._parsing===!1)i._parsed=r,i._sorted=!0,d=r;else{Pn(r[e])?d=this.parseArrayData(i,r,e,n):ct(r[e])?d=this.parseObjectData(i,r,e,n):d=this.parsePrimitiveData(i,r,e,n);const f=()=>h[a]===null||u&&h[a]<u[a];for(c=0;c<n;++c)i._parsed[c+e]=h=d[c],l&&(f()&&(l=!1),u=h);i._sorted=l}o&&mk(this,d)}parsePrimitiveData(e,n,i,r){const{iScale:s,vScale:o}=e,a=s.axis,l=o.axis,u=s.getLabels(),c=s===o,h=new Array(r);let d,f,g;for(d=0,f=r;d<f;++d)g=d+i,h[d]={[a]:c||s.parse(u[g],g),[l]:o.parse(n[g],g)};return h}parseArrayData(e,n,i,r){const{xScale:s,yScale:o}=e,a=new Array(r);let l,u,c,h;for(l=0,u=r;l<u;++l)c=l+i,h=n[c],a[l]={x:s.parse(h[0],c),y:o.parse(h[1],c)};return a}parseObjectData(e,n,i,r){const{xScale:s,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,u=new Array(r);let c,h,d,f;for(c=0,h=r;c<h;++c)d=c+i,f=n[d],u[c]={x:s.parse(yw(f,a),d),y:o.parse(yw(f,l),d)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,i){const r=this.chart,s=this._cachedMeta,o=n[e.axis],a={keys:ej(r,!0),values:n._stacks[e.axis]._visualValues};return fk(a,o,s.index,{mode:i})}updateRangeFromParsed(e,n,i,r){const s=i[n.axis];let o=s===null?NaN:s;const a=r&&i._stacks[n.axis];r&&a&&(r.values=a,o=fk(r,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const i=this._cachedMeta,r=i._parsed,s=i._sorted&&e===i.iScale,o=r.length,a=this._getOtherScale(e),l=cme(n,i,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:h}=ome(a);let d,f;function g(){f=r[d];const m=f[a.axis];return!hr(f[e.axis])||c>m||h<m}for(d=0;d<o&&!(!g()&&(this.updateRangeFromParsed(u,e,f,l),s));++d);if(s){for(d=o-1;d>=0;--d)if(!g()){this.updateRangeFromParsed(u,e,f,l);break}}return u}getAllParsedValues(e){const n=this._cachedMeta._parsed,i=[];let r,s,o;for(r=0,s=n.length;r<s;++r)o=n[r][e.axis],hr(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,i=n.iScale,r=n.vScale,s=this.getParsed(e);return{label:i?""+i.getLabelForValue(s[i.axis]):"",value:r?""+r.getLabelForValue(s[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=ime(Xe(this.options.clip,nme(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,i=this._cachedMeta,r=i.data||[],s=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,u=this.options.drawActiveElementsOnTop;let c;for(i.dataset&&i.dataset.draw(e,s,a,l),c=a;c<a+l;++c){const h=r[c];h.hidden||(h.active&&u?o.push(h):h.draw(e,s))}for(c=0;c<o.length;++c)o[c].draw(e,s)}getStyle(e,n){const i=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,n,i){const r=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=ume(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=r.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=lme(this.chart.getContext(),this.index)),s.dataset=r,s.index=s.datasetIndex=this.index;return s.active=!!n,s.mode=i,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",i){const r=n==="active",s=this._cachedDataOpts,o=e+"-"+n,a=s[o],l=this.enableOptionSharing&&Cw(i);if(a)return pk(a,l);const u=this.chart.config,c=u.datasetElementScopeKeys(this._type,e),h=r?[`${e}Hover`,"hover",e,""]:[e,""],d=u.getOptionScopes(this.getDataset(),c),f=Object.keys(Jt.elements[e]),g=()=>this.getContext(i,r,n),m=u.resolveNamedOptions(d,f,g,h);return m.$shared&&(m.$shared=l,s[o]=Object.freeze(pk(m,l))),m}_resolveAnimations(e,n,i){const r=this.chart,s=this._cachedDataOpts,o=`animation-${n}`,a=s[o];if(a)return a;let l;if(r.options.animation!==!1){const c=this.chart.config,h=c.datasetAnimationScopeKeys(this._type,n),d=c.getOptionScopes(this.getDataset(),h);l=c.createResolver(d,this.getContext(e,i,n))}const u=new Jge(r,l&&l.animations);return l&&l._cacheable&&(s[o]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||YR(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const i=this.resolveDataElementOptions(e,n),r=this._sharedOptions,s=this.getSharedOptions(i),o=this.includeOptions(n,s)||s!==r;return this.updateSharedOptions(s,n,i),{sharedOptions:s,includeOptions:o}}updateElement(e,n,i,r){YR(r)?Object.assign(e,i):this._resolveAnimations(n,r).update(e,i)}updateSharedOptions(e,n,i){e&&!YR(n)&&this._resolveAnimations(void 0,n).update(e,i)}_setStyle(e,n,i,r){e.active=r;const s=this.getStyle(n,r);this._resolveAnimations(n,i,r).update(e,{options:!r&&this.getSharedOptions(s)||s})}removeHoverStyle(e,n,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,n,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,i=this._cachedMeta.data;for(const[a,l,u]of this._syncList)this[a](l,u);this._syncList=[];const r=i.length,s=n.length,o=Math.min(s,r);o&&this.parse(0,o),s>r?this._insertElements(r,s-r,e):s<r&&this._removeElements(s,r-s)}_insertElements(e,n,i=!0){const r=this._cachedMeta,s=r.data,o=e+n;let a;const l=u=>{for(u.length+=n,a=u.length-1;a>=o;a--)u[a]=u[a-n]};for(l(s),a=e;a<o;++a)s[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),i&&this.updateElements(s,e,n,"reset")}updateElements(e,n,i,r){}_removeElements(e,n){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(e,n);i._stacked&&rd(i,r)}i.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,i,r]=e;this[n](i,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}class hme extends tj{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:i,data:r=[],_dataset:s}=n,o=this.chart._animationsDisabled;let{start:a,count:l}=$fe(n,r,o);this._drawStart=a,this._drawCount=l,Vfe(n)&&(a=0,l=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!s._decimated,i.points=r;const u=this.resolveDatasetElementOptions(e);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:u},e),this.updateElements(r,a,l,e)}updateElements(e,n,i,r){const s=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:u}=this._cachedMeta,{sharedOptions:c,includeOptions:h}=this._getSharedOptions(n,r),d=o.axis,f=a.axis,{spanGaps:g,segment:m}=this.options,v=yf(g)?g:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||s||r==="none",y=n+i,M=e.length;let I=n>0&&this.getParsed(n-1);for(let P=0;P<M;++P){const E=e[P],T=S?E:{};if(P<n||P>=y){T.skip=!0;continue}const $=this.getParsed(P),U=xt($[f]),O=T[d]=o.getPixelForValue($[d],P),G=T[f]=s||U?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,$,l):$[f],P);T.skip=isNaN(O)||isNaN(G)||U,T.stop=P>0&&Math.abs($[d]-I[d])>v,m&&(T.parsed=$,T.raw=u.data[P]),h&&(T.options=c||this.resolveDataElementOptions(P,E.active?"active":r)),S||this.updateElement(E,P,T,r),I=$}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,i=n.options&&n.options.borderWidth||0,r=e.data||[];if(!r.length)return i;const s=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(i,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}function Cl(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ix{static override(e){Object.assign(Ix.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Cl()}parse(){return Cl()}format(){return Cl()}add(){return Cl()}diff(){return Cl()}startOf(){return Cl()}endOf(){return Cl()}}var dme={_date:Ix};function fme(t,e,n,i){const{controller:r,data:s,_sorted:o}=t,a=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&s.length){const u=a._reversePixels?Hfe:Ll;if(i){if(r._sharedOptions){const c=s[0],h=typeof c.getRange=="function"&&c.getRange(e);if(h){const d=u(s,e,n-h),f=u(s,e,n+h);return{lo:d.lo,hi:f.hi}}}}else{const c=u(s,e,n);if(l){const{vScale:h}=r._cachedMeta,{_parsed:d}=t,f=d.slice(0,c.lo+1).reverse().findIndex(m=>!xt(m[h.axis]));c.lo-=Math.max(0,f);const g=d.slice(c.hi).findIndex(m=>!xt(m[h.axis]));c.hi+=Math.max(0,g)}return c}}return{lo:0,hi:s.length-1}}function xv(t,e,n,i,r){const s=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=s.length;a<l;++a){const{index:u,data:c}=s[a],{lo:h,hi:d}=fme(s[a],e,o,r);for(let f=h;f<=d;++f){const g=c[f];g.skip||i(g,u,f)}}}function gme(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(i,r){const s=e?Math.abs(i.x-r.x):0,o=n?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function GR(t,e,n,i,r){const s=[];return!r&&!t.isPointInArea(e)||xv(t,n,e,function(a,l,u){!r&&!Cf(a,t.chartArea,0)||a.inRange(e.x,e.y,i)&&s.push({element:a,datasetIndex:l,index:u})},!0),s}function mme(t,e,n,i){let r=[];function s(o,a,l){const{startAngle:u,endAngle:c}=o.getProps(["startAngle","endAngle"],i),{angle:h}=Ife(o,{x:e.x,y:e.y});VB(h,u,c)&&r.push({element:o,datasetIndex:a,index:l})}return xv(t,n,e,s),r}function pme(t,e,n,i,r,s){let o=[];const a=gme(n);let l=Number.POSITIVE_INFINITY;function u(c,h,d){const f=c.inRange(e.x,e.y,r);if(i&&!f)return;const g=c.getCenterPoint(r);if(!(!!s||t.isPointInArea(g))&&!f)return;const v=a(e,g);v<l?(o=[{element:c,datasetIndex:h,index:d}],l=v):v===l&&o.push({element:c,datasetIndex:h,index:d})}return xv(t,n,e,u),o}function qR(t,e,n,i,r,s){return!s&&!t.isPointInArea(e)?[]:n==="r"&&!i?mme(t,e,n,r):pme(t,e,n,i,r,s)}function wk(t,e,n,i,r){const s=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return xv(t,n,e,(l,u,c)=>{l[o]&&l[o](e[n],r)&&(s.push({element:l,datasetIndex:u,index:c}),a=a||l.inRange(e.x,e.y,r))}),i&&!a?[]:s}var wme={modes:{index(t,e,n,i){const r=_l(e,t),s=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?GR(t,r,s,i,o):qR(t,r,s,!1,i,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(u=>{const c=a[0].index,h=u.data[c];h&&!h.skip&&l.push({element:h,datasetIndex:u.index,index:c})}),l):[]},dataset(t,e,n,i){const r=_l(e,t),s=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?GR(t,r,s,i,o):qR(t,r,s,!1,i,o);if(a.length>0){const l=a[0].datasetIndex,u=t.getDatasetMeta(l).data;a=[];for(let c=0;c<u.length;++c)a.push({element:u[c],datasetIndex:l,index:c})}return a},point(t,e,n,i){const r=_l(e,t),s=n.axis||"xy",o=n.includeInvisible||!1;return GR(t,r,s,i,o)},nearest(t,e,n,i){const r=_l(e,t),s=n.axis||"xy",o=n.includeInvisible||!1;return qR(t,r,s,n.intersect,i,o)},x(t,e,n,i){const r=_l(e,t);return wk(t,r,"x",n.intersect,i)},y(t,e,n,i){const r=_l(e,t);return wk(t,r,"y",n.intersect,i)}}};const nj=["left","top","right","bottom"];function sd(t,e){return t.filter(n=>n.pos===e)}function vk(t,e){return t.filter(n=>nj.indexOf(n.pos)===-1&&n.box.axis===e)}function od(t,e){return t.sort((n,i)=>{const r=e?i:n,s=e?n:i;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function vme(t){const e=[];let n,i,r,s,o,a;for(n=0,i=(t||[]).length;n<i;++n)r=t[n],{position:s,options:{stack:o,stackWeight:a=1}}=r,e.push({index:n,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&s+o,stackWeight:a});return e}function yme(t){const e={};for(const n of t){const{stack:i,pos:r,stackWeight:s}=n;if(!i||!nj.includes(r))continue;const o=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function Cme(t,e){const n=yme(t),{vBoxMaxWidth:i,hBoxMaxHeight:r}=e;let s,o,a;for(s=0,o=t.length;s<o;++s){a=t[s];const{fullSize:l}=a.box,u=n[a.stack],c=u&&a.stackWeight/u.weight;a.horizontal?(a.width=c?c*i:l&&e.availableWidth,a.height=r):(a.width=i,a.height=c?c*r:l&&e.availableHeight)}return n}function bme(t){const e=vme(t),n=od(e.filter(u=>u.box.fullSize),!0),i=od(sd(e,"left"),!0),r=od(sd(e,"right")),s=od(sd(e,"top"),!0),o=od(sd(e,"bottom")),a=vk(e,"x"),l=vk(e,"y");return{fullSize:n,leftAndTop:i.concat(s),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:sd(e,"chartArea"),vertical:i.concat(r).concat(l),horizontal:s.concat(o).concat(a)}}function yk(t,e,n,i){return Math.max(t[n],e[n])+Math.max(t[i],e[i])}function ij(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function Sme(t,e,n,i){const{pos:r,box:s}=n,o=t.maxPadding;if(!ct(r)){n.size&&(t[r]-=n.size);const h=i[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?s.height:s.width),n.size=h.size/h.count,t[r]+=n.size}s.getPadding&&ij(o,s.getPadding());const a=Math.max(0,e.outerWidth-yk(o,t,"left","right")),l=Math.max(0,e.outerHeight-yk(o,t,"top","bottom")),u=a!==t.w,c=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:u,other:c}:{same:c,other:u}}function Rme(t){const e=t.maxPadding;function n(i){const r=Math.max(e[i]-t[i],0);return t[i]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function _me(t,e){const n=e.maxPadding;function i(r){const s={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{s[o]=Math.max(e[o],n[o])}),s}return i(t?["left","right"]:["top","bottom"])}function yd(t,e,n,i){const r=[];let s,o,a,l,u,c;for(s=0,o=t.length,u=0;s<o;++s){a=t[s],l=a.box,l.update(a.width||e.w,a.height||e.h,_me(a.horizontal,e));const{same:h,other:d}=Sme(e,n,a,i);u|=h&&r.length,c=c||d,l.fullSize||r.push(a)}return u&&yd(r,e,n,i)||c}function Ym(t,e,n,i,r){t.top=n,t.left=e,t.right=e+i,t.bottom=n+r,t.width=i,t.height=r}function Ck(t,e,n,i){const r=n.padding;let{x:s,y:o}=e;for(const a of t){const l=a.box,u=i[a.stack]||{placed:0,weight:1},c=a.stackWeight/u.weight||1;if(a.horizontal){const h=e.w*c,d=u.size||l.height;Cw(u.start)&&(o=u.start),l.fullSize?Ym(l,r.left,o,n.outerWidth-r.right-r.left,d):Ym(l,e.left+u.placed,o,h,d),u.start=o,u.placed+=h,o=l.bottom}else{const h=e.h*c,d=u.size||l.width;Cw(u.start)&&(s=u.start),l.fullSize?Ym(l,s,r.top,d,n.outerHeight-r.bottom-r.top):Ym(l,s,e.top+u.placed,d,h),u.start=s,u.placed+=h,s=l.right}}e.x=s,e.y=o}var ar={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,i){if(!t)return;const r=Eo(t.options.layout.padding),s=Math.max(e-r.width,0),o=Math.max(n-r.height,0),a=bme(t.boxes),l=a.vertical,u=a.horizontal;$n(t.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const c=l.reduce((m,v)=>v.box.options&&v.box.options.display===!1?m:m+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/c,hBoxMaxHeight:o/2}),d=Object.assign({},r);ij(d,Eo(i));const f=Object.assign({maxPadding:d,w:s,h:o,x:r.left,y:r.top},r),g=Cme(l.concat(u),h);yd(a.fullSize,f,h,g),yd(l,f,h,g),yd(u,f,h,g)&&yd(l,f,h,g),Rme(f),Ck(a.leftAndTop,f,h,g),f.x+=f.w,f.y+=f.h,Ck(a.rightAndBottom,f,h,g),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},$n(a.chartArea,m=>{const v=m.box;Object.assign(v,t.chartArea),v.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class rj{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,i){}removeEventListener(e,n,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,i,r){return n=Math.max(0,n||e.width),i=i||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):i)}}isAttached(e){return!0}updateConfig(e){}}class Eme extends rj{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const yp="$chartjs",Tme={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},bk=t=>t===null||t==="";function Mme(t,e){const n=t.style,i=t.getAttribute("height"),r=t.getAttribute("width");if(t[yp]={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",bk(r)){const s=ak(t,"width");s!==void 0&&(t.width=s)}if(bk(i))if(t.style.height==="")t.height=t.width/(e||2);else{const s=ak(t,"height");s!==void 0&&(t.height=s)}return t}const sj=Hge?{passive:!0}:!1;function xme(t,e,n){t&&t.addEventListener(e,n,sj)}function Pme(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,sj)}function Ime(t,e){const n=Tme[t.type]||t.type,{x:i,y:r}=_l(t,e);return{type:n,chart:e,native:t,x:i!==void 0?i:null,y:r!==void 0?r:null}}function Rw(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function Ome(t,e,n){const i=t.canvas,r=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||Rw(a.addedNodes,i),o=o&&!Rw(a.removedNodes,i);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function Ame(t,e,n){const i=t.canvas,r=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||Rw(a.removedNodes,i),o=o&&!Rw(a.addedNodes,i);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const Sf=new Map;let Sk=0;function oj(){const t=window.devicePixelRatio;t!==Sk&&(Sk=t,Sf.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function Hme(t,e){Sf.size||window.addEventListener("resize",oj),Sf.set(t,e)}function Dme(t){Sf.delete(t),Sf.size||window.removeEventListener("resize",oj)}function Nme(t,e,n){const i=t.canvas,r=i&&Px(i);if(!r)return;const s=jB((a,l)=>{const u=r.clientWidth;n(a,l),u<r.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],u=l.contentRect.width,c=l.contentRect.height;u===0&&c===0||s(u,c)});return o.observe(r),Hme(t,s),o}function KR(t,e,n){n&&n.disconnect(),e==="resize"&&Dme(t)}function kme(t,e,n){const i=t.canvas,r=jB(s=>{t.ctx!==null&&n(Ime(s,t))},t);return xme(i,e,r),r}class Lme extends rj{acquireContext(e,n){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(Mme(e,n),i):null}releaseContext(e){const n=e.canvas;if(!n[yp])return!1;const i=n[yp].initial;["height","width"].forEach(s=>{const o=i[s];xt(o)?n.removeAttribute(s):n.setAttribute(s,o)});const r=i.style||{};return Object.keys(r).forEach(s=>{n.style[s]=r[s]}),n.width=n.width,delete n[yp],!0}addEventListener(e,n,i){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),o={attach:Ome,detach:Ame,resize:Nme}[n]||kme;r[n]=o(e,n,i)}removeEventListener(e,n){const i=e.$proxies||(e.$proxies={}),r=i[n];if(!r)return;({attach:KR,detach:KR,resize:KR}[n]||Pme)(e,n,r),i[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,i,r){return Age(e,n,i,r)}isAttached(e){const n=e&&Px(e);return!!(n&&n.isConnected)}}function Fme(t){return!xx()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?Eme:Lme}class Zc{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:n,y:i}=this.getProps(["x","y"],e);return{x:n,y:i}}hasValue(){return yf(this.x)&&yf(this.y)}getProps(e,n){const i=this.$animations;if(!n||!i)return this;const r={};return e.forEach(s=>{r[s]=i[s]&&i[s].active()?i[s]._to:this[s]}),r}}function $me(t,e){const n=t.options.ticks,i=Vme(t),r=Math.min(n.maxTicksLimit||i,i),s=n.major.enabled?Bme(e):[],o=s.length,a=s[0],l=s[o-1],u=[];if(o>r)return jme(e,u,s,o/r),u;const c=Wme(s,e,r);if(o>0){let h,d;const f=o>1?Math.round((l-a)/(o-1)):null;for(Gm(e,u,c,xt(f)?0:a-f,a),h=0,d=o-1;h<d;h++)Gm(e,u,c,s[h],s[h+1]);return Gm(e,u,c,l,xt(f)?e.length:l+f),u}return Gm(e,u,c),u}function Vme(t){const e=t.options.offset,n=t._tickSize(),i=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(i,r))}function Wme(t,e,n){const i=zme(t),r=e.length/n;if(!i)return Math.max(r,1);const s=Efe(i);for(let o=0,a=s.length-1;o<a;o++){const l=s[o];if(l>r)return l}return Math.max(r,1)}function Bme(t){const e=[];let n,i;for(n=0,i=t.length;n<i;n++)t[n].major&&e.push(n);return e}function jme(t,e,n,i){let r=0,s=n[0],o;for(i=Math.ceil(i),o=0;o<t.length;o++)o===s&&(e.push(t[o]),r++,s=n[r*i])}function Gm(t,e,n,i,r){const s=Xe(i,0),o=Math.min(Xe(r,t.length),t.length);let a=0,l,u,c;for(n=Math.ceil(n),r&&(l=r-i,n=l/Math.floor(l/n)),c=s;c<0;)a++,c=Math.round(s+a*n);for(u=Math.max(s,0);u<o;u++)u===c&&(e.push(t[u]),a++,c=Math.round(s+a*n))}function zme(t){const e=t.length;let n,i;if(e<2)return!1;for(i=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==i)return!1;return i}const Ume=t=>t==="left"?"right":t==="right"?"left":t,Rk=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,_k=(t,e)=>Math.min(e||t,t);function Ek(t,e){const n=[],i=t.length/e,r=t.length;let s=0;for(;s<r;s+=i)n.push(t[Math.floor(s)]);return n}function Yme(t,e,n){const i=t.ticks.length,r=Math.min(e,i-1),s=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),u;if(!(n&&(i===1?u=Math.max(l-s,o-l):e===0?u=(t.getPixelForTick(1)-l)/2:u=(l-t.getPixelForTick(r-1))/2,l+=r<e?u:-u,l<s-a||l>o+a)))return l}function Gme(t,e){$n(t,n=>{const i=n.gc,r=i.length/2;let s;if(r>e){for(s=0;s<r;++s)delete n.data[i[s]];i.splice(0,r)}})}function ad(t){return t.drawTicks?t.tickLength:0}function Tk(t,e){if(!t.display)return 0;const n=vo(t.font,e),i=Eo(t.padding);return(Pn(t.text)?t.text.length:1)*n.lineHeight+i.height}function qme(t,e){return Xc(t,{scale:e,type:"scale"})}function Kme(t,e,n){return Xc(t,{tick:n,index:e,type:"tick"})}function Xme(t,e,n){let i=bx(t);return(n&&e!=="right"||!n&&e==="right")&&(i=Ume(i)),i}function Zme(t,e,n,i){const{top:r,left:s,bottom:o,right:a,chart:l}=t,{chartArea:u,scales:c}=l;let h=0,d,f,g;const m=o-r,v=a-s;if(t.isHorizontal()){if(f=Vn(i,s,a),ct(n)){const S=Object.keys(n)[0],y=n[S];g=c[S].getPixelForValue(y)+m-e}else n==="center"?g=(u.bottom+u.top)/2+m-e:g=Rk(t,n,e);d=a-s}else{if(ct(n)){const S=Object.keys(n)[0],y=n[S];f=c[S].getPixelForValue(y)-v+e}else n==="center"?f=(u.left+u.right)/2-v+e:f=Rk(t,n,e);g=Vn(i,o,r),h=n==="left"?-$r:$r}return{titleX:f,titleY:g,maxWidth:d,rotation:h}}class Qc extends Zc{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:i,_suggestedMax:r}=this;return e=cs(e,Number.POSITIVE_INFINITY),n=cs(n,Number.NEGATIVE_INFINITY),i=cs(i,Number.POSITIVE_INFINITY),r=cs(r,Number.NEGATIVE_INFINITY),{min:cs(e,i),max:cs(n,r),minDefined:hr(e),maxDefined:hr(n)}}getMinMax(e){let{min:n,max:i,minDefined:r,maxDefined:s}=this.getUserBounds(),o;if(r&&s)return{min:n,max:i};const a=this.getMatchingVisibleMetas();for(let l=0,u=a.length;l<u;++l)o=a[l].controller.getMinMax(this,e),r||(n=Math.min(n,o.min)),s||(i=Math.max(i,o.max));return n=s&&n>i?i:n,i=r&&n>i?n:i,{min:cs(n,cs(i,n)),max:cs(i,cs(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Tt(this.options.beforeUpdate,[this])}update(e,n,i){const{beginAtZero:r,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=cge(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?Ek(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=$me(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,i;this.isHorizontal()?(n=this.left,i=this.right):(n=this.top,i=this.bottom,e=!e),this._startPixel=n,this._endPixel=i,this._reversePixels=e,this._length=i-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Tt(this.options.afterUpdate,[this])}beforeSetDimensions(){Tt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Tt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Tt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Tt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let i,r,s;for(i=0,r=e.length;i<r;i++)s=e[i],s.label=Tt(n.callback,[s.value,i,e],this)}afterTickToLabelConversion(){Tt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Tt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,i=_k(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,s=n.maxRotation;let o=r,a,l,u;if(!this._isVisible()||!n.display||r>=s||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const c=this._getLabelSizes(),h=c.widest.width,d=c.highest.height,f=_s(this.chart.width-h,0,this.maxWidth);a=e.offset?this.maxWidth/i:f/(i-1),h+6>a&&(a=f/(i-(e.offset?.5:1)),l=this.maxHeight-ad(e.grid)-n.padding-Tk(e.title,this.chart.options.font),u=Math.sqrt(h*h+d*d),o=Pfe(Math.min(Math.asin(_s((c.highest.height+6)/a,-1,1)),Math.asin(_s(l/u,-1,1))-Math.asin(_s(d/u,-1,1)))),o=Math.max(r,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){Tt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Tt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:i,title:r,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=Tk(r,n.options.font);if(a?(e.width=this.maxWidth,e.height=ad(s)+l):(e.height=this.maxHeight,e.width=ad(s)+l),i.display&&this.ticks.length){const{first:u,last:c,widest:h,highest:d}=this._getLabelSizes(),f=i.padding*2,g=kl(this.labelRotation),m=Math.cos(g),v=Math.sin(g);if(a){const S=i.mirror?0:v*h.width+m*d.height;e.height=Math.min(this.maxHeight,e.height+S+f)}else{const S=i.mirror?0:m*h.width+v*d.height;e.width=Math.min(this.maxWidth,e.width+S+f)}this._calculatePadding(u,c,v,m)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,i,r){const{ticks:{align:s,padding:o},position:a}=this.options,l=this.labelRotation!==0,u=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const c=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,f=0;l?u?(d=r*e.width,f=i*n.height):(d=i*e.height,f=r*n.width):s==="start"?f=n.width:s==="end"?d=e.width:s!=="inner"&&(d=e.width/2,f=n.width/2),this.paddingLeft=Math.max((d-c+o)*this.width/(this.width-c),0),this.paddingRight=Math.max((f-h+o)*this.width/(this.width-h),0)}else{let c=n.height/2,h=e.height/2;s==="start"?(c=0,h=e.height):s==="end"&&(c=n.height,h=0),this.paddingTop=c+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Tt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,i;for(n=0,i=e.length;n<i;n++)xt(e[n].label)&&(e.splice(n,1),i--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let i=this.ticks;n<i.length&&(i=Ek(i,n)),this._labelSizes=e=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,i){const{ctx:r,_longestTextCache:s}=this,o=[],a=[],l=Math.floor(n/_k(n,i));let u=0,c=0,h,d,f,g,m,v,S,y,M,I,P;for(h=0;h<n;h+=l){if(g=e[h].label,m=this._resolveTickFontOptions(h),r.font=v=m.string,S=s[v]=s[v]||{data:{},gc:[]},y=m.lineHeight,M=I=0,!xt(g)&&!Pn(g))M=nk(r,S.data,S.gc,M,g),I=y;else if(Pn(g))for(d=0,f=g.length;d<f;++d)P=g[d],!xt(P)&&!Pn(P)&&(M=nk(r,S.data,S.gc,M,P),I+=y);o.push(M),a.push(I),u=Math.max(M,u),c=Math.max(I,c)}Gme(s,n);const E=o.indexOf(u),T=a.indexOf(c),$=U=>({width:o[U]||0,height:a[U]||0});return{first:$(0),last:$(n-1),widest:$(E),highest:$(T),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return Afe(this._alignToPixels?yl(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const i=n[e];return i.$context||(i.$context=Kme(this.getContext(),e,i))}return this.$context||(this.$context=qme(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=kl(this.labelRotation),i=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,a=s?s.widest.width+o:0,l=s?s.highest.height+o:0;return this.isHorizontal()?l*i>a*r?a/i:l/r:l*r<a*i?l/i:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,i=this.chart,r=this.options,{grid:s,position:o,border:a}=r,l=s.offset,u=this.isHorizontal(),h=this.ticks.length+(l?1:0),d=ad(s),f=[],g=a.setContext(this.getContext()),m=g.display?g.width:0,v=m/2,S=function(Me){return yl(i,Me,m)};let y,M,I,P,E,T,$,U,O,G,q,ne;if(o==="top")y=S(this.bottom),T=this.bottom-d,U=y-v,G=S(e.top)+v,ne=e.bottom;else if(o==="bottom")y=S(this.top),G=e.top,ne=S(e.bottom)-v,T=y+v,U=this.top+d;else if(o==="left")y=S(this.right),E=this.right-d,$=y-v,O=S(e.left)+v,q=e.right;else if(o==="right")y=S(this.left),O=e.left,q=S(e.right)-v,E=y+v,$=this.left+d;else if(n==="x"){if(o==="center")y=S((e.top+e.bottom)/2+.5);else if(ct(o)){const Me=Object.keys(o)[0],Ce=o[Me];y=S(this.chart.scales[Me].getPixelForValue(Ce))}G=e.top,ne=e.bottom,T=y+v,U=T+d}else if(n==="y"){if(o==="center")y=S((e.left+e.right)/2);else if(ct(o)){const Me=Object.keys(o)[0],Ce=o[Me];y=S(this.chart.scales[Me].getPixelForValue(Ce))}E=y-v,$=E-d,O=e.left,q=e.right}const Q=Xe(r.ticks.maxTicksLimit,h),te=Math.max(1,Math.ceil(h/Q));for(M=0;M<h;M+=te){const Me=this.getContext(M),Ce=s.setContext(Me),Ie=a.setContext(Me),at=Ce.lineWidth,Le=Ce.color,Ge=Ie.dash||[],St=Ie.dashOffset,p=Ce.tickWidth,w=Ce.tickColor,b=Ce.tickBorderDash||[],N=Ce.tickBorderDashOffset;I=Yme(this,M,l),I!==void 0&&(P=yl(i,I,at),u?E=$=O=q=P:T=U=G=ne=P,f.push({tx1:E,ty1:T,tx2:$,ty2:U,x1:O,y1:G,x2:q,y2:ne,width:at,color:Le,borderDash:Ge,borderDashOffset:St,tickWidth:p,tickColor:w,tickBorderDash:b,tickBorderDashOffset:N}))}return this._ticksLength=h,this._borderValue=y,f}_computeLabelItems(e){const n=this.axis,i=this.options,{position:r,ticks:s}=i,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:u,padding:c,mirror:h}=s,d=ad(i.grid),f=d+c,g=h?-c:f,m=-kl(this.labelRotation),v=[];let S,y,M,I,P,E,T,$,U,O,G,q,ne="middle";if(r==="top")E=this.bottom-g,T=this._getXAxisLabelAlignment();else if(r==="bottom")E=this.top+g,T=this._getXAxisLabelAlignment();else if(r==="left"){const te=this._getYAxisLabelAlignment(d);T=te.textAlign,P=te.x}else if(r==="right"){const te=this._getYAxisLabelAlignment(d);T=te.textAlign,P=te.x}else if(n==="x"){if(r==="center")E=(e.top+e.bottom)/2+f;else if(ct(r)){const te=Object.keys(r)[0],Me=r[te];E=this.chart.scales[te].getPixelForValue(Me)+f}T=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")P=(e.left+e.right)/2-f;else if(ct(r)){const te=Object.keys(r)[0],Me=r[te];P=this.chart.scales[te].getPixelForValue(Me)}T=this._getYAxisLabelAlignment(d).textAlign}n==="y"&&(l==="start"?ne="top":l==="end"&&(ne="bottom"));const Q=this._getLabelSizes();for(S=0,y=a.length;S<y;++S){M=a[S],I=M.label;const te=s.setContext(this.getContext(S));$=this.getPixelForTick(S)+s.labelOffset,U=this._resolveTickFontOptions(S),O=U.lineHeight,G=Pn(I)?I.length:1;const Me=G/2,Ce=te.color,Ie=te.textStrokeColor,at=te.textStrokeWidth;let Le=T;o?(P=$,T==="inner"&&(S===y-1?Le=this.options.reverse?"left":"right":S===0?Le=this.options.reverse?"right":"left":Le="center"),r==="top"?u==="near"||m!==0?q=-G*O+O/2:u==="center"?q=-Q.highest.height/2-Me*O+O:q=-Q.highest.height+O/2:u==="near"||m!==0?q=O/2:u==="center"?q=Q.highest.height/2-Me*O:q=Q.highest.height-G*O,h&&(q*=-1),m!==0&&!te.showLabelBackdrop&&(P+=O/2*Math.sin(m))):(E=$,q=(1-G)*O/2);let Ge;if(te.showLabelBackdrop){const St=Eo(te.backdropPadding),p=Q.heights[S],w=Q.widths[S];let b=q-St.top,N=0-St.left;switch(ne){case"middle":b-=p/2;break;case"bottom":b-=p;break}switch(T){case"center":N-=w/2;break;case"right":N-=w;break;case"inner":S===y-1?N-=w:S>0&&(N-=w/2);break}Ge={left:N,top:b,width:w+St.width,height:p+St.height,color:te.backdropColor}}v.push({label:I,font:U,textOffset:q,options:{rotation:m,color:Ce,strokeColor:Ie,strokeWidth:at,textAlign:Le,textBaseline:ne,translation:[P,E],backdrop:Ge}})}return v}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-kl(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:i,mirror:r,padding:s}}=this.options,o=this._getLabelSizes(),a=e+s,l=o.widest.width;let u,c;return n==="left"?r?(c=this.right+s,i==="near"?u="left":i==="center"?(u="center",c+=l/2):(u="right",c+=l)):(c=this.right-a,i==="near"?u="right":i==="center"?(u="center",c-=l/2):(u="left",c=this.left)):n==="right"?r?(c=this.left+s,i==="near"?u="right":i==="center"?(u="center",c-=l/2):(u="left",c-=l)):(c=this.left+a,i==="near"?u="left":i==="center"?(u="center",c+=l/2):(u="right",c=this.right)):u="right",{textAlign:u,x:c}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:i,top:r,width:s,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(i,r,s,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(s=>s.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const a=(l,u,c)=>{!c.width||!c.color||(i.save(),i.lineWidth=c.width,i.strokeStyle=c.color,i.setLineDash(c.borderDash||[]),i.lineDashOffset=c.borderDashOffset,i.beginPath(),i.moveTo(l.x,l.y),i.lineTo(u.x,u.y),i.stroke(),i.restore())};if(n.display)for(s=0,o=r.length;s<o;++s){const l=r[s];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:i,grid:r}}=this,s=i.setContext(this.getContext()),o=i.display?s.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let u,c,h,d;this.isHorizontal()?(u=yl(e,this.left,o)-o/2,c=yl(e,this.right,a)+a/2,h=d=l):(h=yl(e,this.top,o)-o/2,d=yl(e,this.bottom,a)+a/2,u=c=l),n.save(),n.lineWidth=s.width,n.strokeStyle=s.color,n.beginPath(),n.moveTo(u,h),n.lineTo(c,d),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&Rx(i,r);const s=this.getLabelItems(e);for(const o of s){const a=o.options,l=o.font,u=o.label,c=o.textOffset;bf(i,u,0,c,l,a)}r&&_x(i)}drawTitle(){const{ctx:e,options:{position:n,title:i,reverse:r}}=this;if(!i.display)return;const s=vo(i.font),o=Eo(i.padding),a=i.align;let l=s.lineHeight/2;n==="bottom"||n==="center"||ct(n)?(l+=o.bottom,Pn(i.text)&&(l+=s.lineHeight*(i.text.length-1))):l+=o.top;const{titleX:u,titleY:c,maxWidth:h,rotation:d}=Zme(this,l,n,a);bf(e,i.text,0,0,s,{color:i.color,maxWidth:h,rotation:d,textAlign:Xme(a,n,r),textBaseline:"middle",translation:[u,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,i=Xe(e.grid&&e.grid.z,-1),r=Xe(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Qc.prototype.draw?[{z:n,draw:s=>{this.draw(s)}}]:[{z:i,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let s,o;for(s=0,o=n.length;s<o;++s){const a=n[s];a[i]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return vo(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class qm{constructor(e,n,i){this.type=e,this.scope=n,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let i;epe(n)&&(i=this.register(n));const r=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in r||(r[s]=e,Qme(e,o,i),this.override&&Jt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,i=e.id,r=this.scope;i in n&&delete n[i],r&&i in Jt[r]&&(delete Jt[r][i],this.override&&delete Kl[i])}}function Qme(t,e,n){const i=vf(Object.create(null),[n?Jt.get(n):{},Jt.get(e),t.defaults]);Jt.set(e,i),t.defaultRoutes&&Jme(e,t.defaultRoutes),t.descriptors&&Jt.describe(e,t.descriptors)}function Jme(t,e){Object.keys(e).forEach(n=>{const i=n.split("."),r=i.pop(),s=[t].concat(i).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");Jt.route(s,r,l,a)})}function epe(t){return"id"in t&&"defaults"in t}class tpe{constructor(){this.controllers=new qm(tj,"datasets",!0),this.elements=new qm(Zc,"elements"),this.plugins=new qm(Object,"plugins"),this.scales=new qm(Qc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,i){[...n].forEach(r=>{const s=i||this._getRegistryForType(r);i||s.isForType(r)||s===this.plugins&&r.id?this._exec(e,s,r):$n(r,o=>{const a=i||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,i){const r=yx(e);Tt(i["before"+r],[],i),n[e](i),Tt(i["after"+r],[],i)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const i=this._typedRegistries[n];if(i.isForType(e))return i}return this.plugins}_get(e,n,i){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return r}}var ws=new tpe;class npe{constructor(){this._init=[]}notify(e,n,i,r){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(s,e,n,i);return n==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,n,i,r){r=r||{};for(const s of e){const o=s.plugin,a=o[i],l=[n,r,s.options];if(Tt(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){xt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const i=e&&e.config,r=Xe(i.options&&i.options.plugins,{}),s=ipe(i);return r===!1&&!n?[]:spe(e,s,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],i=this._cache,r=(s,o)=>s.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,i),e,"stop"),this._notify(r(i,n),e,"start")}}function ipe(t){const e={},n=[],i=Object.keys(ws.plugins.items);for(let s=0;s<i.length;s++)n.push(ws.getPlugin(i[s]));const r=t.plugins||[];for(let s=0;s<r.length;s++){const o=r[s];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function rpe(t,e){return!e&&t===!1?null:t===!0?{}:t}function spe(t,{plugins:e,localIds:n},i,r){const s=[],o=t.getContext();for(const a of e){const l=a.id,u=rpe(i[l],r);u!==null&&s.push({plugin:a,options:ope(t.config,{plugin:a,local:n[l]},u,o)})}return s}function ope(t,{plugin:e,local:n},i,r){const s=t.pluginScopeKeys(e),o=t.getOptionScopes(i,s);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function s_(t,e){const n=Jt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function ape(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function lpe(t,e){return t===e?"_index_":"_value_"}function Mk(t){if(t==="x"||t==="y"||t==="r")return t}function upe(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function o_(t,...e){if(Mk(t))return t;for(const n of e){const i=n.axis||upe(n.position)||t.length>1&&Mk(t[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function xk(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function cpe(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(i=>i.xAxisID===t||i.yAxisID===t);if(n.length)return xk(t,"x",n[0])||xk(t,"y",n[0])}return{}}function hpe(t,e){const n=Kl[t.type]||{scales:{}},i=e.scales||{},r=s_(t.type,e),s=Object.create(null);return Object.keys(i).forEach(o=>{const a=i[o];if(!ct(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=o_(o,a,cpe(o,t),Jt.scales[a.type]),u=lpe(l,r),c=n.scales||{};s[o]=Ud(Object.create(null),[{axis:l},a,c[l],c[u]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||s_(a,e),c=(Kl[a]||{}).scales||{};Object.keys(c).forEach(h=>{const d=ape(h,l),f=o[d+"AxisID"]||d;s[f]=s[f]||Object.create(null),Ud(s[f],[{axis:d},i[f],c[h]])})}),Object.keys(s).forEach(o=>{const a=s[o];Ud(a,[Jt.scales[a.type],Jt.scale])}),s}function aj(t){const e=t.options||(t.options={});e.plugins=Xe(e.plugins,{}),e.scales=hpe(t,e)}function lj(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function dpe(t){return t=t||{},t.data=lj(t.data),aj(t),t}const Pk=new Map,uj=new Set;function Km(t,e){let n=Pk.get(t);return n||(n=e(),Pk.set(t,n),uj.add(n)),n}const ld=(t,e,n)=>{const i=yw(e,n);i!==void 0&&t.add(i)};class fpe{constructor(e){this._config=dpe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=lj(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),aj(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Km(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Km(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Km(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,i=this.type;return Km(`${i}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const i=this._scopeCache;let r=i.get(e);return(!r||n)&&(r=new Map,i.set(e,r)),r}getOptionScopes(e,n,i){const{options:r,type:s}=this,o=this._cachedScopes(e,i),a=o.get(n);if(a)return a;const l=new Set;n.forEach(c=>{e&&(l.add(e),c.forEach(h=>ld(l,e,h))),c.forEach(h=>ld(l,r,h)),c.forEach(h=>ld(l,Kl[s]||{},h)),c.forEach(h=>ld(l,Jt,h)),c.forEach(h=>ld(l,r_,h))});const u=Array.from(l);return u.length===0&&u.push(Object.create(null)),uj.has(n)&&o.set(n,u),u}chartOptionScopes(){const{options:e,type:n}=this;return[e,Kl[n]||{},Jt.datasets[n]||{},{type:n},Jt,r_]}resolveNamedOptions(e,n,i,r=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=Ik(this._resolverCache,e,r);let l=o;if(mpe(o,n)){s.$shared=!1,i=Ma(i)?i():i;const u=this.createResolver(e,i,a);l=Ac(o,i,u)}for(const u of n)s[u]=l[u];return s}createResolver(e,n,i=[""],r){const{resolver:s}=Ik(this._resolverCache,e,i);return ct(n)?Ac(s,n,void 0,r):s}}function Ik(t,e,n){let i=t.get(e);i||(i=new Map,t.set(e,i));const r=n.join();let s=i.get(r);return s||(s={resolver:Ex(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},i.set(r,s)),s}const gpe=t=>ct(t)&&Object.getOwnPropertyNames(t).some(e=>Ma(t[e]));function mpe(t,e){const{isScriptable:n,isIndexable:i}=qB(t);for(const r of e){const s=n(r),o=i(r),a=(o||s)&&t[r];if(s&&(Ma(a)||gpe(a))||o&&Pn(a))return!0}return!1}var ppe="4.5.0";const wpe=["top","bottom","left","right","chartArea"];function Ok(t,e){return t==="top"||t==="bottom"||wpe.indexOf(t)===-1&&e==="x"}function Ak(t,e){return function(n,i){return n[t]===i[t]?n[e]-i[e]:n[t]-i[t]}}function Hk(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Tt(n&&n.onComplete,[t],e)}function vpe(t){const e=t.chart,n=e.options.animation;Tt(n&&n.onProgress,[t],e)}function cj(t){return xx()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Cp={},Dk=t=>{const e=cj(t);return Object.values(Cp).filter(n=>n.canvas===e).pop()};function ype(t,e,n){const i=Object.keys(t);for(const r of i){const s=+r;if(s>=e){const o=t[r];delete t[r],(n>0||s>e)&&(t[s+n]=o)}}}function Cpe(t,e,n,i){return!n||t.type==="mouseout"?null:i?e:t}class a_{static defaults=Jt;static instances=Cp;static overrides=Kl;static registry=ws;static version=ppe;static getChart=Dk;static register(...e){ws.add(...e),Nk()}static unregister(...e){ws.remove(...e),Nk()}constructor(e,n){const i=this.config=new fpe(n),r=cj(e),s=Dk(r);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||Fme(r)),this.platform.updateConfig(i);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,u=l&&l.height,c=l&&l.width;if(this.id=pfe(),this.ctx=a,this.canvas=l,this.width=c,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new npe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Lfe(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],Cp[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}io.listen(this,"complete",Hk),io.listen(this,"progress",vpe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:i,height:r,_aspectRatio:s}=this;return xt(e)?n&&s?s:r?i/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return ws}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():ok(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return ik(this.canvas,this.ctx),this}stop(){return io.stop(this),this}resize(e,n){io.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const i=this.options,r=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,n,s),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,ok(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Tt(i.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};$n(n,(i,r)=>{i.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,i=this.scales,r=Object.keys(i).reduce((o,a)=>(o[a]=!1,o),{});let s=[];n&&(s=s.concat(Object.keys(n).map(o=>{const a=n[o],l=o_(o,a),u=l==="r",c=l==="x";return{options:a,dposition:u?"chartArea":c?"bottom":"left",dtype:u?"radialLinear":c?"category":"linear"}}))),$n(s,o=>{const a=o.options,l=a.id,u=o_(l,a),c=Xe(a.type,o.dtype);(a.position===void 0||Ok(a.position,u)!==Ok(o.dposition))&&(a.position=o.dposition),r[l]=!0;let h=null;if(l in i&&i[l].type===c)h=i[l];else{const d=ws.getScale(c);h=new d({id:l,type:c,ctx:this.ctx,chart:this}),i[h.id]=h}h.init(a,e)}),$n(r,(o,a)=>{o||delete i[a]}),$n(i,o=>{ar.configure(this,o,o.options),ar.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,i=e.length;if(e.sort((r,s)=>r.index-s.index),i>n){for(let r=n;r<i;++r)this._destroyDatasetMeta(r);e.splice(n,i-n)}this._sortedMetasets=e.slice(0).sort(Ak("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((i,r)=>{n.filter(s=>s===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=n.length;i<r;i++){const s=n[i];let o=this.getDatasetMeta(i);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(i),o=this.getDatasetMeta(i)),o.type=a,o.indexAxis=s.indexAxis||s_(a,this.options),o.order=s.order||0,o.index=i,o.label=""+s.label,o.visible=this.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const l=ws.getController(a),{datasetElementType:u,dataElementType:c}=Jt.datasets[a];Object.assign(l,{dataElementType:ws.getElement(c),datasetElementType:u&&ws.getElement(u)}),o.controller=new l(this,i),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){$n(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const i=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,c=this.data.datasets.length;u<c;u++){const{controller:h}=this.getDatasetMeta(u),d=!r&&s.indexOf(h)===-1;h.buildOrUpdateElements(d),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),r||$n(s,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Ak("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){$n(this.scales,e=>{ar.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!YN(n,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:s}of n){const o=i==="_removeElements"?-s:s;ype(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,i=s=>new Set(e.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),r=i(0);for(let s=1;s<n;s++)if(!YN(r,i(s)))return;return Array.from(r).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ar.update(this,this.width,this.height,e);const n=this.chartArea,i=n.width<=0||n.height<=0;this._layers=[],$n(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,s)=>{r._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,i=this.data.datasets.length;n<i;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,i=this.data.datasets.length;n<i;++n)this._updateDataset(n,Ma(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const i=this.getDatasetMeta(e),r={meta:i,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(io.has(this)?this.attached&&!io.running(this)&&io.start(this):(this.draw(),Hk({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,i=[];let r,s;for(r=0,s=n.length;r<s;++r){const o=n[r];(!e||o.visible)&&i.push(o)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,i={meta:e,index:e.index,cancelable:!0},r=Kge(this,e);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(r&&Rx(n,r),e.controller.draw(),r&&_x(n),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(e){return Cf(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,i,r){const s=wme.modes[n];return typeof s=="function"?s(this,e,i,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],i=this._metasets;let r=i.filter(s=>s&&s._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=Xc(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!n.hidden}setDatasetVisibility(e,n){const i=this.getDatasetMeta(e);i.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,i){const r=i?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,r);Cw(n)?(s.data[n].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),o.update(s,{visible:i}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),io.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),ik(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Cp[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,i=(s,o)=>{n.addEventListener(this,s,o),e[s]=o},r=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};$n(this.options.events,s=>i(s,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,i=(l,u)=>{n.addEventListener(this,l,u),e[l]=u},r=(l,u)=>{e[l]&&(n.removeEventListener(this,l,u),delete e[l])},s=(l,u)=>{this.canvas&&this.resize(l,u)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),i("resize",s),i("detach",o)};o=()=>{this.attached=!1,r("resize",s),this._stop(),this._resize(0,0),i("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){$n(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},$n(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,i){const r=i?"set":"remove";let s,o,a,l;for(n==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],i=e.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!zN(i,n)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,n))}notifyPlugins(e,n,i){return this._plugins.notify(this,e,n,i)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,i){const r=this.options.hover,s=(l,u)=>l.filter(c=>!u.some(h=>c.datasetIndex===h.datasetIndex&&c.index===h.index)),o=s(n,e),a=i?e:s(e,n);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,n){const i={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const s=this._handleEvent(e,n,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(s||i.changed)&&this.render(),this}_handleEvent(e,n,i){const{_active:r=[],options:s}=this,o=n,a=this._getActiveElements(e,r,i,o),l=Sfe(e),u=Cpe(e,this._lastEvent,i,l);i&&(this._lastEvent=null,Tt(s.onHover,[e,a,this],this),l&&Tt(s.onClick,[e,a,this],this));const c=!zN(a,r);return(c||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=u,c}_getActiveElements(e,n,i,r){if(e.type==="mouseout")return[];if(!i)return n;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,r)}}function Nk(){return $n(a_.instances,t=>t._plugins.invalidate())}function hj(t,e,n=e){t.lineCap=Xe(n.borderCapStyle,e.borderCapStyle),t.setLineDash(Xe(n.borderDash,e.borderDash)),t.lineDashOffset=Xe(n.borderDashOffset,e.borderDashOffset),t.lineJoin=Xe(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Xe(n.borderWidth,e.borderWidth),t.strokeStyle=Xe(n.borderColor,e.borderColor)}function bpe(t,e,n){t.lineTo(n.x,n.y)}function Spe(t){return t.stepped?Qfe:t.tension||t.cubicInterpolationMode==="monotone"?Jfe:bpe}function dj(t,e,n={}){const i=t.length,{start:r=0,end:s=i-1}=n,{start:o,end:a}=e,l=Math.max(r,o),u=Math.min(s,a),c=r<o&&s<o||r>a&&s>a;return{count:i,start:l,loop:e.loop,ilen:u<l&&!c?i+u-l:u-l}}function Rpe(t,e,n,i){const{points:r,options:s}=e,{count:o,start:a,loop:l,ilen:u}=dj(r,n,i),c=Spe(s);let{move:h=!0,reverse:d}=i||{},f,g,m;for(f=0;f<=u;++f)g=r[(a+(d?u-f:f))%o],!g.skip&&(h?(t.moveTo(g.x,g.y),h=!1):c(t,m,g,d,s.stepped),m=g);return l&&(g=r[(a+(d?u:0))%o],c(t,m,g,d,s.stepped)),!!l}function _pe(t,e,n,i){const r=e.points,{count:s,start:o,ilen:a}=dj(r,n,i),{move:l=!0,reverse:u}=i||{};let c=0,h=0,d,f,g,m,v,S;const y=I=>(o+(u?a-I:I))%s,M=()=>{m!==v&&(t.lineTo(c,v),t.lineTo(c,m),t.lineTo(c,S))};for(l&&(f=r[y(0)],t.moveTo(f.x,f.y)),d=0;d<=a;++d){if(f=r[y(d)],f.skip)continue;const I=f.x,P=f.y,E=I|0;E===g?(P<m?m=P:P>v&&(v=P),c=(h*c+I)/++h):(M(),t.lineTo(I,P),g=E,h=0,m=v=P),S=P}M()}function l_(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?_pe:Rpe}function Epe(t){return t.stepped?Dge:t.tension||t.cubicInterpolationMode==="monotone"?Nge:El}function Tpe(t,e,n,i){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,i)&&r.closePath()),hj(t,e.options),t.stroke(r)}function Mpe(t,e,n,i){const{segments:r,options:s}=e,o=l_(e);for(const a of r)hj(t,s,a.style),t.beginPath(),o(t,e,a,{start:n,end:n+i-1})&&t.closePath(),t.stroke()}const xpe=typeof Path2D=="function";function Ppe(t,e,n,i){xpe&&!e.options.segment?Tpe(t,e,n,i):Mpe(t,e,n,i)}class Ipe extends Zc{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;Tge(this._points,i,e,r,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Uge(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,i=e.length;return i&&n[e[i-1].end]}interpolate(e,n){const i=this.options,r=e[n],s=this.points,o=Bge(this,{property:n,start:r,end:r});if(!o.length)return;const a=[],l=Epe(i);let u,c;for(u=0,c=o.length;u<c;++u){const{start:h,end:d}=o[u],f=s[h],g=s[d];if(f===g){a.push(f);continue}const m=Math.abs((r-f[n])/(g[n]-f[n])),v=l(f,g,m,i.stepped);v[n]=e[n],a.push(v)}return a.length===1?a[0]:a}pathSegment(e,n,i){return l_(this)(e,this,n,i)}path(e,n,i){const r=this.segments,s=l_(this);let o=this._loop;n=n||0,i=i||this.points.length-n;for(const a of r)o&=s(e,this,a,{start:n,end:n+i-1});return!!o}draw(e,n,i,r){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),Ppe(e,this,i,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function kk(t,e,n,i){const r=t.options,{[n]:s}=t.getProps([n],i);return Math.abs(e-s)<r.radius+r.hitRadius}class Ope extends Zc{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,n,i){const r=this.options,{x:s,y:o}=this.getProps(["x","y"],i);return Math.pow(e-s,2)+Math.pow(n-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,n){return kk(this,e,"x",n)}inYRange(e,n){return kk(this,e,"y",n)}getCenterPoint(e){const{x:n,y:i}=this.getProps(["x","y"],e);return{x:n,y:i}}size(e){e=e||this.options||{};let n=e.radius||0;n=Math.max(n,n&&e.hoverRadius||0);const i=n&&e.borderWidth||0;return(n+i)*2}draw(e,n){const i=this.options;this.skip||i.radius<.1||!Cf(this,n,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,Zfe(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}const Lk=(t,e)=>{let{boxHeight:n=e,boxWidth:i=e}=t;return t.usePointStyle&&(n=Math.min(n,e),i=t.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(e,n)}},Ape=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class Fk extends Zc{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,i){this.maxWidth=e,this.maxHeight=n,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Tt(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(i=>e.filter(i,this.chart.data))),e.sort&&(n=n.sort((i,r)=>e.sort(i,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,r=vo(i.font),s=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=Lk(i,s);let u,c;n.font=r.string,this.isHorizontal()?(u=this.maxWidth,c=this._fitRows(o,s,a,l)+10):(c=this.maxHeight,u=this._fitCols(o,r,a,l)+10),this.width=Math.min(u,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,n,i,r){const{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.lineWidths=[0],c=r+a;let h=e;s.textAlign="left",s.textBaseline="middle";let d=-1,f=-c;return this.legendItems.forEach((g,m)=>{const v=i+n/2+s.measureText(g.text).width;(m===0||u[u.length-1]+v+2*a>o)&&(h+=c,u[u.length-(m>0?0:1)]=0,f+=c,d++),l[m]={left:0,top:f,row:d,width:v,height:r},u[u.length-1]+=v+a}),h}_fitCols(e,n,i,r){const{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.columnSizes=[],c=o-e;let h=a,d=0,f=0,g=0,m=0;return this.legendItems.forEach((v,S)=>{const{itemWidth:y,itemHeight:M}=Hpe(i,n,s,v,r);S>0&&f+M+2*a>c&&(h+=d+a,u.push({width:d,height:f}),g+=d+a,m++,d=f=0),l[S]={left:g,top:f,col:m,width:y,height:M},d=Math.max(d,y),f+=M+a}),h+=d,u.push({width:d,height:f}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:r},rtl:s}}=this,o=jR(s,this.left,this.width);if(this.isHorizontal()){let a=0,l=Vn(i,this.left+r,this.right-this.lineWidths[a]);for(const u of n)a!==u.row&&(a=u.row,l=Vn(i,this.left+r,this.right-this.lineWidths[a])),u.top+=this.top+e+r,u.left=o.leftForLtr(o.x(l),u.width),l+=u.width+r}else{let a=0,l=Vn(i,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const u of n)u.col!==a&&(a=u.col,l=Vn(i,this.top+e+r,this.bottom-this.columnSizes[a].height)),u.top=l,u.left+=this.left+r,u.left=o.leftForLtr(o.x(u.left),u.width),l+=u.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Rx(e,this),this._draw(),_x(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:i,ctx:r}=this,{align:s,labels:o}=e,a=Jt.color,l=jR(e.rtl,this.left,this.width),u=vo(o.font),{padding:c}=o,h=u.size,d=h/2;let f;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=u.string;const{boxWidth:g,boxHeight:m,itemHeight:v}=Lk(o,h),S=function(E,T,$){if(isNaN(g)||g<=0||isNaN(m)||m<0)return;r.save();const U=Xe($.lineWidth,1);if(r.fillStyle=Xe($.fillStyle,a),r.lineCap=Xe($.lineCap,"butt"),r.lineDashOffset=Xe($.lineDashOffset,0),r.lineJoin=Xe($.lineJoin,"miter"),r.lineWidth=U,r.strokeStyle=Xe($.strokeStyle,a),r.setLineDash(Xe($.lineDash,[])),o.usePointStyle){const O={radius:m*Math.SQRT2/2,pointStyle:$.pointStyle,rotation:$.rotation,borderWidth:U},G=l.xPlus(E,g/2),q=T+d;YB(r,O,G,q,o.pointStyleWidth&&g)}else{const O=T+Math.max((h-m)/2,0),G=l.leftForLtr(E,g),q=uge($.borderRadius);r.beginPath(),Object.values(q).some(ne=>ne!==0)?ige(r,{x:G,y:O,w:g,h:m,radius:q}):r.rect(G,O,g,m),r.fill(),U!==0&&r.stroke()}r.restore()},y=function(E,T,$){bf(r,$.text,E,T+v/2,u,{strikethrough:$.hidden,textAlign:l.textAlign($.textAlign)})},M=this.isHorizontal(),I=this._computeTitleHeight();M?f={x:Vn(s,this.left+c,this.right-i[0]),y:this.top+c+I,line:0}:f={x:this.left+c,y:Vn(s,this.top+I+c,this.bottom-n[0].height),line:0},Fge(this.ctx,e.textDirection);const P=v+c;this.legendItems.forEach((E,T)=>{r.strokeStyle=E.fontColor,r.fillStyle=E.fontColor;const $=r.measureText(E.text).width,U=l.textAlign(E.textAlign||(E.textAlign=o.textAlign)),O=g+d+$;let G=f.x,q=f.y;l.setWidth(this.width),M?T>0&&G+O+c>this.right&&(q=f.y+=P,f.line++,G=f.x=Vn(s,this.left+c,this.right-i[f.line])):T>0&&q+P>this.bottom&&(G=f.x=G+n[f.line].width+c,f.line++,q=f.y=Vn(s,this.top+I+c,this.bottom-n[f.line].height));const ne=l.x(G);if(S(ne,q,E),G=Ffe(U,G+g+d,M?G+O:this.right,e.rtl),y(l.x(G),q,E),M)f.x+=O+c;else if(typeof E.text!="string"){const Q=u.lineHeight;f.y+=fj(E,Q)+c}else f.y+=P}),$ge(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,i=vo(n.font),r=Eo(n.padding);if(!n.display)return;const s=jR(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=i.size/2,u=r.top+l;let c,h=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),c=this.top+u,h=Vn(e.align,h,this.right-d);else{const g=this.columnSizes.reduce((m,v)=>Math.max(m,v.height),0);c=u+Vn(e.align,this.top,this.bottom-g-e.labels.padding-this._computeTitleHeight())}const f=Vn(a,h,h+d);o.textAlign=s.textAlign(bx(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=i.string,bf(o,n.text,f,c,i)}_computeTitleHeight(){const e=this.options.title,n=vo(e.font),i=Eo(e.padding);return e.display?n.lineHeight+i.height:0}_getLegendItemAt(e,n){let i,r,s;if(vd(e,this.left,this.right)&&vd(n,this.top,this.bottom)){for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(r=s[i],vd(e,r.left,r.left+r.width)&&vd(n,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(e){const n=this.options;if(!kpe(e.type,n))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,s=Ape(r,i);r&&!s&&Tt(n.onLeave,[e,r,this],this),this._hoveredItem=i,i&&!s&&Tt(n.onHover,[e,i,this],this)}else i&&Tt(n.onClick,[e,i,this],this)}}function Hpe(t,e,n,i,r){const s=Dpe(i,t,e,n),o=Npe(r,i,e.lineHeight);return{itemWidth:s,itemHeight:o}}function Dpe(t,e,n,i){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((s,o)=>s.length>o.length?s:o)),e+n.size/2+i.measureText(r).width}function Npe(t,e,n){let i=t;return typeof e.text!="string"&&(i=fj(e,n)),i}function fj(t,e){const n=t.text?t.text.length:0;return e*n}function kpe(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var Lpe={id:"legend",_element:Fk,start(t,e,n){const i=t.legend=new Fk({ctx:t.ctx,options:n,chart:t});ar.configure(t,i,n),ar.addBox(t,i)},stop(t){ar.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const i=t.legend;ar.configure(t,i,n),i.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const i=e.datasetIndex,r=n.chart;r.isDatasetVisible(i)?(r.hide(i),e.hidden=!0):(r.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:r,color:s,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const u=l.controller.getStyle(n?0:void 0),c=Eo(u.borderWidth);return{text:e[l.index].label,fillStyle:u.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:u.borderColor,pointStyle:i||u.pointStyle,rotation:u.rotation,textAlign:r||u.textAlign,borderRadius:o&&(a||u.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class gj extends Zc{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const r=Pn(i.text)?i.text.length:1;this._padding=Eo(i.padding);const s=r*vo(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:i,bottom:r,right:s,options:o}=this,a=o.align;let l=0,u,c,h;return this.isHorizontal()?(c=Vn(a,i,s),h=n+e,u=s-i):(o.position==="left"?(c=i+e,h=Vn(a,r,n),l=En*-.5):(c=s-e,h=Vn(a,n,r),l=En*.5),u=r-n),{titleX:c,titleY:h,maxWidth:u,rotation:l}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const i=vo(n.font),s=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:u}=this._drawArgs(s);bf(e,n.text,0,0,i,{color:n.color,maxWidth:l,rotation:u,textAlign:bx(n.align),textBaseline:"middle",translation:[o,a]})}}function Fpe(t,e){const n=new gj({ctx:t.ctx,options:e,chart:t});ar.configure(t,n,e),ar.addBox(t,n),t.titleBlock=n}var $pe={id:"title",_element:gj,start(t,e,n){Fpe(t,n)},stop(t){const e=t.titleBlock;ar.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const i=t.titleBlock;ar.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Vpe=(t,e,n,i)=>(typeof e=="string"?(n=t.push(e)-1,i.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function Wpe(t,e,n,i){const r=t.indexOf(e);if(r===-1)return Vpe(t,e,n,i);const s=t.lastIndexOf(e);return r!==s?n:r}const Bpe=(t,e)=>t===null?null:_s(Math.round(t),0,e);function $k(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class jpe extends Qc{static id="category";static defaults={ticks:{callback:$k}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const i=this.getLabels();for(const{index:r,label:s}of n)i[r]===s&&i.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(xt(e))return null;const i=this.getLabels();return n=isFinite(n)&&i[n]===e?n:Wpe(i,e,Xe(n,e),this._addedLabels),Bpe(n,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),n||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const e=this.min,n=this.max,i=this.options.offset,r=[];let s=this.getLabels();s=e===0&&n===s.length-1?s:s.slice(e,n+1),this._valueRange=Math.max(s.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let o=e;o<=n;o++)r.push({value:o});return r}getLabelForValue(e){return $k.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function zpe(t,e){const n=[],{bounds:r,step:s,min:o,max:a,precision:l,count:u,maxTicks:c,maxDigits:h,includeBounds:d}=t,f=s||1,g=c-1,{min:m,max:v}=e,S=!xt(o),y=!xt(a),M=!xt(u),I=(v-m)/(h+1);let P=qN((v-m)/g/f)*f,E,T,$,U;if(P<1e-14&&!S&&!y)return[{value:m},{value:v}];U=Math.ceil(v/P)-Math.floor(m/P),U>g&&(P=qN(U*P/g/f)*f),xt(l)||(E=Math.pow(10,l),P=Math.ceil(P*E)/E),r==="ticks"?(T=Math.floor(m/P)*P,$=Math.ceil(v/P)*P):(T=m,$=v),S&&y&&s&&Mfe((a-o)/s,P/1e3)?(U=Math.round(Math.min((a-o)/P,c)),P=(a-o)/U,T=o,$=a):M?(T=S?o:T,$=y?a:$,U=u-1,P=($-T)/U):(U=($-T)/P,Yd(U,Math.round(U),P/1e3)?U=Math.round(U):U=Math.ceil(U));const O=Math.max(KN(P),KN(T));E=Math.pow(10,xt(l)?O:l),T=Math.round(T*E)/E,$=Math.round($*E)/E;let G=0;for(S&&(d&&T!==o?(n.push({value:o}),T<o&&G++,Yd(Math.round((T+G*P)*E)/E,o,Vk(o,I,t))&&G++):T<o&&G++);G<U;++G){const q=Math.round((T+G*P)*E)/E;if(y&&q>a)break;n.push({value:q})}return y&&d&&$!==a?n.length&&Yd(n[n.length-1].value,a,Vk(a,I,t))?n[n.length-1].value=a:n.push({value:a}):(!y||$===a)&&n.push({value:$}),n}function Vk(t,e,{horizontal:n,minRotation:i}){const r=kl(i),s=(n?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/s,o)}class Upe extends Qc{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return xt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:i}=this.getUserBounds();let{min:r,max:s}=this;const o=l=>r=n?r:l,a=l=>s=i?s:l;if(e){const l=Oc(r),u=Oc(s);l<0&&u<0?a(0):l>0&&u>0&&o(0)}if(r===s){let l=s===0?1:Math.abs(s*.05);a(s+l),e||o(r-l)}this.min=r,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:i}=e,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},s=this._range||this,o=zpe(r,s);return e.bounds==="ticks"&&xfe(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const r=(i-n)/Math.max(e.length-1,1)/2;n-=r,i+=r}this._startValue=n,this._endValue=i,this._valueRange=i-n}getLabelForValue(e){return zB(e,this.chart.options.locale,this.options.ticks.format)}}class Ype extends Upe{static id="linear";static defaults={ticks:{callback:UB.formatters.numeric}};determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=hr(e)?e:0,this.max=hr(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,i=kl(this.options.ticks.minRotation),r=(e?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,s.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const Pv={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},_i=Object.keys(Pv);function Wk(t,e){return t-e}function Bk(t,e){if(xt(e))return null;const n=t._adapter,{parser:i,round:r,isoWeekday:s}=t._parseOpts;let o=e;return typeof i=="function"&&(o=i(o)),hr(o)||(o=typeof i=="string"?n.parse(o,i):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(yf(s)||s===!0)?n.startOf(o,"isoWeek",s):n.startOf(o,r)),+o)}function jk(t,e,n,i){const r=_i.length;for(let s=_i.indexOf(t);s<r-1;++s){const o=Pv[_i[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=i)return _i[s]}return _i[r-1]}function Gpe(t,e,n,i,r){for(let s=_i.length-1;s>=_i.indexOf(n);s--){const o=_i[s];if(Pv[o].common&&t._adapter.diff(r,i,o)>=e-1)return o}return _i[n?_i.indexOf(n):0]}function qpe(t){for(let e=_i.indexOf(t)+1,n=_i.length;e<n;++e)if(Pv[_i[e]].common)return _i[e]}function zk(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:i,hi:r}=Cx(n,e),s=n[i]>=e?n[i]:n[r];t[s]=!0}}function Kpe(t,e,n,i){const r=t._adapter,s=+r.startOf(e[0].value,i),o=e[e.length-1].value;let a,l;for(a=s;a<=o;a=+r.add(a,1,i))l=n[a],l>=0&&(e[l].major=!0);return e}function Uk(t,e,n){const i=[],r={},s=e.length;let o,a;for(o=0;o<s;++o)a=e[o],r[a]=o,i.push({value:a,major:!1});return s===0||!n?i:Kpe(t,i,r,n)}class Yk extends Qc{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const i=e.time||(e.time={}),r=this._adapter=new dme._date(e.adapters.date);r.init(n),Ud(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:Bk(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,i=e.time.unit||"day";let{min:r,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function l(u){!o&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!a&&!isNaN(u.max)&&(s=Math.max(s,u.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=hr(r)&&!isNaN(r)?r:+n.startOf(Date.now(),i),s=hr(s)&&!isNaN(s)?s:+n.endOf(Date.now(),i)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],i=e[e.length-1]),{min:n,max:i}}buildTicks(){const e=this.options,n=e.time,i=e.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const s=this.min,o=this.max,a=Dfe(r,s,o);return this._unit=n.unit||(i.autoSkip?jk(n.minUnit,this.min,this.max,this._getLabelCapacity(s)):Gpe(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:qpe(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),Uk(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,i=0,r,s;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?i=s:i=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=_s(n,0,o),i=_s(i,0,o),this._offsets={start:n,end:i,factor:1/(n+1+i)}}_generate(){const e=this._adapter,n=this.min,i=this.max,r=this.options,s=r.time,o=s.unit||jk(s.minUnit,n,i,this._getLabelCapacity(n)),a=Xe(r.ticks.stepSize,1),l=o==="week"?s.isoWeekday:!1,u=yf(l)||l===!0,c={};let h=n,d,f;if(u&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,u?"day":o),e.diff(i,n,o)>1e5*a)throw new Error(n+" and "+i+" are too far apart with stepSize of "+a+" "+o);const g=r.ticks.source==="data"&&this.getDataTimestamps();for(d=h,f=0;d<i;d=+e.add(d,a,o),f++)zk(c,d,g);return(d===i||r.bounds==="ticks"||f===1)&&zk(c,d,g),Object.keys(c).sort(Wk).map(m=>+m)}getLabelForValue(e){const n=this._adapter,i=this.options.time;return i.tooltipFormat?n.format(e,i.tooltipFormat):n.format(e,i.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,s=this._unit,o=n||r[s];return this._adapter.format(e,o)}_tickFormatFunction(e,n,i,r){const s=this.options,o=s.ticks.callback;if(o)return Tt(o,[e,n,i],this);const a=s.time.displayFormats,l=this._unit,u=this._majorUnit,c=l&&a[l],h=u&&a[u],d=i[n],f=u&&h&&d&&d.major;return this._adapter.format(e,r||(f?h:c))}generateTickLabels(e){let n,i,r;for(n=0,i=e.length;n<i;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+i)*n.factor)}getValueForPixel(e){const n=this._offsets,i=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,i=this.ctx.measureText(e).width,r=kl(this.isHorizontal()?n.maxRotation:n.minRotation),s=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:i*s+a*o,h:i*o+a*s}}_getLabelCapacity(e){const n=this.options.time,i=n.displayFormats,r=i[n.unit]||i.millisecond,s=this._tickFormatFunction(e,0,Uk(this,[e],this._majorUnit),r),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,i;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,i=r.length;n<i;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,i;if(e.length)return e;const r=this.getLabels();for(n=0,i=r.length;n<i;++n)e.push(Bk(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return kfe(e.sort(Wk))}}function Xm(t,e,n){let i=0,r=t.length-1,s,o,a,l;n?(e>=t[i].pos&&e<=t[r].pos&&({lo:i,hi:r}=Ll(t,"pos",e)),{pos:s,time:a}=t[i],{pos:o,time:l}=t[r]):(e>=t[i].time&&e<=t[r].time&&({lo:i,hi:r}=Ll(t,"time",e)),{time:s,pos:a}=t[i],{time:o,pos:l}=t[r]);const u=o-s;return u?a+(l-a)*(e-s)/u:a}class dwe extends Yk{static id="timeseries";static defaults=Yk.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Xm(n,this.min),this._tableRange=Xm(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:i}=this,r=[],s=[];let o,a,l,u,c;for(o=0,a=e.length;o<a;++o)u=e[o],u>=n&&u<=i&&r.push(u);if(r.length<2)return[{time:n,pos:0},{time:i,pos:1}];for(o=0,a=r.length;o<a;++o)c=r[o+1],l=r[o-1],u=r[o],Math.round((c+l)/2)!==u&&s.push({time:u,pos:o/(a-1)});return s}_generate(){const e=this.min,n=this.max;let i=super.getDataTimestamps();return(!i.includes(e)||!i.length)&&i.splice(0,0,e),(!i.includes(n)||i.length===1)&&i.push(n),i.sort((r,s)=>r-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),i=this.getLabelTimestamps();return n.length&&i.length?e=this.normalize(n.concat(i)):e=n.length?n:i,e=this._cache.all=e,e}getDecimalForValue(e){return(Xm(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,i=this.getDecimalForPixel(e)/n.factor-n.end;return Xm(this._table,i*this._tableRange+this._minPos,!0)}}const Xpe={class:"p-6"},Zpe={class:"mt-8 w-full max-w-4xl h-[1000px] mx-auto"},fwe={__name:"Simulation",setup(t){a_.register(hme,Ipe,Ope,Ype,$pe,jpe,Lpe);const e=Hv(null),n=Hv(null),i=Hv(null);let r=null;Cj(()=>{n.value=new Se(e.value,{data:[["1æ",1e4,12e3],["2æ",15e3,16e3],["3æ",15e3,16e3],["4æ",15e3,16e3],["5æ",15e3,16e3],["6æ",15e3,16e3],["7æ",15e3,16e3],["8æ",15e3,16e3],["9æ",15e3,16e3],["10æ",15e3,16e3],["11æ",15e3,16e3],["12æ",17e3,18e3]],colHeaders:["æ","ãã©ã³A","ãã©ã³B"],rowHeaders:!0,licenseKey:"non-commercial-and-evaluation",width:"100%",height:"auto",stretchH:"all",afterChange:(a,l)=>{l!=="loadData"&&s()}}),s()});const s=()=>{const a=n.value.getData(),l=a.map(h=>h[0]),u=a.map(h=>Number(h[1])||0),c=a.map(h=>Number(h[2])||0);r&&r.destroy(),r=new a_(i.value,{type:"line",data:{labels:l,datasets:[{label:"ãã©ã³A",data:u,borderColor:"blue",backgroundColor:"rgba(0, 0, 255, 0.1)",tension:.3},{label:"ãã©ã³B",data:c,borderColor:"green",backgroundColor:"rgba(0, 255, 0, 0.1)",tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"è²¯èãã©ã³ã®æ¯è¼"}},scales:{y:{beginAtZero:!0,ticks:{callback:h=>`Â¥${h.toLocaleString()}`}}}}})},o=async()=>{const a=["æ","ãã©ã³A","ãã©ã³B"],l=n.value.getData(),u=[a,...l];try{const c=await Sj.post("/simulation/export",{data:u},{responseType:"blob"}),h=new Blob([c.data],{type:c.headers["content-type"]}),d=document.createElement("a");d.href=URL.createObjectURL(h),d.download="simulation_with_chart.xlsx",d.click(),URL.revokeObjectURL(d.href)}catch(c){console.error("Export failed:",c),alert("Failed to export Excel.")}};return(a,l)=>(Rj(),bj("div",Xpe,[l[0]||(l[0]=uu("h1",{class:"text-xl font-bold mb-4"},"ãã¼ã¿ã·ãã¥ã¬ã¼ã·ã§ã³",-1)),uu("div",{ref_key:"hotElement",ref:e},null,512),uu("div",Zpe,[uu("canvas",{ref_key:"chartCanvas",ref:i,class:"w-full h-full"},null,512)]),uu("div",{class:"mt-4 flex gap-2"},[uu("button",{onClick:o,class:"px-4 py-2 bg-green-600 text-white rounded"}," ãã¦ã³ã­ã¼ã ")])]))}};export{fwe as default};
